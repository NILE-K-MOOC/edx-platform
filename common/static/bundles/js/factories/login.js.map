{"version":3,"sources":["webpack:///./cms/static/js/factories/login.js","webpack:///external \"jQuery\"?0cb8*****************","webpack:///external \"_\"?b3b9***************","webpack:///external \"Backbone\"?709d**********","webpack:///external \"gettext\"?8b52*******"],"names":["LoginFactory","homepageURL","postJSON","url","data","callback","$","ajax","type","dataType","success","on","removeClass","submit","event","preventDefault","$submitButton","deferred","Deferred","promise","ViewUtils","disableElementWhileRunning","submit_data","serialize","json","next","exec","decodeURIComponent","window","location","search","length","isExternal","redirect","prepend","value","addClass","resolve","stop","html"],"mappings":";;;;;;;;;;;;;;;;AACA;;AAEA;AACA;AACA;;AAEe,SAASA,YAAT,CAAsBC,WAAtB,EAAmC;AAC9C,aAASC,QAAT,CAAkBC,GAAlB,EAAuBC,IAAvB,EAA6BC,QAA7B,EAAuC;AACnCC,UAAEC,IAAF,CAAO;AACHC,kBAAM,MADH;AAEHL,iBAAKA,GAFF;AAGHM,sBAAU,MAHP;AAIHL,kBAAMA,IAJH;AAKHM,qBAASL;AALN,SAAP;AAOH;;AAED;AACAC,MAAE,aAAF,EAAiBK,EAAjB,CAAoB,OAApB,EAA6B,YAAY;AACrCL,UAAE,cAAF,EAAkBM,WAAlB,CAA8B,UAA9B;AACH,KAFD;;AAIAN,MAAE,gBAAF,EAAoBK,EAApB,CAAuB,OAAvB,EAAgC,YAAY;AACxCL,UAAE,cAAF,EAAkBM,WAAlB,CAA8B,UAA9B;AACH,KAFD;;AAIAN,MAAE,iBAAF,EAAqBO,MAArB,CAA4B,UAAUC,KAAV,EAAiB;AACzCA,cAAMC,cAAN;AACA,YAAIC,gBAAgBV,EAAE,SAAF,CAApB;AAAA,YACIW,WAAW,IAAIX,EAAEY,QAAN,EADf;AAAA,YAEIC,UAAUF,SAASE,OAAT,EAFd;AAGAC,QAAA,6EAAAA,CAAUC,0BAAV,CAAqCL,aAArC,EAAoD,YAAY;AAAE,mBAAOG,OAAP;AAAiB,SAAnF;AACA,YAAIG,cAAchB,EAAE,aAAF,EAAiBiB,SAAjB,EAAlB;;AAEArB,iBAAS,aAAT,EAAwBoB,WAAxB,EAAqC,UAAUE,IAAV,EAAgB;AACjD,gBAAIA,KAAKd,OAAT,EAAkB;AACd,oBAAIe,OAAO,gBAAgBC,IAAhB,CAAqBC,mBAAmBC,OAAOC,QAAP,CAAgBC,MAAnC,CAArB,CAAX;AACA,oBAAIL,QAAQA,KAAKM,MAAL,GAAc,CAAtB,IAA2B,CAACC,WAAWP,KAAK,CAAL,CAAX,CAAhC,EAAqD;AACjDL,oBAAA,6EAAAA,CAAUa,QAAV,CAAmBR,KAAK,CAAL,CAAnB;AACH,iBAFD,MAEO;AACHL,oBAAA,6EAAAA,CAAUa,QAAV,CAAmBhC,WAAnB;AACH;AACJ,aAPD,MAOO,IAAIK,EAAE,cAAF,EAAkByB,MAAlB,KAA6B,CAAjC,EAAoC;AACvCzB,kBAAE,aAAF,EAAiB4B,OAAjB,CACI,gEACAV,KAAKW,KADL,GAEA,eAHJ;AAKA7B,kBAAE,cAAF,EAAkB8B,QAAlB,CAA2B,UAA3B;AACAnB,yBAASoB,OAAT;AACH,aARM,MAQA;AACH/B,kBAAE,cAAF,EACKgC,IADL,GAEKF,QAFL,CAEc,UAFd,EAGKG,IAHL,CAGUf,KAAKW,KAHf;AAIAlB,yBAASoB,OAAT;AACH;AACJ,SAvBD;AAwBH,KAhCD;AAiCH;;;;;;;;;;AC5DD,aAAa,mCAAmC,EAAE,I;;;;;;;ACAlD,aAAa,8BAA8B,EAAE,I;;;;;;;ACA7C,aAAa,qCAAqC,EAAE,I;;;;;;;ACApD,aAAa,oCAAoC,EAAE,I","file":"js/factories/login.js","sourcesContent":["\n'use strict';\n\nimport cookie from 'jquery.cookie';\nimport utility from 'utility';\nimport ViewUtils from 'common/js/components/utils/view_utils';\n\nexport default function LoginFactory(homepageURL) {\n    function postJSON(url, data, callback) {\n        $.ajax({\n            type: 'POST',\n            url: url,\n            dataType: 'json',\n            data: data,\n            success: callback\n        });\n    }\n\n    // Clear the login error message when credentials are edited\n    $('input#email').on('input', function () {\n        $('#login_error').removeClass('is-shown');\n    });\n\n    $('input#password').on('input', function () {\n        $('#login_error').removeClass('is-shown');\n    });\n\n    $('form#login_form').submit(function (event) {\n        event.preventDefault();\n        var $submitButton = $('#submit'),\n            deferred = new $.Deferred(),\n            promise = deferred.promise();\n        ViewUtils.disableElementWhileRunning($submitButton, function () { return promise; });\n        var submit_data = $('#login_form').serialize();\n\n        postJSON('/login_post', submit_data, function (json) {\n            if (json.success) {\n                var next = /next=([^&]*)/g.exec(decodeURIComponent(window.location.search));\n                if (next && next.length > 1 && !isExternal(next[1])) {\n                    ViewUtils.redirect(next[1]);\n                } else {\n                    ViewUtils.redirect(homepageURL);\n                }\n            } else if ($('#login_error').length === 0) {\n                $('#login_form').prepend(\n                    '<div id=\"login_error\" class=\"message message-status error\">' +\n                    json.value +\n                    '</span></div>'\n                );\n                $('#login_error').addClass('is-shown');\n                deferred.resolve();\n            } else {\n                $('#login_error')\n                    .stop()\n                    .addClass('is-shown')\n                    .html(json.value);\n                deferred.resolve();\n            }\n        });\n    });\n};\n\nexport { LoginFactory }\n\n\n\n// WEBPACK FOOTER //\n// ./cms/static/js/factories/login.js","(function() { module.exports = window[\"jQuery\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = 1 2 3 4 7 8 9 11 12 13 14 15 16 17 18 19 22 23 24 25 26 27 28 29 30 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 83","(function() { module.exports = window[\"_\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 1\n// module chunks = 1 2 3 4 7 8 9 12 13 14 16 17 18 19 22 23 24 25 26 27 28 29 30 33 34 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74","(function() { module.exports = window[\"Backbone\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Backbone\"\n// module id = 2\n// module chunks = 1 3 4 7 8 9 12 13 18 19 22 23 32 84","(function() { module.exports = window[\"gettext\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"gettext\"\n// module id = 3\n// module chunks = 3 4 8 12 13 14 18 19 23"],"sourceRoot":""}