{"version":3,"sources":["webpack:///./common/lib/xmodule/xmodule/js/src/time.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_async_process.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_component.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_i18n.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_iterator.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_resizer.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_sjson.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/00_video_storage.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/01_initialize.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/025_focus_grabber.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/02_html5_hls_video.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/02_html5_video.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/035_video_accessible_menu.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/03_video_player.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/04_video_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/04_video_full_screen.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/05_video_quality_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/06_video_progress_slider.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/07_video_volume_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/08_video_auto_advance_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/08_video_speed_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/095_video_context_menu.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_bumper.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_completion.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_events_bumper_plugin.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_events_plugin.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_play_pause_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_play_placeholder.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_play_skip_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_poster.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_save_state_plugin.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_skip_control.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/09_video_caption.js","webpack:///./common/lib/xmodule/xmodule/js/src/video/10_commands.js","webpack:///./common/static/js/vendor/draggabilly.js","webpack:///./common/static/xmodule/modules/js/001-e45ae357eab0e4e2784fa6d04d4e16c1.js","webpack:///./~/hls.js/dist/hls.js","webpack:///external \"jQuery\"?0cb8*","webpack:///external \"_\"?b3b9*"],"names":["format","time","formatFull","hours","minutes","seconds","_","isFinite","Math","floor","_pad","convert","oldSpeed","newSpeed","toFixed","number","AsyncProcess","array","list","process","isArray","$","Deferred","reject","promise","isFunction","length","resolve","MAX_DELAY","dfd","result","index","len","getCurrentTime","Date","getTime","handler","start","setTimeout","inherit","Object","create","F","o","arguments","Error","isNull","isUndefined","isObject","TypeError","prototype","Component","initialize","apply","extend","protoProps","staticProps","Parent","Child","constructor","__super__","Play","gettext","Pause","Mute","Unmute","Speed","Volume","Muted","Low","Average","Loud","Maximum","Iterator","size","lastIndex","_isValid","isNumber","next","prev","last","first","isEnd","Resizer","params","defaults","container","window","element","containerRatio","elementRatio","callbacksList","delta","height","width","module","mode","config","console","log","getData","$container","containerWidth","containerHeight","$element","align","data","alignByHeightOnly","alignByWidthOnly","fireCallbacks","css","top","left","setMode","param","isString","setElement","addCallback","func","push","error","addOnceCallback","decorator","removeCallback","each","callback","removeCallbacks","inArray","splice","resetDelta","addDelta","value","side","substractDelta","destroy","setParams","callbacks","add","once","remove","removeAll","substract","reset","Sjson","sjson","concat","text","getter","propertyName","getStartTimes","getCaptions","search","startTime","endTime","max","min","results","filter","captions","ceil","end","filteredTimes","filteredCaptions","startTimes","warn","currentStartTime","i","getSize","VideoStorage","namespace","id","setItem","name","instanceSpecific","getItem","removeItem","clear","random","toString","slice","VideoPlayer","i18n","moment","Initialize","state","_makeFunctionsPublic","done","isYoutubeType","parseSpeed","test","isTouch","_hideWaitPlaceholder","el","trigger","_initializeModules","on","methodsDict","bindTo","fetchMetadata","getCurrentLanguage","getDuration","getPlayerMode","getVideoMetadata","isHtml5Mode","isFlashMode","parseYoutubeStreams","setPlayerMode","setSpeed","setAutoAdvance","speedToString","youtubeId","loadHtmlPlayer","loadYoutubePlayer","loadYouTubeIFrameAPI","_youtubeApiDeferred","_oldOnYouTubeIframeAPIReady","_renderElements","video","onYTApiReady","setupOnYouTubeIframeAPIReady","videoType","youtubeApiAvailable","htmlPlayerLoaded","modules","__dfd__","YT","ready","onYouTubeIframeAPIReady","undefined","_waitForYoutubeApi","ytTestTimeout","scriptTag","firstScriptTag","document","getElementsByTagName","parentNode","insertBefore","_configureCaptions","showCaptions","hideCaptions","cookie","expires","path","addClass","_parseYouTubeIDs","streams","extractHLSVideoSources","sources","source","_prepareHTML5Video","speeds","find","removeClass","keys","transcriptLanguages","speed","attr","tabindex","_setConfigurations","controlState","controlHideTimeout","captionState","captionHideTimeout","HLSVideoSources","modulesList","map","options","moduleName","isPlainObject","when","_getConfiguration","storage","isBoolean","regExp","extractKeys","compatKeys","conversions","autoplay","autohideHtml5","autoAdvance","shouldAutoAdvance","savedVideoPosition","Number","generalSpeed","transcriptLanguage","parseInt","sub","option","call","obj","context","rewrite","method","bind","hide","self","onTouchBasedDevice","isFullScreen","metadata","fadeOutTimeout","captionsFreezeTime","availableHDQualities","lang","auto_advance","duration","createElement","src","ytApiUrl","async","Video","youtubeStreams","videos","split","metadataXHRs","url","items","metaDataItem","contentDetails","youtubeMetadataReceived","sort","contains","enabled","ytKey","ajax","ytMetadataUrl","join","timeout","success","notifyOnError","currentSpeed","ISO_8601","asSeconds","err","supportedModes","currentPlayerMode","parseFloat","replace","pop","objChain","extraParameters","Array","tmpObj","chain","shift","hasOwnProperty","focusGrabber","_bindHandlers","disableFocusGrabber","enableFocusGrabber","onFocus","elFirst","elLast","tabIndex","activeElement","parents","hasClass","focus","event","HTML5Video","HLS","HLSVideo","Player","init","HLSOnlySources","canPlayHLS","showErrorMessage","browserIsSafari","videoEl","videoSources","hls","loadSource","attachMedia","Events","ERROR","onError","MANIFEST_PARSED","levels","level","bitrate","resolution","LEVEL_SWITCHED","fatal","type","ErrorTypes","NETWORK_ERROR","details","startLoad","MEDIA_ERROR","recoverMediaError","errorMessage","lastSource","sourceList","indexOf","innerHTML","callStateChangeCallback","events","onStateChange","playerState","pauseVideo","pause","seekTo","currentTime","setVolume","volume","playVideo","play","getPlayerState","getVolume","isNaN","setPlaybackRate","playbackRate","getAvailablePlaybackRates","_getLogs","logs","cssSelecter","removeEventListener","onLoadedMetadata","onPlay","onPlaying","onPause","onEnded","off","PlayerState","PAUSED","onReady","videoOverlayEl","BUFFERING","PLAYING","ENDED","UNSTARTED","bindAll","debug","eventName","addEventListener","readyState","networkState","prop","poster","appendTo","CUED","VideoTranscriptDownloadHandler","clickHandler","that","fileType","downloadUrl","preventDefault","target","transcript_download_format","saveStateUrl","dataType","complete","location","href","HTML5HLSVideo","Time","videoPlayer","_initialize","handlePlaybackQualityChange","isBuffering","isCued","isEnded","isPlaying","isUnstarted","onCaptionSeek","onSeek","runTimer","stopTimer","onLoadMetadataHtml5","onPlaybackQualityChange","onSlideSeek","onSpeedChange","onAutoAdvanceChange","onUnstarted","onVolumeChange","update","figureOutStartEndTime","figureOutStartingTime","updatePlayTime","debouncedF","debounce","player","videoWidth","videoHeight","_resize","_updateVcrAndRegion","youTubeId","userAgent","commonPlayerConfig","eventToBeTriggered","goToStartTime","stopAtEndTime","playerVars","controls","wmode","rel","showinfo","enablejsapi","modestbranding","cc_load_policy","html5","navigator","toLowerCase","browserIsFirefox","browserIsChrome","isSupported","videoId","isYoutube","resizer","_restartUsingFlash","oldTime","isUnplayed","cueVideoById","updateInterval","setInterval","clearInterval","skipOnEndedStartEndReset","setPlaybackQuality","quality","getPlaybackQuality","_this","availablePlaybackRates","baseSpeedSubs","item","key","code","skip_seek","dur","videoControl","hideControls","show","showControls","focusFirst","updateVcrVidTime","mousemove","keydown","clearTimeout","vidTimeEl","focusFirstControl","controlShowLock","captionsHidden","stop","fadeOut","videoVolumeControl","videoSpeedControl","html","HtmlUtils","template","videoFullScreen","enter","exitHandler","exit","onFullscreenChange","toggle","toggleHandler","updateControlsHeight","fullScreenEl","fullscreen","sliderEl","fullScreenState","append","HTML","_getControlsHeight","slider","videoCommands","execute","fullScreenClassNameEl","documentElement","closedCaptionsEl","scrollTop","scrollPos","keyCode","interpolateHtml","highDefinition","videoQualityControl","fetchAvailableQualities","onQualityChange","showQualityControl","toggleQuality","click","qualities","getAvailableQualityLevels","intersection","controlStateStr","newQuality","isHD","videoProgressSlider","buildSlider","getRangeParams","onSlide","onStop","updateStartEndTimeRegion","notifyThroughHandleEnd","getTimeDescription","focusSlider","removeAttr","bindHandlers","sliderToggle","prepend","_buildHandle","handle","role","sliderContents","joinHtml","range","slide","sliderProgress","rangeParams","step","ui","frozen","lastSeekValue","word","msg","ngettext","interpolate","e","which","VolumeControl","videoVolumeControlHtml","volumeInstructions","adjustVideoVolume","volumeText","volumeSlider","a11y","closeMenu","keyDownHandler","volumechange","onVolumeChangeHandler","mouseenter","openMenu","mouseleave","button","mousedown","toggleMuteHandler","keyDownButtonHandler","blur","children","CookieManager","Accessibility","storedVolume","render","checkMuteButtonStatus","instructionsId","orientation","onSlideHandler","updateVolumeSilently","silent","withoutSlider","updateSliderView","increaseVolume","decreaseVolume","mute","muteStatus","updateMuteButtonView","getMuteStatus","isMuted","action","toggleMute","altKey","KEY","UP","shiftKey","DOWN","SPACE","ENTER","liveRegion","class","after","getVolumeDescription","parent","cookieName","AutoAdvanceControl","videoAutoAdvanceControl","autoAdvanceText","onClick","autoPlay","ended","isFirstComponent","SpeedControl","mouseEnterHandler","mouseLeaveHandler","clickMenuHandler","keyDownMenuHandler","onSetSpeed","onRenderSpeed","speedsContainer","isPlaybackRatesSupported","speedButton","reversedSpeeds","reverse","speedsList","setHtml","speedLinks","setActiveSpeed","clickLinkHandler","keyDownLinkHandler","isHtml5","Boolean","bindEvent","unBindEvent","forceUpdate","siblings","resetActiveSpeed","speedOptions","speedOption","currentTarget","is","ESCAPE","TAB","AbstractItem","AbstractMenu","Menu","Overlay","Submenu","MenuItem","label","prefix","dataAttrs","menu","attrs","noop","uniqueId","delegateEvents","invoke","getChildren","undelegateEvents","getElement","open","close","closeSiblings","getSiblings","addChild","child","firstChild","lastChild","hasChildren","getLastChild","getFirstChild","addNamespace","getNext","isHidden","getPrev","getRoot","populateElement","select","unselect","setLabel","itemHandler","fragment","createDocumentFragment","appendChild","appendContent","isRendered","closeChildren","mouseOverHandler","contextmenuElement","overlay","getOverlay","build","contextmenuHandler","removeData","content","has","detach","position","my","of","collision","within","pointInContainerBox","x","y","containerOffset","offset","containerBox","x0","y0","x1","outerWidth","y1","outerHeight","pageX","pageY","stopPropagation","ns","openKeyboard","LEFT","RIGHT","at","timer","classNames","isSelected","speedCallback","menuitem","isFullscreen","speedchange","fn","contextmenu","VideoBumper","doNotShowAgain","videoBumper","maxBumperDuration","getPromise","showMainVideoHandler","saveState","showMainVideo","destroyAndResolve","skip","skipAndDoNotShowAgain","skipByDuration","info","bumper_last_view_date","bumper_do_not_show_again","videoSaveStatePlugin","timeupdate","VideoCompletionHandler","completionHandler","lastSentTime","isComplete","completionPercentage","isEnabled","completionEnabled","completeAfterTime","calculateCompleteAfterTime","handleEnded","ev","handleTimeUpdate","markCompletion","repostDelaySeconds","errmsg","publishCompletionUrl","contentType","JSON","stringify","completion","xhr","responseJSON","EventsBumperPlugin","videoEventsBumperPlugin","onSkip","onShowLanguageMenu","onHideLanguageMenu","onShowCaptions","onHideCaptions","logInfo","host_component_id","bumper_id","Logger","EventsPlugin","videoEventsPlugin","seek","autoadvancechange","onShowTranscript","onHideTranscript","emitPlayVideoEvent","old_time","new_time","current_time","old_speed","new_speed","language","PlayPauseControl","videoPlayPauseControl","PlayPlaceholder","videoPlayPlaceholder","shouldBeShown","PlaySkipControl","videoPlaySkipControl","VideoPoster","SaveStatePlugin","onUnload","bindUnloadHandler","saveStateHandler","onLanguageChange","youtube_availability","onYoutubeAvailability","langCode","youtubeIsAvailable","recordedYoutubeIsAvailable","youtube_is_available","saved_video_position","SkipControl","videoSkipControl","Draggabilly","VideoCaption","videoCaption","renderElements","handleCaptioningCookie","listenForDragDrop","fetchCaption","onResize","onCaptionUpdate","fetchXHR","abort","availableTranslationsXHR","subtitlesEl","languages","langHtml","langTitle","courseId","subtitlesHtml","courseLang","loaded","ensureHtml","subtitlesMenuEl","captionControlEl","captionDisplayEl","transcriptControlEl","languageChooserEl","menuChooserEl","renderLanguageMenu","toggleClosedCaptions","handleCaptionToggle","handleTranscriptToggle","onMouseEnter","onMouseLeave","onMovement","mousewheel","DOMMouseScroll","onCaptionHandler","onContainerMouseEnter","onContainerMouseLeave","showLanguageMenu","handleKeypress","handleKeypressLink","focused","total","previousLanguageMenuItem","nextLanguageMenuItem","closeLanguageMenu","openLanguageMenu","captionMouseOverOut","captionMouseDown","captionClick","captionFocus","captionBlur","captionKeyDown","playing","scrollCaption","getStartEndTimes","getBoundedCaptions","times","fetchWithYoutubeId","transcriptTranslationUrl","ajaxWithPrefix","rendered","renderCaption","jqXHR","textStatus","errorThrown","fetchAvailableTranslations","transcriptAvailableTranslationsUrl","response","currentLanguages","newLanguages","pick","topSpacingHeight","bottomSpacingHeight","setSubtitlesHeight","$menu","currentLang","$li","$link","linkHtml","buildCaptions","$spanEl","wrap","onRender","addPaddings","autoScrolling","currentCaptionIndex","isMouseFocus","empty","topSpacer","bottomSpacer","$caption","captionIndex","seekPlayer","scrollTo","calculateOffset","startAndCaptions","newIndex","round","currentIndex","captionHeight","showClosedCaptions","hideClosedCaptions","updateCaptioningCookie","querySelector","containment","updateCookie","triggerEvent","maxHeight","VideoCommands","Command","playCommand","pauseCommand","togglePlaybackCommand","toggleMuteCommand","toggleFullScreenCommand","setSpeedCommand","skipCommand","commands","getCommands","command","args","commandsList","defineBridget","addOptionMethod","PluginClass","opts","logError","message","bridge","elem","instance","charAt","returnValue","_init","bridget","define","exports","require","jQuery","classReg","className","RegExp","c","classList","toggleClass","classie","prefixes","docElemStyle","style","getStyleProperty","propName","toUpperCase","prefixed","getStyleSize","num","isValid","measurements","getZeroSize","innerWidth","innerHeight","measurement","defineGetSize","isSetup","getStyle","boxSizingProp","isBoxSizeOuter","setup","getComputedStyle","getStyleFn","currentStyle","div","padding","borderStyle","borderWidth","body","removeChild","nodeType","display","offsetWidth","offsetHeight","isBorderBox","mungeNonPixel","paddingWidth","paddingLeft","paddingRight","paddingHeight","paddingTop","paddingBottom","marginWidth","marginLeft","marginRight","marginHeight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderHeight","borderTopWidth","borderBottomWidth","isBorderBoxSizeOuter","styleWidth","styleHeight","rs","runtimeStyle","rsLeft","pixelLeft","docElem","getIEEvent","srcElement","attachEvent","handleEvent","unbind","detachEvent","eventie","EventEmitter","proto","originalGlobalValue","indexOfListener","listeners","listener","alias","aliasClosure","getListeners","evt","_getEvents","flattenListeners","flatListeners","getListenersAsObject","addListener","listenerIsWrapped","addOnceListener","defineEvent","defineEvents","evts","removeListener","addListeners","manipulateListeners","removeListeners","single","multiple","removeEvent","_events","removeAllListeners","emitEvent","_getOnceReturnValue","emit","setOnceReturnValue","_onceReturnValue","noConflict","factory","Unipointer","bindStartEvent","_bindStartEvent","unbindStartEvent","isBind","bindMethod","pointerEnabled","msPointerEnabled","getTouch","touches","touch","identifier","pointerIdentifier","onmousedown","_pointerDown","ontouchstart","changedTouches","onMSPointerDown","onpointerdown","pointer","isPointerDown","pointerId","pointerDown","_bindPostStartEvents","postStartEvents","touchstart","pointerdown","MSPointerDown","node","evnt","_boundPointerEvents","_unbindPostStartEvents","onmousemove","_pointerMove","onMSPointerMove","onpointermove","ontouchmove","pointerMove","onmouseup","_pointerUp","onMSPointerUp","onpointerup","ontouchend","_pointerDone","pointerUp","pointerDone","onMSPointerCancel","onpointercancel","_pointerCancel","ontouchcancel","pointerCancel","getPointerPoint","clientX","clientY","Unidragger","preventDefaultEvent","getParentLink","nodeName","bindHandles","_bindHandles","unbindHandles","binderExtra","touchAction","msTouchAction","disableImgOndragstart","handles","noDragStart","isIE8","ondragstart","images","querySelectorAll","img","allowTouchstartNodes","INPUT","A","BUTTON","SELECT","_dragPointerDown","pointerDownPoint","targetNodeName","isTouchstartNode","moveVector","_dragPointerMove","_dragMove","movePoint","isDragging","hasDragStarted","_dragStart","abs","_dragPointerUp","_dragEnd","_staticClick","dragStartPoint","isPreventingClicks","dragStart","dragMove","dragEnd","onclick","staticClick","a","b","defView","defaultView","isElement","HTMLElement","isElementDOM2","isElementQuirky","lastTime","requestAnimationFrame","cancelAnimationFrame","currTime","timeToCall","transformProperty","is3d","_create","_getPosition","startPoint","dragPoint","startPosition","enable","setHandles","dispatchEvent","emitArgs","$event","Event","_addTransformPosition","transform","matrixValues","xIndex","translateX","translateY","measureContainment","setLeftTop","animate","elemRect","getBoundingClientRect","containerSize","containerRect","relativeStartPosition","dragX","dragY","grid","gridX","gridY","applyGrid","containDrag","axis","drag","measure","positionDrag","animateFrame","translate","disable","FocusGrabber","VideoAccessibleMenu","VideoControl","VideoFullScreen","VideoQualityControl","VideoProgressSlider","VideoVolumeControl","VideoSpeedControl","VideoAutoAdvanceControl","VideoPlayPlaceholder","VideoPlayPauseControl","VideoPlaySkipControl","VideoSkipControl","VideoSaveStatePlugin","VideoEventsPlugin","VideoEventsBumperPlugin","VideoContextMenu","youtubeXhr","bumperMetadata","autoAdvanceEnabled","mainVideoModules","bumperVideoModules","getBumperState","bumperState","innerState","onSequenceChange","mainVideoPlayer","bumper","clearYoutubeXhr"],"mappings":"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;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA,iB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,iDAAiD;AACjF;AACA,4FAA4F,4BAA4B;AACxH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB,EAAE;AAChD;AACA;AACA;AACA;AACA,CAAC;AACD;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,yCAAyC,OAAO;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C,OAAO;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,sDAAsD;AACtD,+CAA+C;AAC/C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,YAAY,GAAG;AACf;;AAEA;;AAEA,gCAAgC,0BAA0B;AAC1D,kCAAkC,aAAa;AAC/C;AACA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,8EAA8E;AACjF;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,8BAA8B;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uMAAuM;AACvM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,2BAA2B;AACpG;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+FAA+F;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA,gCAAgC,mBAAmB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iEAAiE;AACjE;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,gDAAgD;AACnD;;AAEA;AACA;AACA,CAAC;;AAED,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,gBAAgB;AACnF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,MAAM,GAAG,aAAa,GAAG,gBAAgB,GAAG,qCAAqC,GAAG,UAAU;AAC9J;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,aAAa;AAC1E,iBAAiB;AACjB;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,wHAAwH;AACnL;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,aAAa;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4DAA4D,+CAA+C;AAC3G;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,qEAAqE;AACpI;AACA;AACA;AACA,oEAAoE,cAAc;AAClF;AACA,aAAa;AACb;AACA;AACA,kEAAkE,cAAc;AAChF;AACA;;AAEA;AACA;AACA;AACA;AACA,kCAAkC,kEAAkE;AACpG;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,wCAAwC;AAC/F;AACA;AACA;AACA;AACA,gEAAgE,mBAAmB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,qEAAqE;AACvI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wEAAwE;AAC3E;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,+DAA+D,sBAAsB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,sBAAsB;AACnF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,sBAAsB;AACxF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wBAAwB;AAC3B;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,yDAAyD,oBAAoB;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,0DAA0D,mCAAmC;;AAE7F;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,2GAA2G;AAC3J;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA,WAAW;AACX;AACA,sDAAsD,yIAAyI;AAC/L;AACA;AACA;AACA,yDAAyD,iBAAiB;AAC1E;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,2GAA2G;AAC3J;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,4BAA4B,gEAAgE;AAC5F;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB,GAAG,KAAK,YAAY,oBAAoB,IAAI,eAAe;AACrH;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,wBAAwB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,gCAAgC;AACnC;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,gBAAgB;AACnB;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,oGAAoG;AACtJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,sDAAsD;AAC5H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wBAAwB;AAC3B;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,yJAAyJ;AAChN,OAAO;AACP,6CAA6C,iMAAiM;AAC9O;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,oDAAoD;AAC3G;AACA,OAAO;AACP;AACA,6CAA6C,qJAAqJ;AAClM;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,mDAAmD;AAC7G;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wCAAwC;AAC3C;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;AACA,+CAA+C,iBAAiB,GAAG,eAAe,GAAG,qBAAqB,GAAG,mBAAmB;AAChI;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,MAAM,GAAG,aAAa,GAAG,gBAAgB,GAAG,qCAAqC,GAAG,UAAU;AAChJ;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mDAAmD,aAAa;AAChE,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,wHAAwH;AACzK;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,aAAa;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,oBAAoB;AACjF;AACA;AACA,iEAAiE,0BAA0B;AAC3F;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,wDAAwD,yCAAyC;;AAEjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,8CAA8C;AAC1G;AACA,SAAS;AACT;AACA;AACA;AACA,4DAA4D,8CAA8C;AAC1G;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,6EAA6E;AAC9I;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA,yDAAyD,mHAAmH;;AAE5K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,iEAAiE;AAC7H;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,qEAAqE;AAC5H,4DAA4D,cAAc;AAC1E;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,8BAA8B,sEAAsE;AACpG;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gEAAgE,uCAAuC;AACvG;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,4HAA4H;AACrL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,6JAA6J;AACtN;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,yDAAyD,4HAA4H;AACrL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD,0GAA0G;AACnK,mBAAmB;AACnB;AACA,yDAAyD,wGAAwG;AACjK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,qDAAqD;AACzH;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wEAAwE;AAC3E;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA,yDAAyD,aAAa;AACtE;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wBAAwB;AAC3B;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,oBAAoB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kEAAkE,yBAAyB;;AAE3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mEAAmE,sCAAsC;AACzG;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,YAAY;AAC9E;AACA;AACA;AACA;AACA;AACA,qEAAqE,oCAAoC;AACzG;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wBAAwB;AAC3B;;AAEA;AACA;AACA,CAAC;;AAED,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;;AAE9O,0CAA0C,+DAA+D,qGAAqG,EAAE,yEAAyE,eAAe,yEAAyE,EAAE,EAAE,uHAAuH,EAAE;AAC9e;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,KAAK;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,8CAA8C;;AAE9C,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,uBAAuB;AACvB;AACA,qBAAqB,sCAAsC;AAC3D;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,uEAAuE,4BAA4B;AACnG,eAAe;AACf;AACA;AACA,uEAAuE,6BAA6B;AACpG,eAAe;AACf,aAAa;;AAEb;AACA,WAAW;AACX;AACA,wEAAwE,6BAA6B;AACrG;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB,WAAW;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wCAAwC;AAC3C;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kCAAkC,kCAAkC;AACpE;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA,qBAAqB,qBAAqB;AAC1C;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,qBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA,wBAAwB,mBAAmB;AAC3C;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb,WAAW;AACX;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,4CAA4C,2HAA2H;AACvK;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wCAAwC;AAC3C;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qDAAqD,kBAAkB;AACvE;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6DAA6D,oBAAoB,GAAG,YAAY,GAAG,gBAAgB,GAAG,sBAAsB;AAC5I,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,iCAAiC,cAAc,GAAG,YAAY,wCAAwC,GAAG,GAAG,cAAc;AAC1H;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,kBAAkB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wBAAwB;AAC3B;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;;AAGA;;AAEA;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,mKAAmK;AAC1M;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,gBAAgB;AACnB;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,uEAAuE,SAAS,uCAAuC,EAAE;AACzH;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,0DAA0D,GAAG,2DAA2D,GAAG,mEAAmE;;AAExN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,sJAAsJ;AAC1M;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,gEAAgE;AACnE;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sFAAsF,aAAa;AACnG;AACA;;AAEA;AACA;;AAEA;AACA,0FAA0F,eAAe;AACzG;AACA;;AAEA;AACA;;AAEA;AACA,sBAAsB,wBAAwB;AAC9C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA,CAAC,EAAE,8BAA8B;AACjC;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF,aAAa;AACrG;AACA;;AAEA;AACA;;AAEA;AACA,4FAA4F,eAAe;AAC3G;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,oIAAoI,4EAA4E,EAAE;AACjQ;AACA,uBAAuB,oFAAoF;AAC3G,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mUAAmU;AAC1V,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,oDAAoD;AACvD;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;AAEA;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,2BAA2B;AAC3B;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA,2BAA2B;AAC3B,gCAAgC,uCAAuC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA,8BAA8B;AAC9B;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA,gCAAgC;AAChC;AACA;AACA,8BAA8B;AAC9B,OAAO;AACP,iCAAiC;AACjC;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB,OAAO;AAC5B;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,WAAW;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B,gBAAgB,OAAO;AACvB;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+BAA+B;AAC/B,kCAAkC;AAClC,kBAAkB;AAClB,6BAA6B;AAC7B,gBAAgB;AAChB;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,kBAAkB;AAClB,kBAAkB;AAClB,oBAAoB;AACpB;AACA;AACA;AACA,qBAAqB,sBAAsB;AAC3C;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,kBAAkB;AAClB,OAAO;AACP,oBAAoB;AACpB,iBAAiB;AACjB,iBAAiB;AACjB;AACA,mBAAmB,oCAAoC;AACvD,mBAAmB;AACnB;AACA;AACA,gBAAgB;AAChB,kBAAkB;AAClB;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA,qCAAqC;AACrC;AACA,kCAAkC;AAClC;AACA,kCAAkC;AAClC;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;;AAGA;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,QAAQ,GAAG,OAAO;;AAEnE;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,mCAAmC,IAAI;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;AACA,UAAU,OAAO;;;AAGjB;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,wBAAwB;AACxB;AACA,yEAAyE,gCAAgC;AACzG;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,WAAW;AAC/B,gBAAgB,OAAO;AACvB;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAA0B,mCAAmC;AAC7D;AACA,mCAAmC;AACnC,gCAAgC;AAChC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC,gBAAgB,OAAO;AACvB;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA,SAAS;AACT,OAAO;;AAEP;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,6BAA6B,qCAAqC;AAClE;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,8BAA8B,sCAAsC;AACpE;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,wBAAwB;AACxB,0BAA0B;AAC1B,wBAAwB;AACxB,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,aAAa;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,yDAAyD,oJAAoJ;AAC7M;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8CAA8C,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,mCAAmC,cAAc;AACjD;AACA;AACA;AACA;AACA;;AAEA,+EAA+E,0CAA0C;AACzH;AACA;AACA;AACA;AACA,eAAe;AACf,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,cAAc,uCAAuC,uBAAuB;AAC5E;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,iCAAiC,UAAU;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,oBAAoB;AACpB;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,uBAAuB;AACvE;AACA;AACA;AACA,mDAAmD,kBAAkB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uDAAuD,uHAAuH;AAC9K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6DAA6D,oBAAoB,GAAG,YAAY,GAAG,gBAAgB,GAAG,sBAAsB;AAC5I,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,+CAA+C,WAAW;AAC1D,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAA0B,qCAAqC;AAC/D;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,gDAAgD;AACnD;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mDAAmD,+BAA+B;AAClF;AACA,qDAAqD,+BAA+B;AACpF;AACA,sDAAsD;AACtD;AACA,4EAA4E;AAC5E;AACA,gDAAgD,+BAA+B;AAC/E;AACA,kDAAkD,+BAA+B;AACjF;AACA,kDAAkD;AAClD;AACA,uDAAuD,+BAA+B;AACtF;AACA,yDAAyD,+BAA+B;AACxF;AACA,iDAAiD,qCAAqC;AACtF;AACA,yDAAyD;AACzD;AACA,yDAAyD;AACzD;AACA,+DAA+D;AAC/D;AACA,4DAA4D;AAC5D;AACA;AACA,uDAAuD;AACvD;AACA,oDAAoD,qCAAqC;AACzF;AACA,4DAA4D;AAC5D;AACA,6FAA6F;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,oGAAoG,mBAA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qE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,sBAAsB;AACzC,yBAAyB,mDAAmD;AAC5E;AACA;AACA,OAAO;AACP,gBAAgB;AAChB;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,+DAA+D,sBAAsB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,cAAc;AACd;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;AAEA;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,UAAU;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,yBAAyB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,OAAO;AAC9B;AACA;;AAEA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA,iFAAiF,oBAAoB,GAAG,kBAAkB;;AAE1H;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;AACA;AACA;AACA,6IAA6I;AAC7I;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF,aAAa;AACrG;AACA;;AAEA;AACA;;AAEA;AACA,4FAA4F,eAAe;AAC3G;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,sDAAsD,eAAe;AACrE;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,uDAAuD,WAAW;AAClE;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,4EAA4E;AAC/E;;AAEA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ,iDAAiD,aAAa,uFAAuF,EAAE,uFAAuF;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CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA,GAAG;AACH;AACA;AACA,2BAA2B,gDAAgD;AAC3E;AACA,GAAG;AACH;AACA;AACA,2BAA2B,kCAAkC;AAC7D;AACA,GAAG;AACH;AACA;AACA,2BAA2B,qCAAqC;AAChE;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB,yBAAyB;AACzB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB,mBAAmB;AAC5C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,mBAAmB,iFAAiF;AACpG;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,WAAW,kCAAkC,4CAA4C;AACpJ;AACA;AACA;AACA;AACA,0DAA0D,sEAAsE;AAChI,aAAa;AACb;AACA,kEAAkE,8CAA8C;AAChH,eAAe;AACf,qEAAqE,8CAA8C;AACnH;AACA;AACA,WAAW;AACX,iDAAiD,wJAAwJ;AACzM;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,qCAAqC,6BAA6B;AAClE;AACA;AACA,2DAA2D,yFAAyF;AACpJ,WAAW;AACX,iDAAiD,4JAA4J;AAC7M;AACA;AACA,OAAO;AACP,6CAA6C,qJAAqJ;AAClM;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,gJAAgJ;AAChM;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,4HAA4H;AAC5K;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,8CAA8C;AACjD;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B;;AAE/B,4DAA4D;AAC5D,wDAAwD;AACxD;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,SAAS;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,oCAAoC,MAAM;AAC1C;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;;AAEA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6EAA6E,uBAAuB;AACpG;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,OAAO;AAC5B,gBAAgB,WAAW;AAC3B;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,kBAAkB,gCAAgC;AAClD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,mBAAmB;AACrF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,kDAAkD,+IAA+I;AACjM;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAwB,0BAA0B;AAClD;AACA;AACA;AACA,0BAA0B,mBAAmB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA,uBAAuB,aAAa;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,uDAAuD,uKAAuK;AAC9N;AACA;AACA;AACA;AACA;;AAEA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA,0DAA0D,eAAe;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G;AAC5G,eAAe;AACf;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA,wEAAwE,cAAc,GAAG,cAAc,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ,GAAG,sCAAsC;AACjL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;;AAEA;AACA;AACA,mDAAmD,yBAAyB;AAC5E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA;AACA;AACA;AACA,uFAAuF;AACvF;AACA;AACA,2CAA2C,gDAAgD;AAC3F;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,qDAAqD,UAAU,yBAAyB,cAAc,6BAA6B;AACzL;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA,yDAAyD,kBAAkB;AAC3E;AACA;AACA;AACA;AACA,kCAAkC,mBAAmB;AACrD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb,6DAA6D,uKAAuK;AACpO;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,2BAA2B,wBAAwB;AACnD;AACA;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,gBAAgB,GAAG,gBAAgB,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ,GAAG,wCAAwC;AACvL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,eAAe;AACpC;AACA,sBAAsB,4CAA4C;AAClE;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,wCAAwC;AAC3C;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;;AAGA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,MAAM;AACrB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,EAAE;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAkB;AAClB,mBAAmB;AACnB,kBAAkB;AAClB,mBAAmB;;AAEnB;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,wEAAwE;AAC5F;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA,kCAAkC;AAClC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA,uBAAuB,aAAa;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB;AAC1D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,8BAA8B,aAAa;AAC3C;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA,uBAAuB,aAAa;AACpC,sCAAsC;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B,aAAa;AAC5C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,wBAAwB;AAChE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,kCAAkC;AAClC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,2BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,qCAAqC,cAAc;AACnD;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B;AAC3B,6BAA6B;AAC7B,6BAA6B;AAC7B;AACA;AACA;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,QAAQ;AAC7B;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb,yBAAyB;AACzB;;AAEA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,QAAQ;AAC7B;;AAEA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B;AAC5B;;AAEA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,OAAO;AAC5B;;AAEA,KAAK;AACL;AACA;AACA;AACA,2BAA2B;;AAE3B;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,2BAA2B;AAC3B;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,QAAQ;AAC3B;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,+BAA+B;AAClD;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qEAAqE,aAAa;AAClF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6FAA6F,eAAe;AAC5G;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE;;AAEjjB,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,sBAAsB;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,8CAA8C;AAC9C;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL,uDAAuD;AACvD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL,qDAAqD;AACrD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,mDAAmD;AACnD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,gDAAgD;AAChD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;;AAEL,kDAAkD;AAClD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;;AAEL,oDAAoD;AACpD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,uDAAuD;AACvD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;;AAEL,gDAAgD;AAChD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,qDAAqD;AACrD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,oDAAoD;AACpD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,yDAAyD;AACzD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,gDAAgD;AAChD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,iDAAiD;AACjD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;AAED,CAAC,GAAG;AACJ;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,kCAAkC,EAAE,MAAM,EAAE,QAAQ,EAAE;AACtD;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,4BAA4B,IAAI;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6CAA6C,QAAQ;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;;AAEnC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAAgD,eAAe;AAC/D;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iCAAiC;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,QAAQ;AACX;;AAEA;AACA;AACA,CAAC;;AAED,gCAAgC,2CAA2C,gBAAgB,kBAAkB,OAAO,2BAA2B,wDAAwD,gCAAgC,uDAAuD,2DAA2D,EAAE,EAAE,yDAAyD,qEAAqE,6DAA6D,oBAAoB,GAAG,EAAE,GAAG;AACpjB;AACA;;AAEA;;AAEA,iDAAiD,0CAA0C,0DAA0D,EAAE;;AAEvJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,WAAW;AACX;AACA;AACA;AACA,sCAAsC,qCAAqC;AAC3E,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA,CAAC;;AAED;;AAEA,CAAC,EAAE,QAAQ,EAAE,GAAG;AAChB,CAAC;AACD;;;;;;;;ACpleA,aAAa,mCAAmC,EAAE,I;;;;;;;ACAlD,aAAa,8BAA8B,EAAE,I","file":"VideoModule.js","sourcesContent":["\nfunction format(time, formatFull) {\n    var hours, minutes, seconds;\n\n    if (!_.isFinite(time) || time < 0) {\n        time = 0;\n    }\n\n    seconds = Math.floor(time);\n    minutes = Math.floor(seconds / 60);\n    hours = Math.floor(minutes / 60);\n    seconds = seconds % 60;\n    minutes = minutes % 60;\n\n    if (formatFull) {\n        return '' + _pad(hours) + ':' + _pad(minutes) + ':' + _pad(seconds % 60);\n    } else if (hours) {\n        return '' + hours + ':' + _pad(minutes) + ':' + _pad(seconds % 60);\n    } else {\n        return '' + minutes + ':' + _pad(seconds % 60);\n    }\n}\n\nfunction formatFull(time) {\n    // The returned value will not be user-facing. So no need for\n    // internationalization.\n    return format(time, true);\n}\n\nfunction convert(time, oldSpeed, newSpeed) {\n    return (time * oldSpeed / newSpeed).toFixed(3);\n}\n\nfunction _pad(number) {\n    if (number < 10) {\n        return '0' + number;\n    } else {\n        return '' + number;\n    }\n}\n\nexport { format, formatFull, convert }\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/time.js","\n    define(\n'video/00_async_process.js',\n[],\nfunction() {\n    'use strict';\n/**\n * Provides convenient way to process big amount of data without UI blocking.\n *\n * @param {array} list Array to process.\n * @param {function} process Calls this function on each item in the list.\n * @return {array} Returns a Promise object to observe when all actions of a\n *                 certain type bound to the collection, queued or not, have finished.\n */\n    var AsyncProcess = {\n        array: function(list, process) {\n            if (!_.isArray(list)) {\n                return $.Deferred().reject().promise();\n            }\n\n            if (!_.isFunction(process) || !list.length) {\n                return $.Deferred().resolve(list).promise();\n            }\n\n            var MAX_DELAY = 50, // maximum amount of time that js code should be allowed to run continuously\n                dfd = $.Deferred(),\n                result = [],\n                index = 0,\n                len = list.length;\n\n            var getCurrentTime = function() {\n                return (new Date()).getTime();\n            };\n\n            var handler = function() {\n                var start = getCurrentTime();\n\n                do {\n                    result[index] = process(list[index], index);\n                    index++;\n                } while (index < len && getCurrentTime() - start < MAX_DELAY);\n\n                if (index < len) {\n                    setTimeout(handler, 25);\n                } else {\n                    dfd.resolve(result);\n                }\n            };\n\n            setTimeout(handler, 25);\n\n            return dfd.promise();\n        }\n    };\n\n    return AsyncProcess;\n});\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_async_process.js","\n    'use strict';\n    define('video/00_component.js', [],\nfunction() {\n     /**\n     * Creates a new object with the specified prototype object and properties.\n     * @param {Object} o The object which should be the prototype of the\n     * newly-created object.\n     * @private\n     * @throws {TypeError, Error}\n     * @return {Object}\n     */\n    var inherit = Object.create || (function() {\n        var F = function() {};\n\n        return function(o) {\n            if (arguments.length > 1) {\n                throw Error('Second argument not supported');\n            }\n            if (_.isNull(o) || _.isUndefined(o)) {\n                throw Error('Cannot set a null [[Prototype]]');\n            }\n            if (!_.isObject(o)) {\n                throw TypeError('Argument must be an object');\n            }\n\n            F.prototype = o;\n\n            return new F();\n        };\n    }());\n\n    /**\n     * Component module.\n     * @exports video/00_component.js\n     * @constructor\n     * @return {jquery Promise}\n     */\n    var Component = function() {\n        if ($.isFunction(this.initialize)) {\n            return this.initialize.apply(this, arguments);\n        }\n    };\n\n    /**\n     * Returns new constructor that inherits form the current constructor.\n     * @static\n     * @param {Object} protoProps The object containing which will be added to\n     * the prototype.\n     * @return {Object}\n     */\n    Component.extend = function(protoProps, staticProps) {\n        var Parent = this,\n            Child = function() {\n                if ($.isFunction(this.initialize)) {\n                    return this.initialize.apply(this, arguments);\n                }\n            };\n\n        // Inherit methods and properties from the Parent prototype.\n        Child.prototype = inherit(Parent.prototype);\n        Child.constructor = Parent;\n        // Provide access to parent's methods and properties\n        Child.__super__ = Parent.prototype;\n\n        // Extends inherited methods and properties by methods/properties\n        // passed as argument.\n        if (protoProps) {\n            $.extend(Child.prototype, protoProps);\n        }\n\n        // Inherit static methods and properties\n        $.extend(Child, Parent, staticProps);\n\n        return Child;\n    };\n\n    return Component;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_component.js","\n    'use strict';\n    define(\n'video/00_i18n.js',\n[],\nfunction() {\n    /**\n     * i18n module.\n     * @exports video/00_i18n.js\n     * @return {object}\n     */\n\n    return {\n        Play: gettext('Play'),\n        Pause: gettext('Pause'),\n        Mute: gettext('Mute'),\n        Unmute: gettext('Unmute'),\n        'Exit full browser': gettext('Exit full browser'),\n        'Fill browser': gettext('Fill browser'),\n        Speed: gettext('Speed'),\n        'Auto-advance': gettext('Auto-advance'),\n        Volume: gettext('Volume'),\n        // Translators: Volume level equals 0%.\n        Muted: gettext('Muted'),\n        // Translators: Volume level in range ]0,20]%\n        'Very low': gettext('Very low'),\n        // Translators: Volume level in range ]20,40]%\n        Low: gettext('Low'),\n        // Translators: Volume level in range ]40,60]%\n        Average: gettext('Average'),\n        // Translators: Volume level in range ]60,80]%\n        Loud: gettext('Loud'),\n        // Translators: Volume level in range ]80,99]%\n        'Very loud': gettext('Very loud'),\n        // Translators: Volume level equals 100%.\n        Maximum: gettext('Maximum')\n    };\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_i18n.js","\n    define(\n'video/00_iterator.js',\n[],\nfunction() {\n    'use strict';\n    /**\n     * Provides convenient way to work with iterable data.\n     * @exports video/00_iterator.js\n     * @constructor\n     * @param {array} list Array to be iterated.\n     */\n    var Iterator = function(list) {\n        this.list = list;\n        this.index = 0;\n        this.size = this.list.length;\n        this.lastIndex = this.list.length - 1;\n    };\n\n    Iterator.prototype = {\n\n        /**\n         * Checks validity of provided index for the iterator.\n         * @access protected\n         * @param {numebr} index\n         * @return {boolean}\n         */\n        _isValid: function(index) {\n            return _.isNumber(index) && index < this.size && index >= 0;\n        },\n\n        /**\n         * Returns next element.\n         * @param {number} [index] Updates current position.\n         * @return {any}\n         */\n        next: function(index) {\n            if (!(this._isValid(index))) {\n                index = this.index;\n            }\n\n            this.index = (index >= this.lastIndex) ? 0 : index + 1;\n\n            return this.list[this.index];\n        },\n\n        /**\n         * Returns previous element.\n         * @param {number} [index] Updates current position.\n         * @return {any}\n         */\n        prev: function(index) {\n            if (!(this._isValid(index))) {\n                index = this.index;\n            }\n\n            this.index = (index < 1) ? this.lastIndex : index - 1;\n\n            return this.list[this.index];\n        },\n\n        /**\n         * Returns last element in the list.\n         * @return {any}\n         */\n        last: function() {\n            return this.list[this.lastIndex];\n        },\n\n        /**\n         * Returns first element in the list.\n         * @return {any}\n         */\n        first: function() {\n            return this.list[0];\n        },\n\n        /**\n         * Returns `true` if current position is last for the iterator.\n         * @return {boolean}\n         */\n        isEnd: function() {\n            return this.index === this.lastIndex;\n        }\n    };\n\n    return Iterator;\n});\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_iterator.js","\n    define(\n'video/00_resizer.js',\n[],\nfunction() {\n    var Resizer = function(params) {\n        var defaults = {\n                container: window,\n                element: null,\n                containerRatio: null,\n                elementRatio: null\n            },\n            callbacksList = [],\n            delta = {\n                height: 0,\n                width: 0\n            },\n            module = {},\n            mode = null,\n            config;\n\n        var initialize = function(params) {\n            if (!config) {\n                config = defaults;\n            }\n\n            config = $.extend(true, {}, config, params);\n\n            if (!config.element) {\n                console.log(\n                    'Required parameter `element` is not passed.'\n                );\n            }\n\n            return module;\n        };\n\n        var getData = function() {\n            var $container = $(config.container),\n                containerWidth = $container.width() + delta.width,\n                containerHeight = $container.height() + delta.height,\n                containerRatio = config.containerRatio,\n\n                $element = $(config.element),\n                elementRatio = config.elementRatio;\n\n            if (!containerRatio) {\n                containerRatio = containerWidth / containerHeight;\n            }\n\n            if (!elementRatio) {\n                elementRatio = $element.width() / $element.height();\n            }\n\n            return {\n                containerWidth: containerWidth,\n                containerHeight: containerHeight,\n                containerRatio: containerRatio,\n                element: $element,\n                elementRatio: elementRatio\n            };\n        };\n\n        var align = function() {\n            var data = getData();\n\n            switch (mode) {\n            case 'height':\n                alignByHeightOnly();\n                break;\n\n            case 'width':\n                alignByWidthOnly();\n                break;\n\n            default:\n                if (data.containerRatio >= data.elementRatio) {\n                    alignByHeightOnly();\n                } else {\n                    alignByWidthOnly();\n                }\n                break;\n            }\n\n            fireCallbacks();\n\n            return module;\n        };\n\n        var alignByWidthOnly = function() {\n            var data = getData(),\n                height = data.containerWidth / data.elementRatio;\n\n            data.element.css({\n                height: height,\n                width: data.containerWidth,\n                top: 0.5 * (data.containerHeight - height),\n                left: 0\n            });\n\n            return module;\n        };\n\n        var alignByHeightOnly = function() {\n            var data = getData(),\n                width = data.containerHeight * data.elementRatio;\n\n            data.element.css({\n                height: data.containerHeight,\n                width: data.containerHeight * data.elementRatio,\n                top: 0,\n                left: 0.5 * (data.containerWidth - width)\n            });\n\n            return module;\n        };\n\n        var setMode = function(param) {\n            if (_.isString(param)) {\n                mode = param;\n                align();\n            }\n\n            return module;\n        };\n\n        var setElement = function(element) {\n            config.element = element;\n\n            return module;\n        };\n\n        var addCallback = function(func) {\n            if ($.isFunction(func)) {\n                callbacksList.push(func);\n            } else {\n                console.error('[Video info]: TypeError: Argument is not a function.');\n            }\n\n            return module;\n        };\n\n        var addOnceCallback = function(func) {\n            if ($.isFunction(func)) {\n                var decorator = function() {\n                    func();\n                    removeCallback(func);\n                };\n\n                addCallback(decorator);\n            } else {\n                console.error('TypeError: Argument is not a function.');\n            }\n\n            return module;\n        };\n\n        var fireCallbacks = function() {\n            $.each(callbacksList, function(index, callback) {\n                callback();\n            });\n        };\n\n        var removeCallbacks = function() {\n            callbacksList.length = 0;\n\n            return module;\n        };\n\n        var removeCallback = function(func) {\n            var index = $.inArray(func, callbacksList);\n\n            if (index !== -1) {\n                return callbacksList.splice(index, 1);\n            }\n        };\n\n        var resetDelta = function() {\n            delta.height = delta.width = 0;\n\n            return module;\n        };\n\n        var addDelta = function(value, side) {\n            if (_.isNumber(value) && _.isNumber(delta[side])) {\n                delta[side] += value;\n            }\n\n            return module;\n        };\n\n        var substractDelta = function(value, side) {\n            if (_.isNumber(value) && _.isNumber(delta[side])) {\n                delta[side] -= value;\n            }\n\n            return module;\n        };\n\n        var destroy = function() {\n            var data = getData();\n            data.element.css({\n                height: '', width: '', top: '', left: ''\n            });\n            removeCallbacks();\n            resetDelta();\n            mode = null;\n        };\n\n        initialize.apply(module, arguments);\n\n        return $.extend(true, module, {\n            align: align,\n            alignByWidthOnly: alignByWidthOnly,\n            alignByHeightOnly: alignByHeightOnly,\n            destroy: destroy,\n            setParams: initialize,\n            setMode: setMode,\n            setElement: setElement,\n            callbacks: {\n                add: addCallback,\n                once: addOnceCallback,\n                remove: removeCallback,\n                removeAll: removeCallbacks\n            },\n            delta: {\n                add: addDelta,\n                substract: substractDelta,\n                reset: resetDelta\n            }\n        });\n    };\n\n    return Resizer;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_resizer.js","\n    define(\n'video/00_sjson.js',\n[],\nfunction() {\n    'use strict';\n\n    var Sjson = function(data) {\n        var sjson = {\n                start: data.start.concat(),\n                text: data.text.concat()\n            },\n            module = {};\n\n        var getter = function(propertyName) {\n            return function() {\n                return sjson[propertyName];\n            };\n        };\n\n        var getStartTimes = getter('start');\n\n        var getCaptions = getter('text');\n\n        var size = function() {\n            return sjson.text.length;\n        };\n\n        function search(time, startTime, endTime) {\n            var start = getStartTimes(),\n                max = size() - 1,\n                min = 0,\n                results,\n                index;\n\n            // if we specify a start and end time to search,\n            // search the filtered list of captions in between\n            // the start / end times.\n            // Else, search the unfiltered list.\n            if (typeof startTime !== 'undefined' &&\n                typeof endTime !== 'undefined') {\n                results = filter(startTime, endTime);\n                start = results.start;\n                max = results.captions.length - 1;\n            } else {\n                start = getStartTimes();\n            }\n            while (min < max) {\n                index = Math.ceil((max + min) / 2);\n\n                if (time < start[index]) {\n                    max = index - 1;\n                }\n\n                if (time >= start[index]) {\n                    min = index;\n                }\n            }\n\n            return min;\n        }\n\n        function filter(start, end) {\n            /* filters captions that occur between inputs\n             * `start` and `end`. Start and end should\n             * be Numbers (doubles) corresponding to the\n             * number of seconds elapsed since the beginning\n             * of the video.\n             *\n             * Returns an object with properties\n             * \"start\" and \"captions\" representing\n             * parallel arrays of start times and\n             * their corresponding captions.\n             */\n            var filteredTimes = [];\n            var filteredCaptions = [];\n            var startTimes = getStartTimes();\n            var captions = getCaptions();\n\n            if (startTimes.length !== captions.length) {\n                console.warn('video caption and start time arrays do not match in length');\n            }\n\n            // if end is null, then it's been set to\n            // some erroneous value, so filter using the\n            // entire array as long as it's not empty\n            if (end === null && startTimes.length) {\n                end = startTimes[startTimes.length - 1];\n            }\n\n            _.filter(startTimes, function(currentStartTime, i) {\n                if (currentStartTime >= start && currentStartTime <= end) {\n                    filteredTimes.push(currentStartTime);\n                    filteredCaptions.push(captions[i]);\n                }\n            });\n\n            return {\n                start: filteredTimes,\n                captions: filteredCaptions\n            };\n        }\n\n        return {\n            getCaptions: getCaptions,\n            getStartTimes: getStartTimes,\n            getSize: size,\n            filter: filter,\n            search: search\n        };\n    };\n\n    return Sjson;\n});\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_sjson.js","\n    define(\n'video/00_video_storage.js',\n[],\nfunction() {\n    'use strict';\n/**\n * Provides convenient way to store key value pairs.\n *\n * @param {string} namespace Namespace that is used to store data.\n * @return {object} VideoStorage API.\n */\n    var VideoStorage = function(namespace, id) {\n        /**\n        * Adds new value to the storage or rewrites existent.\n        *\n        * @param {string} name Identifier of the data.\n        * @param {any} value Data to store.\n        * @param {boolean} instanceSpecific Data with this flag will be added\n        *     to instance specific storage.\n        */\n        var setItem = function(name, value, instanceSpecific) {\n            if (name) {\n                if (instanceSpecific) {\n                    window[namespace][id][name] = value;\n                } else {\n                    window[namespace][name] = value;\n                }\n            }\n        };\n\n        /**\n        * Returns the current value associated with the given name.\n        *\n        * @param {string} name Identifier of the data.\n        * @param {boolean} instanceSpecific Data with this flag will be added\n        *     to instance specific storage.\n        * @return {any} The current value associated with the given name.\n        *     If the given key does not exist in the list\n        *     associated with the object then this method must return null.\n        */\n        var getItem = function(name, instanceSpecific) {\n            if (instanceSpecific) {\n                return window[namespace][id][name];\n            } else {\n                return window[namespace][name];\n            }\n        };\n\n        /**\n        * Removes the current value associated with the given name.\n        *\n        * @param {string} name Identifier of the data.\n        * @param {boolean} instanceSpecific Data with this flag will be added\n        *     to instance specific storage.\n        */\n        var removeItem = function(name, instanceSpecific) {\n            if (instanceSpecific) {\n                delete window[namespace][id][name];\n            } else {\n                delete window[namespace][name];\n            }\n        };\n\n        /**\n        * Empties the storage.\n        *\n        */\n        var clear = function() {\n            window[namespace] = {};\n            window[namespace][id] = {};\n        };\n\n        /**\n        * Initializes the module: creates a storage with proper namespace.\n        *\n        * @private\n        */\n        (function initialize() {\n            if (!namespace) {\n                namespace = 'VideoStorage';\n            }\n            if (!id) {\n                // Generate random alpha-numeric string.\n                id = Math.random().toString(36).slice(2);\n            }\n\n            window[namespace] = window[namespace] || {};\n            window[namespace][id] = window[namespace][id] || {};\n        }());\n\n        return {\n            clear: clear,\n            getItem: getItem,\n            removeItem: removeItem,\n            setItem: setItem\n        };\n    };\n\n    return VideoStorage;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/00_video_storage.js","/* eslint-disable no-console, no-param-reassign */\n/**\n * @file Initialize module works with the JSON config, and sets up various\n * settings, parameters, variables. After all setup actions are performed, it\n * invokes the video player to play the specified video. This module must be\n * invoked first. It provides several functions which do not fit in with other\n * modules.\n *\n * @external VideoPlayer\n *\n * @module Initialize\n */\n\n\n    define(\n'video/01_initialize.js',\n['video/03_video_player.js', 'video/00_i18n.js', 'moment', 'underscore'],\nfunction(VideoPlayer, i18n, moment, _) {\n    var moment = moment || window.moment;\n    /**\n     * @function\n     *\n     * Initialize module exports this function.\n     *\n     * @param {object} state The object containg the state of the video player.\n     *     All other modules, their parameters, public variables, etc. are\n     *     available via this object.\n     * @param {DOM element} element Container of the entire Video DOM element.\n     */\n    var Initialize = function(state, element) {\n            _makeFunctionsPublic(state);\n\n            state.initialize(element)\n            .done(function() {\n                if (state.isYoutubeType()) {\n                    state.parseSpeed();\n                }\n                // On iPhones and iPods native controls are used.\n                if (/iP(hone|od)/i.test(state.isTouch[0])) {\n                    _hideWaitPlaceholder(state);\n                    state.el.trigger('initialize', arguments);\n\n                    return false;\n                }\n\n                _initializeModules(state, i18n)\n                    .done(function() {\n                        // On iPad ready state occurs just after start playing.\n                        // We hide controls before video starts playing.\n                        if (/iPad|Android/i.test(state.isTouch[0])) {\n                            state.el.on('play', _.once(function() {\n                                state.trigger('videoControl.show', null);\n                            }));\n                        } else {\n                        // On PC show controls immediately.\n                            state.trigger('videoControl.show', null);\n                        }\n\n                        _hideWaitPlaceholder(state);\n                        state.el.trigger('initialize', arguments);\n                    });\n            });\n        },\n\n        /* eslint-disable no-use-before-define */\n        methodsDict = {\n            bindTo: bindTo,\n            fetchMetadata: fetchMetadata,\n            getCurrentLanguage: getCurrentLanguage,\n            getDuration: getDuration,\n            getPlayerMode: getPlayerMode,\n            getVideoMetadata: getVideoMetadata,\n            initialize: initialize,\n            isHtml5Mode: isHtml5Mode,\n            isFlashMode: isFlashMode,\n            isYoutubeType: isYoutubeType,\n            parseSpeed: parseSpeed,\n            parseYoutubeStreams: parseYoutubeStreams,\n            setPlayerMode: setPlayerMode,\n            setSpeed: setSpeed,\n            setAutoAdvance: setAutoAdvance,\n            speedToString: speedToString,\n            trigger: trigger,\n            youtubeId: youtubeId,\n            loadHtmlPlayer: loadHtmlPlayer,\n            loadYoutubePlayer: loadYoutubePlayer,\n            loadYouTubeIFrameAPI: loadYouTubeIFrameAPI\n        },\n        /* eslint-enable no-use-before-define */\n\n        _youtubeApiDeferred = null,\n        _oldOnYouTubeIframeAPIReady;\n\n    Initialize.prototype = methodsDict;\n\n    return Initialize;\n\n    // ***************************************************************\n    // Private functions start here. Private functions start with underscore.\n    // ***************************************************************\n\n    /**\n     * @function _makeFunctionsPublic\n     *\n     * Functions which will be accessible via 'state' object. When called,\n     * these functions will get the 'state'\n     * object as a context.\n     *\n     * @param {object} state The object containg the state (properties,\n     *     methods, modules) of the Video player.\n     */\n    function _makeFunctionsPublic(state) {\n        bindTo(methodsDict, state, state);\n    }\n\n    // function _renderElements(state)\n    //\n    //     Create any necessary DOM elements, attach them, and set their\n    //     initial configuration. Also make the created DOM elements available\n    //     via the 'state' object. Much easier to work this way - you don't\n    //     have to do repeated jQuery element selects.\n    function _renderElements(state) {\n        // Launch embedding of actual video content, or set it up so that it\n        // will be done as soon as the appropriate video player (YouTube or\n        // stand-alone HTML5) is loaded, and can handle embedding.\n        //\n        // Note that the loading of stand alone HTML5 player API is handled by\n        // Require JS. At the time when we reach this code, the stand alone\n        // HTML5 player is already loaded, so no further testing in that case\n        // is required.\n        var video, onYTApiReady, setupOnYouTubeIframeAPIReady;\n\n        if (state.videoType === 'youtube') {\n            state.youtubeApiAvailable = false;\n\n            onYTApiReady = function() {\n                console.log('[Video info]: YouTube API is available and is loaded.');\n                if (state.htmlPlayerLoaded) { return; }\n\n                console.log('[Video info]: Starting YouTube player.');\n                video = VideoPlayer(state);\n\n                state.modules.push(video);\n                state.__dfd__.resolve();\n                state.youtubeApiAvailable = true;\n            };\n\n            if (window.YT) {\n                // If we have a Deferred object responsible for calling OnYouTubeIframeAPIReady\n                // callbacks, make sure that they have all been called by trying to resolve the\n                // Deferred object. Upon resolving, all the OnYouTubeIframeAPIReady will be\n                // called. If the object has been already resolved, the callbacks will not\n                // be called a second time.\n                if (_youtubeApiDeferred) {\n                    _youtubeApiDeferred.resolve();\n                }\n\n                window.YT.ready(onYTApiReady);\n            } else {\n                // There is only one global variable window.onYouTubeIframeAPIReady which\n                // is supposed to be a function that will be called by the YouTube API\n                // when it finished initializing. This function will update this global function\n                // so that it resolves our Deferred object, which will call all of the\n                // OnYouTubeIframeAPIReady callbacks.\n                //\n                // If this global function is already defined, we store it first, and make\n                // sure that it gets executed when our Deferred object is resolved.\n                setupOnYouTubeIframeAPIReady = function() {\n                    _oldOnYouTubeIframeAPIReady = window.onYouTubeIframeAPIReady || undefined;\n\n                    window.onYouTubeIframeAPIReady = function() {\n                        window.onYouTubeIframeAPIReady.resolve();\n                    };\n\n                    window.onYouTubeIframeAPIReady.resolve = _youtubeApiDeferred.resolve;\n                    window.onYouTubeIframeAPIReady.done = _youtubeApiDeferred.done;\n\n                    if (_oldOnYouTubeIframeAPIReady) {\n                        window.onYouTubeIframeAPIReady.done(_oldOnYouTubeIframeAPIReady);\n                    }\n                };\n\n                // If a Deferred object hasn't been created yet, create one now. It will\n                // be responsible for calling OnYouTubeIframeAPIReady callbacks once the\n                // YouTube API loads. After creating the Deferred object, load the YouTube\n                // API.\n                if (!_youtubeApiDeferred) {\n                    _youtubeApiDeferred = $.Deferred();\n                    setupOnYouTubeIframeAPIReady();\n                } else if (!window.onYouTubeIframeAPIReady || !window.onYouTubeIframeAPIReady.done) {\n                    // The Deferred object could have been already defined in a previous\n                    // initialization of the video module. However, since then the global variable\n                    // window.onYouTubeIframeAPIReady could have been overwritten. If so,\n                    // we should set it up again.\n                    setupOnYouTubeIframeAPIReady();\n                }\n\n                // Attach a callback to our Deferred object to be called once the\n                // YouTube API loads.\n                window.onYouTubeIframeAPIReady.done(function() {\n                    window.YT.ready(onYTApiReady);\n                });\n            }\n        } else {\n            video = VideoPlayer(state);\n\n            state.modules.push(video);\n            state.__dfd__.resolve();\n            state.htmlPlayerLoaded = true;\n        }\n    }\n\n    function _waitForYoutubeApi(state) {\n        console.log('[Video info]: Starting to wait for YouTube API to load.');\n        window.setTimeout(function() {\n            // If YouTube API will load OK, it will run `onYouTubeIframeAPIReady`\n            // callback, which will set `state.youtubeApiAvailable` to `true`.\n            // If something goes wrong at this stage, `state.youtubeApiAvailable` is\n            // `false`.\n            if (!state.youtubeApiAvailable) {\n                console.log('[Video info]: YouTube API is not available.');\n                if (!state.htmlPlayerLoaded) {\n                    state.loadHtmlPlayer();\n                }\n            }\n            state.el.trigger('youtube_availability', [state.youtubeApiAvailable]);\n        }, state.config.ytTestTimeout);\n    }\n\n    function loadYouTubeIFrameAPI(scriptTag) {\n        var firstScriptTag = document.getElementsByTagName('script')[0];\n        firstScriptTag.parentNode.insertBefore(scriptTag, firstScriptTag);\n    }\n\n    // function _configureCaptions(state)\n    //     Configure displaying of captions.\n    //\n    //     Option\n    //         this.config.showCaptions = true | false\n    //\n    //     Defines whether or not captions are shown on first viewing.\n    //\n    //     Option\n    //          this.hideCaptions = true | false\n    //\n    //     represents the user's choice of having the subtitles shown or\n    //     hidden. This choice is stored in cookies.\n    function _configureCaptions(state) {\n        if (state.config.showCaptions) {\n            state.hideCaptions = ($.cookie('hide_captions') === 'true');\n        } else {\n            state.hideCaptions = true;\n\n            $.cookie('hide_captions', state.hideCaptions, {\n                expires: 3650,\n                path: '/'\n            });\n\n            state.el.addClass('closed');\n        }\n    }\n\n    // function _parseYouTubeIDs(state)\n    //     The function parse YouTube stream ID's.\n    //     @return\n    //         false: We don't have YouTube video IDs to work with; most likely\n    //             we have HTML5 video sources.\n    //         true: Parsing of YouTube video IDs went OK, and we can proceed\n    //             onwards to play YouTube videos.\n    function _parseYouTubeIDs(state) {\n        if (state.parseYoutubeStreams(state.config.streams)) {\n            state.videoType = 'youtube';\n\n            return true;\n        }\n\n        console.log(\n            '[Video info]: Youtube Video IDs are incorrect or absent.'\n        );\n\n        return false;\n    }\n\n    /**\n     * Extract HLS video URLs from available video URLs.\n     *\n     * @param {object} state The object contaning the state (properties, methods, modules) of the Video player.\n     * @returns Array of available HLS video source urls.\n     */\n    function extractHLSVideoSources(state) {\n        return _.filter(state.config.sources, function(source) {\n            return /\\.m3u8(\\?.*)?$/.test(source);\n        });\n    }\n\n    // function _prepareHTML5Video(state)\n    // The function prepare HTML5 video, parse HTML5\n    // video sources etc.\n    function _prepareHTML5Video(state) {\n        state.speeds = ['0.75', '1.0', '1.25', '1.50'];\n        // If none of the supported video formats can be played and there is no\n        // short-hand video links, than hide the spinner and show error message.\n        if (!state.config.sources.length) {\n            _hideWaitPlaceholder(state);\n            state.el\n                .find('.video-player div')\n                    .addClass('hidden');\n            state.el\n                .find('.video-player .video-error')\n                    .removeClass('is-hidden');\n\n            return false;\n        }\n\n        state.videoType = 'html5';\n\n        if (!_.keys(state.config.transcriptLanguages).length) {\n            state.config.showCaptions = false;\n        }\n        state.setSpeed(state.speed);\n\n        return true;\n    }\n\n    function _hideWaitPlaceholder(state) {\n        state.el\n            .addClass('is-initialized')\n            .find('.spinner')\n            .attr({\n                'aria-hidden': 'true',\n                tabindex: -1\n            });\n    }\n\n    function _setConfigurations(state) {\n        _configureCaptions(state);\n        state.setPlayerMode(state.config.mode);\n        // Possible value are: 'visible', 'hiding', and 'invisible'.\n        state.controlState = 'visible';\n        state.controlHideTimeout = null;\n        state.captionState = 'invisible';\n        state.captionHideTimeout = null;\n        state.HLSVideoSources = extractHLSVideoSources(state);\n    }\n\n    function _initializeModules(state, i18n) {\n        var dfd = $.Deferred(),\n            modulesList = $.map(state.modules, function(module) {\n                var options = state.options[module.moduleName] || {};\n                if (_.isFunction(module)) {\n                    return module(state, i18n, options);\n                } else if ($.isPlainObject(module)) {\n                    return module;\n                }\n            });\n\n        $.when.apply(null, modulesList)\n            .done(dfd.resolve);\n\n        return dfd.promise();\n    }\n\n    function _getConfiguration(data, storage) {\n        var isBoolean = function(value) {\n                var regExp = /^true$/i;\n                return regExp.test(value.toString());\n            },\n                // List of keys that will be extracted form the configuration.\n            extractKeys = [],\n                // Compatibility keys used to change names of some parameters in\n                // the final configuration.\n            compatKeys = {\n                start: 'startTime',\n                end: 'endTime'\n            },\n                // Conversions used to pre-process some configuration data.\n            conversions = {\n                showCaptions: isBoolean,\n                autoplay: isBoolean,\n                autohideHtml5: isBoolean,\n                autoAdvance: function(value) {\n                    var shouldAutoAdvance = storage.getItem('auto_advance');\n                    if (_.isUndefined(shouldAutoAdvance)) {\n                        return isBoolean(value) || false;\n                    } else {\n                        return shouldAutoAdvance;\n                    }\n                },\n                savedVideoPosition: function(value) {\n                    return storage.getItem('savedVideoPosition', true) ||\n                            Number(value) ||\n                            0;\n                },\n                speed: function(value) {\n                    return storage.getItem('speed', true) || value;\n                },\n                generalSpeed: function(value) {\n                    return storage.getItem('general_speed') ||\n                            value ||\n                            '1.0';\n                },\n                transcriptLanguage: function(value) {\n                    return storage.getItem('language') ||\n                            value ||\n                            'en';\n                },\n                ytTestTimeout: function(value) {\n                    value = parseInt(value, 10);\n\n                    if (!isFinite(value)) {\n                        value = 1500;\n                    }\n\n                    return value;\n                },\n                startTime: function(value) {\n                    value = parseInt(value, 10);\n                    if (!isFinite(value) || value < 0) {\n                        return 0;\n                    }\n\n                    return value;\n                },\n                endTime: function(value) {\n                    value = parseInt(value, 10);\n\n                    if (!isFinite(value) || value === 0) {\n                        return null;\n                    }\n\n                    return value;\n                }\n            },\n            config = {};\n\n        data = _.extend({\n            startTime: 0,\n            endTime: null,\n            sub: '',\n            streams: ''\n        }, data);\n\n        $.each(data, function(option, value) {\n                // Extract option that is in `extractKeys`.\n            if ($.inArray(option, extractKeys) !== -1) {\n                return;\n            }\n\n                // Change option name to key that is in `compatKeys`.\n            if (compatKeys[option]) {\n                option = compatKeys[option];\n            }\n\n                // Pre-process data.\n            if (conversions[option]) {\n                if (_.isFunction(conversions[option])) {\n                    value = conversions[option].call(this, value);\n                } else {\n                    throw new TypeError(option + ' is not a function.');\n                }\n            }\n            config[option] = value;\n        });\n\n        return config;\n    }\n\n    // ***************************************************************\n    // Public functions start here.\n    // These are available via the 'state' object. Their context ('this'\n    // keyword) is the 'state' object. The magic private function that makes\n    // them available and sets up their context is makeFunctionsPublic().\n    // ***************************************************************\n\n\n    // function bindTo(methodsDict, obj, context, rewrite)\n    // Creates a new function with specific context and assigns it to the provided\n    // object.\n    function bindTo(methodsDict, obj, context, rewrite) {\n        $.each(methodsDict, function(name, method) {\n            if (_.isFunction(method)) {\n                if (_.isUndefined(rewrite)) {\n                    rewrite = true;\n                }\n\n                if (_.isUndefined(obj[name]) || rewrite) {\n                    obj[name] = _.bind(method, context);\n                }\n            }\n        });\n    }\n\n    function loadYoutubePlayer() {\n        if (this.htmlPlayerLoaded) { return; }\n\n        console.log(\n            '[Video info]: Fetch metadata for YouTube video.'\n        );\n\n        this.fetchMetadata();\n        this.parseSpeed();\n    }\n\n    function loadHtmlPlayer() {\n        // When the youtube link doesn't work for any reason\n        // (for example, firewall) any\n        // alternate sources should automatically play.\n        if (!_prepareHTML5Video(this)) {\n            console.log(\n                '[Video info]: Continue loading ' +\n                'YouTube video.'\n            );\n\n            // Non-YouTube sources were not found either.\n\n            this.el.find('.video-player div')\n                .removeClass('hidden');\n            this.el.find('.video-player .video-error')\n                .addClass('is-hidden');\n\n            // If in reality the timeout was to short, try to\n            // continue loading the YouTube video anyways.\n            this.loadYoutubePlayer();\n        } else {\n            console.log(\n                '[Video info]: Start HTML5 player.'\n            );\n\n            // In-browser HTML5 player does not support quality\n            // control.\n            this.el.find('.quality_control').hide();\n            _renderElements(this);\n        }\n    }\n\n    // function initialize(element)\n    // The function set initial configuration and preparation.\n\n    function initialize(element) {\n        var self = this,\n            el = this.el,\n            id = this.id,\n            container = el.find('.video-wrapper'),\n            __dfd__ = $.Deferred(),\n            isTouch = onTouchBasedDevice() || '';\n\n        if (isTouch) {\n            el.addClass('is-touch');\n        }\n\n        $.extend(this, {\n            __dfd__: __dfd__,\n            container: container,\n            isFullScreen: false,\n            isTouch: isTouch\n        });\n\n        console.log('[Video info]: Initializing video with id \"%s\".', id);\n\n        // We store all settings passed to us by the server in one place. These\n        // are \"read only\", so don't modify them. All variable content lives in\n        // 'state' object.\n        // jQuery .data() return object with keys in lower camelCase format.\n        this.config = $.extend({}, _getConfiguration(this.metadata, this.storage), {\n            element: element,\n            fadeOutTimeout: 1400,\n            captionsFreezeTime: 10000,\n            mode: $.cookie('edX_video_player_mode'),\n            // Available HD qualities will only be accessible once the video has\n            // been played once, via player.getAvailableQualityLevels.\n            availableHDQualities: []\n        });\n\n        if (this.config.endTime < this.config.startTime) {\n            this.config.endTime = null;\n        }\n\n        this.lang = this.config.transcriptLanguage;\n        this.speed = this.speedToString(\n            this.config.speed || this.config.generalSpeed\n        );\n        this.auto_advance = this.config.autoAdvance;\n        this.htmlPlayerLoaded = false;\n        this.duration = this.metadata.duration;\n\n        _setConfigurations(this);\n\n        if (!(_parseYouTubeIDs(this))) {\n            // If we do not have YouTube ID's, try parsing HTML5 video sources.\n            if (!_prepareHTML5Video(this)) {\n                __dfd__.reject();\n                // Non-YouTube sources were not found either.\n                return __dfd__.promise();\n            }\n\n            console.log('[Video info]: Start player in HTML5 mode.');\n            _renderElements(this);\n        } else {\n            _renderElements(this);\n\n            _waitForYoutubeApi(this);\n\n            var scriptTag = document.createElement('script');\n\n            scriptTag.src = this.config.ytApiUrl;\n            scriptTag.async = true;\n\n            $(scriptTag).on('load', function() {\n                self.loadYoutubePlayer();\n            });\n            $(scriptTag).on('error', function() {\n                console.log(\n                    '[Video info]: YouTube returned an error for ' +\n                    'video with id \"' + self.id + '\".'\n                );\n                // If the video is already loaded in `_waitForYoutubeApi` by the\n                // time we get here, then we shouldn't load it again.\n                if (!self.htmlPlayerLoaded) {\n                    self.loadHtmlPlayer();\n                }\n            });\n\n            window.Video.loadYouTubeIFrameAPI(scriptTag);\n        }\n        return __dfd__.promise();\n    }\n\n    // function parseYoutubeStreams(state, youtubeStreams)\n    //\n    //     Take a string in the form:\n    //         \"iCawTYPtehk:0.75,KgpclqP-LBA:1.0,9-2670d5nvU:1.5\"\n    //     parse it, and make it available via the 'state' object. If we are\n    //     not given a string, or it's length is zero, then we return false.\n    //\n    //     @return\n    //         false: We don't have YouTube video IDs to work with; most likely\n    //             we have HTML5 video sources.\n    //         true: Parsing of YouTube video IDs went OK, and we can proceed\n    //             onwards to play YouTube videos.\n    function parseYoutubeStreams(youtubeStreams) {\n        if (_.isUndefined(youtubeStreams) || !youtubeStreams.length) {\n            return false;\n        }\n\n        this.videos = {};\n\n        _.each(youtubeStreams.split(/,/), function(video) {\n            var speed;\n            video = video.split(/:/);\n            speed = this.speedToString(video[0]);\n            this.videos[speed] = video[1];\n        }, this);\n\n        return _.isString(this.videos['1.0']);\n    }\n\n    // function fetchMetadata()\n    //\n    //     When dealing with YouTube videos, we must fetch meta data that has\n    //     certain key facts not available while the video is loading. For\n    //     example the length of the video can be determined from the meta\n    //     data.\n    function fetchMetadata() {\n        var self = this,\n            metadataXHRs = [];\n\n        this.metadata = {};\n\n        metadataXHRs = _.map(this.videos, function(url, speed) {\n            return self.getVideoMetadata(url, function(data) {\n                if (data.items.length > 0) {\n                    var metaDataItem = data.items[0];\n                    self.metadata[metaDataItem.id] = metaDataItem.contentDetails;\n                }\n            });\n        });\n\n        $.when.apply(this, metadataXHRs).done(function() {\n            self.el.trigger('metadata_received');\n\n            // Not only do we trigger the \"metadata_received\" event, we also\n            // set a flag to notify that metadata has been received. This\n            // allows for code that will miss the \"metadata_received\" event\n            // to know that metadata has been received. This is important in\n            // cases when some code will subscribe to the \"metadata_received\"\n            // event after it has been triggered.\n            self.youtubeMetadataReceived = true;\n        });\n    }\n\n    // function parseSpeed()\n    //\n    //     Create a separate array of available speeds.\n    function parseSpeed() {\n        this.speeds = _.keys(this.videos).sort();\n    }\n\n    function setSpeed(newSpeed) {\n        // Possible speeds for each player type.\n        // HTML5 =          [0.75, 1, 1.25, 1.5]\n        // Youtube Flash =  [0.75, 1, 1.25, 1.5]\n        // Youtube HTML5 =  [0.25, 0.5, 1, 1.5, 2]\n        var map = {\n            0.25: '0.75', // Youtube HTML5 -> HTML5 or Youtube Flash\n            '0.50': '0.75', // Youtube HTML5 -> HTML5 or Youtube Flash\n            0.75: '0.50', // HTML5 or Youtube Flash -> Youtube HTML5\n            1.25: '1.50', // HTML5 or Youtube Flash -> Youtube HTML5\n            '2.0': '1.50'   // Youtube HTML5 -> HTML5 or Youtube Flash\n        };\n\n        if (_.contains(this.speeds, newSpeed)) {\n            this.speed = newSpeed;\n        } else {\n            newSpeed = map[newSpeed];\n            this.speed = _.contains(this.speeds, newSpeed) ? newSpeed : '1.0';\n        }\n    }\n\n    function setAutoAdvance(enabled) {\n        this.auto_advance = enabled;\n    }\n\n    function getVideoMetadata(url, callback) {\n        if (!(_.isString(url))) {\n            url = this.videos['1.0'] || '';\n        }\n        // Will hit the API URL iF YT key is defined in settings.\n        if (this.config.ytKey) {\n            return $.ajax({\n                url: [this.config.ytMetadataUrl, '?id=', url, '&part=contentDetails&key=', this.config.ytKey].join(''),\n                timeout: this.config.ytTestTimeout,\n                success: _.isFunction(callback) ? callback : null,\n                error: function() {\n                    console.warn(\n                        'YouTube API request failed - usually this means the YouTube API key is invalid. ' +\n                            'Some video metadata may be unavailable.'\n                    );\n                },\n                notifyOnError: false\n            });\n        } else {\n            return $.Deferred().reject().promise();\n        }\n    }\n\n    function youtubeId(speed) {\n        var currentSpeed = this.isFlashMode() ? this.speed : '1.0';\n\n        return this.videos[speed] ||\n                this.videos[currentSpeed] ||\n                this.videos['1.0'];\n    }\n\n    function getDuration() {\n        try {\n            return moment.duration(this.metadata[this.youtubeId()].duration, moment.ISO_8601).asSeconds();\n        } catch (err) {\n            return _.result(this.metadata[this.youtubeId('1.0')], 'duration') || 0;\n        }\n    }\n\n    /**\n     * Sets player mode.\n     *\n     * @param {string} mode Mode to set for the video player if it is supported.\n     *                      Otherwise, `html5` is used by default.\n     */\n    function setPlayerMode(mode) {\n        var supportedModes = ['html5', 'flash'];\n\n        mode = _.contains(supportedModes, mode) ? mode : 'html5';\n        this.currentPlayerMode = mode;\n    }\n\n    /**\n     * Returns current player mode.\n     *\n     * @return {string} Returns string that describes player mode\n     */\n    function getPlayerMode() {\n        return this.currentPlayerMode;\n    }\n\n    /**\n     * Checks if current player mode is Flash.\n     *\n     * @return {boolean} Returns `true` if current mode is `flash`, otherwise\n     *                   it returns `false`\n     */\n    function isFlashMode() {\n        return this.getPlayerMode() === 'flash';\n    }\n\n    /**\n     * Checks if current player mode is Html5.\n     *\n     * @return {boolean} Returns `true` if current mode is `html5`, otherwise\n     *                   it returns `false`\n     */\n    function isHtml5Mode() {\n        return this.getPlayerMode() === 'html5';\n    }\n\n    function isYoutubeType() {\n        return this.videoType === 'youtube';\n    }\n\n    function speedToString(speed) {\n        return parseFloat(speed).toFixed(2).replace(/\\.00$/, '.0');\n    }\n\n    function getCurrentLanguage() {\n        var keys = _.keys(this.config.transcriptLanguages);\n\n        if (keys.length) {\n            if (!_.contains(keys, this.lang)) {\n                if (_.contains(keys, 'en')) {\n                    this.lang = 'en';\n                } else {\n                    this.lang = keys.pop();\n                }\n            }\n        } else {\n            return null;\n        }\n\n        return this.lang;\n    }\n\n    /*\n     * The trigger() function will assume that the @objChain is a complete\n     * chain with a method (function) at the end. It will call this function.\n     * So for example, when trigger() is called like so:\n     *\n     *     state.trigger('videoPlayer.pause', {'param1': 10});\n     *\n     * Then trigger() will execute:\n     *\n     *     state.videoPlayer.pause({'param1': 10});\n     */\n    function trigger(objChain) {\n        var extraParameters = Array.prototype.slice.call(arguments, 1),\n            i, tmpObj, chain;\n\n        // Remember that 'this' is the 'state' object.\n        tmpObj = this;\n        chain = objChain.split('.');\n\n        // At the end of the loop the variable 'tmpObj' will either be the\n        // correct object/function to trigger/invoke. If the 'chain' chain of\n        // object is incorrect (one of the link is non-existent), then the loop\n        // will immediately exit.\n        while (chain.length) {\n            i = chain.shift();\n\n            if (tmpObj.hasOwnProperty(i)) {\n                tmpObj = tmpObj[i];\n            } else {\n                // An incorrect object chain was specified.\n\n                return false;\n            }\n        }\n\n        tmpObj.apply(this, extraParameters);\n\n        return true;\n    }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/01_initialize.js","/*\n * 025_focus_grabber.js\n *\n * Purpose: Provide a way to focus on autohidden Video controls.\n *\n *\n * Because in HTML player mode we have a feature of autohiding controls on\n * mouse inactivity, sometimes focus is lost from the currently selected\n * control. What's more, when all controls are autohidden, we can't get to any\n * of them because by default browser does not place hidden elements on the\n * focus chain.\n *\n * To get around this minor annoyance, this module will manage 2 placeholder\n * elements that will be invisible to the user's eye, but visible to the\n * browser. This will allow for a sneaky stealing of focus and placing it where\n * we need (on hidden controls).\n *\n * This code has been moved to a separate module because it provides a concrete\n * block of functionality that can be turned on (off).\n */\n\n/*\n * \"If you want to climb a mountain, begin at the top.\"\n *\n * ~ Zen saying\n */\n\n\n// FocusGrabber module.\n    define(\n'video/025_focus_grabber.js',\n[],\nfunction() {\n    return function(state) {\n        var dfd = $.Deferred();\n\n        state.focusGrabber = {};\n\n        _makeFunctionsPublic(state);\n        _renderElements(state);\n        _bindHandlers(state);\n\n        dfd.resolve();\n        return dfd.promise();\n    };\n\n\n    // Private functions.\n\n    function _makeFunctionsPublic(state) {\n        var methodsDict = {\n            disableFocusGrabber: disableFocusGrabber,\n            enableFocusGrabber: enableFocusGrabber,\n            onFocus: onFocus\n        };\n\n        state.bindTo(methodsDict, state.focusGrabber, state);\n    }\n\n    function _renderElements(state) {\n        state.focusGrabber.elFirst = state.el.find('.focus_grabber.first');\n        state.focusGrabber.elLast = state.el.find('.focus_grabber.last');\n\n        // From the start, the Focus Grabber must be disabled so that\n        // tabbing (switching focus) does not land the user on one of the\n        // placeholder elements (elFirst, elLast).\n        state.focusGrabber.disableFocusGrabber();\n    }\n\n    function _bindHandlers(state) {\n        state.focusGrabber.elFirst.on('focus', state.focusGrabber.onFocus);\n        state.focusGrabber.elLast.on('focus', state.focusGrabber.onFocus);\n\n        // When the video container element receives programmatic focus, then\n        // on un-focus ('blur' event) we should trigger a 'mousemove' event so\n        // as to reveal autohidden controls.\n        state.el.on('blur', function() {\n            state.el.trigger('mousemove');\n        });\n    }\n\n\n    // Public functions.\n\n    function enableFocusGrabber() {\n        var tabIndex;\n\n        // When the Focus Grabber is being enabled, there are two different\n        // scenarios:\n        //\n        //     1.) Currently focused element was inside the video player.\n        //     2.) Currently focused element was somewhere else on the page.\n        //\n        // In the first case we must make sure that the video player doesn't\n        // loose focus, even though the controls are autohidden.\n        if ($(document.activeElement).parents().hasClass('video')) {\n            tabIndex = -1;\n        } else {\n            tabIndex = 0;\n        }\n\n        this.focusGrabber.elFirst.attr('tabindex', tabIndex);\n        this.focusGrabber.elLast.attr('tabindex', tabIndex);\n\n        // Don't loose focus. We are inside video player on some control, but\n        // because we can't remain focused on a hidden element, we will shift\n        // focus to the main video element.\n        //\n        // Once the main element will receive the un-focus ('blur') event, a\n        // 'mousemove' event will be triggered, and the video controls will\n        // receive focus once again.\n        if (tabIndex === -1) {\n            this.el.focus();\n\n            this.focusGrabber.elFirst.attr('tabindex', 0);\n            this.focusGrabber.elLast.attr('tabindex', 0);\n        }\n    }\n\n    function disableFocusGrabber() {\n        // Only programmatic focusing on these elements will be available.\n        // We don't want the user to focus on them (for example with the 'Tab'\n        // key).\n        this.focusGrabber.elFirst.attr('tabindex', -1);\n        this.focusGrabber.elLast.attr('tabindex', -1);\n    }\n\n    function onFocus(event, params) {\n        // Once the Focus Grabber placeholder elements will gain focus, we will\n        // trigger 'mousemove' event so that the autohidden controls will\n        // become visible.\n        this.el.trigger('mousemove');\n\n        this.focusGrabber.disableFocusGrabber();\n    }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/025_focus_grabber.js","/* eslint-disable no-console, no-param-reassign */\n/**\n * HTML5 video player module to support HLS video playback.\n *\n */\n\n\n    'use strict';\n    define('video/02_html5_hls_video.js', ['video/02_html5_video.js', 'hls'],\n    function(HTML5Video, HLS) {\n        var HLSVideo = {};\n\n        HLSVideo.Player = (function() {\n            /**\n             * Initialize HLS video player.\n             *\n             * @param {jQuery} el  Reference to video player container element\n             * @param {Object} config  Contains common config for video player\n             */\n            function Player(el, config) {\n                var self = this;\n\n                // do common initialization independent of player type\n                this.init(el, config);\n\n                // If we have only HLS sources and browser doesn't support HLS then show error message.\n                if (config.HLSOnlySources && !config.canPlayHLS) {\n                    this.showErrorMessage(null, '.video-hls-error');\n                    return;\n                }\n\n                // Safari has native support to play HLS videos\n                if (config.browserIsSafari) {\n                    this.videoEl.attr('src', config.videoSources[0]);\n                } else {\n                    this.hls = new HLS();\n                    this.hls.loadSource(config.videoSources[0]);\n                    this.hls.attachMedia(this.video);\n\n                    this.hls.on(HLS.Events.ERROR, this.onError.bind(this));\n\n                    this.hls.on(HLS.Events.MANIFEST_PARSED, function(event, data) {\n                        console.log(\n                            '[HLS Video]: MANIFEST_PARSED, qualityLevelsInfo: ',\n                            data.levels.map(function(level) {\n                                return {\n                                    bitrate: level.bitrate,\n                                    resolution: level.width + 'x' + level.height\n                                };\n                            })\n                        );\n                    });\n                    this.hls.on(HLS.Events.LEVEL_SWITCHED, function(event, data) {\n                        var level = self.hls.levels[data.level];\n                        console.log(\n                            '[HLS Video]: LEVEL_SWITCHED, qualityLevelInfo: ',\n                            {\n                                bitrate: level.bitrate,\n                                resolution: level.width + 'x' + level.height\n                            }\n                        );\n                    });\n                }\n            }\n\n            Player.prototype = Object.create(HTML5Video.Player.prototype);\n            Player.prototype.constructor = Player;\n\n            /**\n             * Handler for HLS video errors. This only takes care of fatal erros, non-fatal errors\n             * are automatically handled by hls.js\n             *\n             * @param {String} event `hlsError`\n             * @param {Object} data  Contains the information regarding error occurred.\n             */\n            Player.prototype.onError = function(event, data) {\n                if (data.fatal) {\n                    switch (data.type) {\n                    case HLS.ErrorTypes.NETWORK_ERROR:\n                        console.error(\n                            '[HLS Video]: Fatal network error encountered, try to recover. Details: %s',\n                            data.details\n                        );\n                        this.hls.startLoad();\n                        break;\n                    case HLS.ErrorTypes.MEDIA_ERROR:\n                        console.error(\n                            '[HLS Video]: Fatal media error encountered, try to recover. Details: %s',\n                            data.details\n                        );\n                        this.hls.recoverMediaError();\n                        break;\n                    default:\n                        console.error(\n                            '[HLS Video]: Unrecoverable error encountered. Details: %s',\n                            data.details\n                        );\n                        break;\n                    }\n                }\n            };\n\n            return Player;\n        }());\n\n        return HLSVideo;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/02_html5_hls_video.js","/* eslint-disable no-console, no-param-reassign */\n/**\n * @file HTML5 video player module. Provides methods to control the in-browser\n * HTML5 video player.\n *\n * The goal was to write this module so that it closely resembles the YouTube\n * API. The main reason for this is because initially the edX video player\n * supported only YouTube videos. When HTML5 support was added, for greater\n * compatibility, and to reduce the amount of code that needed to be modified,\n * it was decided to write a similar API as the one provided by YouTube.\n *\n * @external RequireJS\n *\n * @module HTML5Video\n */\n\n\n    define(\n'video/02_html5_video.js',\n['underscore'],\nfunction(_) {\n    var HTML5Video = {};\n\n    HTML5Video.Player = (function() {\n        /*\n         * Constructor function for HTML5 Video player.\n         *\n         * @param {String|Object} el A DOM element where the HTML5 player will\n         * be inserted (as returned by jQuery(selector) function), or a\n         * selector string which will be used to select an element. This is a\n         * required parameter.\n         *\n         * @param config - An object whose properties will be used as\n         * configuration options for the HTML5 video player. This is an\n         * optional parameter. In the case if this parameter is missing, or\n         * some of the config object's properties are missing, defaults will be\n         * used. The available options (and their defaults) are as\n         * follows:\n         *\n         *     config = {\n         *\n         *        videoSources: [],   // An array with properties being video\n         *                            // sources. The property name is the\n         *                            // video format of the source. Supported\n         *                            // video formats are: 'mp4', 'webm', and\n         *                            // 'ogg'.\n         *        poster:             Video poster URL\n         *\n         *        browserIsSafari:    Flag to tell if current browser is Safari\n         *\n         *        events: {           // Object's properties identify the\n         *                            // events that the API fires, and the\n         *                            // functions (event listeners) that the\n         *                            // API will call when those events occur.\n         *                            // If value is null, or property is not\n         *                            // specified, then no callback will be\n         *                            // called for that event.\n         *\n         *              onReady: null,\n         *              onStateChange: null\n         *          }\n         *     }\n         */\n        function Player(el, config) {\n            var errorMessage, lastSource, sourceList;\n\n            // Create HTML markup for individual sources of the HTML5 <video> element.\n            sourceList = $.map(config.videoSources, function(source) {\n                return [\n                    '<source ',\n                    'src=\"', source,\n            // Following hack allows to open the same video twice\n            // https://code.google.com/p/chromium/issues/detail?id=31014\n            // Check whether the url already has a '?' inside, and if so,\n            // use '&' instead of '?' to prevent breaking the url's integrity.\n                        (source.indexOf('?') === -1 ? '?' : '&'),\n                    (new Date()).getTime(), '\" />'\n                ].join('');\n            });\n\n            // do common initialization independent of player type\n            this.init(el, config);\n\n            // Create HTML markup for the <video> element, populating it with\n            // sources from previous step. Set playback not supported error message.\n            errorMessage = [\n                gettext('This browser cannot play .mp4, .ogg, or .webm files.'),\n                gettext('Try using a different browser, such as Google Chrome.')\n            ].join('');\n            this.video.innerHTML = sourceList.join('') + errorMessage;\n\n            lastSource = this.videoEl.find('source').last();\n            lastSource.on('error', this.showErrorMessage.bind(this));\n            lastSource.on('error', this.onError.bind(this));\n            this.videoEl.on('error', this.onError.bind(this));\n        }\n\n        Player.prototype.callStateChangeCallback = function() {\n            if ($.isFunction(this.config.events.onStateChange)) {\n                this.config.events.onStateChange({\n                    data: this.playerState\n                });\n            }\n        };\n\n        Player.prototype.pauseVideo = function() {\n            this.video.pause();\n        };\n\n        Player.prototype.seekTo = function(value) {\n            if (\n                typeof value === 'number' &&\n                value <= this.video.duration &&\n                value >= 0\n            ) {\n                this.video.currentTime = value;\n            }\n        };\n\n        Player.prototype.setVolume = function(value) {\n            if (typeof value === 'number' && value <= 100 && value >= 0) {\n                this.video.volume = value * 0.01;\n            }\n        };\n\n        Player.prototype.getCurrentTime = function() {\n            return this.video.currentTime;\n        };\n\n        Player.prototype.playVideo = function() {\n            this.video.play();\n        };\n\n        Player.prototype.getPlayerState = function() {\n            return this.playerState;\n        };\n\n        Player.prototype.getVolume = function() {\n            return this.video.volume;\n        };\n\n        Player.prototype.getDuration = function() {\n            if (isNaN(this.video.duration)) {\n                return 0;\n            }\n\n            return this.video.duration;\n        };\n\n        Player.prototype.setPlaybackRate = function(value) {\n            var newSpeed;\n\n            newSpeed = parseFloat(value);\n\n            if (isFinite(newSpeed)) {\n                if (this.video.playbackRate !== value) {\n                    this.video.playbackRate = value;\n                }\n            }\n        };\n\n        Player.prototype.getAvailablePlaybackRates = function() {\n            return [0.75, 1.0, 1.25, 1.5];\n        };\n\n        // eslint-disable-next-line no-underscore-dangle\n        Player.prototype._getLogs = function() {\n            return this.logs;\n        };\n\n        Player.prototype.showErrorMessage = function(event, css) {\n            var cssSelecter = css || '.video-player .video-error';\n            this.el\n                .find('.video-player div')\n                    .addClass('hidden')\n                .end()\n                .find(cssSelecter)\n                    .removeClass('is-hidden')\n                .end()\n                    .addClass('is-initialized')\n                .find('.spinner')\n                    .attr({\n                        'aria-hidden': 'true',\n                        tabindex: -1\n                    });\n        };\n\n        Player.prototype.onError = function() {\n            if ($.isFunction(this.config.events.onError)) {\n                this.config.events.onError();\n            }\n        };\n\n        Player.prototype.destroy = function() {\n            this.video.removeEventListener('loadedmetadata', this.onLoadedMetadata, false);\n            this.video.removeEventListener('play', this.onPlay, false);\n            this.video.removeEventListener('playing', this.onPlaying, false);\n            this.video.removeEventListener('pause', this.onPause, false);\n            this.video.removeEventListener('ended', this.onEnded, false);\n            this.el\n                .find('.video-player div')\n                .removeClass('is-hidden')\n                .end()\n                .find('.video-player .video-error')\n                .addClass('is-hidden')\n                .end()\n                .removeClass('is-initialized')\n                .find('.spinner')\n                .attr({'aria-hidden': 'false'});\n            this.videoEl.off('remove');\n            this.videoEl.remove();\n        };\n\n        Player.prototype.onLoadedMetadata = function() {\n            this.playerState = HTML5Video.PlayerState.PAUSED;\n            if ($.isFunction(this.config.events.onReady)) {\n                this.config.events.onReady(null);\n                this.videoOverlayEl.removeClass('is-hidden');\n            }\n        };\n\n        Player.prototype.onPlay = function() {\n            this.playerState = HTML5Video.PlayerState.BUFFERING;\n            this.callStateChangeCallback();\n            this.videoOverlayEl.addClass('is-hidden');\n        };\n\n        Player.prototype.onPlaying = function() {\n            this.playerState = HTML5Video.PlayerState.PLAYING;\n            this.callStateChangeCallback();\n            this.videoOverlayEl.addClass('is-hidden');\n        };\n\n        Player.prototype.onPause = function() {\n            this.playerState = HTML5Video.PlayerState.PAUSED;\n            this.callStateChangeCallback();\n            this.videoOverlayEl.removeClass('is-hidden');\n        };\n\n        Player.prototype.onEnded = function() {\n            this.playerState = HTML5Video.PlayerState.ENDED;\n            this.callStateChangeCallback();\n        };\n\n        Player.prototype.init = function(el, config) {\n            var isTouch = window.onTouchBasedDevice() || '',\n                events = ['loadstart', 'progress', 'suspend', 'abort', 'error',\n                    'emptied', 'stalled', 'play', 'pause', 'loadedmetadata',\n                    'loadeddata', 'waiting', 'playing', 'canplay', 'canplaythrough',\n                    'seeking', 'seeked', 'timeupdate', 'ended', 'ratechange',\n                    'durationchange', 'volumechange'\n                ],\n                self = this,\n                callback;\n\n            this.config = config;\n            this.logs = [];\n            this.el = $(el);\n\n            // Because of problems with creating video element via jquery\n            // (http://bugs.jquery.com/ticket/9174) we create it using native JS.\n            this.video = document.createElement('video');\n\n            // Get the jQuery object and set error event handlers\n            this.videoEl = $(this.video);\n\n            // Video player overlay play button\n            this.videoOverlayEl = this.el.find('.video-wrapper .btn-play');\n\n            // The player state is used by other parts of the VideoPlayer to\n            // determine what the video is currently doing.\n            this.playerState = HTML5Video.PlayerState.UNSTARTED;\n\n            _.bindAll(this, 'onLoadedMetadata', 'onPlay', 'onPlaying', 'onPause', 'onEnded');\n\n            // Attach a 'click' event on the <video> element. It will cause the\n            // video to pause/play.\n            callback = function() {\n                var PlayerState = HTML5Video.PlayerState;\n\n                if (self.playerState === PlayerState.PLAYING) {\n                    self.playerState = PlayerState.PAUSED;\n                    self.pauseVideo();\n                } else {\n                    self.playerState = PlayerState.PLAYING;\n                    self.playVideo();\n                }\n            };\n            this.videoEl.on('click', callback);\n            this.videoOverlayEl.on('click', callback);\n\n            this.debug = false;\n            $.each(events, function(index, eventName) {\n                self.video.addEventListener(eventName, function() {\n                    self.logs.push({\n                        'event name': eventName,\n                        state: self.playerState\n                    });\n\n                    if (self.debug) {\n                        console.log(\n                            'event name:', eventName,\n                            'state:', self.playerState,\n                            'readyState:', self.video.readyState,\n                            'networkState:', self.video.networkState\n                        );\n                    }\n\n                    el.trigger('html5:' + eventName, arguments);\n                });\n            });\n\n            // When the <video> tag has been processed by the browser, and it\n            // is ready for playback, notify other parts of the VideoPlayer,\n            // and initially pause the video.\n            this.video.addEventListener('loadedmetadata', this.onLoadedMetadata, false);\n            this.video.addEventListener('play', this.onPlay, false);\n            this.video.addEventListener('playing', this.onPlaying, false);\n            this.video.addEventListener('pause', this.onPause, false);\n            this.video.addEventListener('ended', this.onEnded, false);\n\n            if (/iP(hone|od)/i.test(isTouch[0])) {\n                this.videoEl.prop('controls', true);\n            }\n\n            // Set video poster\n            if (this.config.poster) {\n                this.videoEl.prop('poster', this.config.poster);\n            }\n\n            // Place the <video> element on the page.\n            this.videoEl.appendTo(el.find('.video-player > div:first-child'));\n        };\n\n        return Player;\n    }());\n\n    // The YouTube API presents several constants which describe the player's\n    // state at a given moment. HTML5Video API will copy these constants so\n    // that code which uses both the YouTube API and this API doesn't have to\n    // change.\n    HTML5Video.PlayerState = {\n        UNSTARTED: -1,\n        ENDED: 0,\n        PLAYING: 1,\n        PAUSED: 2,\n        BUFFERING: 3,\n        CUED: 5\n    };\n\n    // HTML5Video object - what this module exports.\n    return HTML5Video;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/02_html5_video.js","\n    'use strict';\n// VideoTranscriptDownloadHandler module.\n    define(\n'video/035_video_accessible_menu.js', ['underscore'],\nfunction(_) {\n    /**\n     * Video Download Transcript control module.\n     * @exports video/035_video_accessible_menu.js\n     * @constructor\n     * @param {jquery Element} element\n     * @param {Object} options\n     */\n    var VideoTranscriptDownloadHandler = function(element, options) {\n        if (!(this instanceof VideoTranscriptDownloadHandler)) {\n            return new VideoTranscriptDownloadHandler(element, options);\n        }\n\n        _.bindAll(this, 'clickHandler');\n\n        this.container = element;\n        this.options = options || {};\n\n        if (this.container.find('.wrapper-downloads .wrapper-download-transcripts')) {\n            this.initialize();\n        }\n\n        return false;\n    };\n\n    VideoTranscriptDownloadHandler.prototype = {\n        // Initializes the module.\n        initialize: function() {\n            this.value = this.options.storage.getItem('transcript_download_format');\n            this.el = this.container.find('.list-download-transcripts');\n            this.el.on('click', '.btn-link', this.clickHandler);\n        },\n\n        // Event handler. We delay link clicks until the file type is set\n        clickHandler: function(event) {\n            var that = this,\n                fileType,\n                data,\n                downloadUrl;\n\n            event.preventDefault();\n\n            fileType = $(event.target).data('value');\n            data = {transcript_download_format: fileType};\n            downloadUrl = $(event.target).attr('href');\n\n            $.ajax({\n                url: this.options.saveStateUrl,\n                type: 'POST',\n                dataType: 'json',\n                data: data,\n                success: function() {\n                    that.options.storage.setItem('transcript_download_format', fileType);\n                },\n                complete: function() {\n                    document.location.href = downloadUrl;\n                }\n            });\n        }\n    };\n\n    return VideoTranscriptDownloadHandler;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/035_video_accessible_menu.js","/* eslint-disable no-console, no-param-reassign */\n\n// VideoPlayer module.\n    define(\n'video/03_video_player.js',\n['video/02_html5_video.js', 'video/02_html5_hls_video.js', 'video/00_resizer.js', 'hls', 'underscore', '../time.js'],\nfunction(HTML5Video, HTML5HLSVideo, Resizer, HLS, _, Time) {\n    var dfd = $.Deferred(),\n        VideoPlayer = function(state) {\n            state.videoPlayer = {};\n            _makeFunctionsPublic(state);\n            _initialize(state);\n            // No callbacks to DOM events (click, mousemove, etc.).\n\n            return dfd.promise();\n        },\n        /* eslint-disable no-use-before-define */\n        methodsDict = {\n            destroy: destroy,\n            duration: duration,\n            handlePlaybackQualityChange: handlePlaybackQualityChange,\n\n            // Added for finer graded seeking control.\n            // Please see:\n            //     https://developers.google.com/youtube/js_api_reference#Events\n            isBuffering: isBuffering,\n            // https://developers.google.com/youtube/js_api_reference#cueVideoById\n            isCued: isCued,\n\n            isEnded: isEnded,\n            isPlaying: isPlaying,\n            isUnstarted: isUnstarted,\n            onCaptionSeek: onSeek,\n            onEnded: onEnded,\n            onError: onError,\n            onPause: onPause,\n            onPlay: onPlay,\n            runTimer: runTimer,\n            stopTimer: stopTimer,\n            onLoadMetadataHtml5: onLoadMetadataHtml5,\n            onPlaybackQualityChange: onPlaybackQualityChange,\n            onReady: onReady,\n            onSlideSeek: onSeek,\n            onSpeedChange: onSpeedChange,\n            onAutoAdvanceChange: onAutoAdvanceChange,\n            onStateChange: onStateChange,\n            onUnstarted: onUnstarted,\n            onVolumeChange: onVolumeChange,\n            pause: pause,\n            play: play,\n            seekTo: seekTo,\n            setPlaybackRate: setPlaybackRate,\n            update: update,\n            figureOutStartEndTime: figureOutStartEndTime,\n            figureOutStartingTime: figureOutStartingTime,\n            updatePlayTime: updatePlayTime\n        };\n        /* eslint-enable no-use-before-define */\n\n    VideoPlayer.prototype = methodsDict;\n\n    // VideoPlayer() function - what this module \"exports\".\n    return VideoPlayer;\n\n    // ***************************************************************\n    // Private functions start here.\n    // ***************************************************************\n\n    // function _makeFunctionsPublic(state)\n    //\n    //     Functions which will be accessible via 'state' object. When called,\n    //     these functions will get the 'state' object as a context.\n    function _makeFunctionsPublic(state) {\n        var debouncedF = _.debounce(\n            function(params) {\n                // Can't cancel a queued debounced function on destroy\n                if (state.videoPlayer) {\n                    return onSeek.call(this, params);\n                }\n            }.bind(state),\n            300\n        );\n\n        state.bindTo(methodsDict, state.videoPlayer, state);\n\n        state.videoPlayer.onSlideSeek = debouncedF;\n        state.videoPlayer.onCaptionSeek = debouncedF;\n    }\n\n    // Updates players state, once metadata is loaded for html5 player.\n    function onLoadMetadataHtml5() {\n        var player = this.videoPlayer.player.videoEl,\n            videoWidth = player[0].videoWidth || player.width(),\n            videoHeight = player[0].videoHeight || player.height();\n\n        _resize(this, videoWidth, videoHeight);\n        _updateVcrAndRegion(this);\n    }\n\n\n    // function _initialize(state)\n    //\n    //     Create any necessary DOM elements, attach them, and set their\n    //     initial configuration. Also make the created DOM elements available\n    //     via the 'state' object. Much easier to work this way - you don't\n    //     have to do repeated jQuery element selects.\n    // eslint-disable-next-line no-underscore-dangle\n    function _initialize(state) {\n        var youTubeId,\n            player,\n            userAgent,\n            commonPlayerConfig,\n            eventToBeTriggered = 'loadedmetadata';\n\n        // The function is called just once to apply pre-defined configurations\n        // by student before video starts playing. Waits until the video's\n        // metadata is loaded, which normally happens just after the video\n        // starts playing. Just after that configurations can be applied.\n        state.videoPlayer.ready = _.once(function() {\n            if (!state.isFlashMode() && state.speed != '1.0') {\n                state.videoPlayer.setPlaybackRate(state.speed);\n            }\n        });\n\n        if (state.isYoutubeType()) {\n            state.videoPlayer.PlayerState = YT.PlayerState;\n            state.videoPlayer.PlayerState.UNSTARTED = -1;\n        } else {\n            state.videoPlayer.PlayerState = HTML5Video.PlayerState;\n        }\n\n        state.videoPlayer.currentTime = 0;\n\n        state.videoPlayer.goToStartTime = true;\n        state.videoPlayer.stopAtEndTime = true;\n\n        state.videoPlayer.playerVars = {\n            controls: 0,\n            wmode: 'transparent',\n            rel: 0,\n            showinfo: 0,\n            enablejsapi: 1,\n            modestbranding: 1,\n            cc_load_policy: 0\n        };\n\n        if (!state.isFlashMode()) {\n            state.videoPlayer.playerVars.html5 = 1;\n        }\n\n        // Detect the current browser for several browser-specific work-arounds.\n        userAgent = navigator.userAgent.toLowerCase();\n        state.browserIsFirefox = userAgent.indexOf('firefox') > -1;\n        state.browserIsChrome = userAgent.indexOf('chrome') > -1;\n        // Chrome includes both \"Chrome\" and \"Safari\" in the user agent.\n        state.browserIsSafari = (userAgent.indexOf('safari') > -1 &&\n                                 !state.browserIsChrome);\n\n        // Browser can play HLS videos if either `Media Source Extensions`\n        // feature is supported or browser is safari (native HLS support)\n        state.canPlayHLS = state.HLSVideoSources.length > 0 && (HLS.isSupported() || state.browserIsSafari);\n        state.HLSOnlySources = state.config.sources.length > 0 &&\n                               state.config.sources.length === state.HLSVideoSources.length;\n\n        commonPlayerConfig = {\n            playerVars: state.videoPlayer.playerVars,\n            videoSources: state.config.sources,\n            poster: state.config.poster,\n            browserIsSafari: state.browserIsSafari,\n            events: {\n                onReady: state.videoPlayer.onReady,\n                onStateChange: state.videoPlayer.onStateChange,\n                onError: state.videoPlayer.onError\n            }\n        };\n\n        if (state.videoType === 'html5') {\n            if (state.canPlayHLS || state.HLSOnlySources) {\n                state.videoPlayer.player = new HTML5HLSVideo.Player(\n                    state.el,\n                    _.extend({}, commonPlayerConfig, {\n                        videoSources: state.HLSVideoSources,\n                        canPlayHLS: state.canPlayHLS,\n                        HLSOnlySources: state.HLSOnlySources\n                    })\n                );\n                // `loadedmetadata` event triggered too early on Safari due\n                // to which correct video dimensions were not calculated\n                eventToBeTriggered = state.browserIsSafari ? 'loadeddata' : eventToBeTriggered;\n            } else {\n                state.videoPlayer.player = new HTML5Video.Player(state.el, commonPlayerConfig);\n            }\n            player = state.videoEl = state.videoPlayer.player.videoEl;\n            player[0].addEventListener(eventToBeTriggered, state.videoPlayer.onLoadMetadataHtml5, false);\n            player.on('remove', state.videoPlayer.destroy);\n        } else {\n            youTubeId = state.youtubeId();\n\n            state.videoPlayer.player = new YT.Player(state.id, {\n                playerVars: state.videoPlayer.playerVars,\n                videoId: youTubeId,\n                events: {\n                    onReady: state.videoPlayer.onReady,\n                    onStateChange: state.videoPlayer.onStateChange,\n                    onPlaybackQualityChange: state.videoPlayer.onPlaybackQualityChange,\n                    onError: state.videoPlayer.onError\n                }\n            });\n\n            state.el.on('initialize', function() {\n                var player = state.videoEl = state.el.find('iframe'),\n                    videoWidth = player.attr('width') || player.width(),\n                    videoHeight = player.attr('height') || player.height();\n\n                player.on('remove', state.videoPlayer.destroy);\n\n                _resize(state, videoWidth, videoHeight);\n                _updateVcrAndRegion(state, true);\n            });\n        }\n\n        if (state.isTouch) {\n            dfd.resolve();\n        }\n    }\n\n    function _updateVcrAndRegion(state, isYoutube) {\n        var update = function(state) {\n            var duration = state.videoPlayer.duration(),\n                time;\n\n            time = state.videoPlayer.figureOutStartingTime(duration);\n\n            // Update the VCR.\n            state.trigger(\n                'videoControl.updateVcrVidTime',\n                {\n                    time: time,\n                    duration: duration\n                }\n            );\n\n            // Update the time slider.\n            state.trigger(\n                'videoProgressSlider.updateStartEndTimeRegion',\n                {\n                    duration: duration\n                }\n            );\n            state.trigger(\n                'videoProgressSlider.updatePlayTime',\n                {\n                    time: time,\n                    duration: duration\n                }\n            );\n        };\n\n        // After initialization, update the VCR with total time.\n        // At this point only the metadata duration is available (not\n        // very precise), but it is better than having 00:00:00 for\n        // total time.\n        if (state.youtubeMetadataReceived || !isYoutube) {\n            // Metadata was already received, and is available.\n            update(state);\n        } else {\n            // We wait for metadata to arrive, before we request the update\n            // of the VCR video time, and of the start-end time region.\n            // Metadata contains duration of the video.\n            state.el.on('metadata_received', function() {\n                update(state);\n            });\n        }\n    }\n\n    function _resize(state, videoWidth, videoHeight) {\n        state.resizer = new Resizer({\n            element: state.videoEl,\n            elementRatio: videoWidth / videoHeight,\n            container: state.container\n        })\n            .callbacks.once(function() {\n                state.el.trigger('caption:resize');\n            })\n            .setMode('width');\n\n        // Update captions size when controls becomes visible on iPad or Android\n        if (/iPad|Android/i.test(state.isTouch[0])) {\n            state.el.on('controls:show', function() {\n                state.el.trigger('caption:resize');\n            });\n        }\n\n        $(window).on('resize.video', _.debounce(function() {\n            state.trigger('videoFullScreen.updateControlsHeight', null);\n            state.el.trigger('caption:resize');\n            state.resizer.align();\n        }, 100));\n    }\n\n    // function _restartUsingFlash(state)\n    //\n    //     When we are about to play a YouTube video in HTML5 mode and discover\n    //     that we only have one available playback rate, we will switch to\n    //     Flash mode. In Flash speed switching is done by reloading videos\n    //     recorded at different frame rates.\n    function _restartUsingFlash(state) {\n        // Remove from the page current iFrame with HTML5 video.\n        state.videoPlayer.player.destroy();\n\n        state.setPlayerMode('flash');\n\n        console.log('[Video info]: Changing YouTube player mode to \"flash\".');\n\n        // Removed configuration option that requests the HTML5 mode.\n        delete state.videoPlayer.playerVars.html5;\n\n        // Request for the creation of a new Flash player\n        state.videoPlayer.player = new YT.Player(state.id, {\n            playerVars: state.videoPlayer.playerVars,\n            videoId: state.youtubeId(),\n            events: {\n                onReady: state.videoPlayer.onReady,\n                onStateChange: state.videoPlayer.onStateChange,\n                onPlaybackQualityChange: state.videoPlayer.onPlaybackQualityChange,\n                onError: state.videoPlayer.onError\n            }\n        });\n\n        _updateVcrAndRegion(state, true);\n        state.el.trigger('caption:fetch');\n        state.resizer.setElement(state.el.find('iframe')).align();\n    }\n\n    // ***************************************************************\n    // Public functions start here.\n    // These are available via the 'state' object. Their context ('this'\n    // keyword) is the 'state' object. The magic private function that makes\n    // them available and sets up their context is makeFunctionsPublic().\n    // ***************************************************************\n\n    function destroy() {\n        var player = this.videoPlayer.player;\n        this.el.removeClass([\n            'is-unstarted', 'is-playing', 'is-paused', 'is-buffered',\n            'is-ended', 'is-cued'\n        ].join(' '));\n        $(window).off('.video');\n        this.el.trigger('destroy');\n        this.el.off();\n        this.videoPlayer.stopTimer();\n        if (this.resizer && this.resizer.destroy) {\n            this.resizer.destroy();\n        }\n        if (player && player.video) {\n            player.video.removeEventListener('loadedmetadata', this.videoPlayer.onLoadMetadataHtml5, false);\n        }\n        if (player && _.isFunction(player.destroy)) {\n            player.destroy();\n        }\n        if (this.canPlayHLS && player.hls) {\n            player.hls.destroy();\n        }\n        delete this.videoPlayer;\n    }\n\n    function pause() {\n        if (this.videoPlayer.player.pauseVideo) {\n            this.videoPlayer.player.pauseVideo();\n        }\n    }\n\n    function play() {\n        if (this.videoPlayer.player.playVideo) {\n            if (this.videoPlayer.isEnded()) {\n                // When the video will start playing again from the start, the\n                // start-time and end-time will come back into effect.\n                this.videoPlayer.goToStartTime = true;\n            }\n\n            this.videoPlayer.player.playVideo();\n        }\n    }\n\n    // This function gets the video's current play position in time\n    // (currentTime) and its duration.\n    // It is called at a regular interval when the video is playing.\n    function update(time) {\n        this.videoPlayer.currentTime = time || this.videoPlayer.player.getCurrentTime();\n\n        if (isFinite(this.videoPlayer.currentTime)) {\n            this.videoPlayer.updatePlayTime(this.videoPlayer.currentTime);\n\n            // We need to pause the video if current time is smaller (or equal)\n            // than end-time. Also, we must make sure that this is only done\n            // once per video playing from start to end.\n            if (\n                this.videoPlayer.endTime !== null &&\n                this.videoPlayer.endTime <= this.videoPlayer.currentTime\n            ) {\n                this.videoPlayer.pause();\n\n                this.trigger('videoProgressSlider.notifyThroughHandleEnd', {\n                    end: true\n                });\n\n                this.el.trigger('stop');\n            }\n            this.el.trigger('timeupdate', [this.videoPlayer.currentTime]);\n        }\n    }\n\n    function setPlaybackRate(newSpeed) {\n        this.videoPlayer.player.setPlaybackRate(newSpeed);\n    }\n\n    function onSpeedChange(newSpeed) {\n        var time = this.videoPlayer.currentTime;\n\n        if (this.isFlashMode()) {\n            this.videoPlayer.currentTime = Time.convert(\n                time,\n                parseFloat(this.speed),\n                newSpeed\n            );\n        }\n\n        newSpeed = parseFloat(newSpeed).toFixed(2).replace(/\\.00$/, '.0');\n        this.setSpeed(newSpeed);\n        this.videoPlayer.setPlaybackRate(newSpeed);\n    }\n\n    function onAutoAdvanceChange(enabled) {\n        this.setAutoAdvance(enabled);\n    }\n\n    // Every 200 ms, if the video is playing, we call the function update, via\n    // clearInterval. This interval is called updateInterval.\n    // It is created on a onPlay event. Cleared on a onPause event.\n    // Reinitialized on a onSeek event.\n    function onSeek(params) {\n        var time = params.time,\n            type = params.type,\n            oldTime = this.videoPlayer.currentTime;\n        // After the user seeks, the video will start playing from\n        // the sought point, and stop playing at the end.\n        this.videoPlayer.goToStartTime = false;\n\n        this.videoPlayer.seekTo(time);\n        this.trigger('videoProgressSlider.focusSlider');\n\n        this.el.trigger('seek', [time, oldTime, type]);\n    }\n\n    function seekTo(time) {\n        var duration = this.videoPlayer.duration();\n\n        if ((typeof time !== 'number') || (time > duration) || (time < 0)) {\n            return false;\n        }\n\n        this.el.off('play.seek');\n\n        if (this.videoPlayer.isPlaying()) {\n            this.videoPlayer.stopTimer();\n        }\n        var isUnplayed = this.videoPlayer.isUnstarted() ||\n                         this.videoPlayer.isCued();\n\n        // Use `cueVideoById` method for youtube video that is not played before.\n        if (isUnplayed && this.isYoutubeType()) {\n            this.videoPlayer.player.cueVideoById(this.youtubeId(), time);\n        } else {\n            // Youtube video cannot be rewinded during bufferization, so wait to\n            // finish bufferization and then rewind the video.\n            if (this.isYoutubeType() && this.videoPlayer.isBuffering()) {\n                this.el.on('play.seek', function() {\n                    this.videoPlayer.player.seekTo(time, true);\n                }.bind(this));\n            } else {\n                // Otherwise, just seek the video\n                this.videoPlayer.player.seekTo(time, true);\n            }\n        }\n\n        this.videoPlayer.updatePlayTime(time, true);\n\n        // the timer is stopped above; restart it.\n        if (this.videoPlayer.isPlaying()) {\n            this.videoPlayer.runTimer();\n        }\n        // Update the the current time when user seek. (YoutubePlayer)\n        this.videoPlayer.currentTime = time;\n    }\n\n    function runTimer() {\n        if (!this.videoPlayer.updateInterval) {\n            this.videoPlayer.updateInterval = window.setInterval(\n                this.videoPlayer.update, 200\n            );\n\n            this.videoPlayer.update();\n        }\n    }\n\n    function stopTimer() {\n        window.clearInterval(this.videoPlayer.updateInterval);\n        delete this.videoPlayer.updateInterval;\n    }\n\n    function onEnded() {\n        var time = this.videoPlayer.duration();\n\n\n        this.trigger('videoProgressSlider.notifyThroughHandleEnd', {\n            end: true\n        });\n\n        if (this.videoPlayer.skipOnEndedStartEndReset) {\n            this.videoPlayer.skipOnEndedStartEndReset = undefined;\n        }\n        // Sometimes `onEnded` events fires when `currentTime` not equal\n        // `duration`. In this case, slider doesn't reach the end point of\n        // timeline.\n        this.videoPlayer.updatePlayTime(time);\n\n        // Emit 'pause_video' event when a video ends if Player is of Youtube\n        if (this.isYoutubeType()) {\n            this.el.trigger('pause', arguments);\n        }\n        this.el.trigger('ended', arguments);\n    }\n\n    function onPause() {\n        this.videoPlayer.stopTimer();\n        this.el.trigger('pause', arguments);\n    }\n\n    function onPlay() {\n        this.videoPlayer.runTimer();\n        this.trigger('videoProgressSlider.notifyThroughHandleEnd', {\n            end: false\n        });\n        this.videoPlayer.ready();\n        this.el.trigger('play', arguments);\n    }\n\n    function onUnstarted() { }\n\n    function handlePlaybackQualityChange(value) {\n        this.videoPlayer.player.setPlaybackQuality(value);\n    }\n\n    function onPlaybackQualityChange() {\n        var quality;\n\n        quality = this.videoPlayer.player.getPlaybackQuality();\n\n        this.trigger('videoQualityControl.onQualityChange', quality);\n        this.el.trigger('qualitychange', arguments);\n    }\n\n    function onReady() {\n        var _this = this,\n            availablePlaybackRates, baseSpeedSubs,\n            player, videoWidth, videoHeight;\n\n        dfd.resolve();\n\n        this.el.on('speedchange', function(event, speed) {\n            _this.videoPlayer.onSpeedChange(speed);\n        });\n\n        this.el.on('autoadvancechange', function(event, enabled) {\n            _this.videoPlayer.onAutoAdvanceChange(enabled);\n        });\n\n        this.el.on('volumechange volumechange:silent', function(event, volume) {\n            _this.videoPlayer.onVolumeChange(volume);\n        });\n\n        availablePlaybackRates = this.videoPlayer.player\n                                    .getAvailablePlaybackRates();\n\n        // Because of problems with muting sound outside of range 0.25 and\n        // 5.0, we should filter our available playback rates.\n        // Issues:\n        //   https://code.google.com/p/chromium/issues/detail?id=264341\n        //   https://bugzilla.mozilla.org/show_bug.cgi?id=840745\n        //   https://developer.mozilla.org/en-US/docs/DOM/HTMLMediaElement\n\n        availablePlaybackRates = _.filter(\n            availablePlaybackRates,\n            function(item) {\n                var speed = Number(item);\n                return speed > 0.25 && speed <= 5;\n            }\n        );\n\n        // Because of a recent change in the YouTube API (not documented), sometimes\n        // HTML5 mode loads after Flash mode has been loaded. In this case we have\n        // multiple speeds available but the variable `this.currentPlayerMode` is\n        // set to \"flash\". This is impossible because in Flash mode we can have\n        // only one speed available. Therefore we must execute the following code\n        // block if we have multiple speeds or if `this.currentPlayerMode` is set to\n        // \"html5\". If any of the two conditions are true, we then set the variable\n        // `this.currentPlayerMode` to \"html5\".\n        //\n        // For more information, please see the PR that introduced this change:\n        //     https://github.com/edx/edx-platform/pull/2841\n        if (\n            (this.isHtml5Mode() || availablePlaybackRates.length > 1) &&\n            this.isYoutubeType()\n        ) {\n            if (availablePlaybackRates.length === 1 && !this.isTouch) {\n                // This condition is needed in cases when Firefox version is\n                // less than 20. In those versions HTML5 playback could only\n                // happen at 1 speed (no speed changing). Therefore, in this\n                // case, we need to switch back to Flash.\n                //\n                // This might also happen in other browsers, therefore when we\n                // have 1 speed available, we fall back to Flash.\n\n                _restartUsingFlash(this);\n                return false;\n            } else if (availablePlaybackRates.length > 1) {\n                this.setPlayerMode('html5');\n\n                // We need to synchronize available frame rates with the ones\n                // that the user specified.\n\n                baseSpeedSubs = this.videos['1.0'];\n                // this.videos is a dictionary containing various frame rates\n                // and their associated subs.\n\n                // First clear the dictionary.\n                $.each(this.videos, function(index, value) {\n                    delete _this.videos[index];\n                });\n                this.speeds = [];\n                // Recreate it with the supplied frame rates.\n                $.each(availablePlaybackRates, function(index, value) {\n                    var key = value.toFixed(2).replace(/\\.00$/, '.0');\n\n                    _this.videos[key] = baseSpeedSubs;\n                    _this.speeds.push(key);\n                });\n\n                this.setSpeed(this.speed);\n                this.el.trigger('speed:render', [this.speeds, this.speed]);\n            }\n        }\n\n        if (this.isFlashMode()) {\n            this.setSpeed(this.speed);\n            this.el.trigger('speed:set', [this.speed]);\n        }\n\n        if (this.isHtml5Mode()) {\n            this.videoPlayer.player.setPlaybackRate(this.speed);\n        }\n\n\n        var duration = this.videoPlayer.duration(),\n            time = this.videoPlayer.figureOutStartingTime(duration);\n\n        // this.duration will be set initially only if duration is coming from edx-val\n        this.duration = this.duration || duration;\n\n        if (time > 0 && this.videoPlayer.goToStartTime) {\n            this.videoPlayer.seekTo(time);\n        }\n\n        this.el.trigger('ready', arguments);\n\n        if (this.config.autoplay) {\n            this.videoPlayer.play();\n        }\n    }\n\n    function onStateChange(event) {\n        this.el.removeClass([\n            'is-unstarted', 'is-playing', 'is-paused', 'is-buffered',\n            'is-ended', 'is-cued'\n        ].join(' '));\n\n        switch (event.data) {\n        case this.videoPlayer.PlayerState.UNSTARTED:\n            this.el.addClass('is-unstarted');\n            this.videoPlayer.onUnstarted();\n            break;\n        case this.videoPlayer.PlayerState.PLAYING:\n            this.el.addClass('is-playing');\n            this.videoPlayer.onPlay();\n            break;\n        case this.videoPlayer.PlayerState.PAUSED:\n            this.el.addClass('is-paused');\n            this.videoPlayer.onPause();\n            break;\n        case this.videoPlayer.PlayerState.BUFFERING:\n            this.el.addClass('is-buffered');\n            this.el.trigger('buffering');\n            break;\n        case this.videoPlayer.PlayerState.ENDED:\n            this.el.addClass('is-ended');\n            this.videoPlayer.onEnded();\n            break;\n        case this.videoPlayer.PlayerState.CUED:\n            this.el.addClass('is-cued');\n            if (this.isFlashMode()) {\n                this.videoPlayer.play();\n            }\n            break;\n        }\n    }\n\n    function onError(code) {\n        this.el.trigger('error', [code]);\n    }\n\n    function figureOutStartEndTime(duration) {\n        var videoPlayer = this.videoPlayer;\n\n        videoPlayer.startTime = this.config.startTime;\n        if (videoPlayer.startTime >= duration) {\n            videoPlayer.startTime = 0;\n        } else if (this.isFlashMode()) {\n            videoPlayer.startTime /= Number(this.speed);\n        }\n\n        videoPlayer.endTime = this.config.endTime;\n        if (\n            videoPlayer.endTime <= videoPlayer.startTime ||\n            videoPlayer.endTime >= duration\n        ) {\n            videoPlayer.endTime = null;\n        } else if (this.isFlashMode()) {\n            videoPlayer.endTime /= Number(this.speed);\n        }\n    }\n\n    function figureOutStartingTime(duration) {\n        var savedVideoPosition = this.config.savedVideoPosition,\n\n            // Default starting time is 0. This is the case when\n            // there is not start-time, no previously saved position,\n            // or one (or both) of those values is incorrect.\n            time = 0,\n\n            startTime, endTime;\n\n        this.videoPlayer.figureOutStartEndTime(duration);\n\n        startTime = this.videoPlayer.startTime;\n        endTime = this.videoPlayer.endTime;\n\n        if (startTime > 0) {\n            if (\n                startTime < savedVideoPosition &&\n                (endTime > savedVideoPosition || endTime === null) &&\n\n                // We do not want to jump to the end of the video.\n                // We subtract 1 from the duration for a 1 second\n                // safety net.\n                savedVideoPosition < duration - 1\n            ) {\n                time = savedVideoPosition;\n            } else {\n                time = startTime;\n            }\n        } else if (\n            savedVideoPosition > 0 &&\n            (endTime > savedVideoPosition || endTime === null) &&\n\n            // We do not want to jump to the end of the video.\n            // We subtract 1 from the duration for a 1 second\n            // safety net.\n            savedVideoPosition < duration - 1\n        ) {\n            time = savedVideoPosition;\n        }\n\n        return time;\n    }\n\n    function updatePlayTime(time, skip_seek) {\n        var videoPlayer = this.videoPlayer,\n            endTime = this.videoPlayer.duration(),\n            youTubeId;\n\n        if (this.config.endTime) {\n            endTime = Math.min(this.config.endTime, endTime);\n        }\n\n        this.trigger(\n            'videoProgressSlider.updatePlayTime',\n            {\n                time: time,\n                duration: endTime\n            }\n        );\n\n        this.trigger(\n            'videoControl.updateVcrVidTime',\n            {\n                time: time,\n                duration: endTime\n            }\n        );\n\n        this.el.trigger('caption:update', [time]);\n    }\n\n    function isEnded() {\n        var playerState = this.videoPlayer.player.getPlayerState(),\n            ENDED = this.videoPlayer.PlayerState.ENDED;\n\n        return playerState === ENDED;\n    }\n\n    function isPlaying() {\n        var playerState = this.videoPlayer.player.getPlayerState();\n\n        return playerState === this.videoPlayer.PlayerState.PLAYING;\n    }\n\n    function isBuffering() {\n        var playerState = this.videoPlayer.player.getPlayerState();\n\n        return playerState === this.videoPlayer.PlayerState.BUFFERING;\n    }\n\n    function isCued() {\n        var playerState = this.videoPlayer.player.getPlayerState();\n\n        return playerState === this.videoPlayer.PlayerState.CUED;\n    }\n\n    function isUnstarted() {\n        var playerState = this.videoPlayer.player.getPlayerState();\n\n        return playerState === this.videoPlayer.PlayerState.UNSTARTED;\n    }\n\n    /*\n     * Return the duration of the video in seconds.\n     *\n     * First, try to use the native player API call to get the duration.\n     * If the value returned by the native function is not valid, resort to\n     * the value stored in the metadata for the video. Note that the metadata\n     * is available only for YouTube videos.\n     *\n     * IMPORTANT! It has been observed that sometimes, after initial playback\n     * of the video, when operations \"pause\" and \"play\" are performed (in that\n     * sequence), the function will start returning a slightly different value.\n     *\n     * For example: While playing for the first time, the function returns 31.\n     * After pausing the video and then resuming once more, the function will\n     * start returning 31.950656.\n     *\n     * This instability is internal to the player API (or browser internals).\n     */\n    function duration() {\n        var dur;\n\n        // Sometimes the YouTube API doesn't finish instantiating all of it's\n        // methods, but the execution point arrives here.\n        //\n        // This happens when you have start-time and end-time set, and click \"Edit\"\n        // in Studio, and then \"Save\". The Video editor dialog closes, the\n        // video reloads, but the start-end range is not visible.\n        if (this.videoPlayer.player.getDuration) {\n            dur = this.videoPlayer.player.getDuration();\n        }\n\n        // For YouTube videos, before the video starts playing, the API\n        // function player.getDuration() will return 0. This means that the VCR\n        // will show total time as 0 when the page just loads (before the user\n        // clicks the Play button).\n        //\n        // We can do betterin a case when dur is 0 (or less than 0). We can ask\n        // the getDuration() function for total time, which will query the\n        // metadata for a duration.\n        //\n        // Be careful! Often the metadata duration is not very precise. It\n        // might differ by one or two seconds against the actual time as will\n        // be reported later on by the player.getDuration() API function.\n        if (!isFinite(dur) || dur <= 0) {\n            if (this.isYoutubeType()) {\n                dur = this.getDuration();\n            }\n        }\n\n        // Just in case the metadata is garbled, or something went wrong, we\n        // have a final check.\n        if (!isFinite(dur) || dur <= 0) {\n            dur = 0;\n        }\n\n        return Math.floor(dur);\n    }\n\n    function onVolumeChange(volume) {\n        this.videoPlayer.player.setVolume(volume);\n    }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/03_video_player.js","\n    'use strict';\n    // VideoControl module.\n    define(\n        'video/04_video_control.js',\n        ['time.js'],\n        function(Time) {\n            // VideoControl() function - what this module \"exports\".\n            return function(state) {\n                var dfd = $.Deferred();\n\n                state.videoControl = {};\n\n                _makeFunctionsPublic(state);\n                _renderElements(state);\n                _bindHandlers(state);\n\n                dfd.resolve();\n                return dfd.promise();\n            };\n\n            // ***************************************************************\n            // Private functions start here.\n            // ***************************************************************\n\n            // function _makeFunctionsPublic(state)\n            //\n            //     Functions which will be accessible via 'state' object. When called, these functions will\n            //     get the 'state' object as a context.\n            function _makeFunctionsPublic(state) {\n                var methodsDict = {\n                    destroy: destroy,\n                    hideControls: hideControls,\n                    show: show,\n                    showControls: showControls,\n                    focusFirst: focusFirst,\n                    updateVcrVidTime: updateVcrVidTime\n                };\n\n                state.bindTo(methodsDict, state.videoControl, state);\n            }\n\n            function destroy() {\n                this.el.off({\n                    mousemove: this.videoControl.showControls,\n                    keydown: this.videoControl.showControls,\n                    destroy: this.videoControl.destroy,\n                    initialize: this.videoControl.focusFirst\n                });\n\n                this.el.off('controls:show');\n                if (this.controlHideTimeout) {\n                    clearTimeout(this.controlHideTimeout);\n                }\n                delete this.videoControl;\n            }\n\n            // function _renderElements(state)\n            //\n            //     Create any necessary DOM elements, attach them, and set their initial configuration. Also\n            //     make the created DOM elements available via the 'state' object. Much easier to work this\n            //     way - you don't have to do repeated jQuery element selects.\n            function _renderElements(state) {\n                state.videoControl.el = state.el.find('.video-controls');\n                state.videoControl.vidTimeEl = state.videoControl.el.find('.vidtime');\n\n                if ((state.videoType === 'html5') && (state.config.autohideHtml5)) {\n                    state.videoControl.fadeOutTimeout = state.config.fadeOutTimeout;\n\n                    state.videoControl.el.addClass('html5');\n                    state.controlHideTimeout = setTimeout(state.videoControl.hideControls, state.videoControl.fadeOutTimeout);\n                }\n            }\n\n            // function _bindHandlers(state)\n            //\n            //     Bind any necessary function callbacks to DOM events (click, mousemove, etc.).\n            function _bindHandlers(state) {\n                if ((state.videoType === 'html5') && (state.config.autohideHtml5)) {\n                    state.el.on({\n                        mousemove: state.videoControl.showControls,\n                        keydown: state.videoControl.showControls\n                    });\n                }\n\n                if (state.config.focusFirstControl) {\n                    state.el.on('initialize', state.videoControl.focusFirst);\n                }\n                state.el.on('destroy', state.videoControl.destroy);\n            }\n\n            // ***************************************************************\n            // Public functions start here.\n            // These are available via the 'state' object. Their context ('this' keyword) is the 'state' object.\n            // The magic private function that makes them available and sets up their context is makeFunctionsPublic().\n            // ***************************************************************\n\n            function focusFirst() {\n                this.videoControl.el.find('.vcr a, .vcr button').first().focus();\n            }\n\n            function show() {\n                this.videoControl.el.removeClass('is-hidden');\n                this.el.trigger('controls:show', arguments);\n            }\n\n            function showControls(event) {\n                if (!this.controlShowLock) {\n                    if (!this.captionsHidden) {\n                        return;\n                    }\n\n                    this.controlShowLock = true;\n\n                    if (this.controlState === 'invisible') {\n                        this.videoControl.el.show();\n                        this.controlState = 'visible';\n                    } else if (this.controlState === 'hiding') {\n                        this.videoControl.el.stop(true, false).css('opacity', 1).show();\n                        this.controlState = 'visible';\n                    } else if (this.controlState === 'visible') {\n                        clearTimeout(this.controlHideTimeout);\n                    }\n\n                    this.controlHideTimeout = setTimeout(this.videoControl.hideControls, this.videoControl.fadeOutTimeout);\n                    this.controlShowLock = false;\n                }\n            }\n\n            function hideControls() {\n                var _this = this;\n\n                this.controlHideTimeout = null;\n\n                if (!this.captionsHidden) {\n                    return;\n                }\n\n                this.controlState = 'hiding';\n                this.videoControl.el.fadeOut(this.videoControl.fadeOutTimeout, function() {\n                    _this.controlState = 'invisible';\n                    // If the focus was on the video control or the volume control,\n                    // then we must make sure to close these dialogs. Otherwise, after\n                    // next autofocus, these dialogs will be open, but the focus will\n                    // not be on them.\n                    _this.videoVolumeControl.el.removeClass('open');\n                    _this.videoSpeedControl.el.removeClass('open');\n\n                    _this.focusGrabber.enableFocusGrabber();\n                });\n            }\n\n            function updateVcrVidTime(params) {\n                var endTime = (this.config.endTime !== null) ? this.config.endTime : params.duration;\n                // in case endTime is accidentally specified as being greater than the video\n                endTime = Math.min(endTime, params.duration);\n                this.videoControl.vidTimeEl.html(Time.format(params.time) + ' / ' + Time.format(endTime));\n            }\n        }\n    );\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/04_video_control.js","\n    'use strict';\n    define('video/04_video_full_screen.js', ['edx-ui-toolkit/js/utils/html-utils'], function(HtmlUtils) {\n        var template = [\n            '<button class=\"control add-fullscreen\" aria-disabled=\"false\" title=\"',\n            gettext('Fill browser'),\n            '\">',\n            '<span class=\"icon fa fa-arrows-alt\" aria-hidden=\"true\"></span>',\n            '</button>'\n        ].join('');\n\n    // VideoControl() function - what this module \"exports\".\n        return function(state) {\n            var dfd = $.Deferred();\n\n            state.videoFullScreen = {};\n\n            _makeFunctionsPublic(state);\n            _renderElements(state);\n            _bindHandlers(state);\n\n            dfd.resolve();\n            return dfd.promise();\n        };\n\n    // ***************************************************************\n    // Private functions start here.\n    // ***************************************************************\n\n    // function _makeFunctionsPublic(state)\n    //\n    //     Functions which will be accessible via 'state' object. When called, these functions will\n    //     get the 'state' object as a context.\n        function _makeFunctionsPublic(state) {\n            var methodsDict = {\n                destroy: destroy,\n                enter: enter,\n                exitHandler: exitHandler,\n                exit: exit,\n                onFullscreenChange: onFullscreenChange,\n                toggle: toggle,\n                toggleHandler: toggleHandler,\n                updateControlsHeight: updateControlsHeight\n            };\n\n            state.bindTo(methodsDict, state.videoFullScreen, state);\n        }\n\n        function destroy() {\n            $(document).off('keyup', this.videoFullScreen.exitHandler);\n            this.videoFullScreen.fullScreenEl.remove();\n            this.el.off({\n                fullscreen: this.videoFullScreen.onFullscreenChange,\n                destroy: this.videoFullScreen.destroy\n            });\n            if (this.isFullScreen) {\n                this.videoFullScreen.exit();\n            }\n            delete this.videoFullScreen;\n        }\n\n    // function _renderElements(state)\n    //\n    //     Create any necessary DOM elements, attach them, and set their initial configuration. Also\n    //     make the created DOM elements available via the 'state' object. Much easier to work this\n    //     way - you don't have to do repeated jQuery element selects.\n        function _renderElements(state) {\n            state.videoFullScreen.fullScreenEl = $(template);\n            state.videoFullScreen.sliderEl = state.el.find('.slider');\n            state.videoFullScreen.fullScreenState = false;\n            HtmlUtils.append(state.el.find('.secondary-controls'), HtmlUtils.HTML(state.videoFullScreen.fullScreenEl));\n            state.videoFullScreen.updateControlsHeight();\n        }\n\n    // function _bindHandlers(state)\n    //\n    //     Bind any necessary function callbacks to DOM events (click, mousemove, etc.).\n        function _bindHandlers(state) {\n            state.videoFullScreen.fullScreenEl.on('click', state.videoFullScreen.toggleHandler);\n            state.el.on({\n                fullscreen: state.videoFullScreen.onFullscreenChange,\n                destroy: state.videoFullScreen.destroy\n            });\n            $(document).on('keyup', state.videoFullScreen.exitHandler);\n        }\n\n        function _getControlsHeight(controls, slider) {\n            return controls.height() + 0.5 * slider.height();\n        }\n\n    // ***************************************************************\n    // Public functions start here.\n    // These are available via the 'state' object. Their context ('this' keyword) is the 'state' object.\n    // The magic private function that makes them available and sets up their context is makeFunctionsPublic().\n    // ***************************************************************\n\n        function onFullscreenChange(event, isFullScreen) {\n            var height = this.videoFullScreen.updateControlsHeight();\n\n            if (isFullScreen) {\n                this.resizer\n                .delta\n                .substract(height, 'height')\n                .setMode('both');\n            } else {\n                this.resizer\n                .delta\n                .reset()\n                .setMode('width');\n            }\n        }\n\n        function updateControlsHeight() {\n            var controls = this.el.find('.video-controls'),\n                slider = this.videoFullScreen.sliderEl;\n            this.videoFullScreen.height = _getControlsHeight(controls, slider);\n            return this.videoFullScreen.height;\n        }\n\n    /**\n     * Event handler to toggle fullscreen mode.\n     * @param {jquery Event} event\n     */\n        function toggleHandler(event) {\n            event.preventDefault();\n            this.videoCommands.execute('toggleFullScreen');\n        }\n\n        function exit() {\n            var fullScreenClassNameEl = this.el.add(document.documentElement),\n                closedCaptionsEl = this.el.find('.closed-captions');\n\n            this.videoFullScreen.fullScreenState = this.isFullScreen = false;\n            fullScreenClassNameEl.removeClass('video-fullscreen');\n            $(window).scrollTop(this.scrollPos);\n            this.videoFullScreen.fullScreenEl\n            .attr('title', gettext('Fill browser'))\n            .find('.icon')\n                .removeClass('fa-compress')\n                .addClass('fa-arrows-alt');\n\n            this.el.trigger('fullscreen', [this.isFullScreen]);\n\n            $(closedCaptionsEl).css({\n                top: '70%',\n                left: '5%'\n            });\n        }\n\n        function enter() {\n            var fullScreenClassNameEl = this.el.add(document.documentElement),\n                closedCaptionsEl = this.el.find('.closed-captions');\n\n            this.scrollPos = $(window).scrollTop();\n            $(window).scrollTop(0);\n            this.videoFullScreen.fullScreenState = this.isFullScreen = true;\n            fullScreenClassNameEl.addClass('video-fullscreen');\n            this.videoFullScreen.fullScreenEl\n            .attr('title', gettext('Exit full browser'))\n            .find('.icon')\n                .removeClass('fa-arrows-alt')\n                .addClass('fa-compress');\n\n            this.el.trigger('fullscreen', [this.isFullScreen]);\n\n            $(closedCaptionsEl).css({\n                top: '70%',\n                left: '5%'\n            });\n        }\n\n    /** Toggle fullscreen mode. */\n        function toggle() {\n            if (this.videoFullScreen.fullScreenState) {\n                this.videoFullScreen.exit();\n            } else {\n                this.videoFullScreen.enter();\n            }\n        }\n\n    /**\n     * Event handler to exit from fullscreen mode.\n     * @param {jquery Event} event\n     */\n        function exitHandler(event) {\n            if ((this.isFullScreen) && (event.keyCode === 27)) {\n                event.preventDefault();\n                this.videoCommands.execute('toggleFullScreen');\n            }\n        }\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/04_video_full_screen.js","\n// VideoQualityControl module.\n    'use strict';\n    define(\n'video/05_video_quality_control.js',\n['edx-ui-toolkit/js/utils/html-utils'],\nfunction(HtmlUtils) {\n    var template = HtmlUtils.interpolateHtml(\n        HtmlUtils.HTML([\n            '<button class=\"control quality-control is-hidden\" aria-disabled=\"false\" title=\"',\n            '{highDefinition}',\n            '\">',\n            '<span class=\"icon icon-hd\" aria-hidden=\"true\">HD</span>',\n            '<span class=\"sr text-translation\">',\n            '{highDefinition}',\n            '</span>&nbsp;',\n            '<span class=\"sr control-text\">',\n            '{off}',\n            '</span>',\n            '</button>'\n        ].join('')),\n        {\n            highDefinition: gettext('High Definition'),\n            off: gettext('off')\n        }\n    );\n\n    // VideoQualityControl() function - what this module \"exports\".\n    return function(state) {\n        var dfd = $.Deferred();\n\n        // Changing quality for now only works for YouTube videos.\n        if (state.videoType !== 'youtube') {\n            return;\n        }\n\n        state.videoQualityControl = {};\n\n        _makeFunctionsPublic(state);\n        _renderElements(state);\n        _bindHandlers(state);\n\n        dfd.resolve();\n        return dfd.promise();\n    };\n\n    // ***************************************************************\n    // Private functions start here.\n    // ***************************************************************\n\n    // function _makeFunctionsPublic(state)\n    //\n    //     Functions which will be accessible via 'state' object. When called, these functions will\n    //     get the 'state' object as a context.\n    function _makeFunctionsPublic(state) {\n        var methodsDict = {\n            destroy: destroy,\n            fetchAvailableQualities: fetchAvailableQualities,\n            onQualityChange: onQualityChange,\n            showQualityControl: showQualityControl,\n            toggleQuality: toggleQuality\n        };\n\n        state.bindTo(methodsDict, state.videoQualityControl, state);\n    }\n\n    function destroy() {\n        this.videoQualityControl.el.off({\n            click: this.videoQualityControl.toggleQuality,\n            destroy: this.videoQualityControl.destroy\n        });\n        this.el.off('.quality');\n        this.videoQualityControl.el.remove();\n        delete this.videoQualityControl;\n    }\n\n    // function _renderElements(state)\n    //\n    //     Create any necessary DOM elements, attach them, and set their initial configuration. Also\n    //     make the created DOM elements available via the 'state' object. Much easier to work this\n    //     way - you don't have to do repeated jQuery element selects.\n    function _renderElements(state) {\n        var element = state.videoQualityControl.el = $(template.toString());\n        state.videoQualityControl.quality = 'large';\n        HtmlUtils.append(state.el.find('.secondary-controls'), HtmlUtils.HTML(element));\n    }\n\n    // function _bindHandlers(state)\n    //\n    //     Bind any necessary function callbacks to DOM events (click, mousemove, etc.).\n    function _bindHandlers(state) {\n        state.videoQualityControl.el.on('click',\n            state.videoQualityControl.toggleQuality\n        );\n        state.el.on('play.quality', _.once(\n            state.videoQualityControl.fetchAvailableQualities\n        ));\n\n        state.el.on('destroy.quality', state.videoQualityControl.destroy);\n    }\n\n    // ***************************************************************\n    // Public functions start here.\n    // These are available via the 'state' object. Their context ('this' keyword) is the 'state' object.\n    // The magic private function that makes them available and sets up their context is makeFunctionsPublic().\n    // ***************************************************************\n\n    /*\n     * @desc Shows quality control. This function will only be called if HD\n     *       qualities are available.\n     *\n     * @public\n     */\n    function showQualityControl() {\n        this.videoQualityControl.el.removeClass('is-hidden');\n    }\n\n    // This function can only be called once as _.once has been used.\n    /*\n     * @desc Get the available qualities from YouTube API. Possible values are:\n             ['highres', 'hd1080', 'hd720', 'large', 'medium', 'small'].\n             HD are: ['highres', 'hd1080', 'hd720'].\n     *\n     * @public\n     */\n    function fetchAvailableQualities() {\n        var qualities = this.videoPlayer.player.getAvailableQualityLevels();\n\n        this.config.availableHDQualities = _.intersection(\n            qualities, ['highres', 'hd1080', 'hd720']\n        );\n\n        // HD qualities are available, show video quality control.\n        if (this.config.availableHDQualities.length > 0) {\n            this.trigger('videoQualityControl.showQualityControl');\n            this.trigger('videoQualityControl.onQualityChange', this.videoQualityControl.quality);\n        }\n        // On initialization, force the video quality to be 'large' instead of\n        // 'default'. Otherwise, the player will sometimes switch to HD\n        // automatically, for example when the iframe resizes itself.\n        this.trigger('videoPlayer.handlePlaybackQualityChange',\n            this.videoQualityControl.quality\n        );\n    }\n\n    function onQualityChange(value) {\n        var controlStateStr;\n        this.videoQualityControl.quality = value;\n        if (_.contains(this.config.availableHDQualities, value)) {\n            controlStateStr = gettext('on');\n            this.videoQualityControl.el\n                                    .addClass('active')\n                                    .find('.control-text')\n                                        .text(controlStateStr);\n        } else {\n            controlStateStr = gettext('off');\n            this.videoQualityControl.el\n                                    .removeClass('active')\n                                    .find('.control-text')\n                                        .text(controlStateStr);\n        }\n    }\n\n    // This function toggles the quality of video only if HD qualities are\n    // available.\n    function toggleQuality(event) {\n        var newQuality,\n            value = this.videoQualityControl.quality,\n            isHD = _.contains(this.config.availableHDQualities, value);\n\n        event.preventDefault();\n\n        newQuality = isHD ? 'large' : 'highres';\n\n        this.trigger('videoPlayer.handlePlaybackQualityChange', newQuality);\n    }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/05_video_quality_control.js","\n/*\n\"This is as true in everyday life as it is in battle: we are given one life\nand the decision is ours whether to wait for circumstances to make up our\nmind, or whether to act, and in acting, to live.\"\n— Omar N. Bradley\n */\n\n// VideoProgressSlider module.\n    define(\n'video/06_video_progress_slider.js',\n[],\nfunction() {\n    var template = [\n        '<div class=\"slider\" role=\"application\" title=\"',\n        gettext('Video position. Press space to toggle playback'),\n        '\"></div>'\n    ].join('');\n\n    // VideoProgressSlider() function - what this module \"exports\".\n    return function(state) {\n        var dfd = $.Deferred();\n\n        state.videoProgressSlider = {};\n        _makeFunctionsPublic(state);\n        _renderElements(state);\n\n        dfd.resolve();\n        return dfd.promise();\n    };\n\n    // ***************************************************************\n    // Private functions start here.\n    // ***************************************************************\n\n    // function _makeFunctionsPublic(state)\n    //\n    //     Functions which will be accessible via 'state' object. When called,\n    //     these functions will get the 'state' object as a context.\n\n    /* eslint-disable no-use-before-define */\n    function _makeFunctionsPublic(state) {\n        var methodsDict = {\n            destroy: destroy,\n            buildSlider: buildSlider,\n            getRangeParams: getRangeParams,\n            onSlide: onSlide,\n            onStop: onStop,\n            updatePlayTime: updatePlayTime,\n            updateStartEndTimeRegion: updateStartEndTimeRegion,\n            notifyThroughHandleEnd: notifyThroughHandleEnd,\n            getTimeDescription: getTimeDescription,\n            focusSlider: focusSlider\n        };\n\n        state.bindTo(methodsDict, state.videoProgressSlider, state);\n    }\n\n    function destroy() {\n        this.videoProgressSlider.el.removeAttr('tabindex').slider('destroy');\n        this.el.off('destroy', this.videoProgressSlider.destroy);\n        delete this.videoProgressSlider;\n    }\n\n    function bindHandlers(state) {\n        state.videoProgressSlider.el.on('keypress', sliderToggle.bind(state));\n        state.el.on('destroy', state.videoProgressSlider.destroy);\n    }\n    /* eslint-enable no-use-before-define */\n\n    // function _renderElements(state)\n    //\n    //     Create any necessary DOM elements, attach them, and set their\n    //     initial configuration. Also make the created DOM elements available\n    //     via the 'state' object. Much easier to work this way - you don't\n    //     have to do repeated jQuery element selects.\n    function _renderElements(state) {\n        state.videoProgressSlider.el = $(template);\n\n        state.el.find('.video-controls').prepend(state.videoProgressSlider.el);\n        state.videoProgressSlider.buildSlider();\n        _buildHandle(state);\n        bindHandlers(state);\n    }\n\n    function _buildHandle(state) {\n        state.videoProgressSlider.handle = state.videoProgressSlider.el\n            .find('.ui-slider-handle');\n\n        // ARIA\n        // We just want the knob to be selectable with keyboard\n        state.videoProgressSlider.el.attr({\n            tabindex: -1\n        });\n\n        // Let screen readers know that this div, representing the slider\n        // handle, behaves as a slider named 'video position'.\n        state.videoProgressSlider.handle.attr({\n            role: 'slider',\n            'aria-disabled': false,\n            'aria-valuetext': getTimeDescription(state.videoProgressSlider\n                .slider.slider('option', 'value')),\n            'aria-valuemax': state.videoPlayer.duration(),\n            'aria-valuemin': '0',\n            'aria-valuenow': state.videoPlayer.currentTime,\n            tabindex: '0',\n            'aria-label': gettext('Video position. Press space to toggle playback')\n        });\n    }\n\n    // ***************************************************************\n    // Public functions start here.\n    // These are available via the 'state' object. Their context ('this'\n    // keyword) is the 'state' object. The magic private function that makes\n    // them available and sets up their context is makeFunctionsPublic().\n    // ***************************************************************\n\n    function buildSlider() {\n        var sliderContents = edx.HtmlUtils.joinHtml(\n            edx.HtmlUtils.HTML('<div class=\"ui-slider-handle progress-handle\"></div>')\n        );\n\n        this.videoProgressSlider.el.append(sliderContents.text);\n\n        this.videoProgressSlider.slider = this.videoProgressSlider.el\n            .slider({\n                range: 'min',\n                min: this.config.startTime,\n                max: this.config.endTime,\n                slide: this.videoProgressSlider.onSlide,\n                stop: this.videoProgressSlider.onStop\n            });\n\n        this.videoProgressSlider.sliderProgress = this.videoProgressSlider\n            .slider\n            .find('.ui-slider-range.ui-widget-header.ui-slider-range-min');\n    }\n\n    // Rebuild the slider start-end range (if it doesn't take up the\n    // whole slider). Remember that endTime === null means the end-time\n    // is set to the end of video by default.\n    function updateStartEndTimeRegion(params) {\n        var start, end, duration, rangeParams;\n\n        // We must have a duration in order to determine the area of range.\n        // It also must be non-zero.\n        if (!params.duration) {\n            return;\n        } else {\n            duration = params.duration;\n        }\n\n        start = this.config.startTime;\n        end = this.config.endTime;\n\n        if (start > duration) {\n            start = 0;\n        } else if (this.isFlashMode()) {\n            start /= Number(this.speed);\n        }\n\n        // If end is set to null, or it is greater than the duration of the\n        // video, then we set it to the end of the video.\n        if (end === null || end > duration) {\n            end = duration;\n        } else if (this.isFlashMode()) {\n            end /= Number(this.speed);\n        }\n\n        // Don't build a range if it takes up the whole slider.\n        if (start === 0 && end === duration) {\n            return;\n        }\n\n        // Because JavaScript has weird rounding rules when a series of\n        // mathematical operations are performed in a single statement, we will\n        // split everything up into smaller statements.\n        //\n        // This will ensure that visually, the start-end range aligns nicely\n        // with actual starting and ending point of the video.\n\n        rangeParams = getRangeParams(start, end, duration);\n    }\n\n    function getRangeParams(startTime, endTime, duration) {\n        var step = 100 / duration,\n            left = startTime * step,\n            width = endTime * step - left;\n\n        return {\n            left: left + '%',\n            width: width + '%'\n        };\n    }\n\n    function onSlide(event, ui) {\n        var time = ui.value,\n            endTime = this.videoPlayer.duration();\n\n        if (this.config.endTime) {\n            endTime = Math.min(this.config.endTime, endTime);\n        }\n\n        this.videoProgressSlider.frozen = true;\n\n        // Remember the seek to value so that we don't repeat ourselves on the\n        // 'stop' slider event.\n        this.videoProgressSlider.lastSeekValue = time;\n\n        this.trigger(\n            'videoControl.updateVcrVidTime',\n            {\n                time: time,\n                duration: endTime\n            }\n        );\n\n        this.trigger(\n            'videoPlayer.onSlideSeek',\n            {type: 'onSlideSeek', time: time}\n        );\n\n        // ARIA\n        this.videoProgressSlider.handle.attr(\n            'aria-valuetext', getTimeDescription(this.videoPlayer.currentTime)\n        );\n    }\n\n    function onStop(event, ui) {\n        var _this = this;\n\n        this.videoProgressSlider.frozen = true;\n\n        // Only perform a seek if we haven't made a seek for the new slider value.\n        // This is necessary so that if the user only clicks on the slider, without\n        // dragging it, then only one seek is made, even when a 'slide' and a 'stop'\n        // events are triggered on the slider.\n        if (this.videoProgressSlider.lastSeekValue !== ui.value) {\n            this.trigger(\n                'videoPlayer.onSlideSeek',\n                {type: 'onSlideSeek', time: ui.value}\n            );\n        }\n\n        // ARIA\n        this.videoProgressSlider.handle.attr(\n            'aria-valuetext', getTimeDescription(this.videoPlayer.currentTime)\n        );\n\n        setTimeout(function() {\n            _this.videoProgressSlider.frozen = false;\n        }, 200);\n    }\n\n    function updatePlayTime(params) {\n        var time = Math.floor(params.time);\n        // params.duration could accidentally be construed as a floating\n        // point double. Since we're displaying this number, round down\n        // to nearest second\n        var endTime = Math.floor(params.duration);\n\n        if (this.config.endTime !== null) {\n            endTime = Math.min(this.config.endTime, endTime);\n        }\n\n        if (\n            this.videoProgressSlider.slider &&\n            !this.videoProgressSlider.frozen\n        ) {\n            this.videoProgressSlider.slider\n                .slider('option', 'max', endTime)\n                .slider('option', 'value', time);\n        }\n\n        // Update aria values.\n        this.videoProgressSlider.handle.attr({\n            'aria-valuemax': endTime,\n            'aria-valuenow': time\n        });\n    }\n\n    // When the video stops playing (either because the end was reached, or\n    // because endTime was reached), the screen reader must be notified that\n    // the video is no longer playing. We do this by a little trick. Setting\n    // the title attribute of the slider know to \"video ended\", and focusing\n    // on it. The screen reader will read the attr text.\n    //\n    // The user can then tab his way forward, landing on the next control\n    // element, the Play button.\n    //\n    // @param params  -  object with property `end`. If set to true, the\n    //                   function must set the title attribute to\n    //                   `video ended`;\n    //                   if set to false, the function must reset the attr to\n    //                   it's original state.\n    //\n    // This function will be triggered from VideoPlayer methods onEnded(),\n    // onPlay(), and update() (update method handles endTime).\n    function notifyThroughHandleEnd(params) {\n        if (params.end) {\n            this.videoProgressSlider.handle\n                .attr('title', gettext('Video ended'))\n                .focus();\n        } else {\n            this.videoProgressSlider.handle\n                .attr('title', gettext('Video position'));\n        }\n    }\n\n    // Returns a string describing the current time of video in\n    // `%d hours %d minutes %d seconds` format.\n    function getTimeDescription(time) {\n        var seconds = Math.floor(time),\n            minutes = Math.floor(seconds / 60),\n            hours = Math.floor(minutes / 60),\n            i18n = function(value, word) {\n                var msg;\n\n                switch (word) {\n                case 'hour':\n                    msg = ngettext('%(value)s hour', '%(value)s hours', value);\n                    break;\n                case 'minute':\n                    msg = ngettext('%(value)s minute', '%(value)s minutes', value);\n                    break;\n                case 'second':\n                    msg = ngettext('%(value)s second', '%(value)s seconds', value);\n                    break;\n                }\n                return interpolate(msg, {value: value}, true);\n            };\n\n        seconds = seconds % 60;\n        minutes = minutes % 60;\n\n        if (hours) {\n            return i18n(hours, 'hour') + ' ' +\n                    i18n(minutes, 'minute') + ' ' +\n                    i18n(seconds, 'second');\n        } else if (minutes) {\n            return i18n(minutes, 'minute') + ' ' +\n                    i18n(seconds, 'second');\n        }\n\n        return i18n(seconds, 'second');\n    }\n\n    // Shift focus to the progress slider container element.\n    function focusSlider() {\n        this.videoProgressSlider.handle.attr(\n            'aria-valuetext', getTimeDescription(this.videoPlayer.currentTime)\n        );\n        this.videoProgressSlider.el.trigger('focus');\n    }\n\n    // Toggle video playback when the spacebar is pushed.\n    function sliderToggle(e) {\n        if (e.which === 32) {\n            e.preventDefault();\n            this.videoCommands.execute('togglePlayback');\n        }\n    }\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/06_video_progress_slider.js","\n    'use strict';\n// VideoVolumeControl module.\n    define(\n'video/07_video_volume_control.js', ['edx-ui-toolkit/js/utils/html-utils'],\nfunction(HtmlUtils) {\n    /**\n     * Video volume control module.\n     * @exports video/07_video_volume_control.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @return {jquery Promise}\n     */\n    var VolumeControl = function(state, i18n) {\n        if (!(this instanceof VolumeControl)) {\n            return new VolumeControl(state, i18n);\n        }\n\n        _.bindAll(this, 'keyDownHandler', 'updateVolumeSilently',\n            'onVolumeChangeHandler', 'openMenu', 'closeMenu',\n            'toggleMuteHandler', 'keyDownButtonHandler', 'destroy'\n        );\n        this.state = state;\n        this.state.videoVolumeControl = this;\n        this.i18n = i18n;\n        this.initialize();\n\n        return $.Deferred().resolve().promise();\n    };\n\n    VolumeControl.prototype = {\n        /** Minimum value for the volume slider. */\n        min: 0,\n        /** Maximum value for the volume slider. */\n        max: 100,\n        /** Step to increase/decrease volume level via keyboard. */\n        step: 20,\n\n        videoVolumeControlHtml: HtmlUtils.interpolateHtml(\n            HtmlUtils.HTML([\n                '<div class=\"volume\" role=\"application\">',\n                '<p class=\"sr instructions\">',\n                '{volumeInstructions}',\n                '</p>',\n                '<button class=\"control\" aria-disabled=\"false\"',\n                '\" aria-expanded=\"false\" title=\"',\n                '{adjustVideoVolume}',\n                '\">',\n                '<span class=\"icon fa fa-volume-up\" aria-hidden=\"true\"></span>',\n                '</button>',\n                '<div class=\"volume-slider-container\" aria-hidden=\"true\" title=\"',\n                '{adjustVideoVolume}',\n                '\">',\n                '<div class=\"volume-slider\" ',\n                'role=\"slider\"',\n                'aria-orientation=\"vertical\" ',\n                'aria-valuemin=\"0\" ',\n                'aria-valuemax=\"100\" ',\n                'aria-valuenow=\"\" ',\n                'aria-label=\"',\n                '{volumeText}',\n                '\"></div>',\n                '</div>',\n                '</div>'].join('')),\n            {\n                volumeInstructions: gettext('Click on this button to mute or unmute this video or press UP or DOWN buttons to increase or decrease volume level.'),  // eslint-disable-line max-len\n                adjustVideoVolume: gettext('Adjust video volume'),\n                volumeText: gettext('Volume')\n            }\n        ),\n\n        destroy: function() {\n            this.volumeSlider.slider('destroy');\n            this.state.el.find('iframe').removeAttr('tabindex');\n            this.a11y.destroy();\n            this.cookie = this.a11y = null;\n            this.closeMenu();\n\n            this.state.el\n                .off('play.volume')\n                .off({\n                    keydown: this.keyDownHandler,\n                    volumechange: this.onVolumeChangeHandler\n                });\n            this.el.off({\n                mouseenter: this.openMenu,\n                mouseleave: this.closeMenu\n            });\n            this.button.off({\n                mousedown: this.toggleMuteHandler,\n                keydown: this.keyDownButtonHandler,\n                focus: this.openMenu,\n                blur: this.closeMenu\n            });\n            this.el.remove();\n            delete this.state.videoVolumeControl;\n        },\n\n        /** Initializes the module. */\n        initialize: function() {\n            var volume;\n\n            if (this.state.isTouch) {\n                // iOS doesn't support volume change\n                return false;\n            }\n\n            this.el = $(this.videoVolumeControlHtml.toString());\n            // Youtube iframe react on key buttons and has his own handlers.\n            // So, we disallow focusing on iframe.\n            this.state.el.find('iframe').attr('tabindex', -1);\n            this.button = this.el.children('.control');\n            this.cookie = new CookieManager(this.min, this.max);\n            this.a11y = new Accessibility(\n                this.button, this.min, this.max, this.i18n\n            );\n            volume = this.cookie.getVolume();\n            this.storedVolume = this.max;\n\n            this.render();\n            this.bindHandlers();\n            this.setVolume(volume, true, false);\n            this.checkMuteButtonStatus(volume);\n        },\n\n        /**\n         * Creates any necessary DOM elements, attach them, and set their,\n         * initial configuration.\n         */\n        render: function() {\n            var container = this.el.find('.volume-slider'),\n                instructionsId = 'volume-instructions-' + this.state.id;\n\n            HtmlUtils.append(container, HtmlUtils.HTML('<div class=\"ui-slider-handle volume-handle\"></div>'));\n\n            this.volumeSlider = container.slider({\n                orientation: 'vertical',\n                range: 'min',\n                min: this.min,\n                max: this.max,\n                slide: this.onSlideHandler.bind(this)\n            });\n\n            // We provide an independent behavior to adjust volume level.\n            // Therefore, we do not need redundant focusing on slider in TAB\n            // order.\n            container.find('.volume-handle').attr('tabindex', -1);\n            this.state.el.find('.secondary-controls').append(this.el);\n\n            // set dynamic id for instruction element to avoid collisions\n            this.el.find('.instructions').attr('id', instructionsId);\n            this.button.attr('aria-describedby', instructionsId);\n        },\n\n        /** Bind any necessary function callbacks to DOM events. */\n        bindHandlers: function() {\n            this.state.el.on({\n                'play.volume': _.once(this.updateVolumeSilently),\n                volumechange: this.onVolumeChangeHandler\n            });\n            this.state.el.find('.volume').on({\n                mouseenter: this.openMenu,\n                mouseleave: this.closeMenu\n            });\n            this.button.on({\n                keydown: this.keyDownHandler,\n                click: false,\n                mousedown: this.toggleMuteHandler,\n                focus: this.openMenu,\n                blur: this.closeMenu\n            });\n            this.state.el.on('destroy', this.destroy);\n        },\n\n        /**\n         * Updates volume level without updating view and triggering\n         * `volumechange` event.\n         */\n        updateVolumeSilently: function() {\n            this.state.el.trigger(\n                'volumechange:silent', [this.getVolume()]\n            );\n        },\n\n        /**\n         * Returns current volume level.\n         * @return {Number}\n         */\n        getVolume: function() {\n            return this.volume;\n        },\n\n        /**\n         * Sets current volume level.\n         * @param {Number} volume Suggested volume level\n         * @param {Boolean} [silent] Sets the new volume level without\n         * triggering `volumechange` event and updating the cookie.\n         * @param {Boolean} [withoutSlider] Disables updating the slider.\n         */\n        setVolume: function(volume, silent, withoutSlider) {\n            if (volume === this.getVolume()) {\n                return false;\n            }\n\n            this.volume = volume;\n            this.a11y.update(this.getVolume());\n\n            if (!withoutSlider) {\n                this.updateSliderView(this.getVolume());\n            }\n\n            if (!silent) {\n                this.cookie.setVolume(this.getVolume());\n                this.state.el.trigger('volumechange', [this.getVolume()]);\n            }\n        },\n\n        /** Increases current volume level using previously defined step. */\n        increaseVolume: function() {\n            var volume = Math.min(this.getVolume() + this.step, this.max);\n\n            this.setVolume(volume, false, false);\n            this.el.find('.volume-slider')\n                .attr('aria-valuenow', volume);\n        },\n\n        /** Decreases current volume level using previously defined step. */\n        decreaseVolume: function() {\n            var volume = Math.max(this.getVolume() - this.step, this.min);\n\n            this.setVolume(volume, false, false);\n            this.el.find('.volume-slider')\n                .attr('aria-valuenow', volume);\n        },\n\n        /** Updates volume slider view. */\n        updateSliderView: function(volume) {\n            this.volumeSlider.slider('value', volume);\n            this.el.find('.volume-slider')\n                .attr('aria-valuenow', volume);\n        },\n\n        /**\n         * Mutes or unmutes volume.\n         * @param {Number} muteStatus Flag to mute/unmute volume.\n         */\n        mute: function(muteStatus) {\n            var volume;\n\n            this.updateMuteButtonView(muteStatus);\n\n            if (muteStatus) {\n                this.storedVolume = this.getVolume() || this.max;\n            }\n\n            volume = muteStatus ? 0 : this.storedVolume;\n            this.setVolume(volume, false, false);\n            this.el.find('.volume-slider')\n                .attr('aria-valuenow', volume);\n        },\n\n        /**\n         * Returns current volume state (is it muted or not?).\n         * @return {Boolean}\n         */\n        getMuteStatus: function() {\n            return this.getVolume() === 0;\n        },\n\n        /**\n         * Updates the volume button view.\n         * @param {Boolean} isMuted Flag to use muted or unmuted view.\n         */\n        updateMuteButtonView: function(isMuted) {\n            var action = isMuted ? 'addClass' : 'removeClass';\n\n            this.el[action]('is-muted');\n\n            if (isMuted) {\n                this.el\n                    .find('.control .icon')\n                        .removeClass('fa-volume-up')\n                        .addClass('fa-volume-off');\n            } else {\n                this.el\n                    .find('.control .icon')\n                        .removeClass('fa-volume-off')\n                        .addClass('fa-volume-up');\n            }\n        },\n\n        /** Toggles the state of the volume button. */\n        toggleMute: function() {\n            this.mute(!this.getMuteStatus());\n        },\n\n        /**\n         * Checks and updates the state of the volume button relatively to\n         * volume level.\n         * @param {Number} volume Volume level.\n         */\n        checkMuteButtonStatus: function(volume) {\n            if (volume <= this.min) {\n                this.updateMuteButtonView(true);\n                this.state.el.off('volumechange.is-muted');\n                this.state.el.on('volumechange.is-muted', _.once(function() {\n                    this.updateMuteButtonView(false);\n                }.bind(this)));\n            }\n        },\n\n        /** Opens volume menu. */\n        openMenu: function() {\n            this.el.addClass('is-opened');\n            this.button.attr('aria-expanded', 'true');\n        },\n\n        /** Closes speed menu. */\n        closeMenu: function() {\n            this.el.removeClass('is-opened');\n            this.button.attr('aria-expanded', 'false');\n        },\n\n        /**\n         * Keydown event handler for the video container.\n         * @param {jquery Event} event\n         */\n        keyDownHandler: function(event) {\n            // ALT key is used to change (alternate) the function of\n            // other pressed keys. In this case, do nothing.\n            if (event.altKey) {\n                return true;\n            }\n\n            if ($(event.target).hasClass('ui-slider-handle')) {\n                return true;\n            }\n\n            var KEY = $.ui.keyCode,\n                keyCode = event.keyCode;\n\n            switch (keyCode) {\n            case KEY.UP:\n                    // Shift + Arrows keyboard shortcut might be used by\n                    // screen readers. In this case, do nothing.\n                if (event.shiftKey) {\n                    return true;\n                }\n\n                this.increaseVolume();\n                return false;\n            case KEY.DOWN:\n                    // Shift + Arrows keyboard shortcut might be used by\n                    // screen readers. In this case, do nothing.\n                if (event.shiftKey) {\n                    return true;\n                }\n\n                this.decreaseVolume();\n                return false;\n\n            case KEY.SPACE:\n            case KEY.ENTER:\n                    // Shift + Enter keyboard shortcut might be used by\n                    // screen readers. In this case, do nothing.\n                if (event.shiftKey) {\n                    return true;\n                }\n\n                this.toggleMute();\n                return false;\n            }\n\n            return true;\n        },\n\n        /**\n         * Keydown event handler for the volume button.\n         * @param {jquery Event} event\n         */\n        keyDownButtonHandler: function(event) {\n            // ALT key is used to change (alternate) the function of\n            // other pressed keys. In this case, do nothing.\n            if (event.altKey) {\n                return true;\n            }\n\n            var KEY = $.ui.keyCode,\n                keyCode = event.keyCode;\n\n            switch (keyCode) {\n            case KEY.ENTER:\n            case KEY.SPACE:\n                this.toggleMute();\n                return false;\n            }\n\n            return true;\n        },\n\n        /**\n         * onSlide callback for the video slider.\n         * @param {jquery Event} event\n         * @param {jqueryuiSlider ui} ui\n         */\n        onSlideHandler: function(event, ui) {\n            this.setVolume(ui.value, false, true);\n            this.el.find('.volume-slider')\n                .attr('aria-valuenow', ui.volume);\n        },\n\n        /**\n         * Mousedown event handler for the volume button.\n         * @param {jquery Event} event\n         */\n        toggleMuteHandler: function(event) {\n            this.toggleMute();\n            event.preventDefault();\n        },\n\n        /**\n         * Volumechange event handler.\n         * @param {jquery Event} event\n         * @param {Number} volume Volume level.\n         */\n        onVolumeChangeHandler: function(event, volume) {\n            this.checkMuteButtonStatus(volume);\n        }\n    };\n\n    /**\n     * Module responsible for the accessibility of volume controls.\n     * @constructor\n     * @private\n     * @param {jquery $} button The volume button.\n     * @param {Number} min Minimum value for the volume slider.\n     * @param {Number} max Maximum value for the volume slider.\n     * @param {Object} i18n The object containing strings with translations.\n     */\n    var Accessibility = function(button, min, max, i18n) {\n        this.min = min;\n        this.max = max;\n        this.button = button;\n        this.i18n = i18n;\n\n        this.initialize();\n    };\n\n    Accessibility.prototype = {\n        destroy: function() {\n            this.liveRegion.remove();\n        },\n\n        /** Initializes the module. */\n        initialize: function() {\n            this.liveRegion = $('<div />', {\n                class: 'sr video-live-region',\n                'aria-hidden': 'false',\n                'aria-live': 'polite'\n            });\n\n            this.button.after(HtmlUtils.HTML(this.liveRegion).toString());\n        },\n\n        /**\n         * Updates text of the live region.\n         * @param {Number} volume Volume level.\n         */\n        update: function(volume) {\n            this.liveRegion.text([\n                this.getVolumeDescription(volume),\n                this.i18n.Volume + '.'\n            ].join(' '));\n\n            $(this.button).parent().find('.volume-slider')\n                .attr('aria-valuenow', volume);\n        },\n\n        /**\n         * Returns a string describing the level of volume.\n         * @param {Number} volume Volume level.\n         */\n        getVolumeDescription: function(volume) {\n            if (volume === 0) {\n                return this.i18n.Muted;\n            } else if (volume <= 20) {\n                return this.i18n['Very low'];\n            } else if (volume <= 40) {\n                return this.i18n.Low;\n            } else if (volume <= 60) {\n                return this.i18n.Average;\n            } else if (volume <= 80) {\n                return this.i18n.Loud;\n            } else if (volume <= 99) {\n                return this.i18n['Very loud'];\n            }\n\n            return this.i18n.Maximum;\n        }\n    };\n\n    /**\n     * Module responsible for the work with volume cookie.\n     * @constructor\n     * @private\n     * @param {Number} min Minimum value for the volume slider.\n     * @param {Number} max Maximum value for the volume slider.\n     */\n    var CookieManager = function(min, max) {\n        this.min = min;\n        this.max = max;\n        this.cookieName = 'video_player_volume_level';\n    };\n\n    CookieManager.prototype = {\n        /**\n         * Returns volume level from the cookie.\n         * @return {Number} Volume level.\n         */\n        getVolume: function() {\n            var volume = parseInt($.cookie(this.cookieName), 10);\n\n            if (_.isFinite(volume)) {\n                volume = Math.max(volume, this.min);\n                volume = Math.min(volume, this.max);\n            } else {\n                volume = this.max;\n            }\n\n            return volume;\n        },\n\n        /**\n         * Updates volume cookie.\n         * @param {Number} volume Volume level.\n         */\n        setVolume: function(value) {\n            $.cookie(this.cookieName, value, {\n                expires: 3650,\n                path: '/'\n            });\n        }\n    };\n\n    return VolumeControl;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/07_video_volume_control.js","\n    'use strict';\n    define(\n        'video/08_video_auto_advance_control.js', [\n            'edx-ui-toolkit/js/utils/html-utils',\n            'underscore'\n        ], function(HtmlUtils, _) {\n            /**\n             * Auto advance control module.\n             * @exports video/08_video_auto_advance_control.js\n             * @constructor\n             * @param {object} state The object containing the state of the video player.\n             * @return {jquery Promise}\n             */\n            var AutoAdvanceControl = function(state) {\n                if (!(this instanceof AutoAdvanceControl)) {\n                    return new AutoAdvanceControl(state);\n                }\n\n                _.bindAll(this, 'onClick', 'destroy', 'autoPlay', 'autoAdvance');\n                this.state = state;\n                this.state.videoAutoAdvanceControl = this;\n                this.initialize();\n\n                return $.Deferred().resolve().promise();\n            };\n\n            AutoAdvanceControl.prototype = {\n                template: HtmlUtils.interpolateHtml(\n                    HtmlUtils.HTML([\n                        '<button class=\"control auto-advance\" aria-disabled=\"false\" title=\"',\n                        '{autoAdvanceText}',\n                        '\">',\n                        '<span class=\"label\" aria-hidden=\"true\">',\n                        '{autoAdvanceText}',\n                        '</span>',\n                        '</button>'].join('')),\n                    {\n                        autoAdvanceText: gettext('Auto-advance')\n                    }\n                ).toString(),\n\n                destroy: function() {\n                    this.el.off({\n                        click: this.onClick\n                    });\n                    this.el.remove();\n                    this.state.el.off({\n                        ready: this.autoPlay,\n                        ended: this.autoAdvance,\n                        destroy: this.destroy\n                    });\n                    delete this.state.videoAutoAdvanceControl;\n                },\n\n                /** Initializes the module. */\n                initialize: function() {\n                    var state = this.state;\n\n                    this.el = $(this.template);\n                    this.render();\n                    this.setAutoAdvance(state.auto_advance);\n                    this.bindHandlers();\n\n                    return true;\n                },\n\n                /**\n                 * Creates any necessary DOM elements, attach them, and set their,\n                 * initial configuration.\n                 * @param {boolean} enabled Whether auto advance is enabled\n                 */\n                render: function() {\n                    this.state.el.find('.secondary-controls').prepend(this.el);\n                },\n\n                /**\n                 * Bind any necessary function callbacks to DOM events (click,\n                 * mousemove, etc.).\n                 */\n                bindHandlers: function() {\n                    this.el.on({\n                        click: this.onClick\n                    });\n                    this.state.el.on({\n                        ready: this.autoPlay,\n                        ended: this.autoAdvance,\n                        destroy: this.destroy\n                    });\n                },\n\n                onClick: function(event) {\n                    var enabled = !this.state.auto_advance;\n                    event.preventDefault();\n                    this.setAutoAdvance(enabled);\n                    this.el.trigger('autoadvancechange', [enabled]);\n                },\n\n                /**\n                 * Sets or unsets auto advance.\n                 * @param {boolean} enabled Sets auto advance.\n                 */\n                setAutoAdvance: function(enabled) {\n                    if (enabled) {\n                        this.el.addClass('active');\n                    } else {\n                        this.el.removeClass('active');\n                    }\n                },\n\n                autoPlay: function() {\n                    // Only autoplay the video if it's the first component of the unit.\n                    // If a unit has more than one video, no more than one will autoplay.\n                    var isFirstComponent = this.state.el.parents('.vert-0').length === 1;\n                    if (this.state.auto_advance && isFirstComponent) {\n                        this.state.videoCommands.execute('play');\n                    }\n                },\n\n                autoAdvance: function() {\n                    if (this.state.auto_advance) {\n                        $('.sequence-nav-button.button-next').first().click();\n                    }\n                }\n            };\n\n            return AutoAdvanceControl;\n        });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/08_video_auto_advance_control.js","\n    'use strict';\n    define(\n'video/08_video_speed_control.js', [\n    'video/00_iterator.js',\n    'edx-ui-toolkit/js/utils/html-utils'\n], function(Iterator, HtmlUtils) {\n    /**\n     * Video speed control module.\n     * @exports video/08_video_speed_control.js\n     * @constructor\n     * @param {object} state The object containing the state of the video player.\n     * @return {jquery Promise}\n     */\n    var SpeedControl = function(state) {\n        if (!(this instanceof SpeedControl)) {\n            return new SpeedControl(state);\n        }\n\n        _.bindAll(this, 'onSetSpeed', 'onRenderSpeed', 'clickLinkHandler',\n            'keyDownLinkHandler', 'mouseEnterHandler', 'mouseLeaveHandler',\n            'clickMenuHandler', 'keyDownMenuHandler', 'destroy'\n        );\n        this.state = state;\n        this.state.videoSpeedControl = this;\n        this.initialize();\n\n        return $.Deferred().resolve().promise();\n    };\n\n    SpeedControl.prototype = {\n        template: [\n            '<div class=\"speeds menu-container\" role=\"application\">',\n            '<p class=\"sr instructions\">',\n                    gettext('Press UP to enter the speed menu then use the UP and DOWN arrow keys to navigate the different speeds, then press ENTER to change to the selected speed.'),  // eslint-disable-line max-len, indent\n            '</p>',\n            '<button class=\"control speed-button\" aria-disabled=\"false\" aria-expanded=\"false\"',\n            'title=\"',\n            gettext('Adjust video speed'),\n            '\">',\n            '<span>',\n            '<span class=\"icon fa fa-caret-right\" aria-hidden=\"true\"></span>',\n            '</span>',\n            '<span class=\"label\" aria-hidden=\"true\">',\n            gettext('Speed'),\n            '</span>',\n            '<span class=\"value\"></span>',\n            '</button>',\n            '<ol class=\"video-speeds menu\"></ol>',\n            '</div>'\n        ].join(''),\n\n        destroy: function() {\n            this.el.off({\n                mouseenter: this.mouseEnterHandler,\n                mouseleave: this.mouseLeaveHandler,\n                click: this.clickMenuHandler,\n                keydown: this.keyDownMenuHandler\n            });\n\n            this.state.el.off({\n                'speed:set': this.onSetSpeed,\n                'speed:render': this.onRenderSpeed\n            });\n            this.closeMenu(true);\n            this.speedsContainer.remove();\n            this.el.remove();\n            delete this.state.videoSpeedControl;\n        },\n\n        /** Initializes the module. */\n        initialize: function() {\n            var state = this.state;\n\n            if (!this.isPlaybackRatesSupported(state)) {\n                console.log(\n                    '[Video info]: playbackRate is not supported.'\n                );\n\n                return false;\n            }\n            this.el = $(this.template);\n            this.speedsContainer = this.el.find('.video-speeds');\n            this.speedButton = this.el.find('.speed-button');\n            this.render(state.speeds, state.speed);\n            this.setSpeed(state.speed, true, true);\n            this.bindHandlers();\n\n            return true;\n        },\n\n        /**\n         * Creates any necessary DOM elements, attach them, and set their,\n         * initial configuration.\n         * @param {array} speeds List of speeds available for the player.\n         * @param {string} currentSpeed The current speed set to the player.\n         */\n        render: function(speeds, currentSpeed) {\n            var speedsContainer = this.speedsContainer,\n                reversedSpeeds = speeds.concat().reverse(),\n                instructionsId = 'speed-instructions-' + this.state.id,\n                speedsList = $.map(reversedSpeeds, function(speed) {\n                    return HtmlUtils.interpolateHtml(\n                        HtmlUtils.HTML(\n                        [\n                            '<li data-speed=\"{speed}\">',\n                            '<button class=\"control speed-option\" tabindex=\"-1\" aria-pressed=\"false\">',\n                            '{speed}x',\n                            '</button>',\n                            '</li>'\n                        ].join('')\n                        ),\n                        {\n                            speed: speed\n                        }\n                    ).toString();\n                });\n\n            HtmlUtils.setHtml(\n                speedsContainer,\n                HtmlUtils.HTML(speedsList)\n            );\n            this.speedLinks = new Iterator(speedsContainer.find('.speed-option'));\n            HtmlUtils.prepend(\n                this.state.el.find('.secondary-controls'),\n                HtmlUtils.HTML(this.el)\n            );\n            this.setActiveSpeed(currentSpeed);\n\n            // set dynamic id for instruction element to avoid collisions\n            this.el.find('.instructions').attr('id', instructionsId);\n            this.speedButton.attr('aria-describedby', instructionsId);\n        },\n\n        /**\n         * Bind any necessary function callbacks to DOM events (click,\n         * mousemove, etc.).\n         */\n        bindHandlers: function() {\n            // Attach various events handlers to the speed menu button.\n            this.el.on({\n                mouseenter: this.mouseEnterHandler,\n                mouseleave: this.mouseLeaveHandler,\n                click: this.openMenu,\n                keydown: this.keyDownMenuHandler\n            });\n\n            // Attach click and keydown event handlers to the individual speed\n            // entries.\n            this.speedsContainer.on({\n                click: this.clickLinkHandler,\n                keydown: this.keyDownLinkHandler\n            }, '.speed-option');\n\n            this.state.el.on({\n                'speed:set': this.onSetSpeed,\n                'speed:render': this.onRenderSpeed\n            });\n            this.state.el.on('destroy', this.destroy);\n        },\n\n        onSetSpeed: function(event, speed) {\n            this.setSpeed(speed, true);\n        },\n\n        onRenderSpeed: function(event, speeds, currentSpeed) {\n            this.render(speeds, currentSpeed);\n        },\n\n        /**\n         * Check if playbackRate supports by browser. If browser supports, 1.0\n         * should be returned by playbackRate property. In this case, function\n         * return True. Otherwise, False will be returned.\n         * iOS doesn't support speed change.\n         * @param {object} state The object containing the state of the video\n         * player.\n         * @return {boolean}\n         *   true: Browser support playbackRate functionality.\n         *   false: Browser doesn't support playbackRate functionality.\n         */\n        isPlaybackRatesSupported: function(state) {\n            var isHtml5 = state.videoType === 'html5',\n                isTouch = state.isTouch,\n                video = document.createElement('video');\n\n            return !isTouch || (isHtml5 && !Boolean(video.playbackRate));\n        },\n\n        /**\n         * Opens speed menu.\n         * @param {boolean} [bindEvent] Click event will be attached on window.\n         */\n        openMenu: function(bindEvent) {\n            // When speed entries have focus, the menu stays open on\n            // mouseleave. A clickHandler is added to the window\n            // element to have clicks close the menu when they happen\n            // outside of it.\n            if (bindEvent) {\n                $(window).on('click.speedMenu', this.clickMenuHandler);\n            }\n\n            this.el.addClass('is-opened');\n            this.speedButton\n                .attr('tabindex', -1)\n                .attr('aria-expanded', 'true');\n        },\n\n        /**\n         * Closes speed menu.\n         * @param {boolean} [unBindEvent] Click event will be detached from window.\n         */\n        closeMenu: function(unBindEvent) {\n            // Remove the previously added clickHandler from window element.\n            if (unBindEvent) {\n                $(window).off('click.speedMenu');\n            }\n\n            this.el.removeClass('is-opened');\n            this.speedButton\n                .attr('tabindex', 0)\n                .attr('aria-expanded', 'false');\n        },\n\n        /**\n         * Sets new current speed for the speed control and triggers `speedchange`\n         * event if needed.\n         * @param {string|number} speed Speed to be set.\n         * @param {boolean} [silent] Sets the new speed without triggering\n         * `speedchange` event.\n         * @param {boolean} [forceUpdate] Updates the speed even if it's\n         * not differs from current speed.\n         */\n        setSpeed: function(speed, silent, forceUpdate) {\n            if (speed !== this.currentSpeed || forceUpdate) {\n                this.speedsContainer\n                    .find('li')\n                    .siblings(\"li[data-speed='\" + speed + \"']\");\n\n                this.speedButton.find('.value').text(speed + 'x');\n                this.currentSpeed = speed;\n\n                if (!silent) {\n                    this.el.trigger('speedchange', [speed, this.state.speed]);\n                }\n            }\n\n            this.resetActiveSpeed();\n            this.setActiveSpeed(speed);\n        },\n\n        resetActiveSpeed: function() {\n            var speedOptions = this.speedsContainer.find('li');\n\n            $(speedOptions).each(function(index, el) {\n                $(el).removeClass('is-active')\n                    .find('.speed-option')\n                    .attr('aria-pressed', 'false');\n            });\n        },\n\n        setActiveSpeed: function(speed) {\n            var speedOption = this.speedsContainer.find('li[data-speed=\"' + speed + '\"]');\n\n            speedOption.addClass('is-active')\n                .find('.speed-option')\n                .attr('aria-pressed', 'true');\n\n            this.speedButton.attr('title', gettext('Video speed: ') + speed + 'x');\n        },\n\n        /**\n         * Click event handler for the menu.\n         * @param {jquery Event} event\n         */\n        clickMenuHandler: function() {\n            this.closeMenu();\n\n            return false;\n        },\n\n        /**\n         * Click event handler for speed links.\n         * @param {jquery Event} event\n         */\n        clickLinkHandler: function(event) {\n            var el = $(event.currentTarget).parent(),\n                speed = $(el).data('speed');\n\n            this.resetActiveSpeed();\n            this.setActiveSpeed(speed);\n            this.state.videoCommands.execute('speed', speed);\n            this.closeMenu(true);\n\n            return false;\n        },\n\n        /**\n         * Mouseenter event handler for the menu.\n         * @param {jquery Event} event\n         */\n        mouseEnterHandler: function() {\n            this.openMenu();\n\n            return false;\n        },\n\n        /**\n         * Mouseleave event handler for the menu.\n         * @param {jquery Event} event\n         */\n        mouseLeaveHandler: function() {\n            // Only close the menu is no speed entry has focus.\n            if (!this.speedLinks.list.is(':focus')) {\n                this.closeMenu();\n            }\n\n            return false;\n        },\n\n        /**\n         * Keydown event handler for the menu.\n         * @param {jquery Event} event\n         */\n        keyDownMenuHandler: function(event) {\n            var KEY = $.ui.keyCode,\n                keyCode = event.keyCode;\n\n            switch (keyCode) {\n                // Open menu and focus on last element of list above it.\n            case KEY.ENTER:\n            case KEY.SPACE:\n            case KEY.UP:\n                this.openMenu(true);\n                this.speedLinks.last().focus();\n                break;\n                // Close menu.\n            case KEY.ESCAPE:\n                this.closeMenu(true);\n                break;\n            }\n            // We do not stop propagation and default behavior on a TAB\n            // keypress.\n            return event.keyCode === KEY.TAB;\n        },\n\n        /**\n         * Keydown event handler for speed links.\n         * @param {jquery Event} event\n         */\n        keyDownLinkHandler: function(event) {\n            // ALT key is used to change (alternate) the function of\n            // other pressed keys. In this, do nothing.\n            if (event.altKey) {\n                return true;\n            }\n\n            var KEY = $.ui.keyCode,\n                self = this,\n                parent = $(event.currentTarget).parent(),\n                index = parent.index(),\n                speed = parent.data('speed');\n\n            switch (event.keyCode) {\n                // Close menu.\n            case KEY.TAB:\n                    // Closes menu after 25ms delay to change `tabindex` after\n                    // finishing default behavior.\n                setTimeout(function() {\n                    self.closeMenu(true);\n                }, 25);\n\n                return true;\n                // Close menu and give focus to speed control.\n            case KEY.ESCAPE:\n                this.closeMenu(true);\n                this.speedButton.focus();\n\n                return false;\n                // Scroll up menu, wrapping at the top. Keep menu open.\n            case KEY.UP:\n                    // Shift + Arrows keyboard shortcut might be used by\n                    // screen readers. In this, do nothing.\n                if (event.shiftKey) {\n                    return true;\n                }\n\n                this.speedLinks.prev(index).focus();\n                return false;\n                // Scroll down  menu, wrapping at the bottom. Keep menu\n                // open.\n            case KEY.DOWN:\n                    // Shift + Arrows keyboard shortcut might be used by\n                    // screen readers. In this, do nothing.\n                if (event.shiftKey) {\n                    return true;\n                }\n\n                this.speedLinks.next(index).focus();\n                return false;\n                // Close menu, give focus to speed control and change\n                // speed.\n            case KEY.ENTER:\n            case KEY.SPACE:\n                this.closeMenu(true);\n                this.speedButton.focus();\n                this.setSpeed(this.state.speedToString(speed));\n\n                return false;\n            }\n\n            return true;\n        }\n    };\n\n    return SpeedControl;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/08_video_speed_control.js","\n    'use strict';\n// VideoContextMenu module.\n    define(\n'video/095_video_context_menu.js',\n['video/00_component.js'],\nfunction(Component) {\n    var AbstractItem, AbstractMenu, Menu, Overlay, Submenu, MenuItem;\n\n    AbstractItem = Component.extend({\n        initialize: function(options) {\n            this.options = $.extend(true, {\n                label: '',\n                prefix: 'edx-',\n                dataAttrs: {menu: this},\n                attrs: {},\n                items: [],\n                callback: $.noop,\n                initialize: $.noop\n            }, options);\n\n            this.id = _.uniqueId();\n            this.element = this.createElement();\n            this.element.attr(this.options.attrs).data(this.options.dataAttrs);\n            this.children = [];\n            this.delegateEvents();\n            this.options.initialize.call(this, this);\n        },\n        destroy: function() {\n            _.invoke(this.getChildren(), 'destroy');\n            this.undelegateEvents();\n            this.getElement().remove();\n        },\n        open: function() {\n            this.getElement().addClass('is-opened');\n            return this;\n        },\n        close: function() { },\n        closeSiblings: function() {\n            _.invoke(this.getSiblings(), 'close');\n            return this;\n        },\n        getElement: function() {\n            return this.element;\n        },\n        addChild: function(child) {\n            var firstChild = null,\n                lastChild = null;\n            if (this.hasChildren()) {\n                lastChild = this.getLastChild();\n                lastChild.next = child;\n                firstChild = this.getFirstChild();\n                firstChild.prev = child;\n            }\n            child.parent = this;\n            child.next = firstChild;\n            child.prev = lastChild;\n            this.children.push(child);\n            return this;\n        },\n        getChildren: function() {\n            // Returns the copy.\n            return this.children.concat();\n        },\n        hasChildren: function() {\n            return this.getChildren().length > 0;\n        },\n        getFirstChild: function() {\n            return _.first(this.children);\n        },\n        getLastChild: function() {\n            return _.last(this.children);\n        },\n        bindEvent: function(element, events, handler) {\n            $(element).on(this.addNamespace(events), handler);\n            return this;\n        },\n        getNext: function() {\n            var item = this.next;\n            while (item.isHidden() && this.id !== item.id) { item = item.next; }\n            return item;\n        },\n        getPrev: function() {\n            var item = this.prev;\n            while (item.isHidden() && this.id !== item.id) { item = item.prev; }\n            return item;\n        },\n        createElement: function() {\n            return null;\n        },\n        getRoot: function() {\n            var item = this;\n            while (item.parent) { item = item.parent; }\n            return item;\n        },\n        populateElement: function() { },\n        focus: function() {\n            this.getElement().focus();\n            this.closeSiblings();\n            return this;\n        },\n        isHidden: function() {\n            return this.getElement().is(':hidden');\n        },\n        getSiblings: function() {\n            var items = [],\n                item = this;\n            while (item.next && item.next.id !== this.id) {\n                item = item.next;\n                items.push(item);\n            }\n            return items;\n        },\n        select: function() { },\n        unselect: function() { },\n        setLabel: function() { },\n        itemHandler: function() { },\n        keyDownHandler: function() { },\n        delegateEvents: function() { },\n        undelegateEvents: function() {\n            this.getElement().off('.' + this.id);\n        },\n        addNamespace: function(events) {\n            return _.map(events.split(/\\s+/), function(event) {\n                return event + '.' + this.id;\n            }, this).join(' ');\n        }\n    });\n\n    AbstractMenu = AbstractItem.extend({\n        delegateEvents: function() {\n            this.bindEvent(this.getElement(), 'keydown mouseleave mouseover', this.itemHandler.bind(this))\n                .bindEvent(this.getElement(), 'contextmenu', function(event) { event.preventDefault(); });\n            return this;\n        },\n\n        populateElement: function() {\n            var fragment = document.createDocumentFragment();\n\n            _.each(this.getChildren(), function(child) {\n                fragment.appendChild(child.populateElement()[0]);\n            }, this);\n\n            this.appendContent([fragment]);\n            this.isRendered = true;\n            return this.getElement();\n        },\n\n        close: function() {\n            this.closeChildren();\n            this.getElement().removeClass('is-opened');\n            return this;\n        },\n\n        closeChildren: function() {\n            _.invoke(this.getChildren(), 'close');\n            return this;\n        },\n\n        itemHandler: function(event) {\n            event.preventDefault();\n            var item = $(event.target).data('menu');\n            switch (event.type) {\n            case 'keydown':\n                this.keyDownHandler.call(this, event, item);\n                break;\n            case 'mouseover':\n                this.mouseOverHandler.call(this, event, item);\n                break;\n            case 'mouseleave':\n                this.mouseLeaveHandler.call(this, event, item);\n                break;\n            }\n        },\n\n        keyDownHandler: function() { },\n        mouseOverHandler: function() { },\n        mouseLeaveHandler: function() { }\n    });\n\n    Menu = AbstractMenu.extend({\n        initialize: function(options, contextmenuElement, container) {\n            this.contextmenuElement = $(contextmenuElement);\n            this.container = $(container);\n            this.overlay = this.getOverlay();\n            AbstractMenu.prototype.initialize.apply(this, arguments);\n            this.build(this, this.options.items);\n        },\n\n        createElement: function() {\n            return $('<ol />', {\n                class: ['contextmenu', this.options.prefix + 'contextmenu'].join(' '),\n                role: 'menu',\n                tabindex: -1\n            });\n        },\n\n        delegateEvents: function() {\n            AbstractMenu.prototype.delegateEvents.call(this);\n            this.bindEvent(this.contextmenuElement, 'contextmenu', this.contextmenuHandler.bind(this))\n                .bindEvent(window, 'resize', _.debounce(this.close.bind(this), 100));\n            return this;\n        },\n\n        destroy: function() {\n            AbstractMenu.prototype.destroy.call(this);\n            this.overlay.destroy();\n            this.contextmenuElement.removeData('contextmenu');\n            return this;\n        },\n\n        undelegateEvents: function() {\n            AbstractMenu.prototype.undelegateEvents.call(this);\n            this.contextmenuElement.off(this.addNamespace('contextmenu'));\n            this.overlay.undelegateEvents();\n            return this;\n        },\n\n        appendContent: function(content) {\n            this.getElement().append(content);\n            return this;\n        },\n\n        addChild: function() {\n            AbstractMenu.prototype.addChild.apply(this, arguments);\n            this.next = this.getFirstChild();\n            this.prev = this.getLastChild();\n            return this;\n        },\n\n        build: function(container, items) {\n            _.each(items, function(item) {\n                var child;\n                if (_.has(item, 'items')) {\n                    child = this.build((new Submenu(item, this.contextmenuElement)), item.items);\n                } else {\n                    child = new MenuItem(item);\n                }\n                container.addChild(child);\n            }, this);\n            return container;\n        },\n\n        focus: function() {\n            this.getElement().focus();\n            return this;\n        },\n\n        open: function() {\n            var menu = (this.isRendered) ? this.getElement() : this.populateElement();\n            this.container.append(menu);\n            AbstractItem.prototype.open.call(this);\n            this.overlay.show(this.container);\n            return this;\n        },\n\n        close: function() {\n            AbstractMenu.prototype.close.call(this);\n            this.getElement().detach();\n            this.overlay.hide();\n            return this;\n        },\n\n        position: function(event) {\n            this.getElement().position({\n                my: 'left top',\n                of: event,\n                collision: 'flipfit flipfit',\n                within: this.contextmenuElement\n            });\n\n            return this;\n        },\n\n        pointInContainerBox: function(x, y) {\n            var containerOffset = this.contextmenuElement.offset(),\n                containerBox = {\n                    x0: containerOffset.left,\n                    y0: containerOffset.top,\n                    x1: containerOffset.left + this.contextmenuElement.outerWidth(),\n                    y1: containerOffset.top + this.contextmenuElement.outerHeight()\n                };\n            return containerBox.x0 <= x && x <= containerBox.x1 && containerBox.y0 <= y && y <= containerBox.y1;\n        },\n\n        getOverlay: function() {\n            return new Overlay(\n                this.close.bind(this),\n                function(event) {\n                    event.preventDefault();\n                    if (this.pointInContainerBox(event.pageX, event.pageY)) {\n                        this.position(event).focus();\n                        this.closeChildren();\n                    } else {\n                        this.close();\n                    }\n                }.bind(this)\n            );\n        },\n\n        contextmenuHandler: function(event) {\n            event.preventDefault();\n            event.stopPropagation();\n            this.open().position(event).focus();\n        },\n\n        keyDownHandler: function(event, item) {\n            var KEY = $.ui.keyCode,\n                keyCode = event.keyCode;\n\n            switch (keyCode) {\n            case KEY.UP:\n                item.getPrev().focus();\n                event.stopPropagation();\n                break;\n            case KEY.DOWN:\n                item.getNext().focus();\n                event.stopPropagation();\n                break;\n            case KEY.TAB:\n                event.stopPropagation();\n                break;\n            case KEY.ESCAPE:\n                this.close();\n                break;\n            }\n\n            return false;\n        }\n    });\n\n    Overlay = Component.extend({\n        ns: '.overlay',\n        initialize: function(clickHandler, contextmenuHandler) {\n            this.element = $('<div />', {\n                class: 'overlay'\n            });\n            this.clickHandler = clickHandler;\n            this.contextmenuHandler = contextmenuHandler;\n        },\n\n        destroy: function() {\n            this.getElement().remove();\n            this.undelegateEvents();\n        },\n\n        getElement: function() {\n            return this.element;\n        },\n\n        hide: function() {\n            this.getElement().detach();\n            this.undelegateEvents();\n            return this;\n        },\n\n        show: function(container) {\n            $(container).append(this.getElement());\n            this.delegateEvents();\n            return this;\n        },\n\n        delegateEvents: function() {\n            var self = this;\n            $(document)\n                .on('click' + this.ns, function() {\n                    if (_.isFunction(self.clickHandler)) {\n                        self.clickHandler.apply(this, arguments);\n                    }\n                    self.hide();\n                })\n                .on('contextmenu' + this.ns, function() {\n                    if (_.isFunction(self.contextmenuHandler)) {\n                        self.contextmenuHandler.apply(this, arguments);\n                    }\n                });\n            return this;\n        },\n\n        undelegateEvents: function() {\n            $(document).off(this.ns);\n            return this;\n        }\n    });\n\n    Submenu = AbstractMenu.extend({\n        initialize: function(options, contextmenuElement) {\n            this.contextmenuElement = contextmenuElement;\n            AbstractMenu.prototype.initialize.apply(this, arguments);\n        },\n\n        createElement: function() {\n            var $element = $('<li />', {\n                class: ['submenu-item', 'menu-item', this.options.prefix + 'submenu-item'].join(' '),\n                'aria-expanded': 'false',\n                'aria-haspopup': 'true',\n                'aria-labelledby': 'submenu-item-label-' + this.id,\n                role: 'menuitem',\n                tabindex: -1\n            });\n\n            this.label = $('<span />', {\n                id: 'submenu-item-label-' + this.id,\n                text: this.options.label\n            }).appendTo($element);\n\n            this.list = $('<ol />', {\n                class: ['submenu', this.options.prefix + 'submenu'].join(' '),\n                role: 'menu'\n            }).appendTo($element);\n\n            return $element;\n        },\n\n        appendContent: function(content) {\n            this.list.append(content);\n            return this;\n        },\n\n        setLabel: function(label) {\n            this.label.text(label);\n            return this;\n        },\n\n        openKeyboard: function() {\n            if (this.hasChildren()) {\n                this.open();\n                this.getFirstChild().focus();\n            }\n            return this;\n        },\n\n        keyDownHandler: function(event) {\n            var KEY = $.ui.keyCode,\n                keyCode = event.keyCode;\n\n            switch (keyCode) {\n            case KEY.LEFT:\n                this.close().focus();\n                event.stopPropagation();\n                break;\n            case KEY.RIGHT:\n            case KEY.ENTER:\n            case KEY.SPACE:\n                this.openKeyboard();\n                event.stopPropagation();\n                break;\n            }\n\n            return false;\n        },\n\n        open: function() {\n            AbstractMenu.prototype.open.call(this);\n            this.getElement().attr({'aria-expanded': 'true'});\n            this.position();\n            return this;\n        },\n\n        close: function() {\n            AbstractMenu.prototype.close.call(this);\n            this.getElement().attr({'aria-expanded': 'false'});\n            return this;\n        },\n\n        position: function() {\n            this.list.position({\n                my: 'left top',\n                at: 'right top',\n                of: this.getElement(),\n                collision: 'flipfit flipfit',\n                within: this.contextmenuElement\n            });\n            return this;\n        },\n\n        mouseOverHandler: function() {\n            clearTimeout(this.timer);\n            this.timer = setTimeout(this.open.bind(this), 200);\n            this.focus();\n        },\n\n        mouseLeaveHandler: function() {\n            clearTimeout(this.timer);\n            this.timer = setTimeout(this.close.bind(this), 200);\n            this.focus();\n        }\n    });\n\n    MenuItem = AbstractItem.extend({\n        createElement: function() {\n            var classNames = [\n                'menu-item', this.options.prefix + 'menu-item',\n                this.options.isSelected ? 'is-selected' : ''\n            ].join(' ');\n\n            return $('<li />', {\n                class: classNames,\n                'aria-selected': this.options.isSelected ? 'true' : 'false',\n                role: 'menuitem',\n                tabindex: -1,\n                text: this.options.label\n            });\n        },\n\n        populateElement: function() {\n            return this.getElement();\n        },\n\n        delegateEvents: function() {\n            this.bindEvent(this.getElement(), 'click keydown contextmenu mouseover', this.itemHandler.bind(this));\n            return this;\n        },\n\n        setLabel: function(label) {\n            this.getElement().text(label);\n            return this;\n        },\n\n        select: function(event) {\n            this.options.callback.call(this, event, this, this.options);\n            this.getElement()\n                .addClass('is-selected')\n                .attr({'aria-selected': 'true'});\n            _.invoke(this.getSiblings(), 'unselect');\n            // Hide the menu.\n            this.getRoot().close();\n            return this;\n        },\n\n        unselect: function() {\n            this.getElement()\n                .removeClass('is-selected')\n                .attr({'aria-selected': 'false'});\n            return this;\n        },\n\n        itemHandler: function(event) {\n            event.preventDefault();\n            switch (event.type) {\n            case 'contextmenu':\n            case 'click':\n                this.select();\n                break;\n            case 'mouseover':\n                this.focus();\n                event.stopPropagation();\n                break;\n            case 'keydown':\n                this.keyDownHandler.call(this, event, this);\n                break;\n            }\n        },\n\n        keyDownHandler: function(event) {\n            var KEY = $.ui.keyCode,\n                keyCode = event.keyCode;\n\n            switch (keyCode) {\n            case KEY.RIGHT:\n                event.stopPropagation();\n                break;\n            case KEY.ENTER:\n            case KEY.SPACE:\n                this.select();\n                event.stopPropagation();\n                break;\n            }\n\n            return false;\n        }\n    });\n\n    // VideoContextMenu() function - what this module 'exports'.\n    return function(state, i18n) {\n        var speedCallback = function(event, menuitem, options) {\n                var speed = parseFloat(options.label);\n                state.videoCommands.execute('speed', speed);\n            },\n            options = {\n                items: [{\n                    label: i18n.Play,\n                    callback: function() {\n                        state.videoCommands.execute('togglePlayback');\n                    },\n                    initialize: function(menuitem) {\n                        state.el.on({\n                            play: function() {\n                                menuitem.setLabel(i18n.Pause);\n                            },\n                            pause: function() {\n                                menuitem.setLabel(i18n.Play);\n                            }\n                        });\n                    }\n                }, {\n                    label: state.videoVolumeControl.getMuteStatus() ? i18n.Unmute : i18n.Mute,\n                    callback: function() {\n                        state.videoCommands.execute('toggleMute');\n                    },\n                    initialize: function(menuitem) {\n                        state.el.on({\n                            volumechange: function() {\n                                if (state.videoVolumeControl.getMuteStatus()) {\n                                    menuitem.setLabel(i18n.Unmute);\n                                } else {\n                                    menuitem.setLabel(i18n.Mute);\n                                }\n                            }\n                        });\n                    }\n                }, {\n                    label: i18n['Fill browser'],\n                    callback: function() {\n                        state.videoCommands.execute('toggleFullScreen');\n                    },\n                    initialize: function(menuitem) {\n                        state.el.on({\n                            fullscreen: function(event, isFullscreen) {\n                                if (isFullscreen) {\n                                    menuitem.setLabel(i18n['Exit full browser']);\n                                } else {\n                                    menuitem.setLabel(i18n['Fill browser']);\n                                }\n                            }\n                        });\n                    }\n                }, {\n                    label: i18n.Speed,\n                    items: _.map(state.speeds, function(speed) {\n                        var isSelected = speed === state.speed;\n                        return {label: speed + 'x', callback: speedCallback, speed: speed, isSelected: isSelected};\n                    }),\n                    initialize: function(menuitem) {\n                        state.el.on({\n                            speedchange: function(event, speed) {\n                                var item = menuitem.getChildren().filter(function(item) {\n                                    return item.options.speed === speed;\n                                })[0];\n                                if (item) {\n                                    item.select();\n                                }\n                            }\n                        });\n                    }\n                }\n                ]\n            };\n\n        $.fn.contextmenu = function(container, options) {\n            return this.each(function() {\n                $(this).data('contextmenu', new Menu(options, this, container));\n            });\n        };\n\n        if (!state.isYoutubeType()) {\n            state.el.find('video').contextmenu(state.el, options);\n            state.el.on('destroy', function() {\n                var contextmenu = $(this).find('video').data('contextmenu');\n                if (contextmenu) {\n                    contextmenu.destroy();\n                }\n            });\n        }\n\n        return $.Deferred().resolve().promise();\n    };\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/095_video_context_menu.js","\n    'use strict';\n    define('video/09_bumper.js', [], function() {\n    /**\n     * VideoBumper module.\n     * @exports video/09_bumper.js\n     * @constructor\n     * @param {Object} player The player factory.\n     * @param {Object} state The object containing the state of the video\n     * @return {jquery Promise}\n     */\n        var VideoBumper = function(player, state) {\n            if (!(this instanceof VideoBumper)) {\n                return new VideoBumper(player, state);\n            }\n\n            _.bindAll(\n            this, 'showMainVideoHandler', 'destroy', 'skipByDuration', 'destroyAndResolve'\n        );\n            this.dfd = $.Deferred();\n            this.element = state.el;\n            this.element.addClass('is-bumper');\n            this.player = player;\n            this.state = state;\n            this.doNotShowAgain = false;\n            this.state.videoBumper = this;\n            this.bindHandlers();\n            this.initialize();\n            this.maxBumperDuration = 35; // seconds\n        };\n\n        VideoBumper.prototype = {\n            initialize: function() {\n                this.player();\n            },\n\n            getPromise: function() {\n                return this.dfd.promise();\n            },\n\n            showMainVideoHandler: function() {\n                this.state.storage.setItem('isBumperShown', true);\n                setTimeout(function() {\n                    this.saveState();\n                    this.showMainVideo();\n                }.bind(this), 20);\n            },\n\n            destroyAndResolve: function() {\n                this.destroy();\n                this.dfd.resolve();\n            },\n\n            showMainVideo: function() {\n                if (this.state.videoPlayer) {\n                    this.destroyAndResolve();\n                } else {\n                    this.state.el.on('initialize', this.destroyAndResolve);\n                }\n            },\n\n            skip: function() {\n                this.element.trigger('skip', [this.doNotShowAgain]);\n                this.showMainVideoHandler();\n            },\n\n            skipAndDoNotShowAgain: function() {\n                this.doNotShowAgain = true;\n                this.skip();\n            },\n\n            skipByDuration: function(event, time) {\n                if (time > this.maxBumperDuration) {\n                    this.element.trigger('ended');\n                }\n            },\n\n            bindHandlers: function() {\n                var events = ['ended', 'error'].join(' ');\n                this.element.on(events, this.showMainVideoHandler);\n                this.element.on('timeupdate', this.skipByDuration);\n            },\n\n            saveState: function() {\n                var info = {bumper_last_view_date: true};\n                if (this.doNotShowAgain) {\n                    _.extend(info, {bumper_do_not_show_again: true});\n                }\n                if (this.state.videoSaveStatePlugin) {\n                    this.state.videoSaveStatePlugin.saveState(true, info);\n                }\n            },\n\n            destroy: function() {\n                var events = ['ended', 'error'].join(' ');\n                this.element.off(events, this.showMainVideoHandler);\n                this.element.off({\n                    timeupdate: this.skipByDuration,\n                    initialize: this.destroyAndResolve\n                });\n                this.element.removeClass('is-bumper');\n                if (_.isFunction(this.state.videoPlayer.destroy)) {\n                    this.state.videoPlayer.destroy();\n                }\n                delete this.state.videoBumper;\n            }\n        };\n\n        return VideoBumper;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_bumper.js","\n    'use strict';\n    /**\n     * Completion handler\n     * @exports video/09_completion.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @return {jquery Promise}\n     */\n    define('video/09_completion.js', [], function() {\n        var VideoCompletionHandler = function(state) {\n            if (!(this instanceof VideoCompletionHandler)) {\n                return new VideoCompletionHandler(state);\n            }\n            this.state = state;\n            this.state.completionHandler = this;\n            this.initialize();\n            return $.Deferred().resolve().promise();\n        };\n\n        VideoCompletionHandler.prototype = {\n\n            /** Tears down the VideoCompletionHandler.\n             *\n             *  * Removes backreferences from this.state to this.\n             *  * Turns off signal handlers.\n             */\n            destroy: function() {\n                this.el.remove();\n                this.el.off('timeupdate.completion');\n                this.el.off('ended.completion');\n                delete this.state.completionHandler;\n            },\n\n            /** Initializes the VideoCompletionHandler.\n             *\n             *  This sets all the instance variables needed to perform\n             *  completion calculations.\n             */\n            initialize: function() {\n                // Attributes with \"Time\" in the name refer to the number of seconds since\n                // the beginning of the video, except for lastSentTime, which refers to a\n                // timestamp in seconds since the Unix epoch.\n                this.lastSentTime = undefined;\n                this.isComplete = false;\n                this.completionPercentage = this.state.config.completionPercentage;\n                this.startTime = this.state.config.startTime;\n                this.endTime = this.state.config.endTime;\n                this.isEnabled = this.state.config.completionEnabled;\n                if (this.endTime) {\n                    this.completeAfterTime = this.calculateCompleteAfterTime(this.startTime, this.endTime);\n                }\n                if (this.isEnabled) {\n                    this.bindHandlers();\n                }\n            },\n\n            /** Bind event handler callbacks.\n             *\n             *  When ended is triggered, mark the video complete\n             *  unconditionally.\n             *\n             *  When timeupdate is triggered, check to see if the user has\n             *  passed the completeAfterTime in the video, and if so, mark the\n             *  video complete.\n             *\n             *  When destroy is triggered, clean up outstanding resources.\n             */\n            bindHandlers: function() {\n                var self = this;\n\n                /** Event handler to check if the video is complete, and submit\n                 *  a completion if it is.\n                 *\n                 *  If the timeupdate handler doesn't fire after the required\n                 *  percentage, this will catch any fully complete videos.\n                 */\n                this.state.el.on('ended.completion', function() {\n                    self.handleEnded();\n                });\n\n                /** Event handler to check video progress, and mark complete if\n                 *  greater than completionPercentage\n                 */\n                this.state.el.on('timeupdate.completion', function(ev, currentTime) {\n                    self.handleTimeUpdate(currentTime);\n                });\n\n                /** Event handler to clean up resources when the video player\n                 *  is destroyed.\n                 */\n                this.state.el.off('destroy', this.destroy);\n            },\n\n            /** Handler to call when the ended event is triggered */\n            handleEnded: function() {\n                if (this.isComplete) {\n                    return;\n                }\n                this.markCompletion();\n            },\n\n            /** Handler to call when a timeupdate event is triggered */\n            handleTimeUpdate: function(currentTime) {\n                var duration;\n                if (this.isComplete) {\n                    return;\n                }\n                if (this.lastSentTime !== undefined && currentTime - this.lastSentTime < this.repostDelaySeconds()) {\n                    // Throttle attempts to submit in case of network issues\n                    return;\n                }\n                if (this.completeAfterTime === undefined) {\n                    // Duration is not available at initialization time\n                    duration = this.state.videoPlayer.duration();\n                    if (!duration) {\n                        // duration is not yet set. Wait for another event,\n                        // or fall back to 'ended' handler.\n                        return;\n                    }\n                    this.completeAfterTime = this.calculateCompleteAfterTime(this.startTime, duration);\n                }\n\n                if (currentTime > this.completeAfterTime) {\n                    this.markCompletion(currentTime);\n                }\n            },\n\n            /** Submit completion to the LMS */\n            markCompletion: function(currentTime) {\n                var self = this;\n                var errmsg;\n                this.isComplete = true;\n                this.lastSentTime = currentTime;\n                if (this.state.config.publishCompletionUrl) {\n                    $.ajax({\n                        type: 'POST',\n                        url: this.state.config.publishCompletionUrl,\n                        contentType: 'application/json',\n                        dataType: 'json',\n                        data: JSON.stringify({completion: 1.0}),\n                        success: function() {\n                            self.state.el.off('timeupdate.completion');\n                            self.state.el.off('ended.completion');\n                        },\n                        error: function(xhr) {\n                            /* eslint-disable no-console */\n                            self.complete = false;\n                            errmsg = 'Failed to submit completion';\n                            if (xhr.responseJSON !== undefined) {\n                                errmsg += ': ' + xhr.responseJSON.error;\n                            }\n                            console.warn(errmsg);\n                            /* eslint-enable no-console */\n                        }\n                    });\n                } else {\n                    /* eslint-disable no-console */\n                    console.warn('publishCompletionUrl not defined');\n                    /* eslint-enable no-console */\n                }\n            },\n\n            /** Determine what point in the video (in seconds from the\n             *  beginning) counts as complete.\n             */\n            calculateCompleteAfterTime: function(startTime, endTime) {\n                return startTime + (endTime - startTime) * this.completionPercentage;\n            },\n\n            /** How many seconds to wait after a POST fails to try again. */\n            repostDelaySeconds: function() {\n                return 3.0;\n            }\n        };\n        return VideoCompletionHandler;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_completion.js","\n    'use strict';\n    define('video/09_events_bumper_plugin.js', [], function() {\n    /**\n     * Events module.\n     * @exports video/09_events_bumper_plugin.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @param {Object} options\n     * @return {jquery Promise}\n     */\n        var EventsBumperPlugin = function(state, i18n, options) {\n            if (!(this instanceof EventsBumperPlugin)) {\n                return new EventsBumperPlugin(state, i18n, options);\n            }\n\n            _.bindAll(this, 'onReady', 'onPlay', 'onEnded', 'onShowLanguageMenu', 'onHideLanguageMenu', 'onSkip',\n            'onShowCaptions', 'onHideCaptions', 'destroy');\n            this.state = state;\n            this.options = _.extend({}, options);\n            this.state.videoEventsBumperPlugin = this;\n            this.i18n = i18n;\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        EventsBumperPlugin.moduleName = 'EventsBumperPlugin';\n        EventsBumperPlugin.prototype = {\n            destroy: function() {\n                this.state.el.off(this.events);\n                delete this.state.videoEventsBumperPlugin;\n            },\n\n            initialize: function() {\n                this.events = {\n                    ready: this.onReady,\n                    play: this.onPlay,\n                    'ended stop': this.onEnded,\n                    skip: this.onSkip,\n                    'language_menu:show': this.onShowLanguageMenu,\n                    'language_menu:hide': this.onHideLanguageMenu,\n                    'captions:show': this.onShowCaptions,\n                    'captions:hide': this.onHideCaptions,\n                    destroy: this.destroy\n                };\n                this.bindHandlers();\n            },\n\n            bindHandlers: function() {\n                this.state.el.on(this.events);\n            },\n\n            onReady: function() {\n                this.log('edx.video.bumper.loaded');\n            },\n\n            onPlay: function() {\n                this.log('edx.video.bumper.played', {currentTime: this.getCurrentTime()});\n            },\n\n            onEnded: function() {\n                this.log('edx.video.bumper.stopped', {currentTime: this.getCurrentTime()});\n            },\n\n            onSkip: function(event, doNotShowAgain) {\n                var info = {currentTime: this.getCurrentTime()},\n                    eventName = 'edx.video.bumper.' + (doNotShowAgain ? 'dismissed' : 'skipped');\n                this.log(eventName, info);\n            },\n\n            onShowLanguageMenu: function() {\n                this.log('edx.video.bumper.transcript.menu.shown');\n            },\n\n            onHideLanguageMenu: function() {\n                this.log('edx.video.bumper.transcript.menu.hidden');\n            },\n\n            onShowCaptions: function() {\n                this.log('edx.video.bumper.transcript.shown', {currentTime: this.getCurrentTime()});\n            },\n\n            onHideCaptions: function() {\n                this.log('edx.video.bumper.transcript.hidden', {currentTime: this.getCurrentTime()});\n            },\n\n            getCurrentTime: function() {\n                var player = this.state.videoPlayer;\n                return player ? player.currentTime : 0;\n            },\n\n            getDuration: function() {\n                var player = this.state.videoPlayer;\n                return player ? player.duration() : 0;\n            },\n\n            log: function(eventName, data) {\n                var logInfo = _.extend({\n                    host_component_id: this.state.id,\n                    bumper_id: this.state.config.sources[0] || '',\n                    duration: this.getDuration(),\n                    code: 'html5'\n                }, data, this.options.data);\n                Logger.log(eventName, logInfo);\n            }\n        };\n\n        return EventsBumperPlugin;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_events_bumper_plugin.js","\n    'use strict';\n    define('video/09_events_plugin.js', [], function() {\n    /**\n     * Events module.\n     * @exports video/09_events_plugin.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @param {Object} options\n     * @return {jquery Promise}\n     */\n        var EventsPlugin = function(state, i18n, options) {\n            if (!(this instanceof EventsPlugin)) {\n                return new EventsPlugin(state, i18n, options);\n            }\n\n            _.bindAll(this, 'onReady', 'onPlay', 'onPause', 'onEnded', 'onSeek',\n            'onSpeedChange', 'onAutoAdvanceChange', 'onShowLanguageMenu', 'onHideLanguageMenu',\n            'onSkip', 'onShowTranscript', 'onHideTranscript', 'onShowCaptions', 'onHideCaptions',\n            'destroy');\n\n            this.state = state;\n            this.options = _.extend({}, options);\n            this.state.videoEventsPlugin = this;\n            this.i18n = i18n;\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        EventsPlugin.moduleName = 'EventsPlugin';\n        EventsPlugin.prototype = {\n            destroy: function() {\n                this.state.el.off(this.events);\n                delete this.state.videoEventsPlugin;\n            },\n\n            initialize: function() {\n                this.events = {\n                    ready: this.onReady,\n                    play: this.onPlay,\n                    pause: this.onPause,\n                    'ended stop': this.onEnded,\n                    seek: this.onSeek,\n                    skip: this.onSkip,\n                    speedchange: this.onSpeedChange,\n                    autoadvancechange: this.onAutoAdvanceChange,\n                    'language_menu:show': this.onShowLanguageMenu,\n                    'language_menu:hide': this.onHideLanguageMenu,\n                    'transcript:show': this.onShowTranscript,\n                    'transcript:hide': this.onHideTranscript,\n                    'captions:show': this.onShowCaptions,\n                    'captions:hide': this.onHideCaptions,\n                    destroy: this.destroy\n                };\n                this.bindHandlers();\n                this.emitPlayVideoEvent = true;\n            },\n\n            bindHandlers: function() {\n                this.state.el.on(this.events);\n            },\n\n            onReady: function() {\n                this.log('load_video');\n            },\n\n            onPlay: function() {\n                if (this.emitPlayVideoEvent) {\n                    this.log('play_video', {currentTime: this.getCurrentTime()});\n                    this.emitPlayVideoEvent = false;\n                }\n            },\n\n            onPause: function() {\n                this.log('pause_video', {currentTime: this.getCurrentTime()});\n                this.emitPlayVideoEvent = true;\n            },\n\n            onEnded: function() {\n                this.log('stop_video', {currentTime: this.getCurrentTime()});\n                this.emitPlayVideoEvent = true;\n            },\n\n            onSkip: function(event, doNotShowAgain) {\n                var info = {currentTime: this.getCurrentTime()},\n                    eventName = doNotShowAgain ? 'do_not_show_again_video' : 'skip_video';\n                this.log(eventName, info);\n            },\n\n            onSeek: function(event, time, oldTime, type) {\n                this.log('seek_video', {\n                    old_time: oldTime,\n                    new_time: time,\n                    type: type\n                });\n                this.emitPlayVideoEvent = true;\n            },\n\n            onSpeedChange: function(event, newSpeed, oldSpeed) {\n                this.log('speed_change_video', {\n                    current_time: this.getCurrentTime(),\n                    old_speed: oldSpeed,\n                    new_speed: newSpeed\n                });\n            },\n\n            onAutoAdvanceChange: function(event, enabled) {\n                this.log('auto_advance_change_video', {\n                    enabled: enabled\n                });\n            },\n\n            onShowLanguageMenu: function() {\n                this.log('edx.video.language_menu.shown');\n            },\n\n            onHideLanguageMenu: function() {\n                this.log('edx.video.language_menu.hidden', {language: this.getCurrentLanguage()});\n            },\n\n            onShowTranscript: function() {\n                this.log('show_transcript', {current_time: this.getCurrentTime()});\n            },\n\n            onHideTranscript: function() {\n                this.log('hide_transcript', {current_time: this.getCurrentTime()});\n            },\n\n            onShowCaptions: function() {\n                this.log('edx.video.closed_captions.shown', {current_time: this.getCurrentTime()});\n            },\n\n            onHideCaptions: function() {\n                this.log('edx.video.closed_captions.hidden', {current_time: this.getCurrentTime()});\n            },\n\n            getCurrentTime: function() {\n                var player = this.state.videoPlayer;\n                return player ? player.currentTime : 0;\n            },\n\n            getCurrentLanguage: function() {\n                var language = this.state.lang;\n                return language;\n            },\n\n            log: function(eventName, data) {\n                var logInfo = _.extend({\n                    id: this.state.id,\n                    // eslint-disable-next-line no-nested-ternary\n                    code: this.state.isYoutubeType() ? this.state.youtubeId() : this.state.canPlayHLS ? 'hls' : 'html5',\n                    duration: this.state.duration\n                }, data, this.options.data);\n                Logger.log(eventName, logInfo);\n            }\n        };\n\n        return EventsPlugin;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_events_plugin.js","\n    'use strict';\n    define('video/09_play_pause_control.js', [], function() {\n    /**\n     * Play/pause control module.\n     * @exports video/09_play_pause_control.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @return {jquery Promise}\n     */\n        var PlayPauseControl = function(state, i18n) {\n            if (!(this instanceof PlayPauseControl)) {\n                return new PlayPauseControl(state, i18n);\n            }\n\n            _.bindAll(this, 'play', 'pause', 'onClick', 'destroy');\n            this.state = state;\n            this.state.videoPlayPauseControl = this;\n            this.i18n = i18n;\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        PlayPauseControl.prototype = {\n            template: [\n                '<button class=\"control video_control play\" aria-disabled=\"false\" title=\"',\n                gettext('Play'),\n                '\">',\n                '<span class=\"icon fa fa-play\" aria-hidden=\"true\"></span>',\n                '</button>'\n            ].join(''),\n\n            destroy: function() {\n                this.el.remove();\n                this.state.el.off('destroy', this.destroy);\n                delete this.state.videoPlayPauseControl;\n            },\n\n        /** Initializes the module. */\n            initialize: function() {\n                this.el = $(this.template);\n                this.render();\n                this.bindHandlers();\n            },\n\n        /**\n         * Creates any necessary DOM elements, attach them, and set their,\n         * initial configuration.\n         */\n            render: function() {\n                this.state.el.find('.vcr').prepend(this.el);\n            },\n\n        /** Bind any necessary function callbacks to DOM events. */\n            bindHandlers: function() {\n                this.el.on({\n                    click: this.onClick\n                });\n                this.state.el.on({\n                    play: this.play,\n                    'pause ended': this.pause,\n                    destroy: this.destroy\n                });\n            },\n\n            onClick: function(event) {\n                event.preventDefault();\n                this.state.videoCommands.execute('togglePlayback');\n            },\n\n            play: function() {\n                this.el\n                .addClass('pause')\n                .removeClass('play')\n                .attr('title', gettext('Pause'))\n                .find('.icon')\n                    .removeClass('fa-play')\n                    .addClass('fa-pause');\n            },\n\n            pause: function() {\n                this.el\n                .removeClass('pause')\n                .addClass('play')\n                .attr('title', gettext('Play'))\n                .find('.icon')\n                    .removeClass('fa-pause')\n                    .addClass('fa-play');\n            }\n        };\n\n        return PlayPauseControl;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_play_pause_control.js","\n    'use strict';\n    define('video/09_play_placeholder.js', [], function() {\n    /**\n     * Play placeholder control module.\n     * @exports video/09_play_placeholder.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @return {jquery Promise}\n     */\n        var PlayPlaceholder = function(state, i18n) {\n            if (!(this instanceof PlayPlaceholder)) {\n                return new PlayPlaceholder(state, i18n);\n            }\n\n            _.bindAll(this, 'onClick', 'hide', 'show', 'destroy');\n            this.state = state;\n            this.state.videoPlayPlaceholder = this;\n            this.i18n = i18n;\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        PlayPlaceholder.prototype = {\n            destroy: function() {\n                this.el.off('click', this.onClick);\n                this.state.el.on({\n                    destroy: this.destroy,\n                    play: this.hide,\n                    'ended pause': this.show\n                });\n                this.hide();\n                delete this.state.videoPlayPlaceholder;\n            },\n\n        /**\n         * Indicates whether the placeholder should be shown. We display it\n         * for html5 videos on iPad and Android devices.\n         * @return {Boolean}\n         */\n            shouldBeShown: function() {\n                return /iPad|Android/i.test(this.state.isTouch[0]) && !this.state.isYoutubeType();\n            },\n\n        /** Initializes the module. */\n            initialize: function() {\n                if (!this.shouldBeShown()) {\n                    return false;\n                }\n\n                this.el = this.state.el.find('.btn-play');\n                this.bindHandlers();\n                this.show();\n            },\n\n        /** Bind any necessary function callbacks to DOM events. */\n            bindHandlers: function() {\n                this.el.on('click', this.onClick);\n                this.state.el.on({\n                    destroy: this.destroy,\n                    play: this.hide,\n                    'ended pause': this.show\n                });\n            },\n\n            onClick: function() {\n                this.state.videoCommands.execute('play');\n            },\n\n            hide: function() {\n                this.el\n                .addClass('is-hidden')\n                .attr({'aria-hidden': 'true', tabindex: -1});\n            },\n\n            show: function() {\n                this.el\n                .removeClass('is-hidden')\n                .attr({'aria-hidden': 'false', tabindex: 0});\n            }\n        };\n\n        return PlayPlaceholder;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_play_placeholder.js","\n    'use strict';\n    define('video/09_play_skip_control.js', [], function() {\n    /**\n     * Play/skip control module.\n     * @exports video/09_play_skip_control.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @return {jquery Promise}\n     */\n        var PlaySkipControl = function(state, i18n) {\n            if (!(this instanceof PlaySkipControl)) {\n                return new PlaySkipControl(state, i18n);\n            }\n\n            _.bindAll(this, 'play', 'onClick', 'destroy');\n            this.state = state;\n            this.state.videoPlaySkipControl = this;\n            this.i18n = i18n;\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        PlaySkipControl.prototype = {\n            template: [\n                '<button class=\"control video_control play play-skip-control\" title=\"',\n                gettext('Play'),\n                '\">',\n                '<span class=\"icon fa fa-play\" aria-hidden=\"true\"></span>',\n                '</button>'\n            ].join(''),\n\n            destroy: function() {\n                this.el.remove();\n                this.state.el.off('destroy', this.destroy);\n                delete this.state.videoPlaySkipControl;\n            },\n\n        /** Initializes the module. */\n            initialize: function() {\n                this.el = $(this.template);\n                this.render();\n                this.bindHandlers();\n            },\n\n        /**\n         * Creates any necessary DOM elements, attach them, and set their,\n         * initial configuration.\n         */\n            render: function() {\n                this.state.el.find('.vcr').prepend(this.el);\n            },\n\n        /** Bind any necessary function callbacks to DOM events. */\n            bindHandlers: function() {\n                this.el.on('click', this.onClick);\n                this.state.el.on({\n                    play: this.play,\n                    destroy: this.destroy\n                });\n            },\n\n            onClick: function(event) {\n                event.preventDefault();\n                if (this.state.videoPlayer.isPlaying()) {\n                    this.state.videoCommands.execute('skip');\n                } else {\n                    this.state.videoCommands.execute('play');\n                }\n            },\n\n            play: function() {\n                this.el\n                .removeClass('play')\n                .addClass('skip')\n                .attr('title', gettext('Skip'))\n                .find('.icon')\n                    .removeClass('fa-play')\n                    .addClass('fa-step-forward');\n            // Disable possibility to pause the video.\n                this.state.el.find('video').off('click');\n            }\n        };\n\n        return PlaySkipControl;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_play_skip_control.js","\n    'use strict';\n    define('video/09_poster.js', [], function() {\n    /**\n     * Poster module.\n     * @exports video/09_poster.js\n     * @constructor\n     * @param {jquery Element} element\n     * @param {Object} options\n     */\n        var VideoPoster = function(element, options) {\n            if (!(this instanceof VideoPoster)) {\n                return new VideoPoster(element, options);\n            }\n\n            _.bindAll(this, 'onClick', 'destroy');\n            this.element = element;\n            this.container = element.find('.video-player');\n            this.options = options || {};\n            this.initialize();\n        };\n\n        VideoPoster.moduleName = 'Poster';\n        VideoPoster.prototype = {\n            template: _.template([\n                '<div class=\"video-pre-roll is-<%= type %> poster\" ',\n                'style=\"background-image: url(<%= url %>)\">',\n                '<button class=\"btn-play btn-pre-roll\">',\n                '<img src=\"/static/images/play.png\" alt=\"\">',\n                '<span class=\"sr\">', gettext('Play video'), '</span>',\n                '</button>',\n                '</div>'\n            ].join('')),\n\n            initialize: function() {\n                this.el = $(this.template({\n                    url: this.options.poster.url,\n                    type: this.options.poster.type\n                }));\n                this.element.addClass('is-pre-roll');\n                this.render();\n                this.bindHandlers();\n            },\n\n            bindHandlers: function() {\n                this.el.on('click', this.onClick);\n                this.element.on('destroy', this.destroy);\n            },\n\n            render: function() {\n                this.container.append(this.el);\n            },\n\n            onClick: function() {\n                if (_.isFunction(this.options.onClick)) {\n                    this.options.onClick();\n                }\n                this.destroy();\n            },\n\n            destroy: function() {\n                this.element.off('destroy', this.destroy).removeClass('is-pre-roll');\n                this.el.remove();\n            }\n        };\n\n        return VideoPoster;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_poster.js","\n    'use strict';\n    define('video/09_save_state_plugin.js', ['underscore', 'time.js'], function(_, Time) {\n    /**\n     * Save state module.\n     * @exports video/09_save_state_plugin.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @param {Object} options\n     * @return {jquery Promise}\n     */\n        var SaveStatePlugin = function(state, i18n, options) {\n            if (!(this instanceof SaveStatePlugin)) {\n                return new SaveStatePlugin(state, i18n, options);\n            }\n\n            _.bindAll(this, 'onSpeedChange', 'onAutoAdvanceChange', 'saveStateHandler', 'bindUnloadHandler', 'onUnload',\n            'onYoutubeAvailability', 'onLanguageChange', 'destroy');\n            this.state = state;\n            this.options = _.extend({events: []}, options);\n            this.state.videoSaveStatePlugin = this;\n            this.i18n = i18n;\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n\n        SaveStatePlugin.moduleName = 'SaveStatePlugin';\n        SaveStatePlugin.prototype = {\n            destroy: function() {\n                this.state.el.off(this.events).off('destroy', this.destroy);\n                $(window).off('unload', this.onUnload);\n                delete this.state.videoSaveStatePlugin;\n            },\n\n            initialize: function() {\n                this.events = {\n                    speedchange: this.onSpeedChange,\n                    autoadvancechange: this.onAutoAdvanceChange,\n                    play: this.bindUnloadHandler,\n                    'pause destroy': this.saveStateHandler,\n                    'language_menu:change': this.onLanguageChange,\n                    youtube_availability: this.onYoutubeAvailability\n                };\n                this.bindHandlers();\n            },\n\n            bindHandlers: function() {\n                if (this.options.events.length) {\n                    _.each(this.options.events, function(eventName) {\n                        var callback;\n                        if (_.has(this.events, eventName)) {\n                            callback = this.events[eventName];\n                            this.state.el.on(eventName, callback);\n                        }\n                    }, this);\n                } else {\n                    this.state.el.on(this.events);\n                }\n                this.state.el.on('destroy', this.destroy);\n            },\n\n            bindUnloadHandler: _.once(function() {\n                $(window).on('unload.video', this.onUnload);\n            }),\n\n            onSpeedChange: function(event, newSpeed) {\n                this.saveState(true, {speed: newSpeed});\n                this.state.storage.setItem('speed', newSpeed, true);\n                this.state.storage.setItem('general_speed', newSpeed);\n            },\n\n            onAutoAdvanceChange: function(event, enabled) {\n                this.saveState(true, {auto_advance: enabled});\n                this.state.storage.setItem('auto_advance', enabled);\n            },\n\n            saveStateHandler: function() {\n                this.saveState(true);\n            },\n\n            onUnload: function() {\n                this.saveState();\n            },\n\n            onLanguageChange: function(event, langCode) {\n                this.state.storage.setItem('language', langCode);\n            },\n\n            onYoutubeAvailability: function(event, youtubeIsAvailable) {\n            // Compare what the client-side code has determined Youtube\n            // availability to be (true/false) vs. what the LMS recorded for\n            // this user. The LMS will assume YouTube is available by default.\n                if (youtubeIsAvailable !== this.state.config.recordedYoutubeIsAvailable) {\n                    this.saveState(true, {youtube_is_available: youtubeIsAvailable});\n                }\n            },\n\n            saveState: function(async, data) {\n                if (!($.isPlainObject(data))) {\n                    data = {\n                        saved_video_position: this.state.videoPlayer.currentTime\n                    };\n                }\n\n                if (data.speed) {\n                    this.state.storage.setItem('speed', data.speed, true);\n                }\n\n                if (_.has(data, 'saved_video_position')) {\n                    this.state.storage.setItem('savedVideoPosition', data.saved_video_position, true);\n                    data.saved_video_position = Time.formatFull(data.saved_video_position);\n                }\n\n                $.ajax({\n                    url: this.state.config.saveStateUrl,\n                    type: 'POST',\n                    async: !!async,\n                    dataType: 'json',\n                    data: data\n                });\n            }\n        };\n\n        return SaveStatePlugin;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_save_state_plugin.js","\n    'use strict';\n// VideoSkipControl module.\n    define(\n'video/09_skip_control.js', [],\nfunction() {\n    /**\n     * Video skip control module.\n     * @exports video/09_skip_control.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @return {jquery Promise}\n     */\n    var SkipControl = function(state, i18n) {\n        if (!(this instanceof SkipControl)) {\n            return new SkipControl(state, i18n);\n        }\n\n        _.bindAll(this, 'onClick', 'render', 'destroy');\n        this.state = state;\n        this.state.videoSkipControl = this;\n        this.i18n = i18n;\n        this.initialize();\n\n        return $.Deferred().resolve().promise();\n    };\n\n    SkipControl.prototype = {\n        template: [\n            '<button class=\"control video_control skip skip-control\" aria-disabled=\"false\" title=\"',\n            gettext('Do not show again'),\n            '\">',\n            '<span class=\"icon fa fa-step-forward\" aria-hidden=\"true\"></span>',\n            '</button>'\n        ].join(''),\n\n        destroy: function() {\n            this.el.remove();\n            this.state.el.off('.skip');\n            delete this.state.videoSkipControl;\n        },\n\n        /** Initializes the module. */\n        initialize: function() {\n            this.el = $(this.template);\n            this.bindHandlers();\n        },\n\n        /**\n         * Creates any necessary DOM elements, attach them, and set their,\n         * initial configuration.\n         */\n        render: function() {\n            this.state.el.find('.vcr .control').after(this.el);\n        },\n\n        /** Bind any necessary function callbacks to DOM events. */\n        bindHandlers: function() {\n            this.el.on('click', this.onClick);\n            this.state.el.on({\n                'play.skip': _.once(this.render),\n                'destroy.skip': this.destroy\n            });\n        },\n\n        onClick: function(event) {\n            event.preventDefault();\n            this.state.videoCommands.execute('skip', true);\n        }\n    };\n\n    return SkipControl;\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_skip_control.js","\n// VideoCaption module.\n    'use strict';\n\n    define('video/09_video_caption.js', [\n        'video/00_sjson.js',\n        'video/00_async_process.js',\n        'edx-ui-toolkit/js/utils/html-utils',\n        'draggabilly',\n        'time.js',\n        'underscore'\n    ], function(Sjson, AsyncProcess, HtmlUtils, Draggabilly, Time, _) {\n        /**\n         * @desc VideoCaption module exports a function.\n         *\n         * @type {function}\n         * @access public\n         *\n         * @param {object} state - The object containing the state of the video\n         *     player. All other modules, their parameters, public variables, etc.\n         *     are available via this object.\n         *\n         * @this {object} The global window object.\n         *\n         * @returns {jquery Promise}\n         */\n        var VideoCaption = function(state) {\n            if (!(this instanceof VideoCaption)) {\n                return new VideoCaption(state);\n            }\n\n            _.bindAll(this, 'toggle', 'onMouseEnter', 'onMouseLeave', 'onMovement',\n                'onContainerMouseEnter', 'onContainerMouseLeave', 'fetchCaption',\n                'onResize', 'pause', 'play', 'onCaptionUpdate', 'onCaptionHandler', 'destroy',\n                'handleKeypress', 'handleKeypressLink', 'openLanguageMenu', 'closeLanguageMenu',\n                'previousLanguageMenuItem', 'nextLanguageMenuItem', 'handleCaptionToggle',\n                'showClosedCaptions', 'hideClosedCaptions', 'toggleClosedCaptions',\n                'updateCaptioningCookie', 'handleCaptioningCookie', 'handleTranscriptToggle',\n                'listenForDragDrop'\n            );\n            this.state = state;\n            this.state.videoCaption = this;\n            this.renderElements();\n            this.handleCaptioningCookie();\n            this.listenForDragDrop();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        VideoCaption.prototype = {\n\n            destroy: function() {\n                this.state.el\n                    .off({\n                        'caption:fetch': this.fetchCaption,\n                        'caption:resize': this.onResize,\n                        'caption:update': this.onCaptionUpdate,\n                        ended: this.pause,\n                        fullscreen: this.onResize,\n                        pause: this.pause,\n                        play: this.play,\n                        destroy: this.destroy\n                    })\n                    .removeClass('is-captions-rendered');\n                if (this.fetchXHR && this.fetchXHR.abort) {\n                    this.fetchXHR.abort();\n                }\n                if (this.availableTranslationsXHR && this.availableTranslationsXHR.abort) {\n                    this.availableTranslationsXHR.abort();\n                }\n                this.subtitlesEl.remove();\n                this.container.remove();\n                delete this.state.videoCaption;\n            },\n            /**\n            * @desc Initiate rendering of elements, and set their initial configuration.\n            *\n            */\n            renderElements: function() {\n                var languages = this.state.config.transcriptLanguages;\n\n                var langHtml = HtmlUtils.interpolateHtml(\n                    HtmlUtils.HTML(\n                    [\n                        '<div class=\"grouped-controls\">',\n                        '<button class=\"control toggle-captions\" aria-disabled=\"false\">',\n                        '<span class=\"icon fa fa-cc\" aria-hidden=\"true\"></span>',\n                        '</button>',\n                        '<button class=\"control toggle-transcript\" aria-disabled=\"false\">',\n                        '<span class=\"icon fa fa-quote-left\" aria-hidden=\"true\"></span>',\n                        '</button>',\n                        '<div class=\"lang menu-container\" role=\"application\">',\n                        '<p class=\"sr instructions\" id=\"lang-instructions-{courseId}\"></p>',\n                        '<button class=\"control language-menu\" aria-disabled=\"false\"',\n                        'aria-describedby=\"lang-instructions-{courseId}\" ',\n                        'title=\"{langTitle}\">',\n                        '<span class=\"icon fa fa-caret-left\" aria-hidden=\"true\"></span>',\n                        '</button>',\n                        '</div>',\n                        '</div>'\n                    ].join('')),\n                    {\n                        langTitle: gettext('Open language menu'),\n                        courseId: this.state.id\n                    }\n                );\n\n                var subtitlesHtml = HtmlUtils.interpolateHtml(\n                    HtmlUtils.HTML(\n                    [\n                        '<div class=\"subtitles\" role=\"region\" id=\"transcript-{courseId}\">',\n                        '<h3 id=\"transcript-label-{courseId}\" class=\"transcript-title sr\"></h3>',\n                        '<ol id=\"transcript-captions-{courseId}\" class=\"subtitles-menu\" lang=\"{courseLang}\"></ol>',\n                        '</div>'\n                    ].join('')),\n                    {\n                        courseId: this.state.id,\n                        courseLang: this.state.lang\n                    }\n                );\n\n                this.loaded = false;\n                this.subtitlesEl = $(HtmlUtils.ensureHtml(subtitlesHtml).toString());\n                this.subtitlesMenuEl = this.subtitlesEl.find('.subtitles-menu');\n                this.container = $(HtmlUtils.ensureHtml(langHtml).toString());\n                this.captionControlEl = this.container.find('.toggle-captions');\n                this.captionDisplayEl = this.state.el.find('.closed-captions');\n                this.transcriptControlEl = this.container.find('.toggle-transcript');\n                this.languageChooserEl = this.container.find('.lang');\n                this.menuChooserEl = this.languageChooserEl.parent();\n\n                if (_.keys(languages).length) {\n                    this.renderLanguageMenu(languages);\n                    this.fetchCaption();\n                }\n            },\n\n            /**\n            * @desc Bind any necessary function callbacks to DOM events (click,\n            *     mousemove, etc.).\n            *\n            */\n            bindHandlers: function() {\n                var state = this.state,\n                    events = [\n                        'mouseover', 'mouseout', 'mousedown', 'click', 'focus', 'blur',\n                        'keydown'\n                    ].join(' ');\n\n                this.captionControlEl.on({\n                    click: this.toggleClosedCaptions,\n                    keydown: this.handleCaptionToggle\n                });\n                this.transcriptControlEl.on({\n                    click: this.toggle,\n                    keydown: this.handleTranscriptToggle\n                });\n                this.subtitlesMenuEl.on({\n                    mouseenter: this.onMouseEnter,\n                    mouseleave: this.onMouseLeave,\n                    mousemove: this.onMovement,\n                    mousewheel: this.onMovement,\n                    DOMMouseScroll: this.onMovement\n                })\n                .on(events, 'span[data-index]', this.onCaptionHandler);\n                this.container.on({\n                    mouseenter: this.onContainerMouseEnter,\n                    mouseleave: this.onContainerMouseLeave\n                });\n\n                if (this.showLanguageMenu) {\n                    this.languageChooserEl.on({\n                        keydown: this.handleKeypress\n                    }, '.language-menu');\n\n                    this.languageChooserEl.on({\n                        keydown: this.handleKeypressLink\n                    }, '.control-lang');\n                }\n\n                state.el\n                    .on({\n                        'caption:fetch': this.fetchCaption,\n                        'caption:resize': this.onResize,\n                        'caption:update': this.onCaptionUpdate,\n                        ended: this.pause,\n                        fullscreen: this.onResize,\n                        pause: this.pause,\n                        play: this.play,\n                        destroy: this.destroy\n                    });\n\n                if ((state.videoType === 'html5') && (state.config.autohideHtml5)) {\n                    this.subtitlesMenuEl.on('scroll', state.videoControl.showControls);\n                }\n            },\n\n            onCaptionUpdate: function(event, time) {\n                this.updatePlayTime(time);\n            },\n\n            handleCaptionToggle: function(event) {\n                var KEY = $.ui.keyCode,\n                    keyCode = event.keyCode;\n\n                switch (keyCode) {\n                case KEY.SPACE:\n                case KEY.ENTER:\n                    event.preventDefault();\n                    this.toggleClosedCaptions(event);\n                // no default\n                }\n            },\n\n            handleTranscriptToggle: function(event) {\n                var KEY = $.ui.keyCode,\n                    keyCode = event.keyCode;\n\n                switch (keyCode) {\n                case KEY.SPACE:\n                case KEY.ENTER:\n                    event.preventDefault();\n                    this.toggle(event);\n                // no default\n                }\n            },\n\n            handleKeypressLink: function(event) {\n                var KEY = $.ui.keyCode,\n                    keyCode = event.keyCode,\n                    focused, index, total;\n\n                switch (keyCode) {\n                case KEY.UP:\n                    event.preventDefault();\n                    focused = $(':focus').parent();\n                    index = this.languageChooserEl.find('li').index(focused);\n                    total = this.languageChooserEl.find('li').size() - 1;\n\n                    this.previousLanguageMenuItem(event, index);\n                    break;\n\n                case KEY.DOWN:\n                    event.preventDefault();\n                    focused = $(':focus').parent();\n                    index = this.languageChooserEl.find('li').index(focused);\n                    total = this.languageChooserEl.find('li').size() - 1;\n\n                    this.nextLanguageMenuItem(event, index, total);\n                    break;\n\n                case KEY.ESCAPE:\n                    this.closeLanguageMenu(event);\n                    break;\n\n                case KEY.ENTER:\n                case KEY.SPACE:\n                    return true;\n                // no default\n                }\n                return true;\n            },\n\n            handleKeypress: function(event) {\n                var KEY = $.ui.keyCode,\n                    keyCode = event.keyCode;\n\n                switch (keyCode) {\n                    // Handle keypresses\n                case KEY.ENTER:\n                case KEY.SPACE:\n                case KEY.UP:\n                    event.preventDefault();\n                    this.openLanguageMenu(event);\n                    break;\n\n                case KEY.ESCAPE:\n                    this.closeLanguageMenu(event);\n                    break;\n                // no default\n                }\n\n                return event.keyCode === KEY.TAB;\n            },\n\n            nextLanguageMenuItem: function(event, index, total) {\n                event.preventDefault();\n\n                if (event.altKey || event.shiftKey) {\n                    return true;\n                }\n\n                if (index === total) {\n                    this.languageChooserEl\n                        .find('.control-lang').first()\n                            .focus();\n                } else {\n                    this.languageChooserEl\n                        .find('li:eq(' + index + ')')\n                        .next()\n                            .find('.control-lang')\n                                .focus();\n                }\n\n                return false;\n            },\n\n            previousLanguageMenuItem: function(event, index) {\n                event.preventDefault();\n\n                if (event.altKey || event.shiftKey) {\n                    return true;\n                }\n\n                if (index === 0) {\n                    this.languageChooserEl\n                        .find('.control-lang').last()\n                        .focus();\n                } else {\n                    this.languageChooserEl\n                        .find('li:eq(' + index + ')')\n                        .prev()\n                            .find('.control-lang')\n                            .focus();\n                }\n\n                return false;\n            },\n\n            openLanguageMenu: function(event) {\n                var button = this.languageChooserEl,\n                    menu = button.parent().find('.menu');\n\n                event.preventDefault();\n\n                button\n                    .addClass('is-opened');\n\n                menu\n                    .find('.control-lang').last()\n                        .focus();\n            },\n\n            closeLanguageMenu: function(event) {\n                var button = this.languageChooserEl;\n                event.preventDefault();\n\n                button\n                    .removeClass('is-opened')\n                    .find('.language-menu')\n                        .focus();\n            },\n\n            onCaptionHandler: function(event) {\n                switch (event.type) {\n                case 'mouseover':\n                case 'mouseout':\n                    this.captionMouseOverOut(event);\n                    break;\n                case 'mousedown':\n                    this.captionMouseDown(event);\n                    break;\n                case 'click':\n                    this.captionClick(event);\n                    break;\n                case 'focusin':\n                    this.captionFocus(event);\n                    break;\n                case 'focusout':\n                    this.captionBlur(event);\n                    break;\n                case 'keydown':\n                    this.captionKeyDown(event);\n                    break;\n                // no default\n                }\n            },\n\n            /**\n            * @desc Opens language menu.\n            *\n            * @param {jquery Event} event\n            */\n            onContainerMouseEnter: function(event) {\n                event.preventDefault();\n                $(event.currentTarget).find('.lang').addClass('is-opened');\n\n                // We only want to fire the analytics event if a menu is\n                // present instead of on the container hover, since it wraps\n                // the \"CC\" and \"Transcript\" buttons as well.\n                if ($(event.currentTarget).find('.lang').length) {\n                    this.state.el.trigger('language_menu:show');\n                }\n            },\n\n            /**\n            * @desc Closes language menu.\n            *\n            * @param {jquery Event} event\n            */\n            onContainerMouseLeave: function(event) {\n                event.preventDefault();\n                $(event.currentTarget).find('.lang').removeClass('is-opened');\n\n                // We only want to fire the analytics event if a menu is\n                // present instead of on the container hover, since it wraps\n                // the \"CC\" and \"Transcript\" buttons as well.\n                if ($(event.currentTarget).find('.lang').length) {\n                    this.state.el.trigger('language_menu:hide');\n                }\n            },\n\n            /**\n            * @desc Freezes moving of captions when mouse is over them.\n            *\n            * @param {jquery Event} event\n            */\n            onMouseEnter: function() {\n                if (this.frozen) {\n                    clearTimeout(this.frozen);\n                }\n\n                this.frozen = setTimeout(\n                    this.onMouseLeave,\n                    this.state.config.captionsFreezeTime\n                );\n            },\n\n            /**\n            * @desc Unfreezes moving of captions when mouse go out.\n            *\n            * @param {jquery Event} event\n            */\n            onMouseLeave: function() {\n                if (this.frozen) {\n                    clearTimeout(this.frozen);\n                }\n\n                this.frozen = null;\n\n                if (this.playing) {\n                    this.scrollCaption();\n                }\n            },\n\n            /**\n            * @desc Freezes moving of captions when mouse is moving over them.\n            *\n            * @param {jquery Event} event\n            */\n            onMovement: function() {\n                this.onMouseEnter();\n            },\n\n            /**\n             * @desc Gets the correct start and end times from the state configuration\n             *\n             * @returns {array} if [startTime, endTime] are defined\n             */\n            getStartEndTimes: function() {\n                // due to the way config.startTime/endTime are\n                // processed in 03_video_player.js, we assume\n                // endTime can be an integer or null,\n                // and startTime is an integer > 0\n                var config = this.state.config;\n                var startTime = config.startTime * 1000;\n                var endTime = (config.endTime !== null) ? config.endTime * 1000 : null;\n                return [startTime, endTime];\n            },\n\n            /**\n             * @desc Gets captions within the start / end times stored within this.state.config\n             *\n             * @returns {object} {start, captions} parallel arrays of\n             *    start times and corresponding captions\n             */\n            getBoundedCaptions: function() {\n                // get start and caption. If startTime and endTime\n                // are specified, filter by that range.\n                var times = this.getStartEndTimes();\n                var results = this.sjson.filter.apply(this.sjson, times);\n                var start = results.start;\n                var captions = results.captions;\n\n                return {\n                    start: start,\n                    captions: captions\n                };\n            },\n\n            /**\n            * @desc Fetch the caption file specified by the user. Upon successful\n            *     receipt of the file, the captions will be rendered.\n            * @param {boolean} [fetchWithYoutubeId] Fetch youtube captions if true.\n            * @returns {boolean}\n            *     true: The user specified a caption file. NOTE: if an error happens\n            *         while the specified file is being retrieved (for example the\n            *         file is missing on the server), this function will still return\n            *         true.\n            *     false: No caption file was specified, or an empty string was\n            *         specified for the Youtube type player.\n            */\n            fetchCaption: function(fetchWithYoutubeId) {\n                var self = this,\n                    state = this.state,\n                    language = state.getCurrentLanguage(),\n                    url = state.config.transcriptTranslationUrl.replace('__lang__', language),\n                    data, youtubeId;\n\n                if (this.loaded) {\n                    this.hideCaptions(false);\n                }\n\n                if (this.fetchXHR && this.fetchXHR.abort) {\n                    this.fetchXHR.abort();\n                }\n\n                if (state.videoType === 'youtube' || fetchWithYoutubeId) {\n                    try {\n                        youtubeId = state.youtubeId('1.0');\n                    } catch (err) {\n                        youtubeId = null;\n                    }\n\n                    if (!youtubeId) {\n                        return false;\n                    }\n\n                    data = {videoId: youtubeId};\n                }\n\n                state.el.removeClass('is-captions-rendered');\n                // Fetch the captions file. If no file was specified, or if an error\n                // occurred, then we hide the captions panel, and the \"Transcript\" button\n                this.fetchXHR = $.ajaxWithPrefix({\n                    url: url,\n                    notifyOnError: false,\n                    data: data,\n                    success: function(sjson) {\n                        var results, start, captions;\n                        self.sjson = new Sjson(sjson);\n                        results = self.getBoundedCaptions();\n                        start = results.start;\n                        captions = results.captions;\n\n                        if (self.loaded) {\n                            if (self.rendered) {\n                                self.renderCaption(start, captions);\n                                self.updatePlayTime(state.videoPlayer.currentTime);\n                            }\n                        } else {\n                            if (state.isTouch) {\n                                HtmlUtils.setHtml(\n                                    self.subtitlesEl.find('.subtitles-menu'),\n                                    HtmlUtils.joinHtml(\n                                        HtmlUtils.HTML('<li>'),\n                                        gettext('Transcript will be displayed when you start playing the video.'),\n                                        HtmlUtils.HTML('</li>')\n                                    )\n                                );\n                            } else {\n                                self.renderCaption(start, captions);\n                            }\n                            self.hideCaptions(state.hideCaptions, false);\n                            HtmlUtils.append(\n                                self.state.el.find('.video-wrapper').parent(),\n                                HtmlUtils.HTML(self.subtitlesEl)\n                            );\n                            HtmlUtils.append(\n                                self.state.el.find('.secondary-controls'),\n                                HtmlUtils.HTML(self.container)\n                            );\n                            self.bindHandlers();\n                        }\n\n                        self.loaded = true;\n                    },\n                    error: function(jqXHR, textStatus, errorThrown) {\n                        console.log('[Video info]: ERROR while fetching captions.');\n                        console.log(\n                            '[Video info]: STATUS:', textStatus +\n                            ', MESSAGE:', '' + errorThrown\n                        );\n                        // If initial list of languages has more than 1 item, check\n                        // for availability other transcripts.\n                        // If player mode is html5 and there are no initial languages\n                        // then try to fetch youtube version of transcript with\n                        // youtubeId.\n                        if (_.keys(state.config.transcriptLanguages).length > 1) {\n                            self.fetchAvailableTranslations();\n                        } else if (!fetchWithYoutubeId && state.videoType === 'html5') {\n                            console.log('[Video info]: Html5 mode fetching caption with youtubeId.');\n                            self.fetchCaption(true);\n                        } else {\n                            self.hideCaptions(true, false);\n                            self.state.el.find('.lang').hide();\n                            self.state.el.find('.transcript-control').hide();\n                            self.subtitlesEl.hide();\n                        }\n                    }\n                });\n\n                return true;\n            },\n\n            /**\n            * @desc Fetch the list of available language codes. Upon successful receipt\n            * the list of available languages will be updated.\n            *\n            * @returns {jquery Promise}\n            */\n            fetchAvailableTranslations: function() {\n                var self = this,\n                    state = this.state;\n\n                this.availableTranslationsXHR = $.ajaxWithPrefix({\n                    url: state.config.transcriptAvailableTranslationsUrl,\n                    notifyOnError: false,\n                    success: function(response) {\n                        var currentLanguages = state.config.transcriptLanguages,\n                            newLanguages = _.pick(currentLanguages, response);\n\n                        // Update property with available currently translations.\n                        state.config.transcriptLanguages = newLanguages;\n                        // Remove an old language menu.\n                        self.container.find('.langs-list').remove();\n\n                        if (_.keys(newLanguages).length) {\n                            self.renderLanguageMenu(newLanguages);\n                        }\n                    },\n                    error: function() {\n                        self.hideCaptions(true, false);\n                        self.state.el.find('.lang').hide();\n                        self.state.el.find('.transcript-control').hide();\n                        self.subtitlesEl.hide();\n                    }\n                });\n\n                return this.availableTranslationsXHR;\n            },\n\n            /**\n            * @desc Recalculates and updates the height of the container of captions.\n            *\n            */\n            onResize: function() {\n                this.subtitlesEl\n                    .find('.spacing').first()\n                        .height(this.topSpacingHeight());\n\n                this.subtitlesEl\n                    .find('.spacing').last()\n                        .height(this.bottomSpacingHeight());\n\n                this.scrollCaption();\n                this.setSubtitlesHeight();\n            },\n\n            /**\n            * @desc Create any necessary DOM elements, attach them, and set their\n            *     initial configuration for the Language menu.\n            *\n            * @param {object} languages Dictionary where key is language code,\n            *     value - language label\n            *\n            */\n            renderLanguageMenu: function(languages) {\n                var self = this,\n                    state = this.state,\n                    $menu = $('<ol class=\"langs-list menu\">'),\n                    currentLang = state.getCurrentLanguage(),\n                    $li, $link, linkHtml;\n\n                if (_.keys(languages).length < 2) {\n                    // Remove the menu toggle button\n                    self.container.find('.lang').remove();\n                    return;\n                }\n\n                this.showLanguageMenu = true;\n\n                $.each(languages, function(code, label) {\n                    $li = $('<li />', {'data-lang-code': code});\n                    linkHtml = HtmlUtils.joinHtml(\n                        HtmlUtils.HTML('<button class=\"control control-lang\">'),\n                        label,\n                        HtmlUtils.HTML('</button>')\n                    );\n                    $link = $(linkHtml.toString());\n\n                    if (currentLang === code) {\n                        $li.addClass('is-active');\n                        $link.attr('aria-pressed', 'true');\n                    }\n\n                    $li.append($link);\n                    $menu.append($li);\n                });\n\n                HtmlUtils.append(\n                    this.languageChooserEl,\n                    HtmlUtils.HTML($menu)\n                );\n\n                $menu.on('click', '.control-lang', function(e) {\n                    var el = $(e.currentTarget).parent(),\n                        captionState = self.state,\n                        langCode = el.data('lang-code');\n\n                    if (captionState.lang !== langCode) {\n                        captionState.lang = langCode;\n                        el.addClass('is-active')\n                            .siblings('li')\n                            .removeClass('is-active')\n                            .find('.control-lang')\n                            .attr('aria-pressed', 'false');\n\n                        $(e.currentTarget).attr('aria-pressed', 'true');\n\n                        captionState.el.trigger('language_menu:change', [langCode]);\n                        self.fetchCaption();\n\n                        // update the closed-captions lang attribute\n                        self.captionDisplayEl.attr('lang', langCode);\n\n                        // update the transcript lang attribute\n                        self.subtitlesMenuEl.attr('lang', langCode);\n                        self.closeLanguageMenu(e);\n                    }\n                });\n            },\n\n            /**\n            * @desc Create any necessary DOM elements, attach them, and set their\n            *     initial configuration.\n            *\n            * @param {jQuery element} container Element in which captions will be\n            *     inserted.\n            * @param {array} start List of start times for the video.\n            * @param {array} captions List of captions for the video.\n            * @returns {object} jQuery's Promise object\n            *\n            */\n            buildCaptions: function(container, start, captions) {\n                var process = function(text, index) {\n                    var $spanEl = $('<span>', {\n                        role: 'link',\n                        'data-index': index,\n                        'data-start': start[index],\n                        tabindex: 0\n                    });\n\n                    HtmlUtils.setHtml($($spanEl), HtmlUtils.HTML(text.toString()));\n\n                    return $spanEl.wrap('<li>').parent()[0]; // xss-lint: disable=javascript-jquery-insertion\n                };\n\n                return AsyncProcess.array(captions, process).done(function(list) {\n                    HtmlUtils.append(\n                        container,\n                        HtmlUtils.HTML(list)\n                    );\n                });\n            },\n\n            /**\n            * @desc Initiates creating of captions and set their initial configuration.\n            *\n            * @param {array} start List of start times for the video.\n            * @param {array} captions List of captions for the video.\n            *\n            */\n            renderCaption: function(start, captions) {\n                var self = this;\n\n                var onRender = function() {\n                    self.addPaddings();\n                    // Enables or disables automatic scrolling of the captions when the\n                    // video is playing. This feature has to be disabled when tabbing\n                    // through them as it interferes with that action. Initially, have\n                    // this flag enabled as we assume mouse use. Then, if the first\n                    // caption (through forward tabbing) or the last caption (through\n                    // backwards tabbing) gets the focus, disable that feature.\n                    // Re-enable it if tabbing then cycles out of the the captions.\n                    self.autoScrolling = true;\n                    // Keeps track of where the focus is situated in the array of\n                    // captions. Used to implement the automatic scrolling behavior and\n                    // decide if the outline around a caption has to be hidden or shown\n                    // on a mouseenter or mouseleave. Initially, no caption has the\n                    // focus, set the index to -1.\n                    self.currentCaptionIndex = -1;\n                    // Used to track if the focus is coming from a click or tabbing. This\n                    // has to be known to decide if, when a caption gets the focus, an\n                    // outline has to be drawn (tabbing) or not (mouse click).\n                    self.isMouseFocus = false;\n                    self.rendered = true;\n                    self.state.el.addClass('is-captions-rendered');\n\n                    self.subtitlesEl\n                        .attr('aria-label', gettext('Activating a link in this group will skip to the corresponding point in the video.'));  // eslint-disable-line max-len\n\n                    self.subtitlesEl.find('.transcript-title')\n                        .text(gettext('Video transcript'));\n\n                    self.subtitlesEl.find('.transcript-start')\n                        .text(gettext('Start of transcript. Skip to the end.'))\n                        .attr('lang', $('html').attr('lang'));\n\n                    self.subtitlesEl.find('.transcript-end')\n                        .text(gettext('End of transcript. Skip to the start.'))\n                        .attr('lang', $('html').attr('lang'));\n\n                    self.container.find('.menu-container .instructions')\n                        .text(gettext('Press the UP arrow key to enter the language menu then use UP and DOWN arrow keys to navigate language options. Press ENTER to change to the selected language.'));  // eslint-disable-line max-len\n                };\n\n                this.rendered = false;\n                this.subtitlesMenuEl.empty();\n                this.setSubtitlesHeight();\n                this.buildCaptions(this.subtitlesMenuEl, start, captions).done(onRender);\n            },\n\n            /**\n            * @desc Sets top and bottom spacing height and make sure they are taken\n            *     out of the tabbing order.\n            *\n            */\n            addPaddings: function() {\n                var topSpacer = HtmlUtils.interpolateHtml(\n                        HtmlUtils.HTML([\n                            '<li class=\"spacing\" style=\"height: {height}px\">',\n                                '<a href=\"#transcript-end-{id}\" id=\"transcript-start-{id}\" class=\"transcript-start\"></a>',  // eslint-disable-line max-len, indent\n                            '</li>'\n                        ].join('')),\n                    {\n                        id: this.state.id,\n                        height: this.topSpacingHeight()\n                    }\n                    );\n\n                var bottomSpacer = HtmlUtils.interpolateHtml(\n                        HtmlUtils.HTML([\n                            '<li class=\"spacing\" style=\"height: {height}px\">',\n                                '<a href=\"#transcript-start-{id}\" id=\"transcript-end-{id}\" class=\"transcript-end\"></a>',  // eslint-disable-line max-len, indent\n                            '</li>'\n                        ].join('')),\n                    {\n                        id: this.state.id,\n                        height: this.bottomSpacingHeight()\n                    }\n                    );\n\n                HtmlUtils.prepend(\n                    this.subtitlesMenuEl,\n                    topSpacer\n                );\n\n                HtmlUtils.append(\n                    this.subtitlesMenuEl,\n                    bottomSpacer\n                );\n            },\n\n            /**\n            * @desc\n            * On mouseOver: Hides the outline of a caption that has been tabbed to.\n            * On mouseOut: Shows the outline of a caption that has been tabbed to.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            captionMouseOverOut: function(event) {\n                var $caption = $(event.target),\n                    captionIndex = parseInt($caption.attr('data-index'), 10);\n\n                if (captionIndex === this.currentCaptionIndex) {\n                    if (event.type === 'mouseover') {\n                        $caption.removeClass('focused');\n                    } else { // mouseout\n                        $caption.addClass('focused');\n                    }\n                }\n            },\n\n            /**\n            * @desc Handles mousedown event on concrete caption.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            captionMouseDown: function(event) {\n                var $caption = $(event.target);\n\n                this.isMouseFocus = true;\n                this.autoScrolling = true;\n                $caption.removeClass('focused');\n                this.currentCaptionIndex = -1;\n            },\n\n            /**\n            * @desc Handles click event on concrete caption.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            captionClick: function(event) {\n                this.seekPlayer(event);\n            },\n\n            /**\n            * @desc Handles focus event on concrete caption.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            captionFocus: function(event) {\n                var $caption = $(event.target),\n                    container = $caption.parent(),\n                    captionIndex = parseInt($caption.attr('data-index'), 10);\n                // If the focus comes from a mouse click, hide the outline, turn on\n                // automatic scrolling and set currentCaptionIndex to point outside of\n                // caption list (ie -1) to disable mouseenter, mouseleave behavior.\n                if (this.isMouseFocus) {\n                    this.autoScrolling = true;\n                    container.removeClass('focused');\n                    this.currentCaptionIndex = -1;\n                } else {\n                    // If the focus comes from tabbing, show the outline and turn off\n                    // automatic scrolling.\n\n                    this.currentCaptionIndex = captionIndex;\n                    container.addClass('focused');\n                    // The second and second to last elements turn automatic scrolling\n                    // off again as it may have been enabled in captionBlur.\n                    if (\n                        captionIndex <= 1 ||\n                        captionIndex >= this.sjson.getSize() - 2\n                    ) {\n                        this.autoScrolling = false;\n                    }\n                }\n            },\n\n            /**\n            * @desc Handles blur event on concrete caption.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            captionBlur: function(event) {\n                var $caption = $(event.target),\n                    container = $caption.parent(),\n                    captionIndex = parseInt($caption.attr('data-index'), 10);\n\n                container.removeClass('focused');\n                // If we are on first or last index, we have to turn automatic scroll\n                // on again when losing focus. There is no way to know in what\n                // direction we are tabbing. So we could be on the first element and\n                // tabbing back out of the captions or on the last element and tabbing\n                // forward out of the captions.\n                if (captionIndex === 0 ||\n                    captionIndex === this.sjson.getSize() - 1) {\n                    this.autoScrolling = true;\n                }\n            },\n\n            /**\n            * @desc Handles keydown event on concrete caption.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            captionKeyDown: function(event) {\n                this.isMouseFocus = false;\n                if (event.which === 13) { // Enter key\n                    this.seekPlayer(event);\n                }\n            },\n\n            /**\n            * @desc Scrolls caption container to make active caption visible.\n            *\n            */\n            scrollCaption: function() {\n                var el = this.subtitlesEl.find('.current:first');\n\n                // Automatic scrolling gets disabled if one of the captions has\n                // received focus through tabbing.\n                if (\n                    !this.frozen &&\n                    el.length &&\n                    this.autoScrolling\n                ) {\n                    this.subtitlesEl.scrollTo(\n                        el,\n                        {\n                            offset: -1 * this.calculateOffset(el)\n                        }\n                    );\n                }\n            },\n\n            /**\n            * @desc Updates flags on play\n            *\n            */\n            play: function() {\n                var captions, startAndCaptions, start;\n                if (this.loaded) {\n                    if (!this.rendered) {\n                        startAndCaptions = this.getBoundedCaptions();\n                        start = startAndCaptions.start;\n                        captions = startAndCaptions.captions;\n                        this.renderCaption(start, captions);\n                    }\n\n                    this.playing = true;\n                }\n            },\n\n            /**\n            * @desc Updates flags on pause\n            *\n            */\n            pause: function() {\n                if (this.loaded) {\n                    this.playing = false;\n                }\n            },\n\n            /**\n            * @desc Updates captions UI on paying.\n            *\n            * @param {number} time Time in seconds.\n            *\n            */\n            updatePlayTime: function(time) {\n                var state = this.state,\n                    params, newIndex, times;\n\n                if (this.loaded) {\n                    if (state.isFlashMode()) {\n                        time = Time.convert(time, state.speed, '1.0');\n                    }\n\n                    time = Math.round(time * 1000 + 100);\n                    times = this.getStartEndTimes();\n                    // if start and end times are defined, limit search.\n                    // else, use the entire list of video captions\n                    params = [time].concat(times);\n                    newIndex = this.sjson.search.apply(this.sjson, params);\n\n                    if (\n                        typeof newIndex !== 'undefined' &&\n                        newIndex !== -1 &&\n                        this.currentIndex !== newIndex\n                    ) {\n                        if (typeof this.currentIndex !== 'undefined') {\n                            this.subtitlesEl\n                                .find('li.current')\n                                .removeClass('current');\n                        }\n\n                        this.subtitlesEl\n                            .find(\"span[data-index='\" + newIndex + \"']\")\n                            .parent()\n                            .addClass('current');\n\n                        this.currentIndex = newIndex;\n                        this.captionDisplayEl.text(this.subtitlesEl.find(\"span[data-index='\" + newIndex + \"']\").text());\n                        this.scrollCaption();\n                    }\n                }\n            },\n\n            /**\n            * @desc Sends log to the server on caption seek.\n            *\n            * @param {jquery Event} event\n            *\n            */\n            seekPlayer: function(event) {\n                var state = this.state,\n                    time = parseInt($(event.target).data('start'), 10);\n\n                if (state.isFlashMode()) {\n                    time = Math.round(Time.convert(time, '1.0', state.speed));\n                }\n\n                state.trigger(\n                    'videoPlayer.onCaptionSeek',\n                    {\n                        type: 'onCaptionSeek',\n                        time: time / 1000\n                    }\n                );\n\n                event.preventDefault();\n            },\n\n            /**\n            * @desc Calculates offset for paddings.\n            *\n            * @param {jquery element} element Top or bottom padding element.\n            * @returns {number} Offset for the passed padding element.\n            *\n            */\n            calculateOffset: function(element) {\n                return this.captionHeight() / 2 - element.height() / 2;\n            },\n\n            /**\n            * @desc Calculates offset for the top padding element.\n            *\n            * @returns {number} Offset for the passed top padding element.\n            *\n            */\n            topSpacingHeight: function() {\n                return this.calculateOffset(\n                    this.subtitlesEl.find('li:not(.spacing)').first()\n                );\n            },\n\n            /**\n            * @desc Calculates offset for the bottom padding element.\n            *\n            * @returns {number} Offset for the passed bottom padding element.\n            *\n            */\n            bottomSpacingHeight: function() {\n                return this.calculateOffset(\n                    this.subtitlesEl.find('li:not(.spacing)').last()\n                );\n            },\n\n            /**\n            * @desc Shows/Hides transcript on click `transcript` button\n            *\n            * @param {jquery Event} event\n            *\n            */\n            toggle: function(event) {\n                event.preventDefault();\n\n                if (this.state.el.hasClass('closed')) {\n                    this.hideCaptions(false, true, true);\n                } else {\n                    this.hideCaptions(true, true, true);\n                }\n            },\n\n            handleCaptioningCookie: function() {\n                if ($.cookie('show_closed_captions') === 'true') {\n                    this.state.showClosedCaptions = true;\n                    this.showClosedCaptions();\n\n                    // keep it going until turned off\n                    $.cookie('show_closed_captions', 'true', {\n                        expires: 3650,\n                        path: '/'\n                    });\n                } else {\n                    this.hideClosedCaptions();\n                }\n            },\n\n            toggleClosedCaptions: function(event) {\n                event.preventDefault();\n\n                if (this.state.el.hasClass('has-captions')) {\n                    this.state.showClosedCaptions = false;\n                    this.updateCaptioningCookie(false);\n                    this.hideClosedCaptions();\n                } else {\n                    this.state.showClosedCaptions = true;\n                    this.updateCaptioningCookie(true);\n                    this.showClosedCaptions();\n                }\n            },\n\n            showClosedCaptions: function() {\n                this.state.el.addClass('has-captions');\n\n                this.captionDisplayEl\n                    .show()\n                    .addClass('is-visible')\n                    .attr('lang', this.state.lang);\n\n                this.captionControlEl\n                    .addClass('is-active')\n                    .attr('title', gettext('Hide closed captions'));\n\n                if (this.subtitlesEl.find('.current').text()) {\n                    this.captionDisplayEl\n                        .text(this.subtitlesEl.find('.current').text());\n                } else {\n                    this.captionDisplayEl\n                        .text(gettext('(Caption will be displayed when you start playing the video.)'));\n                }\n\n                this.state.el.trigger('captions:show');\n            },\n\n            hideClosedCaptions: function() {\n                this.state.el.removeClass('has-captions');\n\n                this.captionDisplayEl\n                    .hide()\n                    .removeClass('is-visible');\n\n                this.captionControlEl\n                    .removeClass('is-active')\n                    .attr('title', gettext('Turn on closed captioning'));\n\n                this.state.el.trigger('captions:hide');\n            },\n\n            updateCaptioningCookie: function(method) {\n                if (method) {\n                    $.cookie('show_closed_captions', 'true', {\n                        expires: 3650,\n                        path: '/'\n                    });\n                } else {\n                    $.cookie('show_closed_captions', null, {\n                        path: '/'\n                    });\n                }\n            },\n\n            listenForDragDrop: function() {\n                var captions = document.querySelector('.closed-captions');\n\n                if (typeof Draggabilly === 'function') {\n                    new Draggabilly(captions, {containment: true});\n                } else {\n                    console.log('Closed captioning available but not draggable');\n                }\n            },\n\n            /**\n            * @desc Shows/Hides captions and updates the cookie.\n            *\n            * @param {boolean} hideCaptions if `true` hides the caption,\n            *     otherwise - show.\n            * @param {boolean} updateCookie Flag to update or not the cookie.\n            *\n            */\n            hideCaptions: function(hideCaptions, updateCookie, triggerEvent) {\n                var transcriptControlEl = this.transcriptControlEl,\n                    state = this.state,\n                    text;\n\n                if (typeof updateCookie === 'undefined') {\n                    updateCookie = true;\n                }\n\n                if (hideCaptions) {\n                    state.captionsHidden = true;\n                    state.el.addClass('closed');\n                    text = gettext('Turn on transcripts');\n                    if (triggerEvent) {\n                        this.state.el.trigger('transcript:hide');\n                    }\n\n                    transcriptControlEl\n                        .removeClass('is-active')\n                        .attr('title', gettext(text));\n                } else {\n                    state.captionsHidden = false;\n                    state.el.removeClass('closed');\n                    this.scrollCaption();\n                    text = gettext('Turn off transcripts');\n                    if (triggerEvent) {\n                        this.state.el.trigger('transcript:show');\n                    }\n\n                    transcriptControlEl\n                        .addClass('is-active')\n                        .attr('title', gettext(text));\n                }\n\n                if (state.resizer) {\n                    if (state.isFullScreen) {\n                        state.resizer.setMode('both');\n                    } else {\n                        state.resizer.alignByWidthOnly();\n                    }\n                }\n\n                this.setSubtitlesHeight();\n                if (updateCookie) {\n                    $.cookie('hideCaptions', hideCaptions, {\n                        expires: 3650,\n                        path: '/'\n                    });\n                }\n            },\n\n            /**\n            * @desc Return the caption container height.\n            *\n            * @returns {number} event Height of the container in pixels.\n            *\n            */\n            captionHeight: function() {\n                var state = this.state;\n                if (state.isFullScreen) {\n                    return state.container.height() - state.videoFullScreen.height;\n                } else {\n                    return state.container.height();\n                }\n            },\n\n            /**\n            * @desc Sets the height of the caption container element.\n            *\n            */\n            setSubtitlesHeight: function() {\n                var height = 0,\n                    state = this.state;\n                // on page load captionHidden = undefined\n                if ((state.captionsHidden === undefined && state.hideCaptions) ||\n                    state.captionsHidden === true\n                ) {\n                    // In case of html5 autoshowing subtitles, we adjust height of\n                    // subs, by height of scrollbar.\n                    height = state.el.find('.video-controls').height() +\n                        0.5 * state.el.find('.slider').height();\n                    // Height of videoControl does not contain height of slider.\n                    // css is set to absolute, to avoid yanking when slider\n                    // autochanges its height.\n                }\n\n                this.subtitlesEl.css({\n                    maxHeight: this.captionHeight() - height\n                });\n            }\n        };\n\n        return VideoCaption;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/09_video_caption.js","\n    'use strict';\n    define('video/10_commands.js', [], function() {\n        var VideoCommands, Command, playCommand, pauseCommand, togglePlaybackCommand,\n            toggleMuteCommand, toggleFullScreenCommand, setSpeedCommand, skipCommand;\n    /**\n     * Video commands module.\n     * @exports video/10_commands.js\n     * @constructor\n     * @param {Object} state The object containing the state of the video\n     * @param {Object} i18n The object containing strings with translations.\n     * @return {jquery Promise}\n     */\n        VideoCommands = function(state, i18n) {\n            if (!(this instanceof VideoCommands)) {\n                return new VideoCommands(state, i18n);\n            }\n\n            _.bindAll(this, 'destroy');\n            this.state = state;\n            this.state.videoCommands = this;\n            this.i18n = i18n;\n            this.commands = [];\n            this.initialize();\n\n            return $.Deferred().resolve().promise();\n        };\n\n        VideoCommands.prototype = {\n            destroy: function() {\n                this.state.el.off('destroy', this.destroy);\n                delete this.state.videoCommands;\n            },\n\n        /** Initializes the module. */\n            initialize: function() {\n                this.commands = this.getCommands();\n                this.state.el.on('destroy', this.destroy);\n            },\n\n            execute: function(command) {\n                var args = [].slice.call(arguments, 1) || [];\n\n                if (_.has(this.commands, command)) {\n                    this.commands[command].execute.apply(this, [this.state].concat(args));\n                } else {\n                    console.log('Command \"' + command + '\" is not available.');\n                }\n            },\n\n            getCommands: function() {\n                var commands = {},\n                    commandsList = [\n                        playCommand, pauseCommand, togglePlaybackCommand,\n                        toggleMuteCommand, toggleFullScreenCommand, setSpeedCommand,\n                        skipCommand\n                    ];\n\n                _.each(commandsList, function(command) {\n                    commands[command.name] = command;\n                }, this);\n\n                return commands;\n            }\n        };\n\n        Command = function(name, execute) {\n            this.name = name;\n            this.execute = execute;\n        };\n\n        playCommand = new Command('play', function(state) {\n            state.videoPlayer.play();\n        });\n\n        pauseCommand = new Command('pause', function(state) {\n            state.videoPlayer.pause();\n        });\n\n        togglePlaybackCommand = new Command('togglePlayback', function(state) {\n            if (state.videoPlayer.isPlaying()) {\n                pauseCommand.execute(state);\n            } else {\n                playCommand.execute(state);\n            }\n        });\n\n        toggleMuteCommand = new Command('toggleMute', function(state) {\n            state.videoVolumeControl.toggleMute();\n        });\n\n        toggleFullScreenCommand = new Command('toggleFullScreen', function(state) {\n            state.videoFullScreen.toggle();\n        });\n\n        setSpeedCommand = new Command('speed', function(state, speed) {\n            state.videoSpeedControl.setSpeed(state.speedToString(speed));\n        });\n\n        skipCommand = new Command('skip', function(state, doNotShowAgain) {\n            if (doNotShowAgain) {\n                state.videoBumper.skipAndDoNotShowAgain();\n            } else {\n                state.videoBumper.skip();\n            }\n        });\n\n        return VideoCommands;\n    });\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/lib/xmodule/xmodule/js/src/video/10_commands.js","/*!\n * Draggabilly PACKAGED v1.2.4\n * Make that shiz draggable\n * http://draggabilly.desandro.com\n * MIT license\n */\n\n/**\n * Bridget makes jQuery widgets\n * v1.1.0\n * MIT license\n */\n\n( function( window ) {\n\n\n\n// -------------------------- utils -------------------------- //\n\nvar slice = Array.prototype.slice;\n\nfunction noop() {}\n\n// -------------------------- definition -------------------------- //\n\nfunction defineBridget( $ ) {\n\n// bail if no jQuery\nif ( !$ ) {\n  return;\n}\n\n// -------------------------- addOptionMethod -------------------------- //\n\n/**\n * adds option method -> $().plugin('option', {...})\n * @param {Function} PluginClass - constructor class\n */\nfunction addOptionMethod( PluginClass ) {\n  // don't overwrite original option method\n  if ( PluginClass.prototype.option ) {\n    return;\n  }\n\n  // option setter\n  PluginClass.prototype.option = function( opts ) {\n    // bail out if not an object\n    if ( !$.isPlainObject( opts ) ){\n      return;\n    }\n    this.options = $.extend( true, this.options, opts );\n  };\n}\n\n// -------------------------- plugin bridge -------------------------- //\n\n// helper function for logging errors\n// $.error breaks jQuery chaining\nvar logError = typeof console === 'undefined' ? noop :\n  function( message ) {\n    console.error( message );\n  };\n\n/**\n * jQuery plugin bridge, access methods like $elem.plugin('method')\n * @param {String} namespace - plugin name\n * @param {Function} PluginClass - constructor class\n */\nfunction bridge( namespace, PluginClass ) {\n  // add to jQuery fn namespace\n  $.fn[ namespace ] = function( options ) {\n    if ( typeof options === 'string' ) {\n      // call plugin method when first argument is a string\n      // get arguments for method\n      var args = slice.call( arguments, 1 );\n\n      for ( var i=0, len = this.length; i < len; i++ ) {\n        var elem = this[i];\n        var instance = $.data( elem, namespace );\n        if ( !instance ) {\n          logError( \"cannot call methods on \" + namespace + \" prior to initialization; \" +\n            \"attempted to call '\" + options + \"'\" );\n          continue;\n        }\n        if ( !$.isFunction( instance[options] ) || options.charAt(0) === '_' ) {\n          logError( \"no such method '\" + options + \"' for \" + namespace + \" instance\" );\n          continue;\n        }\n\n        // trigger method with arguments\n        var returnValue = instance[ options ].apply( instance, args );\n\n        // break look and return first value if provided\n        if ( returnValue !== undefined ) {\n          return returnValue;\n        }\n      }\n      // return this if no return value\n      return this;\n    } else {\n      return this.each( function() {\n        var instance = $.data( this, namespace );\n        if ( instance ) {\n          // apply options & init\n          instance.option( options );\n          instance._init();\n        } else {\n          // initialize new instance\n          instance = new PluginClass( this, options );\n          $.data( this, namespace, instance );\n        }\n      });\n    }\n  };\n\n}\n\n// -------------------------- bridget -------------------------- //\n\n/**\n * converts a Prototypical class into a proper jQuery plugin\n *   the class must have a ._init method\n * @param {String} namespace - plugin name, used in $().pluginName\n * @param {Function} PluginClass - constructor class\n */\n$.bridget = function( namespace, PluginClass ) {\n  addOptionMethod( PluginClass );\n  bridge( namespace, PluginClass );\n};\n\nreturn $.bridget;\n\n}\n\n// transport\nif ( typeof define === 'function' && define.amd ) {\n  // AMD\n  define( 'jquery-bridget/jquery.bridget',[ 'jquery' ], defineBridget );\n} else if ( typeof exports === 'object' ) {\n  defineBridget( require('jquery') );\n} else {\n  // get jquery from browser global\n  defineBridget( window.jQuery );\n}\n\n})( window );\n\n/*!\n * classie v1.0.1\n * class helper functions\n * from bonzo https://github.com/ded/bonzo\n * MIT license\n * \n * classie.has( elem, 'my-class' ) -> true/false\n * classie.add( elem, 'my-new-class' )\n * classie.remove( elem, 'my-unwanted-class' )\n * classie.toggle( elem, 'my-class' )\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n/*global define: false, module: false */\n\n( function( window ) {\n\n\n\n// class helper functions from bonzo https://github.com/ded/bonzo\n\nfunction classReg( className ) {\n  return new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\");\n}\n\n// classList support for class management\n// altho to be fair, the api sucks because it won't accept multiple classes at once\nvar hasClass, addClass, removeClass;\n\nif ( 'classList' in document.documentElement ) {\n  hasClass = function( elem, c ) {\n    return elem.classList.contains( c );\n  };\n  addClass = function( elem, c ) {\n    elem.classList.add( c );\n  };\n  removeClass = function( elem, c ) {\n    elem.classList.remove( c );\n  };\n}\nelse {\n  hasClass = function( elem, c ) {\n    return classReg( c ).test( elem.className );\n  };\n  addClass = function( elem, c ) {\n    if ( !hasClass( elem, c ) ) {\n      elem.className = elem.className + ' ' + c;\n    }\n  };\n  removeClass = function( elem, c ) {\n    elem.className = elem.className.replace( classReg( c ), ' ' );\n  };\n}\n\nfunction toggleClass( elem, c ) {\n  var fn = hasClass( elem, c ) ? removeClass : addClass;\n  fn( elem, c );\n}\n\nvar classie = {\n  // full names\n  hasClass: hasClass,\n  addClass: addClass,\n  removeClass: removeClass,\n  toggleClass: toggleClass,\n  // short names\n  has: hasClass,\n  add: addClass,\n  remove: removeClass,\n  toggle: toggleClass\n};\n\n// transport\nif ( typeof define === 'function' && define.amd ) {\n  // AMD\n  define( 'classie/classie',classie );\n} else if ( typeof exports === 'object' ) {\n  // CommonJS\n  module.exports = classie;\n} else {\n  // browser global\n  window.classie = classie;\n}\n\n})( window );\n\n/*!\n * getStyleProperty v1.0.4\n * original by kangax\n * http://perfectionkills.com/feature-testing-css-properties/\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true */\n/*global define: false, exports: false, module: false */\n\n( function( window ) {\n\n\n\nvar prefixes = 'Webkit Moz ms Ms O'.split(' ');\nvar docElemStyle = document.documentElement.style;\n\nfunction getStyleProperty( propName ) {\n  if ( !propName ) {\n    return;\n  }\n\n  // test standard property first\n  if ( typeof docElemStyle[ propName ] === 'string' ) {\n    return propName;\n  }\n\n  // capitalize\n  propName = propName.charAt(0).toUpperCase() + propName.slice(1);\n\n  // test vendor specific properties\n  var prefixed;\n  for ( var i=0, len = prefixes.length; i < len; i++ ) {\n    prefixed = prefixes[i] + propName;\n    if ( typeof docElemStyle[ prefixed ] === 'string' ) {\n      return prefixed;\n    }\n  }\n}\n\n// transport\nif ( typeof define === 'function' && define.amd ) {\n  // AMD\n  define( 'get-style-property/get-style-property',[],function() {\n    return getStyleProperty;\n  });\n} else if ( typeof exports === 'object' ) {\n  // CommonJS for Component\n  module.exports = getStyleProperty;\n} else {\n  // browser global\n  window.getStyleProperty = getStyleProperty;\n}\n\n})( window );\n\n/*!\n * getSize v1.2.2\n * measure size of elements\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n/*global define: false, exports: false, require: false, module: false, console: false */\n\n( function( window, undefined ) {\n\n\n\n// -------------------------- helpers -------------------------- //\n\n// get a number from a string, not a percentage\nfunction getStyleSize( value ) {\n  var num = parseFloat( value );\n  // not a percent like '100%', and a number\n  var isValid = value.indexOf('%') === -1 && !isNaN( num );\n  return isValid && num;\n}\n\nfunction noop() {}\n\nvar logError = typeof console === 'undefined' ? noop :\n  function( message ) {\n    console.error( message );\n  };\n\n// -------------------------- measurements -------------------------- //\n\nvar measurements = [\n  'paddingLeft',\n  'paddingRight',\n  'paddingTop',\n  'paddingBottom',\n  'marginLeft',\n  'marginRight',\n  'marginTop',\n  'marginBottom',\n  'borderLeftWidth',\n  'borderRightWidth',\n  'borderTopWidth',\n  'borderBottomWidth'\n];\n\nfunction getZeroSize() {\n  var size = {\n    width: 0,\n    height: 0,\n    innerWidth: 0,\n    innerHeight: 0,\n    outerWidth: 0,\n    outerHeight: 0\n  };\n  for ( var i=0, len = measurements.length; i < len; i++ ) {\n    var measurement = measurements[i];\n    size[ measurement ] = 0;\n  }\n  return size;\n}\n\n\n\nfunction defineGetSize( getStyleProperty ) {\n\n// -------------------------- setup -------------------------- //\n\nvar isSetup = false;\n\nvar getStyle, boxSizingProp, isBoxSizeOuter;\n\n/**\n * setup vars and functions\n * do it on initial getSize(), rather than on script load\n * For Firefox bug https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n */\nfunction setup() {\n  // setup once\n  if ( isSetup ) {\n    return;\n  }\n  isSetup = true;\n\n  var getComputedStyle = window.getComputedStyle;\n  getStyle = ( function() {\n    var getStyleFn = getComputedStyle ?\n      function( elem ) {\n        return getComputedStyle( elem, null );\n      } :\n      function( elem ) {\n        return elem.currentStyle;\n      };\n\n      return function getStyle( elem ) {\n        var style = getStyleFn( elem );\n        if ( !style ) {\n          logError( 'Style returned ' + style +\n            '. Are you running this code in a hidden iframe on Firefox? ' +\n            'See http://bit.ly/getsizebug1' );\n        }\n        return style;\n      };\n  })();\n\n  // -------------------------- box sizing -------------------------- //\n\n  boxSizingProp = getStyleProperty('boxSizing');\n\n  /**\n   * WebKit measures the outer-width on style.width on border-box elems\n   * IE & Firefox measures the inner-width\n   */\n  if ( boxSizingProp ) {\n    var div = document.createElement('div');\n    div.style.width = '200px';\n    div.style.padding = '1px 2px 3px 4px';\n    div.style.borderStyle = 'solid';\n    div.style.borderWidth = '1px 2px 3px 4px';\n    div.style[ boxSizingProp ] = 'border-box';\n\n    var body = document.body || document.documentElement;\n    body.appendChild( div );\n    var style = getStyle( div );\n\n    isBoxSizeOuter = getStyleSize( style.width ) === 200;\n    body.removeChild( div );\n  }\n\n}\n\n// -------------------------- getSize -------------------------- //\n\nfunction getSize( elem ) {\n  setup();\n\n  // use querySeletor if elem is string\n  if ( typeof elem === 'string' ) {\n    elem = document.querySelector( elem );\n  }\n\n  // do not proceed on non-objects\n  if ( !elem || typeof elem !== 'object' || !elem.nodeType ) {\n    return;\n  }\n\n  var style = getStyle( elem );\n\n  // if hidden, everything is 0\n  if ( style.display === 'none' ) {\n    return getZeroSize();\n  }\n\n  var size = {};\n  size.width = elem.offsetWidth;\n  size.height = elem.offsetHeight;\n\n  var isBorderBox = size.isBorderBox = !!( boxSizingProp &&\n    style[ boxSizingProp ] && style[ boxSizingProp ] === 'border-box' );\n\n  // get all measurements\n  for ( var i=0, len = measurements.length; i < len; i++ ) {\n    var measurement = measurements[i];\n    var value = style[ measurement ];\n    value = mungeNonPixel( elem, value );\n    var num = parseFloat( value );\n    // any 'auto', 'medium' value will be 0\n    size[ measurement ] = !isNaN( num ) ? num : 0;\n  }\n\n  var paddingWidth = size.paddingLeft + size.paddingRight;\n  var paddingHeight = size.paddingTop + size.paddingBottom;\n  var marginWidth = size.marginLeft + size.marginRight;\n  var marginHeight = size.marginTop + size.marginBottom;\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\n\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\n\n  // overwrite width and height if we can get it from style\n  var styleWidth = getStyleSize( style.width );\n  if ( styleWidth !== false ) {\n    size.width = styleWidth +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\n  }\n\n  var styleHeight = getStyleSize( style.height );\n  if ( styleHeight !== false ) {\n    size.height = styleHeight +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\n  }\n\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\n\n  size.outerWidth = size.width + marginWidth;\n  size.outerHeight = size.height + marginHeight;\n\n  return size;\n}\n\n// IE8 returns percent values, not pixels\n// taken from jQuery's curCSS\nfunction mungeNonPixel( elem, value ) {\n  // IE8 and has percent value\n  if ( window.getComputedStyle || value.indexOf('%') === -1 ) {\n    return value;\n  }\n  var style = elem.style;\n  // Remember the original values\n  var left = style.left;\n  var rs = elem.runtimeStyle;\n  var rsLeft = rs && rs.left;\n\n  // Put in the new values to get a computed value out\n  if ( rsLeft ) {\n    rs.left = elem.currentStyle.left;\n  }\n  style.left = value;\n  value = style.pixelLeft;\n\n  // Revert the changed values\n  style.left = left;\n  if ( rsLeft ) {\n    rs.left = rsLeft;\n  }\n\n  return value;\n}\n\nreturn getSize;\n\n}\n\n// transport\nif ( typeof define === 'function' && define.amd ) {\n  // AMD for RequireJS\n  define( 'get-size/get-size',[ 'get-style-property/get-style-property' ], defineGetSize );\n} else if ( typeof exports === 'object' ) {\n  // CommonJS for Component\n  module.exports = defineGetSize( require('desandro-get-style-property') );\n} else {\n  // browser global\n  window.getSize = defineGetSize( window.getStyleProperty );\n}\n\n})( window );\n\n/*!\n * eventie v1.0.6\n * event binding helper\n *   eventie.bind( elem, 'click', myFn )\n *   eventie.unbind( elem, 'click', myFn )\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true */\n/*global define: false, module: false */\n\n( function( window ) {\n\n\n\nvar docElem = document.documentElement;\n\nvar bind = function() {};\n\nfunction getIEEvent( obj ) {\n  var event = window.event;\n  // add event.target\n  event.target = event.target || event.srcElement || obj;\n  return event;\n}\n\nif ( docElem.addEventListener ) {\n  bind = function( obj, type, fn ) {\n    obj.addEventListener( type, fn, false );\n  };\n} else if ( docElem.attachEvent ) {\n  bind = function( obj, type, fn ) {\n    obj[ type + fn ] = fn.handleEvent ?\n      function() {\n        var event = getIEEvent( obj );\n        fn.handleEvent.call( fn, event );\n      } :\n      function() {\n        var event = getIEEvent( obj );\n        fn.call( obj, event );\n      };\n    obj.attachEvent( \"on\" + type, obj[ type + fn ] );\n  };\n}\n\nvar unbind = function() {};\n\nif ( docElem.removeEventListener ) {\n  unbind = function( obj, type, fn ) {\n    obj.removeEventListener( type, fn, false );\n  };\n} else if ( docElem.detachEvent ) {\n  unbind = function( obj, type, fn ) {\n    obj.detachEvent( \"on\" + type, obj[ type + fn ] );\n    try {\n      delete obj[ type + fn ];\n    } catch ( err ) {\n      // can't delete window object properties\n      obj[ type + fn ] = undefined;\n    }\n  };\n}\n\nvar eventie = {\n  bind: bind,\n  unbind: unbind\n};\n\n// ----- module definition ----- //\n\nif ( typeof define === 'function' && define.amd ) {\n  // AMD\n  define( 'eventie/eventie',eventie );\n} else if ( typeof exports === 'object' ) {\n  // CommonJS\n  module.exports = eventie;\n} else {\n  // browser global\n  window.eventie = eventie;\n}\n\n})( window );\n\n/*!\n * EventEmitter v4.2.11 - git.io/ee\n * Unlicense - http://unlicense.org/\n * Oliver Caldwell - http://oli.me.uk/\n * @preserve\n */\n\n;(function () {\n    \n\n    /**\n     * Class for managing events.\n     * Can be extended to provide event functionality in other classes.\n     *\n     * @class EventEmitter Manages event registering and emitting.\n     */\n    function EventEmitter() {}\n\n    // Shortcuts to improve speed and size\n    var proto = EventEmitter.prototype;\n    var exports = this;\n    var originalGlobalValue = exports.EventEmitter;\n\n    /**\n     * Finds the index of the listener for the event in its storage array.\n     *\n     * @param {Function[]} listeners Array of listeners to search through.\n     * @param {Function} listener Method to look for.\n     * @return {Number} Index of the specified listener, -1 if not found\n     * @api private\n     */\n    function indexOfListener(listeners, listener) {\n        var i = listeners.length;\n        while (i--) {\n            if (listeners[i].listener === listener) {\n                return i;\n            }\n        }\n\n        return -1;\n    }\n\n    /**\n     * Alias a method while keeping the context correct, to allow for overwriting of target method.\n     *\n     * @param {String} name The name of the target method.\n     * @return {Function} The aliased method\n     * @api private\n     */\n    function alias(name) {\n        return function aliasClosure() {\n            return this[name].apply(this, arguments);\n        };\n    }\n\n    /**\n     * Returns the listener array for the specified event.\n     * Will initialise the event object and listener arrays if required.\n     * Will return an object if you use a regex search. The object contains keys for each matched event. So /ba[rz]/ might return an object containing bar and baz. But only if you have either defined them with defineEvent or added some listeners to them.\n     * Each property in the object response is an array of listener functions.\n     *\n     * @param {String|RegExp} evt Name of the event to return the listeners from.\n     * @return {Function[]|Object} All listener functions for the event.\n     */\n    proto.getListeners = function getListeners(evt) {\n        var events = this._getEvents();\n        var response;\n        var key;\n\n        // Return a concatenated array of all matching events if\n        // the selector is a regular expression.\n        if (evt instanceof RegExp) {\n            response = {};\n            for (key in events) {\n                if (events.hasOwnProperty(key) && evt.test(key)) {\n                    response[key] = events[key];\n                }\n            }\n        }\n        else {\n            response = events[evt] || (events[evt] = []);\n        }\n\n        return response;\n    };\n\n    /**\n     * Takes a list of listener objects and flattens it into a list of listener functions.\n     *\n     * @param {Object[]} listeners Raw listener objects.\n     * @return {Function[]} Just the listener functions.\n     */\n    proto.flattenListeners = function flattenListeners(listeners) {\n        var flatListeners = [];\n        var i;\n\n        for (i = 0; i < listeners.length; i += 1) {\n            flatListeners.push(listeners[i].listener);\n        }\n\n        return flatListeners;\n    };\n\n    /**\n     * Fetches the requested listeners via getListeners but will always return the results inside an object. This is mainly for internal use but others may find it useful.\n     *\n     * @param {String|RegExp} evt Name of the event to return the listeners from.\n     * @return {Object} All listener functions for an event in an object.\n     */\n    proto.getListenersAsObject = function getListenersAsObject(evt) {\n        var listeners = this.getListeners(evt);\n        var response;\n\n        if (listeners instanceof Array) {\n            response = {};\n            response[evt] = listeners;\n        }\n\n        return response || listeners;\n    };\n\n    /**\n     * Adds a listener function to the specified event.\n     * The listener will not be added if it is a duplicate.\n     * If the listener returns true then it will be removed after it is called.\n     * If you pass a regular expression as the event name then the listener will be added to all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to attach the listener to.\n     * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.addListener = function addListener(evt, listener) {\n        var listeners = this.getListenersAsObject(evt);\n        var listenerIsWrapped = typeof listener === 'object';\n        var key;\n\n        for (key in listeners) {\n            if (listeners.hasOwnProperty(key) && indexOfListener(listeners[key], listener) === -1) {\n                listeners[key].push(listenerIsWrapped ? listener : {\n                    listener: listener,\n                    once: false\n                });\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of addListener\n     */\n    proto.on = alias('addListener');\n\n    /**\n     * Semi-alias of addListener. It will add a listener that will be\n     * automatically removed after its first execution.\n     *\n     * @param {String|RegExp} evt Name of the event to attach the listener to.\n     * @param {Function} listener Method to be called when the event is emitted. If the function returns true then it will be removed after calling.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.addOnceListener = function addOnceListener(evt, listener) {\n        return this.addListener(evt, {\n            listener: listener,\n            once: true\n        });\n    };\n\n    /**\n     * Alias of addOnceListener.\n     */\n    proto.once = alias('addOnceListener');\n\n    /**\n     * Defines an event name. This is required if you want to use a regex to add a listener to multiple events at once. If you don't do this then how do you expect it to know what event to add to? Should it just add to every possible match for a regex? No. That is scary and bad.\n     * You need to tell it what event names should be matched by a regex.\n     *\n     * @param {String} evt Name of the event to create.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.defineEvent = function defineEvent(evt) {\n        this.getListeners(evt);\n        return this;\n    };\n\n    /**\n     * Uses defineEvent to define multiple events.\n     *\n     * @param {String[]} evts An array of event names to define.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.defineEvents = function defineEvents(evts) {\n        for (var i = 0; i < evts.length; i += 1) {\n            this.defineEvent(evts[i]);\n        }\n        return this;\n    };\n\n    /**\n     * Removes a listener function from the specified event.\n     * When passed a regular expression as the event name, it will remove the listener from all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to remove the listener from.\n     * @param {Function} listener Method to remove from the event.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.removeListener = function removeListener(evt, listener) {\n        var listeners = this.getListenersAsObject(evt);\n        var index;\n        var key;\n\n        for (key in listeners) {\n            if (listeners.hasOwnProperty(key)) {\n                index = indexOfListener(listeners[key], listener);\n\n                if (index !== -1) {\n                    listeners[key].splice(index, 1);\n                }\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of removeListener\n     */\n    proto.off = alias('removeListener');\n\n    /**\n     * Adds listeners in bulk using the manipulateListeners method.\n     * If you pass an object as the second argument you can add to multiple events at once. The object should contain key value pairs of events and listeners or listener arrays. You can also pass it an event name and an array of listeners to be added.\n     * You can also pass it a regular expression to add the array of listeners to all events that match it.\n     * Yeah, this function does quite a bit. That's probably a bad thing.\n     *\n     * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add to multiple events at once.\n     * @param {Function[]} [listeners] An optional array of listener functions to add.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.addListeners = function addListeners(evt, listeners) {\n        // Pass through to manipulateListeners\n        return this.manipulateListeners(false, evt, listeners);\n    };\n\n    /**\n     * Removes listeners in bulk using the manipulateListeners method.\n     * If you pass an object as the second argument you can remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\n     * You can also pass it an event name and an array of listeners to be removed.\n     * You can also pass it a regular expression to remove the listeners from all events that match it.\n     *\n     * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to remove from multiple events at once.\n     * @param {Function[]} [listeners] An optional array of listener functions to remove.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.removeListeners = function removeListeners(evt, listeners) {\n        // Pass through to manipulateListeners\n        return this.manipulateListeners(true, evt, listeners);\n    };\n\n    /**\n     * Edits listeners in bulk. The addListeners and removeListeners methods both use this to do their job. You should really use those instead, this is a little lower level.\n     * The first argument will determine if the listeners are removed (true) or added (false).\n     * If you pass an object as the second argument you can add/remove from multiple events at once. The object should contain key value pairs of events and listeners or listener arrays.\n     * You can also pass it an event name and an array of listeners to be added/removed.\n     * You can also pass it a regular expression to manipulate the listeners of all events that match it.\n     *\n     * @param {Boolean} remove True if you want to remove listeners, false if you want to add.\n     * @param {String|Object|RegExp} evt An event name if you will pass an array of listeners next. An object if you wish to add/remove from multiple events at once.\n     * @param {Function[]} [listeners] An optional array of listener functions to add/remove.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.manipulateListeners = function manipulateListeners(remove, evt, listeners) {\n        var i;\n        var value;\n        var single = remove ? this.removeListener : this.addListener;\n        var multiple = remove ? this.removeListeners : this.addListeners;\n\n        // If evt is an object then pass each of its properties to this method\n        if (typeof evt === 'object' && !(evt instanceof RegExp)) {\n            for (i in evt) {\n                if (evt.hasOwnProperty(i) && (value = evt[i])) {\n                    // Pass the single listener straight through to the singular method\n                    if (typeof value === 'function') {\n                        single.call(this, i, value);\n                    }\n                    else {\n                        // Otherwise pass back to the multiple function\n                        multiple.call(this, i, value);\n                    }\n                }\n            }\n        }\n        else {\n            // So evt must be a string\n            // And listeners must be an array of listeners\n            // Loop over it and pass each one to the multiple method\n            i = listeners.length;\n            while (i--) {\n                single.call(this, evt, listeners[i]);\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Removes all listeners from a specified event.\n     * If you do not specify an event then all listeners will be removed.\n     * That means every event will be emptied.\n     * You can also pass a regex to remove all events that match it.\n     *\n     * @param {String|RegExp} [evt] Optional name of the event to remove all listeners for. Will remove from every event if not passed.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.removeEvent = function removeEvent(evt) {\n        var type = typeof evt;\n        var events = this._getEvents();\n        var key;\n\n        // Remove different things depending on the state of evt\n        if (type === 'string') {\n            // Remove all listeners for the specified event\n            delete events[evt];\n        }\n        else if (evt instanceof RegExp) {\n            // Remove all events matching the regex.\n            for (key in events) {\n                if (events.hasOwnProperty(key) && evt.test(key)) {\n                    delete events[key];\n                }\n            }\n        }\n        else {\n            // Remove all listeners in all events\n            delete this._events;\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of removeEvent.\n     *\n     * Added to mirror the node API.\n     */\n    proto.removeAllListeners = alias('removeEvent');\n\n    /**\n     * Emits an event of your choice.\n     * When emitted, every listener attached to that event will be executed.\n     * If you pass the optional argument array then those arguments will be passed to every listener upon execution.\n     * Because it uses `apply`, your array of arguments will be passed as if you wrote them out separately.\n     * So they will not arrive within the array on the other side, they will be separate.\n     * You can also pass a regular expression to emit to all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\n     * @param {Array} [args] Optional array of arguments to be passed to each listener.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.emitEvent = function emitEvent(evt, args) {\n        var listeners = this.getListenersAsObject(evt);\n        var listener;\n        var i;\n        var key;\n        var response;\n\n        for (key in listeners) {\n            if (listeners.hasOwnProperty(key)) {\n                i = listeners[key].length;\n\n                while (i--) {\n                    // If the listener returns true then it shall be removed from the event\n                    // The function is executed either with a basic call or an apply if there is an args array\n                    listener = listeners[key][i];\n\n                    if (listener.once === true) {\n                        this.removeListener(evt, listener.listener);\n                    }\n\n                    response = listener.listener.apply(this, args || []);\n\n                    if (response === this._getOnceReturnValue()) {\n                        this.removeListener(evt, listener.listener);\n                    }\n                }\n            }\n        }\n\n        return this;\n    };\n\n    /**\n     * Alias of emitEvent\n     */\n    proto.trigger = alias('emitEvent');\n\n    /**\n     * Subtly different from emitEvent in that it will pass its arguments on to the listeners, as opposed to taking a single array of arguments to pass on.\n     * As with emitEvent, you can pass a regex in place of the event name to emit to all events that match it.\n     *\n     * @param {String|RegExp} evt Name of the event to emit and execute listeners for.\n     * @param {...*} Optional additional arguments to be passed to each listener.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.emit = function emit(evt) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return this.emitEvent(evt, args);\n    };\n\n    /**\n     * Sets the current value to check against when executing listeners. If a\n     * listeners return value matches the one set here then it will be removed\n     * after execution. This value defaults to true.\n     *\n     * @param {*} value The new value to check for when executing listeners.\n     * @return {Object} Current instance of EventEmitter for chaining.\n     */\n    proto.setOnceReturnValue = function setOnceReturnValue(value) {\n        this._onceReturnValue = value;\n        return this;\n    };\n\n    /**\n     * Fetches the current value to check against when executing listeners. If\n     * the listeners return value matches this one then it should be removed\n     * automatically. It will return true by default.\n     *\n     * @return {*|Boolean} The current value to check for or the default, true.\n     * @api private\n     */\n    proto._getOnceReturnValue = function _getOnceReturnValue() {\n        if (this.hasOwnProperty('_onceReturnValue')) {\n            return this._onceReturnValue;\n        }\n        else {\n            return true;\n        }\n    };\n\n    /**\n     * Fetches the events object and creates one if required.\n     *\n     * @return {Object} The events storage object.\n     * @api private\n     */\n    proto._getEvents = function _getEvents() {\n        return this._events || (this._events = {});\n    };\n\n    /**\n     * Reverts the global {@link EventEmitter} to its previous value and returns a reference to this version.\n     *\n     * @return {Function} Non conflicting EventEmitter class.\n     */\n    EventEmitter.noConflict = function noConflict() {\n        exports.EventEmitter = originalGlobalValue;\n        return EventEmitter;\n    };\n\n    // Expose the class either via AMD, CommonJS or the global object\n    if (typeof define === 'function' && define.amd) {\n        define('eventEmitter/EventEmitter',[],function () {\n            return EventEmitter;\n        });\n    }\n    else if (typeof module === 'object' && module.exports){\n        module.exports = EventEmitter;\n    }\n    else {\n        exports.EventEmitter = EventEmitter;\n    }\n}.call(this));\n\n/*!\n * Unipointer v1.1.0\n * base class for doing one thing with pointer event\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true, strict: true */\n/*global define: false, module: false, require: false */\n\n( function( window, factory ) {\n  \n  // universal module definition\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'unipointer/unipointer',[\n      'eventEmitter/EventEmitter',\n      'eventie/eventie'\n    ], function( EventEmitter, eventie ) {\n      return factory( window, EventEmitter, eventie );\n    });\n  } else if ( typeof exports == 'object' ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('wolfy87-eventemitter'),\n      require('eventie')\n    );\n  } else {\n    // browser global\n    window.Unipointer = factory(\n      window,\n      window.EventEmitter,\n      window.eventie\n    );\n  }\n\n}( window, function factory( window, EventEmitter, eventie ) {\n\n\n\nfunction noop() {}\n\nfunction Unipointer() {}\n\n// inherit EventEmitter\nUnipointer.prototype = new EventEmitter();\n\nUnipointer.prototype.bindStartEvent = function( elem ) {\n  this._bindStartEvent( elem, true );\n};\n\nUnipointer.prototype.unbindStartEvent = function( elem ) {\n  this._bindStartEvent( elem, false );\n};\n\n/**\n * works as unbinder, as you can ._bindStart( false ) to unbind\n * @param {Boolean} isBind - will unbind if falsey\n */\nUnipointer.prototype._bindStartEvent = function( elem, isBind ) {\n  // munge isBind, default to true\n  isBind = isBind === undefined ? true : !!isBind;\n  var bindMethod = isBind ? 'bind' : 'unbind';\n\n  if ( window.navigator.pointerEnabled ) {\n    // W3C Pointer Events, IE11. See https://coderwall.com/p/mfreca\n    eventie[ bindMethod ]( elem, 'pointerdown', this );\n  } else if ( window.navigator.msPointerEnabled ) {\n    // IE10 Pointer Events\n    eventie[ bindMethod ]( elem, 'MSPointerDown', this );\n  } else {\n    // listen for both, for devices like Chrome Pixel\n    eventie[ bindMethod ]( elem, 'mousedown', this );\n    eventie[ bindMethod ]( elem, 'touchstart', this );\n  }\n};\n\n// trigger handler methods for events\nUnipointer.prototype.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\n// returns the touch that we're keeping track of\nUnipointer.prototype.getTouch = function( touches ) {\n  for ( var i=0, len = touches.length; i < len; i++ ) {\n    var touch = touches[i];\n    if ( touch.identifier == this.pointerIdentifier ) {\n      return touch;\n    }\n  }\n};\n\n// ----- start event ----- //\n\nUnipointer.prototype.onmousedown = function( event ) {\n  // dismiss clicks from right or middle buttons\n  var button = event.button;\n  if ( button && ( button !== 0 && button !== 1 ) ) {\n    return;\n  }\n  this._pointerDown( event, event );\n};\n\nUnipointer.prototype.ontouchstart = function( event ) {\n  this._pointerDown( event, event.changedTouches[0] );\n};\n\nUnipointer.prototype.onMSPointerDown =\nUnipointer.prototype.onpointerdown = function( event ) {\n  this._pointerDown( event, event );\n};\n\n/**\n * pointer start\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nUnipointer.prototype._pointerDown = function( event, pointer ) {\n  // dismiss other pointers\n  if ( this.isPointerDown ) {\n    return;\n  }\n\n  this.isPointerDown = true;\n  // save pointer identifier to match up touch events\n  this.pointerIdentifier = pointer.pointerId !== undefined ?\n    // pointerId for pointer events, touch.indentifier for touch events\n    pointer.pointerId : pointer.identifier;\n\n  this.pointerDown( event, pointer );\n};\n\nUnipointer.prototype.pointerDown = function( event, pointer ) {\n  this._bindPostStartEvents( event );\n  this.emitEvent( 'pointerDown', [ event, pointer ] );\n};\n\n// hash of events to be bound after start event\nvar postStartEvents = {\n  mousedown: [ 'mousemove', 'mouseup' ],\n  touchstart: [ 'touchmove', 'touchend', 'touchcancel' ],\n  pointerdown: [ 'pointermove', 'pointerup', 'pointercancel' ],\n  MSPointerDown: [ 'MSPointerMove', 'MSPointerUp', 'MSPointerCancel' ]\n};\n\nUnipointer.prototype._bindPostStartEvents = function( event ) {\n  if ( !event ) {\n    return;\n  }\n  // get proper events to match start event\n  var events = postStartEvents[ event.type ];\n  // IE8 needs to be bound to document\n  var node = event.preventDefault ? window : document;\n  // bind events to node\n  for ( var i=0, len = events.length; i < len; i++ ) {\n    var evnt = events[i];\n    eventie.bind( node, evnt, this );\n  }\n  // save these arguments\n  this._boundPointerEvents = {\n    events: events,\n    node: node\n  };\n};\n\nUnipointer.prototype._unbindPostStartEvents = function() {\n  var args = this._boundPointerEvents;\n  // IE8 can trigger dragEnd twice, check for _boundEvents\n  if ( !args || !args.events ) {\n    return;\n  }\n\n  for ( var i=0, len = args.events.length; i < len; i++ ) {\n    var event = args.events[i];\n    eventie.unbind( args.node, event, this );\n  }\n  delete this._boundPointerEvents;\n};\n\n// ----- move event ----- //\n\nUnipointer.prototype.onmousemove = function( event ) {\n  this._pointerMove( event, event );\n};\n\nUnipointer.prototype.onMSPointerMove =\nUnipointer.prototype.onpointermove = function( event ) {\n  if ( event.pointerId == this.pointerIdentifier ) {\n    this._pointerMove( event, event );\n  }\n};\n\nUnipointer.prototype.ontouchmove = function( event ) {\n  var touch = this.getTouch( event.changedTouches );\n  if ( touch ) {\n    this._pointerMove( event, touch );\n  }\n};\n\n/**\n * pointer move\n * @param {Event} event\n * @param {Event or Touch} pointer\n * @private\n */\nUnipointer.prototype._pointerMove = function( event, pointer ) {\n  this.pointerMove( event, pointer );\n};\n\n// public\nUnipointer.prototype.pointerMove = function( event, pointer ) {\n  this.emitEvent( 'pointerMove', [ event, pointer ] );\n};\n\n// ----- end event ----- //\n\n\nUnipointer.prototype.onmouseup = function( event ) {\n  this._pointerUp( event, event );\n};\n\nUnipointer.prototype.onMSPointerUp =\nUnipointer.prototype.onpointerup = function( event ) {\n  if ( event.pointerId == this.pointerIdentifier ) {\n    this._pointerUp( event, event );\n  }\n};\n\nUnipointer.prototype.ontouchend = function( event ) {\n  var touch = this.getTouch( event.changedTouches );\n  if ( touch ) {\n    this._pointerUp( event, touch );\n  }\n};\n\n/**\n * pointer up\n * @param {Event} event\n * @param {Event or Touch} pointer\n * @private\n */\nUnipointer.prototype._pointerUp = function( event, pointer ) {\n  this._pointerDone();\n  this.pointerUp( event, pointer );\n};\n\n// public\nUnipointer.prototype.pointerUp = function( event, pointer ) {\n  this.emitEvent( 'pointerUp', [ event, pointer ] );\n};\n\n// ----- pointer done ----- //\n\n// triggered on pointer up & pointer cancel\nUnipointer.prototype._pointerDone = function() {\n  // reset properties\n  this.isPointerDown = false;\n  delete this.pointerIdentifier;\n  // remove events\n  this._unbindPostStartEvents();\n  this.pointerDone();\n};\n\nUnipointer.prototype.pointerDone = noop;\n\n// ----- pointer cancel ----- //\n\nUnipointer.prototype.onMSPointerCancel =\nUnipointer.prototype.onpointercancel = function( event ) {\n  if ( event.pointerId == this.pointerIdentifier ) {\n    this._pointerCancel( event, event );\n  }\n};\n\nUnipointer.prototype.ontouchcancel = function( event ) {\n  var touch = this.getTouch( event.changedTouches );\n  if ( touch ) {\n    this._pointerCancel( event, touch );\n  }\n};\n\n/**\n * pointer cancel\n * @param {Event} event\n * @param {Event or Touch} pointer\n * @private\n */\nUnipointer.prototype._pointerCancel = function( event, pointer ) {\n  this._pointerDone();\n  this.pointerCancel( event, pointer );\n};\n\n// public\nUnipointer.prototype.pointerCancel = function( event, pointer ) {\n  this.emitEvent( 'pointerCancel', [ event, pointer ] );\n};\n\n// -----  ----- //\n\n// utility function for getting x/y cooridinates from event, because IE8\nUnipointer.getPointerPoint = function( pointer ) {\n  return {\n    x: pointer.pageX !== undefined ? pointer.pageX : pointer.clientX,\n    y: pointer.pageY !== undefined ? pointer.pageY : pointer.clientY\n  };\n};\n\n// -----  ----- //\n\nreturn Unipointer;\n\n}));\n\n/*!\n * Unidragger v1.1.0\n * Draggable base class\n * MIT license\n */\n\n/*jshint browser: true, unused: true, undef: true, strict: true */\n\n( function( window, factory ) {\n  /*global define: false, module: false, require: false */\n  \n  // universal module definition\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'unidragger/unidragger',[\n      'eventie/eventie',\n      'unipointer/unipointer'\n    ], function( eventie, Unipointer ) {\n      return factory( window, eventie, Unipointer );\n    });\n  } else if ( typeof exports == 'object' ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('eventie'),\n      require('unipointer')\n    );\n  } else {\n    // browser global\n    window.Unidragger = factory(\n      window,\n      window.eventie,\n      window.Unipointer\n    );\n  }\n\n}( window, function factory( window, eventie, Unipointer ) {\n\n\n\n// -----  ----- //\n\nfunction noop() {}\n\n// handle IE8 prevent default\nfunction preventDefaultEvent( event ) {\n  if ( event.preventDefault ) {\n    event.preventDefault();\n  } else {\n    event.returnValue = false;\n  }\n}\n\nfunction getParentLink( elem ) {\n  while ( elem != document.body ) {\n    elem = elem.parentNode;\n    if ( elem.nodeName == 'A' ) {\n      return elem;\n    }\n  }\n}\n\n// -------------------------- Unidragger -------------------------- //\n\nfunction Unidragger() {}\n\n// inherit Unipointer & EventEmitter\nUnidragger.prototype = new Unipointer();\n\n// ----- bind start ----- //\n\nUnidragger.prototype.bindHandles = function() {\n  this._bindHandles( true );\n};\n\nUnidragger.prototype.unbindHandles = function() {\n  this._bindHandles( false );\n};\n\nvar navigator = window.navigator;\n/**\n * works as unbinder, as you can .bindHandles( false ) to unbind\n * @param {Boolean} isBind - will unbind if falsey\n */\nUnidragger.prototype._bindHandles = function( isBind ) {\n  // munge isBind, default to true\n  isBind = isBind === undefined ? true : !!isBind;\n  // extra bind logic\n  var binderExtra;\n  if ( navigator.pointerEnabled ) {\n    binderExtra = function( handle ) {\n      // disable scrolling on the element\n      handle.style.touchAction = isBind ? 'none' : '';\n    };\n  } else if ( navigator.msPointerEnabled ) {\n    binderExtra = function( handle ) {\n      // disable scrolling on the element\n      handle.style.msTouchAction = isBind ? 'none' : '';\n    };\n  } else {\n    binderExtra = function() {\n      // TODO re-enable img.ondragstart when unbinding\n      if ( isBind ) {\n        disableImgOndragstart( handle );\n      }\n    };\n  }\n  // bind each handle\n  var bindMethod = isBind ? 'bind' : 'unbind';\n  for ( var i=0, len = this.handles.length; i < len; i++ ) {\n    var handle = this.handles[i];\n    this._bindStartEvent( handle, isBind );\n    binderExtra( handle );\n    eventie[ bindMethod ]( handle, 'click', this );\n  }\n};\n\n// remove default dragging interaction on all images in IE8\n// IE8 does its own drag thing on images, which messes stuff up\n\nfunction noDragStart() {\n  return false;\n}\n\n// TODO replace this with a IE8 test\nvar isIE8 = 'attachEvent' in document.documentElement;\n\n// IE8 only\nvar disableImgOndragstart = !isIE8 ? noop : function( handle ) {\n\n  if ( handle.nodeName == 'IMG' ) {\n    handle.ondragstart = noDragStart;\n  }\n\n  var images = handle.querySelectorAll('img');\n  for ( var i=0, len = images.length; i < len; i++ ) {\n    var img = images[i];\n    img.ondragstart = noDragStart;\n  }\n};\n\n// ----- start event ----- //\n\nvar allowTouchstartNodes = Unidragger.allowTouchstartNodes = {\n  INPUT: true,\n  A: true,\n  BUTTON: true,\n  SELECT: true\n};\n\n/**\n * pointer start\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nUnidragger.prototype.pointerDown = function( event, pointer ) {\n  this._dragPointerDown( event, pointer );\n  // kludge to blur focused inputs in dragger\n  var focused = document.activeElement;\n  if ( focused && focused.blur ) {\n    focused.blur();\n  }\n  // bind move and end events\n  this._bindPostStartEvents( event );\n  this.emitEvent( 'pointerDown', [ event, pointer ] );\n};\n\n// base pointer down logic\nUnidragger.prototype._dragPointerDown = function( event, pointer ) {\n  // track to see when dragging starts\n  this.pointerDownPoint = Unipointer.getPointerPoint( pointer );\n\n  var targetNodeName = event.target.nodeName;\n  // HACK iOS, allow clicks on buttons, inputs, and links, or children of links\n  var isTouchstartNode = event.type == 'touchstart' &&\n    ( allowTouchstartNodes[ targetNodeName ] || getParentLink( event.target ) );\n  // do not prevent default on touchstart nodes or <select>\n  if ( !isTouchstartNode && targetNodeName != 'SELECT' ) {\n    preventDefaultEvent( event );\n  }\n};\n\n// ----- move event ----- //\n\n/**\n * drag move\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nUnidragger.prototype.pointerMove = function( event, pointer ) {\n  var moveVector = this._dragPointerMove( event, pointer );\n  this.emitEvent( 'pointerMove', [ event, pointer, moveVector ] );\n  this._dragMove( event, pointer, moveVector );\n};\n\n// base pointer move logic\nUnidragger.prototype._dragPointerMove = function( event, pointer ) {\n  var movePoint = Unipointer.getPointerPoint( pointer );\n  var moveVector = {\n    x: movePoint.x - this.pointerDownPoint.x,\n    y: movePoint.y - this.pointerDownPoint.y\n  };\n  // start drag if pointer has moved far enough to start drag\n  if ( !this.isDragging && this.hasDragStarted( moveVector ) ) {\n    this._dragStart( event, pointer );\n  }\n  return moveVector;\n};\n\n// condition if pointer has moved far enough to start drag\nUnidragger.prototype.hasDragStarted = function( moveVector ) {\n  return Math.abs( moveVector.x ) > 3 || Math.abs( moveVector.y ) > 3;\n};\n\n\n// ----- end event ----- //\n\n/**\n * pointer up\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nUnidragger.prototype.pointerUp = function( event, pointer ) {\n  this.emitEvent( 'pointerUp', [ event, pointer ] );\n  this._dragPointerUp( event, pointer );\n};\n\nUnidragger.prototype._dragPointerUp = function( event, pointer ) {\n  if ( this.isDragging ) {\n    this._dragEnd( event, pointer );\n  } else {\n    // pointer didn't move enough for drag to start\n    this._staticClick( event, pointer );\n  }\n};\n\n// -------------------------- drag -------------------------- //\n\n// dragStart\nUnidragger.prototype._dragStart = function( event, pointer ) {\n  this.isDragging = true;\n  this.dragStartPoint = Unidragger.getPointerPoint( pointer );\n  // prevent clicks\n  this.isPreventingClicks = true;\n\n  this.dragStart( event, pointer );\n};\n\nUnidragger.prototype.dragStart = function( event, pointer ) {\n  this.emitEvent( 'dragStart', [ event, pointer ] );\n};\n\n// dragMove\nUnidragger.prototype._dragMove = function( event, pointer, moveVector ) {\n  // do not drag if not dragging yet\n  if ( !this.isDragging ) {\n    return;\n  }\n\n  this.dragMove( event, pointer, moveVector );\n};\n\nUnidragger.prototype.dragMove = function( event, pointer, moveVector ) {\n  this.emitEvent( 'dragMove', [ event, pointer, moveVector ] );\n};\n\n// dragEnd\nUnidragger.prototype._dragEnd = function( event, pointer ) {\n  // set flags\n  this.isDragging = false;\n  // re-enable clicking async\n  var _this = this;\n  setTimeout( function() {\n    delete _this.isPreventingClicks;\n  });\n\n  this.dragEnd( event, pointer );\n};\n\nUnidragger.prototype.dragEnd = function( event, pointer ) {\n  this.emitEvent( 'dragEnd', [ event, pointer ] );\n};\n\n// ----- onclick ----- //\n\n// handle all clicks and prevent clicks when dragging\nUnidragger.prototype.onclick = function( event ) {\n  if ( this.isPreventingClicks ) {\n    preventDefaultEvent( event );\n  }\n};\n\n// ----- staticClick ----- //\n\n// triggered after pointer down & up with no/tiny movement\nUnidragger.prototype._staticClick = function( event, pointer ) {\n  // allow click in text input\n  if ( event.target.nodeName == 'INPUT' && event.target.type == 'text' ) {\n    event.target.focus();\n  }\n  this.staticClick( event, pointer );\n};\n\nUnidragger.prototype.staticClick = function( event, pointer ) {\n  this.emitEvent( 'staticClick', [ event, pointer ] );\n};\n\n// -----  ----- //\n\nUnidragger.getPointerPoint = function( pointer ) {\n  return {\n    x: pointer.pageX !== undefined ? pointer.pageX : pointer.clientX,\n    y: pointer.pageY !== undefined ? pointer.pageY : pointer.clientY\n  };\n};\n\n// -----  ----- //\n\nUnidragger.getPointerPoint = Unipointer.getPointerPoint;\n\nreturn Unidragger;\n\n}));\n\n/*!\n * Draggabilly v1.2.4\n * Make that shiz draggable\n * http://draggabilly.desandro.com\n * MIT license\n */\n\n( function( window, factory ) {\n  \n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    // Note: fixed by andy-armstrong to include a name for the definition\n    // so that this works when optimized using r.js. This is only an issue\n    // in Studio, as the LMS uses a namespaced version of RequireJS so\n    // this clause isn't reached.\n    // See http://requirejs.org/docs/errors.html#mismatch\n    define(\n      'draggabilly',\n      [\n        'classie/classie',\n        'get-style-property/get-style-property',\n        'get-size/get-size',\n        'unidragger/unidragger'\n      ],\n      function( classie, getStyleProperty, getSize, Unidragger ) {\n        return factory( window, classie, getStyleProperty, getSize, Unidragger );\n      });\n  } else if ( typeof exports == 'object' ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('desandro-classie'),\n      require('desandro-get-style-property'),\n      require('get-size'),\n      require('unidragger')\n    );\n  } else {\n    // browser global\n    window.Draggabilly = factory(\n      window,\n      window.classie,\n      window.getStyleProperty,\n      window.getSize,\n      window.Unidragger\n    );\n  }\n\n}( window, function factory( window, classie, getStyleProperty, getSize, Unidragger ) {\n\n\n\n// vars\nvar document = window.document;\n\nfunction noop() {}\n\n// -------------------------- helpers -------------------------- //\n\n// extend objects\nfunction extend( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n}\n\n// ----- get style ----- //\n\nvar defView = document.defaultView;\n\nvar getStyle = defView && defView.getComputedStyle ?\n  function( elem ) {\n    return defView.getComputedStyle( elem, null );\n  } :\n  function( elem ) {\n    return elem.currentStyle;\n  };\n\n\n// http://stackoverflow.com/a/384380/182183\nvar isElement = ( typeof HTMLElement == 'object' ) ?\n  function isElementDOM2( obj ) {\n    return obj instanceof HTMLElement;\n  } :\n  function isElementQuirky( obj ) {\n    return obj && typeof obj == 'object' &&\n      obj.nodeType == 1 && typeof obj.nodeName == 'string';\n  };\n\n// -------------------------- requestAnimationFrame -------------------------- //\n\n// https://gist.github.com/1866474\n\nvar lastTime = 0;\nvar prefixes = 'webkit moz ms o'.split(' ');\n// get unprefixed rAF and cAF, if present\nvar requestAnimationFrame = window.requestAnimationFrame;\nvar cancelAnimationFrame = window.cancelAnimationFrame;\n// loop through vendor prefixes and get prefixed rAF and cAF\nvar prefix;\nfor( var i = 0; i < prefixes.length; i++ ) {\n  if ( requestAnimationFrame && cancelAnimationFrame ) {\n    break;\n  }\n  prefix = prefixes[i];\n  requestAnimationFrame = requestAnimationFrame || window[ prefix + 'RequestAnimationFrame' ];\n  cancelAnimationFrame  = cancelAnimationFrame  || window[ prefix + 'CancelAnimationFrame' ] ||\n                            window[ prefix + 'CancelRequestAnimationFrame' ];\n}\n\n// fallback to setTimeout and clearTimeout if either request/cancel is not supported\nif ( !requestAnimationFrame || !cancelAnimationFrame )  {\n  requestAnimationFrame = function( callback ) {\n    var currTime = new Date().getTime();\n    var timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n    var id = window.setTimeout( function() {\n      callback( currTime + timeToCall );\n    }, timeToCall );\n    lastTime = currTime + timeToCall;\n    return id;\n  };\n\n  cancelAnimationFrame = function( id ) {\n    window.clearTimeout( id );\n  };\n}\n\n// -------------------------- support -------------------------- //\n\nvar transformProperty = getStyleProperty('transform');\n// TODO fix quick & dirty check for 3D support\nvar is3d = !!getStyleProperty('perspective');\n\nvar jQuery = window.jQuery;\n\n// --------------------------  -------------------------- //\n\nfunction Draggabilly( element, options ) {\n  // querySelector if string\n  this.element = typeof element == 'string' ?\n    document.querySelector( element ) : element;\n\n  if ( jQuery ) {\n    this.$element = jQuery( this.element );\n  }\n\n  // options\n  this.options = extend( {}, this.constructor.defaults );\n  this.option( options );\n\n  this._create();\n}\n\n// inherit Unidragger methods\nextend( Draggabilly.prototype, Unidragger.prototype );\n\nDraggabilly.defaults = {\n};\n\n/**\n * set options\n * @param {Object} opts\n */\nDraggabilly.prototype.option = function( opts ) {\n  extend( this.options, opts );\n};\n\nDraggabilly.prototype._create = function() {\n\n  // properties\n  this.position = {};\n  this._getPosition();\n\n  this.startPoint = { x: 0, y: 0 };\n  this.dragPoint = { x: 0, y: 0 };\n\n  this.startPosition = extend( {}, this.position );\n\n  // set relative positioning\n  var style = getStyle( this.element );\n  if ( style.position != 'relative' && style.position != 'absolute' ) {\n    this.element.style.position = 'relative';\n  }\n\n  this.enable();\n  this.setHandles();\n\n};\n\n/**\n * set this.handles and bind start events to 'em\n */\nDraggabilly.prototype.setHandles = function() {\n  this.handles = this.options.handle ?\n    this.element.querySelectorAll( this.options.handle ) : [ this.element ];\n\n  this.bindHandles();\n};\n\n/**\n * emits events via eventEmitter and jQuery events\n * @param {String} type - name of event\n * @param {Event} event - original event\n * @param {Array} args - extra arguments\n */\nDraggabilly.prototype.dispatchEvent = function( type, event, args ) {\n  var emitArgs = [ event ].concat( args );\n  this.emitEvent( type, emitArgs );\n  var jQuery = window.jQuery;\n  // trigger jQuery event\n  if ( jQuery && this.$element ) {\n    if ( event ) {\n      // create jQuery event\n      var $event = jQuery.Event( event );\n      $event.type = type;\n      this.$element.trigger( $event, args );\n    } else {\n      // just trigger with type if no event available\n      this.$element.trigger( type, args );\n    }\n  }\n};\n\n// -------------------------- position -------------------------- //\n\n// get left/top position from style\nDraggabilly.prototype._getPosition = function() {\n  // properties\n  var style = getStyle( this.element );\n\n  var x = parseInt( style.left, 10 );\n  var y = parseInt( style.top, 10 );\n\n  // clean up 'auto' or other non-integer values\n  this.position.x = isNaN( x ) ? 0 : x;\n  this.position.y = isNaN( y ) ? 0 : y;\n\n  this._addTransformPosition( style );\n};\n\n// add transform: translate( x, y ) to position\nDraggabilly.prototype._addTransformPosition = function( style ) {\n  if ( !transformProperty ) {\n    return;\n  }\n  var transform = style[ transformProperty ];\n  // bail out if value is 'none'\n  if ( transform.indexOf('matrix') !== 0 ) {\n    return;\n  }\n  // split matrix(1, 0, 0, 1, x, y)\n  var matrixValues = transform.split(',');\n  // translate X value is in 12th or 4th position\n  var xIndex = transform.indexOf('matrix3d') === 0 ? 12 : 4;\n  var translateX = parseInt( matrixValues[ xIndex ], 10 );\n  // translate Y value is in 13th or 5th position\n  var translateY = parseInt( matrixValues[ xIndex + 1 ], 10 );\n  this.position.x += translateX;\n  this.position.y += translateY;\n};\n\n// -------------------------- events -------------------------- //\n\n/**\n * pointer start\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nDraggabilly.prototype.pointerDown = function( event, pointer ) {\n  this._dragPointerDown( event, pointer );\n  // kludge to blur focused inputs in dragger\n  var focused = document.activeElement;\n  if ( focused && focused.blur ) {\n    focused.blur();\n  }\n  // bind move and end events\n  this._bindPostStartEvents( event );\n  classie.add( this.element, 'is-pointer-down' );\n  this.dispatchEvent( 'pointerDown', event, [ pointer ] );\n};\n\n/**\n * drag move\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nDraggabilly.prototype.pointerMove = function( event, pointer ) {\n  var moveVector = this._dragPointerMove( event, pointer );\n  this.dispatchEvent( 'pointerMove', event, [ pointer, moveVector ] );\n  this._dragMove( event, pointer, moveVector );\n};\n\n/**\n * drag start\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nDraggabilly.prototype.dragStart = function( event, pointer ) {\n  if ( !this.isEnabled ) {\n    return;\n  }\n  this._getPosition();\n  this.measureContainment();\n  // position _when_ drag began\n  this.startPosition.x = this.position.x;\n  this.startPosition.y = this.position.y;\n  // reset left/top style\n  this.setLeftTop();\n\n  this.dragPoint.x = 0;\n  this.dragPoint.y = 0;\n\n  // reset isDragging flag\n  this.isDragging = true;\n  classie.add( this.element, 'is-dragging' );\n  this.dispatchEvent( 'dragStart', event, [ pointer ] );\n  // start animation\n  this.animate();\n};\n\nDraggabilly.prototype.measureContainment = function() {\n  var containment = this.options.containment;\n  if ( !containment ) {\n    return;\n  }\n\n  this.size = getSize( this.element );\n  var elemRect = this.element.getBoundingClientRect();\n\n  // use element if element\n  var container = isElement( containment ) ? containment :\n    // fallback to querySelector if string\n    typeof containment == 'string' ? document.querySelector( containment ) :\n    // otherwise just `true`, use the parent\n    this.element.parentNode;\n\n  this.containerSize = getSize( container );\n  var containerRect = container.getBoundingClientRect();\n\n  this.relativeStartPosition = {\n    x: elemRect.left - containerRect.left,\n    y: elemRect.top  - containerRect.top\n  };\n};\n\n// ----- move event ----- //\n\n/**\n * drag move\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nDraggabilly.prototype.dragMove = function( event, pointer, moveVector ) {\n  if ( !this.isEnabled ) {\n    return;\n  }\n  var dragX = moveVector.x;\n  var dragY = moveVector.y;\n\n  var grid = this.options.grid;\n  var gridX = grid && grid[0];\n  var gridY = grid && grid[1];\n\n  dragX = applyGrid( dragX, gridX );\n  dragY = applyGrid( dragY, gridY );\n\n  dragX = this.containDrag( 'x', dragX, gridX );\n  dragY = this.containDrag( 'y', dragY, gridY );\n\n  // constrain to axis\n  dragX = this.options.axis == 'y' ? 0 : dragX;\n  dragY = this.options.axis == 'x' ? 0 : dragY;\n\n  this.position.x = this.startPosition.x + dragX;\n  this.position.y = this.startPosition.y + dragY;\n  // set dragPoint properties\n  this.dragPoint.x = dragX;\n  this.dragPoint.y = dragY;\n\n  this.dispatchEvent( 'dragMove', event, [ pointer, moveVector ] );\n};\n\nfunction applyGrid( value, grid, method ) {\n  method = method || 'round';\n  return grid ? Math[ method ]( value / grid ) * grid : value;\n}\n\nDraggabilly.prototype.containDrag = function( axis, drag, grid ) {\n  if ( !this.options.containment ) {\n    return drag;\n  }\n  var measure = axis == 'x' ? 'width' : 'height';\n\n  var rel = this.relativeStartPosition[ axis ];\n  var min = applyGrid( -rel, grid, 'ceil' );\n  var max = this.containerSize[ measure ] - rel - this.size[ measure ];\n  max = applyGrid( max, grid, 'floor' );\n  return  Math.min( max, Math.max( min, drag ) );\n};\n\n// ----- end event ----- //\n\n/**\n * pointer up\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nDraggabilly.prototype.pointerUp = function( event, pointer ) {\n  classie.remove( this.element, 'is-pointer-down' );\n  this.dispatchEvent( 'pointerUp', event, [ pointer ] );\n  this._dragPointerUp( event, pointer );\n};\n\n/**\n * drag end\n * @param {Event} event\n * @param {Event or Touch} pointer\n */\nDraggabilly.prototype.dragEnd = function( event, pointer ) {\n  if ( !this.isEnabled ) {\n    return;\n  }\n  this.isDragging = false;\n  // use top left position when complete\n  if ( transformProperty ) {\n    this.element.style[ transformProperty ] = '';\n    this.setLeftTop();\n  }\n  classie.remove( this.element, 'is-dragging' );\n  this.dispatchEvent( 'dragEnd', event, [ pointer ] );\n};\n\n// -------------------------- animation -------------------------- //\n\nDraggabilly.prototype.animate = function() {\n  // only render and animate if dragging\n  if ( !this.isDragging ) {\n    return;\n  }\n\n  this.positionDrag();\n\n  var _this = this;\n  requestAnimationFrame( function animateFrame() {\n    _this.animate();\n  });\n\n};\n\n// transform translate function\nvar translate = is3d ?\n  function( x, y ) {\n    return 'translate3d( ' + x + 'px, ' + y + 'px, 0)';\n  } :\n  function( x, y ) {\n    return 'translate( ' + x + 'px, ' + y + 'px)';\n  };\n\n// left/top positioning\nDraggabilly.prototype.setLeftTop = function() {\n  this.element.style.left = this.position.x + 'px';\n  this.element.style.top  = this.position.y + 'px';\n};\n\nDraggabilly.prototype.positionDrag = transformProperty ?\n  function() {\n    // position with transform\n    this.element.style[ transformProperty ] = translate( this.dragPoint.x, this.dragPoint.y );\n  } : Draggabilly.prototype.setLeftTop;\n\n// ----- staticClick ----- //\n\nDraggabilly.prototype.staticClick = function( event, pointer ) {\n  this.dispatchEvent( 'staticClick', event, [ pointer ] );\n};\n\n// ----- methods ----- //\n\nDraggabilly.prototype.enable = function() {\n  this.isEnabled = true;\n};\n\nDraggabilly.prototype.disable = function() {\n  this.isEnabled = false;\n  if ( this.isDragging ) {\n    this.dragEnd();\n  }\n};\n\nDraggabilly.prototype.destroy = function() {\n  this.disable();\n  // reset styles\n  if ( transformProperty ) {\n    this.element.style[ transformProperty ] = '';\n  }\n  this.element.style.left = '';\n  this.element.style.top = '';\n  this.element.style.position = '';\n  // unbind handles\n  this.unbindHandles();\n  // remove jQuery data\n  if ( this.$element ) {\n    this.$element.removeData('draggabilly');\n  }\n};\n\n// ----- jQuery bridget ----- //\n\n// required for jQuery bridget\nDraggabilly.prototype._init = noop;\n\nif ( jQuery && jQuery.bridget ) {\n  jQuery.bridget( 'draggabilly', Draggabilly );\n}\n\n// -----  ----- //\n\nreturn Draggabilly;\n\n}));\n\n\n\n\n// WEBPACK FOOTER //\n// ./common/static/js/vendor/draggabilly.js","/*** IMPORTS FROM imports-loader ***/\n(function() {\n\n/* globals _ */\n/* RequireJS\n\n    'use strict';\n\n    // In the case when the Video constructor will be called before RequireJS finishes loading all of the Video\n    // dependencies, we will have a mock function that will collect all the elements that must be initialized as\n    // Video elements.\n    //\n    // Once RequireJS will load all of the necessary dependencies, main code will invoke the mock function with\n    // the second parameter set to truthy value. This will trigger the actual Video constructor on all elements\n    // that are stored in a temporary list.\n    window.Video = (function() {\n        // Temporary storage place for elements that must be initialized as Video elements.\n        var tempCallStack = [];\n\n        return function(element, processTempCallStack) {\n            // If mock function was called with second parameter set to truthy value, we invoke the real `window.Video`\n            // on all the stored elements so far.\n            if (processTempCallStack) {\n                $.each(tempCallStack, function(index, el) {\n                    // By now, `window.Video` is the real constructor.\n                    window.Video(el);\n                });\n\n                return null;\n            }\n\n            // If normal call to `window.Video` constructor, store the element for later initializing.\n            tempCallStack.push(element);\n\n            // Real Video constructor returns the `state` object. The mock function will return an empty object.\n            return {};\n        };\n    }());\n\n    // Main module.\n    require(\n/* End RequireJS */\n    /* Webpack */\n    define(\n    /* End Webpack */\n        [\n            'video/00_video_storage.js',\n            'video/01_initialize.js',\n            'video/025_focus_grabber.js',\n            'video/035_video_accessible_menu.js',\n            'video/04_video_control.js',\n            'video/04_video_full_screen.js',\n            'video/05_video_quality_control.js',\n            'video/06_video_progress_slider.js',\n            'video/07_video_volume_control.js',\n            'video/08_video_speed_control.js',\n            'video/08_video_auto_advance_control.js',\n            'video/09_video_caption.js',\n            'video/09_play_placeholder.js',\n            'video/09_play_pause_control.js',\n            'video/09_play_skip_control.js',\n            'video/09_skip_control.js',\n            'video/09_bumper.js',\n            'video/09_save_state_plugin.js',\n            'video/09_events_plugin.js',\n            'video/09_events_bumper_plugin.js',\n            'video/09_poster.js',\n            'video/09_completion.js',\n            'video/10_commands.js',\n            'video/095_video_context_menu.js'\n        ],\n        function(\n            VideoStorage, initialize, FocusGrabber, VideoAccessibleMenu, VideoControl, VideoFullScreen,\n            VideoQualityControl, VideoProgressSlider, VideoVolumeControl, VideoSpeedControl, VideoAutoAdvanceControl,\n            VideoCaption, VideoPlayPlaceholder, VideoPlayPauseControl, VideoPlaySkipControl, VideoSkipControl,\n            VideoBumper, VideoSaveStatePlugin, VideoEventsPlugin, VideoEventsBumperPlugin, VideoPoster,\n            VideoCompletionHandler, VideoCommands, VideoContextMenu\n        ) {\n            /* RequireJS\n            var youtubeXhr = null,\n                oldVideo = window.Video;\n            /* End RequireJS */\n            /* Webpack */\n            var youtubeXhr = null;\n            /* End Webpack */\n\n            window.Video = function(element) {\n                var el = $(element).find('.video'),\n                    id = el.attr('id').replace(/video_/, ''),\n                    storage = VideoStorage('VideoState', id),\n                    bumperMetadata = el.data('bumper-metadata'),\n                    autoAdvanceEnabled = el.data('autoadvance-enabled') === 'True',\n                    mainVideoModules = [\n                        FocusGrabber, VideoControl, VideoPlayPlaceholder,\n                        VideoPlayPauseControl, VideoProgressSlider, VideoSpeedControl,\n                        VideoVolumeControl, VideoQualityControl, VideoFullScreen, VideoCaption, VideoCommands,\n                        VideoContextMenu, VideoSaveStatePlugin, VideoEventsPlugin, VideoCompletionHandler\n                    ].concat(autoAdvanceEnabled ? [VideoAutoAdvanceControl] : []),\n                    bumperVideoModules = [VideoControl, VideoPlaySkipControl, VideoSkipControl,\n                        VideoVolumeControl, VideoCaption, VideoCommands, VideoSaveStatePlugin,\n                        VideoEventsBumperPlugin, VideoCompletionHandler],\n                    state = {\n                        el: el,\n                        id: id,\n                        metadata: el.data('metadata'),\n                        storage: storage,\n                        options: {},\n                        youtubeXhr: youtubeXhr,\n                        modules: mainVideoModules\n                    };\n\n                var getBumperState = function(metadata) {\n                    var bumperState = $.extend(true, {\n                        el: el,\n                        id: id,\n                        storage: storage,\n                        options: {},\n                        youtubeXhr: youtubeXhr\n                    }, {metadata: metadata});\n\n                    bumperState.modules = bumperVideoModules;\n                    bumperState.options = {\n                        SaveStatePlugin: {events: ['language_menu:change']}\n                    };\n                    return bumperState;\n                };\n\n                var player = function(innerState) {\n                    return function() {\n                        _.extend(innerState.metadata, {autoplay: true, focusFirstControl: true});\n                        initialize(innerState, element);\n                    };\n                };\n                var onSequenceChange;\n\n                VideoAccessibleMenu(el, {\n                    storage: storage,\n                    saveStateUrl: state.metadata.saveStateUrl\n                });\n\n                if (bumperMetadata) {\n                    VideoPoster(el, {\n                        poster: el.data('poster'),\n                        onClick: _.once(function() {\n                            var mainVideoPlayer = player(state);\n                            var bumper, bumperState;\n                            if (storage.getItem('isBumperShown')) {\n                                mainVideoPlayer();\n                            } else {\n                                bumperState = getBumperState(bumperMetadata);\n                                bumper = new VideoBumper(player(bumperState), bumperState);\n                                state.bumperState = bumperState;\n                                bumper.getPromise().done(function() {\n                                    delete state.bumperState;\n                                    mainVideoPlayer();\n                                });\n                            }\n                        })\n                    });\n                } else {\n                    initialize(state, element);\n                }\n\n                if (!youtubeXhr) {\n                    youtubeXhr = state.youtubeXhr;\n                }\n\n                el.data('video-player-state', state);\n                onSequenceChange = function() {\n                    if (state && state.videoPlayer) {\n                        state.videoPlayer.destroy();\n                    }\n                    $('.sequence').off('sequence:change', onSequenceChange);\n                };\n                $('.sequence').on('sequence:change', onSequenceChange);\n\n                // Because the 'state' object is only available inside this closure, we will also make it available to\n                // the caller by returning it. This is necessary so that we can test Video with Jasmine.\n                return state;\n            };\n\n            window.Video.clearYoutubeXhr = function() {\n                youtubeXhr = null;\n            };\n\n            window.Video.loadYouTubeIFrameAPI = initialize.prototype.loadYouTubeIFrameAPI;\n\n            /* RequireJS\n            // Invoke the mock Video constructor so that the elements stored within it can be processed by the real\n            // `window.Video` constructor.\n            oldVideo(null, true);\n            /* End RequireJS */\n        }\n    );\n/* RequireJS\n\n/* End RequireJS */\n\n}.call(window));\n\n\n// WEBPACK FOOTER //\n// ./common/static/xmodule/modules/js/001-e45ae357eab0e4e2784fa6d04d4e16c1.js","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Hls = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],2:[function(_dereq_,module,exports){\n/* jshint ignore:start */\r\n(function(root) { \r\n/* jshint ignore:end */\r\n\r\n  var HASH_SPLIT = /^([^#]*)(.*)$/;\r\n  var QUERY_SPLIT = /^([^\\?]*)(.*)$/;\r\n  var DOMAIN_SPLIT = /^(([a-z]+:\\/\\/)?[^:\\/]+(?::[0-9]+)?)?(\\/?.*)$/i;\r\n\r\n  var URLToolkit = {\r\n    // build an absolute URL from a relative one using the provided baseURL\r\n    // if relativeURL is an absolute URL it will be returned as is.\r\n    buildAbsoluteURL: function(baseURL, relativeURL) {\r\n      // remove any remaining space and CRLF\r\n      relativeURL = relativeURL.trim();\r\n      if (/^[a-z]+:/i.test(relativeURL)) {\r\n        // complete url, not relative\r\n        return relativeURL;\r\n      }\r\n\r\n      var relativeURLQuery = null;\r\n      var relativeURLHash = null;\r\n\r\n      var relativeURLHashSplit = HASH_SPLIT.exec(relativeURL);\r\n      if (relativeURLHashSplit) {\r\n        relativeURLHash = relativeURLHashSplit[2];\r\n        relativeURL = relativeURLHashSplit[1];\r\n      }\r\n      var relativeURLQuerySplit = QUERY_SPLIT.exec(relativeURL);\r\n      if (relativeURLQuerySplit) {\r\n        relativeURLQuery = relativeURLQuerySplit[2];\r\n        relativeURL = relativeURLQuerySplit[1];\r\n      }\r\n\r\n      var baseURLHashSplit = HASH_SPLIT.exec(baseURL);\r\n      if (baseURLHashSplit) {\r\n        baseURL = baseURLHashSplit[1];\r\n      }\r\n      var baseURLQuerySplit = QUERY_SPLIT.exec(baseURL);\r\n      if (baseURLQuerySplit) {\r\n        baseURL = baseURLQuerySplit[1];\r\n      }\r\n\r\n      var baseURLDomainSplit = DOMAIN_SPLIT.exec(baseURL);\r\n      if (!baseURLDomainSplit) {\r\n        throw new Error('Error trying to parse base URL.');\r\n      }\r\n      \r\n      // e.g. 'http://', 'https://', ''\r\n      var baseURLProtocol = baseURLDomainSplit[2] || '';\r\n      // e.g. 'http://example.com', '//example.com', 'example.com', ''\r\n      var baseURLProtocolDomain = baseURLDomainSplit[1] || '';\r\n      // e.g. '/a/b/c/playlist.m3u8', 'a/b/c/playlist.m3u8'\r\n      var baseURLPath = baseURLDomainSplit[3];\r\n      if (baseURLPath.indexOf('/') !== 0 && baseURLProtocolDomain !== '') {\r\n        // this handles a base url of http://example.com (missing last slash)\r\n        baseURLPath = '/'+baseURLPath;\r\n      }\r\n\r\n      var builtURL = null;\r\n      if (/^\\/\\//.test(relativeURL)) {\r\n        // relative url starts wth '//' so copy protocol (which may be '' if baseUrl didn't provide one)\r\n        builtURL = baseURLProtocol+URLToolkit.buildAbsolutePath('', relativeURL.substring(2));\r\n      }\r\n      else if (/^\\//.test(relativeURL)) {\r\n        // relative url starts with '/' so start from root of domain\r\n        builtURL = baseURLProtocolDomain+'/'+URLToolkit.buildAbsolutePath('', relativeURL.substring(1));\r\n      }\r\n      else {\r\n        builtURL = URLToolkit.buildAbsolutePath(baseURLProtocolDomain+baseURLPath, relativeURL);\r\n      }\r\n\r\n      // put the query and hash parts back\r\n      if (relativeURLQuery) {\r\n        builtURL += relativeURLQuery;\r\n      }\r\n      if (relativeURLHash) {\r\n        builtURL += relativeURLHash;\r\n      }\r\n      return builtURL;\r\n    },\r\n\r\n    // build an absolute path using the provided basePath\r\n    // adapted from https://developer.mozilla.org/en-US/docs/Web/API/document/cookie#Using_relative_URLs_in_the_path_parameter\r\n    // this does not handle the case where relativePath is \"/\" or \"//\". These cases should be handled outside this.\r\n    buildAbsolutePath: function(basePath, relativePath) {\r\n      var sRelPath = relativePath;\r\n      var nUpLn, sDir = '', sPath = basePath.replace(/[^\\/]*$/, sRelPath.replace(/(\\/|^)(?:\\.?\\/+)+/g, '$1'));\r\n      for (var nEnd, nStart = 0; nEnd = sPath.indexOf('/../', nStart), nEnd > -1; nStart = nEnd + nUpLn) {\r\n        nUpLn = /^\\/(?:\\.\\.\\/)*/.exec(sPath.slice(nEnd))[0].length;\r\n        sDir = (sDir + sPath.substring(nStart, nEnd)).replace(new RegExp('(?:\\\\\\/+[^\\\\\\/]*){0,' + ((nUpLn - 1) / 3) + '}$'), '/');\r\n      }\r\n      return sDir + sPath.substr(nStart);\r\n    }\r\n  };\r\n\r\n/* jshint ignore:start */\r\n  if(typeof exports === 'object' && typeof module === 'object')\r\n    module.exports = URLToolkit;\r\n  else if(typeof define === 'function' && define.amd)\r\n    define([], function() { return URLToolkit; });\r\n  else if(typeof exports === 'object')\r\n    exports[\"URLToolkit\"] = URLToolkit;\r\n  else\r\n    root[\"URLToolkit\"] = URLToolkit;\r\n})(this);\r\n/* jshint ignore:end */\r\n\n},{}],3:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            Function(['require','module','exports'], '(' + fn + ')(self)'),\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        Function(['require'], (\n            // try to call default if defined to also support babel esmodule\n            // exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);'\n        )),\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],4:[function(_dereq_,module,exports){\n/**\n * HLS config\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n      value: true\n});\nexports.hlsDefaultConfig = undefined;\n\nvar _abrController = _dereq_(5);\n\nvar _abrController2 = _interopRequireDefault(_abrController);\n\nvar _bufferController = _dereq_(8);\n\nvar _bufferController2 = _interopRequireDefault(_bufferController);\n\nvar _capLevelController = _dereq_(9);\n\nvar _capLevelController2 = _interopRequireDefault(_capLevelController);\n\nvar _fpsController = _dereq_(11);\n\nvar _fpsController2 = _interopRequireDefault(_fpsController);\n\nvar _xhrLoader = _dereq_(55);\n\nvar _xhrLoader2 = _interopRequireDefault(_xhrLoader);\n\nvar _audioTrackController = _dereq_(7);\n\nvar _audioTrackController2 = _interopRequireDefault(_audioTrackController);\n\nvar _audioStreamController = _dereq_(6);\n\nvar _audioStreamController2 = _interopRequireDefault(_audioStreamController);\n\nvar _cues = _dereq_(48);\n\nvar _cues2 = _interopRequireDefault(_cues);\n\nvar _timelineController = _dereq_(16);\n\nvar _timelineController2 = _interopRequireDefault(_timelineController);\n\nvar _subtitleTrackController = _dereq_(15);\n\nvar _subtitleTrackController2 = _interopRequireDefault(_subtitleTrackController);\n\nvar _subtitleStreamController = _dereq_(14);\n\nvar _subtitleStreamController2 = _interopRequireDefault(_subtitleStreamController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//#endif\n\n//#endif\n\n//#if subtitle\n\n//import FetchLoader from './utils/fetch-loader';\n//#if altaudio\nvar hlsDefaultConfig = exports.hlsDefaultConfig = {\n      autoStartLoad: true, // used by stream-controller\n      startPosition: -1, // used by stream-controller\n      defaultAudioCodec: undefined, // used by stream-controller\n      debug: false, // used by logger\n      capLevelOnFPSDrop: false, // used by fps-controller\n      capLevelToPlayerSize: false, // used by cap-level-controller\n      initialLiveManifestSize: 1, // used by stream-controller\n      maxBufferLength: 30, // used by stream-controller\n      maxBufferSize: 60 * 1000 * 1000, // used by stream-controller\n      maxBufferHole: 0.5, // used by stream-controller\n      maxSeekHole: 2, // used by stream-controller\n      lowBufferWatchdogPeriod: 0.5, // used by stream-controller\n      highBufferWatchdogPeriod: 3, // used by stream-controller\n      nudgeOffset: 0.1, // used by stream-controller\n      nudgeMaxRetry: 3, // used by stream-controller\n      maxFragLookUpTolerance: 0.2, // used by stream-controller\n      liveSyncDurationCount: 3, // used by stream-controller\n      liveMaxLatencyDurationCount: Infinity, // used by stream-controller\n      liveSyncDuration: undefined, // used by stream-controller\n      liveMaxLatencyDuration: undefined, // used by stream-controller\n      maxMaxBufferLength: 600, // used by stream-controller\n      enableWorker: true, // used by demuxer\n      enableSoftwareAES: true, // used by decrypter\n      manifestLoadingTimeOut: 10000, // used by playlist-loader\n      manifestLoadingMaxRetry: 1, // used by playlist-loader\n      manifestLoadingRetryDelay: 1000, // used by playlist-loader\n      manifestLoadingMaxRetryTimeout: 64000, // used by playlist-loader\n      startLevel: undefined, // used by level-controller\n      levelLoadingTimeOut: 10000, // used by playlist-loader\n      levelLoadingMaxRetry: 4, // used by playlist-loader\n      levelLoadingRetryDelay: 1000, // used by playlist-loader\n      levelLoadingMaxRetryTimeout: 64000, // used by playlist-loader\n      fragLoadingTimeOut: 20000, // used by fragment-loader\n      fragLoadingMaxRetry: 6, // used by fragment-loader\n      fragLoadingRetryDelay: 1000, // used by fragment-loader\n      fragLoadingMaxRetryTimeout: 64000, // used by fragment-loader\n      fragLoadingLoopThreshold: 3, // used by stream-controller\n      startFragPrefetch: false, // used by stream-controller\n      fpsDroppedMonitoringPeriod: 5000, // used by fps-controller\n      fpsDroppedMonitoringThreshold: 0.2, // used by fps-controller\n      appendErrorMaxRetry: 3, // used by buffer-controller\n      loader: _xhrLoader2.default,\n      //loader: FetchLoader,\n      fLoader: undefined,\n      pLoader: undefined,\n      xhrSetup: undefined,\n      fetchSetup: undefined,\n      abrController: _abrController2.default,\n      bufferController: _bufferController2.default,\n      capLevelController: _capLevelController2.default,\n      fpsController: _fpsController2.default,\n      //#if altaudio\n      audioStreamController: _audioStreamController2.default,\n      audioTrackController: _audioTrackController2.default,\n      //#endif\n      //#if subtitle\n      subtitleStreamController: _subtitleStreamController2.default,\n      subtitleTrackController: _subtitleTrackController2.default,\n      timelineController: _timelineController2.default,\n      cueHandler: _cues2.default,\n      enableCEA708Captions: true, // used by timeline-controller\n      enableWebVTT: true, // used by timeline-controller\n      //#endif\n      stretchShortVideoTrack: false, // used by mp4-remuxer\n      forceKeyFrameOnDiscontinuity: true, // used by ts-demuxer\n      abrEwmaFastLive: 3, // used by abr-controller\n      abrEwmaSlowLive: 9, // used by abr-controller\n      abrEwmaFastVoD: 3, // used by abr-controller\n      abrEwmaSlowVoD: 9, // used by abr-controller\n      abrEwmaDefaultEstimate: 5e5, // 500 kbps  // used by abr-controller\n      abrBandWidthFactor: 0.95, // used by abr-controller\n      abrBandWidthUpFactor: 0.7, // used by abr-controller\n      abrMaxWithRealBitrate: false, // used by abr-controller\n      maxStarvationDelay: 4, // used by abr-controller\n      maxLoadingDelay: 4, // used by abr-controller\n      minAutoBitrate: 0 // used by hls\n};\n\n},{\"11\":11,\"14\":14,\"15\":15,\"16\":16,\"48\":48,\"5\":5,\"55\":55,\"6\":6,\"7\":7,\"8\":8,\"9\":9}],5:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _bufferHelper = _dereq_(35);\n\nvar _bufferHelper2 = _interopRequireDefault(_bufferHelper);\n\nvar _errors = _dereq_(31);\n\nvar _logger = _dereq_(50);\n\nvar _ewmaBandwidthEstimator = _dereq_(10);\n\nvar _ewmaBandwidthEstimator2 = _interopRequireDefault(_ewmaBandwidthEstimator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * simple ABR Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *  - compute next level based on last fragment bw heuristics\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *  - implement an abandon rules triggered if we have less than 2 frag buffered and if computed bw shows that we risk buffer stalling\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar AbrController = function (_EventHandler) {\n  _inherits(AbrController, _EventHandler);\n\n  function AbrController(hls) {\n    _classCallCheck(this, AbrController);\n\n    var _this = _possibleConstructorReturn(this, (AbrController.__proto__ || Object.getPrototypeOf(AbrController)).call(this, hls, _events2.default.FRAG_LOADING, _events2.default.FRAG_LOADED, _events2.default.FRAG_BUFFERED, _events2.default.ERROR));\n\n    _this.lastLoadedFragLevel = 0;\n    _this._nextAutoLevel = -1;\n    _this.hls = hls;\n    _this.onCheck = _this._abandonRulesCheck.bind(_this);\n    return _this;\n  }\n\n  _createClass(AbrController, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.clearTimer();\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'onFragLoading',\n    value: function onFragLoading(data) {\n      var frag = data.frag;\n      if (frag.type === 'main') {\n        if (!this.timer) {\n          this.timer = setInterval(this.onCheck, 100);\n        }\n        // lazy init of bw Estimator, rationale is that we use different params for Live/VoD\n        // so we need to wait for stream manifest / playlist type to instantiate it.\n        if (!this._bwEstimator) {\n          var hls = this.hls,\n              level = data.frag.level,\n              isLive = hls.levels[level].details.live,\n              config = hls.config,\n              ewmaFast = void 0,\n              ewmaSlow = void 0;\n\n          if (isLive) {\n            ewmaFast = config.abrEwmaFastLive;\n            ewmaSlow = config.abrEwmaSlowLive;\n          } else {\n            ewmaFast = config.abrEwmaFastVoD;\n            ewmaSlow = config.abrEwmaSlowVoD;\n          }\n          this._bwEstimator = new _ewmaBandwidthEstimator2.default(hls, ewmaSlow, ewmaFast, config.abrEwmaDefaultEstimate);\n        }\n        this.fragCurrent = frag;\n      }\n    }\n  }, {\n    key: '_abandonRulesCheck',\n    value: function _abandonRulesCheck() {\n      /*\n        monitor fragment retrieval time...\n        we compute expected time of arrival of the complete fragment.\n        we compare it to expected time of buffer starvation\n      */\n      var hls = this.hls,\n          v = hls.media,\n          frag = this.fragCurrent,\n          loader = frag.loader,\n          minAutoLevel = hls.minAutoLevel;\n\n      // if loader has been destroyed or loading has been aborted, stop timer and return\n      if (!loader || loader.stats && loader.stats.aborted) {\n        _logger.logger.warn('frag loader destroy or aborted, disarm abandonRules');\n        this.clearTimer();\n        return;\n      }\n      var stats = loader.stats;\n      /* only monitor frag retrieval time if\n      (video not paused OR first fragment being loaded(ready state === HAVE_NOTHING = 0)) AND autoswitching enabled AND not lowest level (=> means that we have several levels) */\n      if (v && (!v.paused && v.playbackRate !== 0 || !v.readyState) && frag.autoLevel && frag.level) {\n        var requestDelay = performance.now() - stats.trequest,\n            playbackRate = Math.abs(v.playbackRate);\n        // monitor fragment load progress after half of expected fragment duration,to stabilize bitrate\n        if (requestDelay > 500 * frag.duration / playbackRate) {\n          var levels = hls.levels,\n              loadRate = Math.max(1, stats.bw ? stats.bw / 8 : stats.loaded * 1000 / requestDelay),\n              // byte/s; at least 1 byte/s to avoid division by zero\n          // compute expected fragment length using frag duration and level bitrate. also ensure that expected len is gte than already loaded size\n          level = levels[frag.level],\n              levelBitrate = level.realBitrate ? Math.max(level.realBitrate, level.bitrate) : level.bitrate,\n              expectedLen = stats.total ? stats.total : Math.max(stats.loaded, Math.round(frag.duration * levelBitrate / 8)),\n              pos = v.currentTime,\n              fragLoadedDelay = (expectedLen - stats.loaded) / loadRate,\n              bufferStarvationDelay = (_bufferHelper2.default.bufferInfo(v, pos, hls.config.maxBufferHole).end - pos) / playbackRate;\n          // consider emergency switch down only if we have less than 2 frag buffered AND\n          // time to finish loading current fragment is bigger than buffer starvation delay\n          // ie if we risk buffer starvation if bw does not increase quickly\n          if (bufferStarvationDelay < 2 * frag.duration / playbackRate && fragLoadedDelay > bufferStarvationDelay) {\n            var fragLevelNextLoadedDelay = void 0,\n                nextLoadLevel = void 0;\n            // lets iterate through lower level and try to find the biggest one that could avoid rebuffering\n            // we start from current level - 1 and we step down , until we find a matching level\n            for (nextLoadLevel = frag.level - 1; nextLoadLevel > minAutoLevel; nextLoadLevel--) {\n              // compute time to load next fragment at lower level\n              // 0.8 : consider only 80% of current bw to be conservative\n              // 8 = bits per byte (bps/Bps)\n              var levelNextBitrate = levels[nextLoadLevel].realBitrate ? Math.max(levels[nextLoadLevel].realBitrate, levels[nextLoadLevel].bitrate) : levels[nextLoadLevel].bitrate;\n              fragLevelNextLoadedDelay = frag.duration * levelNextBitrate / (8 * 0.8 * loadRate);\n              if (fragLevelNextLoadedDelay < bufferStarvationDelay) {\n                // we found a lower level that be rebuffering free with current estimated bw !\n                break;\n              }\n            }\n            // only emergency switch down if it takes less time to load new fragment at lowest level instead\n            // of finishing loading current one ...\n            if (fragLevelNextLoadedDelay < fragLoadedDelay) {\n              _logger.logger.warn('loading too slow, abort fragment loading and switch to level ' + nextLoadLevel + ':fragLoadedDelay[' + nextLoadLevel + ']<fragLoadedDelay[' + (frag.level - 1) + '];bufferStarvationDelay:' + fragLevelNextLoadedDelay.toFixed(1) + '<' + fragLoadedDelay.toFixed(1) + ':' + bufferStarvationDelay.toFixed(1));\n              // force next load level in auto mode\n              hls.nextLoadLevel = nextLoadLevel;\n              // update bw estimate for this fragment before cancelling load (this will help reducing the bw)\n              this._bwEstimator.sample(requestDelay, stats.loaded);\n              //abort fragment loading\n              loader.abort();\n              // stop abandon rules timer\n              this.clearTimer();\n              hls.trigger(_events2.default.FRAG_LOAD_EMERGENCY_ABORTED, { frag: frag, stats: stats });\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: 'onFragLoaded',\n    value: function onFragLoaded(data) {\n      var frag = data.frag;\n      if (frag.type === 'main' && !isNaN(frag.sn)) {\n        // stop monitoring bw once frag loaded\n        this.clearTimer();\n        // store level id after successful fragment load\n        this.lastLoadedFragLevel = frag.level;\n        // reset forced auto level value so that next level will be selected\n        this._nextAutoLevel = -1;\n\n        // compute level average bitrate\n        if (this.hls.config.abrMaxWithRealBitrate) {\n          var level = this.hls.levels[frag.level];\n          var loadedBytes = (level.loaded ? level.loaded.bytes : 0) + data.stats.loaded;\n          var loadedDuration = (level.loaded ? level.loaded.duration : 0) + data.frag.duration;\n          level.loaded = { bytes: loadedBytes, duration: loadedDuration };\n          level.realBitrate = Math.round(8 * loadedBytes / loadedDuration);\n        }\n        // if fragment has been loaded to perform a bitrate test,\n        if (data.frag.bitrateTest) {\n          var stats = data.stats;\n          stats.tparsed = stats.tbuffered = stats.tload;\n          this.onFragBuffered(data);\n        }\n      }\n    }\n  }, {\n    key: 'onFragBuffered',\n    value: function onFragBuffered(data) {\n      var stats = data.stats,\n          frag = data.frag;\n      // only update stats on first frag buffering\n      // if same frag is loaded multiple times, it might be in browser cache, and loaded quickly\n      // and leading to wrong bw estimation\n      // on bitrate test, also only update stats once (if tload = tbuffered == on FRAG_LOADED)\n      if (stats.aborted !== true && frag.loadCounter === 1 && frag.type === 'main' && !isNaN(frag.sn) && (!frag.bitrateTest || stats.tload === stats.tbuffered)) {\n        // use tparsed-trequest instead of tbuffered-trequest to compute fragLoadingProcessing; rationale is that  buffer appending only happens once media is attached\n        // in case we use config.startFragPrefetch while media is not attached yet, fragment might be parsed while media not attached yet, but it will only be buffered on media attached\n        // as a consequence it could happen really late in the process. meaning that appending duration might appears huge ... leading to underestimated throughput estimation\n        var fragLoadingProcessingMs = stats.tparsed - stats.trequest;\n        _logger.logger.log('latency/loading/parsing/append/kbps:' + Math.round(stats.tfirst - stats.trequest) + '/' + Math.round(stats.tload - stats.tfirst) + '/' + Math.round(stats.tparsed - stats.tload) + '/' + Math.round(stats.tbuffered - stats.tparsed) + '/' + Math.round(8 * stats.loaded / (stats.tbuffered - stats.trequest)));\n        this._bwEstimator.sample(fragLoadingProcessingMs, stats.loaded);\n        // if fragment has been loaded to perform a bitrate test, (hls.startLevel = -1), store bitrate test delay duration\n        if (frag.bitrateTest) {\n          this.bitrateTestDelay = fragLoadingProcessingMs / 1000;\n        } else {\n          this.bitrateTestDelay = 0;\n        }\n      }\n    }\n  }, {\n    key: 'onError',\n    value: function onError(data) {\n      // stop timer in case of frag loading error\n      switch (data.details) {\n        case _errors.ErrorDetails.FRAG_LOAD_ERROR:\n        case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:\n          this.clearTimer();\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: 'clearTimer',\n    value: function clearTimer() {\n      if (this.timer) {\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n    }\n\n    // return next auto level\n\n  }, {\n    key: '_findBestLevel',\n    value: function _findBestLevel(currentLevel, currentFragDuration, currentBw, minAutoLevel, maxAutoLevel, maxFetchDuration, bwFactor, bwUpFactor, levels) {\n      for (var i = maxAutoLevel; i >= minAutoLevel; i--) {\n        var levelInfo = levels[i],\n            levelDetails = levelInfo.details,\n            avgDuration = levelDetails ? levelDetails.totalduration / levelDetails.fragments.length : currentFragDuration,\n            live = levelDetails ? levelDetails.live : false,\n            adjustedbw = void 0;\n        // follow algorithm captured from stagefright :\n        // https://android.googlesource.com/platform/frameworks/av/+/master/media/libstagefright/httplive/LiveSession.cpp\n        // Pick the highest bandwidth stream below or equal to estimated bandwidth.\n        // consider only 80% of the available bandwidth, but if we are switching up,\n        // be even more conservative (70%) to avoid overestimating and immediately\n        // switching back.\n        if (i <= currentLevel) {\n          adjustedbw = bwFactor * currentBw;\n        } else {\n          adjustedbw = bwUpFactor * currentBw;\n        }\n        var bitrate = levels[i].realBitrate ? Math.max(levels[i].realBitrate, levels[i].bitrate) : levels[i].bitrate,\n            fetchDuration = bitrate * avgDuration / adjustedbw;\n\n        _logger.logger.trace('level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: ' + i + '/' + Math.round(adjustedbw) + '/' + bitrate + '/' + avgDuration + '/' + maxFetchDuration + '/' + fetchDuration);\n        // if adjusted bw is greater than level bitrate AND\n        if (adjustedbw > bitrate && (\n        // fragment fetchDuration unknown OR live stream OR fragment fetchDuration less than max allowed fetch duration, then this level matches\n        // we don't account for max Fetch Duration for live streams, this is to avoid switching down when near the edge of live sliding window ...\n        !fetchDuration || live || fetchDuration < maxFetchDuration)) {\n          // as we are looping from highest to lowest, this will return the best achievable quality level\n\n          return i;\n        }\n      }\n      // not enough time budget even with quality level 0 ... rebuffering might happen\n      return -1;\n    }\n  }, {\n    key: 'nextAutoLevel',\n    get: function get() {\n      var forcedAutoLevel = this._nextAutoLevel;\n      var bwEstimator = this._bwEstimator;\n      // in case next auto level has been forced, and bw not available or not reliable, return forced value\n      if (forcedAutoLevel !== -1 && (!bwEstimator || !bwEstimator.canEstimate())) {\n        return forcedAutoLevel;\n      }\n      // compute next level using ABR logic\n      var nextABRAutoLevel = this._nextABRAutoLevel;\n      // if forced auto level has been defined, use it to cap ABR computed quality level\n      if (forcedAutoLevel !== -1) {\n        nextABRAutoLevel = Math.min(forcedAutoLevel, nextABRAutoLevel);\n      }\n      return nextABRAutoLevel;\n    },\n    set: function set(nextLevel) {\n      this._nextAutoLevel = nextLevel;\n    }\n  }, {\n    key: '_nextABRAutoLevel',\n    get: function get() {\n      var hls = this.hls,\n          maxAutoLevel = hls.maxAutoLevel,\n          levels = hls.levels,\n          config = hls.config,\n          minAutoLevel = hls.minAutoLevel;\n      var v = hls.media,\n          currentLevel = this.lastLoadedFragLevel,\n          currentFragDuration = this.fragCurrent ? this.fragCurrent.duration : 0,\n          pos = v ? v.currentTime : 0,\n\n      // playbackRate is the absolute value of the playback rate; if v.playbackRate is 0, we use 1 to load as\n      // if we're playing back at the normal rate.\n      playbackRate = v && v.playbackRate !== 0 ? Math.abs(v.playbackRate) : 1.0,\n          avgbw = this._bwEstimator ? this._bwEstimator.getEstimate() : config.abrEwmaDefaultEstimate,\n\n      // bufferStarvationDelay is the wall-clock time left until the playback buffer is exhausted.\n      bufferStarvationDelay = (_bufferHelper2.default.bufferInfo(v, pos, config.maxBufferHole).end - pos) / playbackRate;\n\n      // First, look to see if we can find a level matching with our avg bandwidth AND that could also guarantee no rebuffering at all\n      var bestLevel = this._findBestLevel(currentLevel, currentFragDuration, avgbw, minAutoLevel, maxAutoLevel, bufferStarvationDelay, config.abrBandWidthFactor, config.abrBandWidthUpFactor, levels);\n      if (bestLevel >= 0) {\n        return bestLevel;\n      } else {\n        _logger.logger.trace('rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering');\n        // not possible to get rid of rebuffering ... let's try to find level that will guarantee less than maxStarvationDelay of rebuffering\n        // if no matching level found, logic will return 0\n        var maxStarvationDelay = currentFragDuration ? Math.min(currentFragDuration, config.maxStarvationDelay) : config.maxStarvationDelay,\n            bwFactor = config.abrBandWidthFactor,\n            bwUpFactor = config.abrBandWidthUpFactor;\n        if (bufferStarvationDelay === 0) {\n          // in case buffer is empty, let's check if previous fragment was loaded to perform a bitrate test\n          var bitrateTestDelay = this.bitrateTestDelay;\n          if (bitrateTestDelay) {\n            // if it is the case, then we need to adjust our max starvation delay using maxLoadingDelay config value\n            // max video loading delay used in  automatic start level selection :\n            // in that mode ABR controller will ensure that video loading time (ie the time to fetch the first fragment at lowest quality level +\n            // the time to fetch the fragment at the appropriate quality level is less than ```maxLoadingDelay``` )\n            // cap maxLoadingDelay and ensure it is not bigger 'than bitrate test' frag duration\n            var maxLoadingDelay = currentFragDuration ? Math.min(currentFragDuration, config.maxLoadingDelay) : config.maxLoadingDelay;\n            maxStarvationDelay = maxLoadingDelay - bitrateTestDelay;\n            _logger.logger.trace('bitrate test took ' + Math.round(1000 * bitrateTestDelay) + 'ms, set first fragment max fetchDuration to ' + Math.round(1000 * maxStarvationDelay) + ' ms');\n            // don't use conservative factor on bitrate test\n            bwFactor = bwUpFactor = 1;\n          }\n        }\n        bestLevel = this._findBestLevel(currentLevel, currentFragDuration, avgbw, minAutoLevel, maxAutoLevel, bufferStarvationDelay + maxStarvationDelay, bwFactor, bwUpFactor, levels);\n        return Math.max(bestLevel, 0);\n      }\n    }\n  }]);\n\n  return AbrController;\n}(_eventHandler2.default);\n\nexports.default = AbrController;\n\n},{\"10\":10,\"31\":31,\"32\":32,\"33\":33,\"35\":35,\"50\":50}],6:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _binarySearch = _dereq_(46);\n\nvar _binarySearch2 = _interopRequireDefault(_binarySearch);\n\nvar _bufferHelper = _dereq_(35);\n\nvar _bufferHelper2 = _interopRequireDefault(_bufferHelper);\n\nvar _demuxer = _dereq_(25);\n\nvar _demuxer2 = _interopRequireDefault(_demuxer);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _levelHelper = _dereq_(36);\n\nvar _levelHelper2 = _interopRequireDefault(_levelHelper);\n\nvar _timeRanges = _dereq_(51);\n\nvar _timeRanges2 = _interopRequireDefault(_timeRanges);\n\nvar _errors = _dereq_(31);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Audio Stream Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar State = {\n  STOPPED: 'STOPPED',\n  STARTING: 'STARTING',\n  IDLE: 'IDLE',\n  PAUSED: 'PAUSED',\n  KEY_LOADING: 'KEY_LOADING',\n  FRAG_LOADING: 'FRAG_LOADING',\n  FRAG_LOADING_WAITING_RETRY: 'FRAG_LOADING_WAITING_RETRY',\n  WAITING_TRACK: 'WAITING_TRACK',\n  PARSING: 'PARSING',\n  PARSED: 'PARSED',\n  BUFFER_FLUSHING: 'BUFFER_FLUSHING',\n  ENDED: 'ENDED',\n  ERROR: 'ERROR',\n  WAITING_INIT_PTS: 'WAITING_INIT_PTS'\n};\n\nvar AudioStreamController = function (_EventHandler) {\n  _inherits(AudioStreamController, _EventHandler);\n\n  function AudioStreamController(hls) {\n    _classCallCheck(this, AudioStreamController);\n\n    var _this = _possibleConstructorReturn(this, (AudioStreamController.__proto__ || Object.getPrototypeOf(AudioStreamController)).call(this, hls, _events2.default.MEDIA_ATTACHED, _events2.default.MEDIA_DETACHING, _events2.default.AUDIO_TRACKS_UPDATED, _events2.default.AUDIO_TRACK_SWITCHING, _events2.default.AUDIO_TRACK_LOADED, _events2.default.KEY_LOADED, _events2.default.FRAG_LOADED, _events2.default.FRAG_PARSING_INIT_SEGMENT, _events2.default.FRAG_PARSING_DATA, _events2.default.FRAG_PARSED, _events2.default.ERROR, _events2.default.BUFFER_CREATED, _events2.default.BUFFER_APPENDED, _events2.default.BUFFER_FLUSHED, _events2.default.INIT_PTS_FOUND));\n\n    _this.config = hls.config;\n    _this.audioCodecSwap = false;\n    _this.ticks = 0;\n    _this._state = State.STOPPED;\n    _this.ontick = _this.tick.bind(_this);\n    _this.initPTS = [];\n    _this.waitingFragment = null;\n    return _this;\n  }\n\n  _createClass(AudioStreamController, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.stopLoad();\n      if (this.timer) {\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n      _eventHandler2.default.prototype.destroy.call(this);\n      this.state = State.STOPPED;\n    }\n\n    //Signal that video PTS was found\n\n  }, {\n    key: 'onInitPtsFound',\n    value: function onInitPtsFound(data) {\n      var demuxerId = data.id,\n          cc = data.frag.cc,\n          initPTS = data.initPTS;\n      if (demuxerId === 'main') {\n        //Always update the new INIT PTS\n        //Can change due level switch\n        this.initPTS[cc] = initPTS;\n        _logger.logger.log('InitPTS for cc:' + cc + ' found from video track:' + initPTS);\n\n        //If we are waiting we need to demux/remux the waiting frag\n        //With the new initPTS\n        if (this.state === State.WAITING_INIT_PTS) {\n          _logger.logger.log('sending pending audio frag to demuxer');\n          this.state = State.FRAG_LOADING;\n          //We have audio frag waiting or video pts\n          //Let process it\n          this.onFragLoaded(this.waitingFragment);\n          //Lets clean the waiting frag\n          this.waitingFragment = null;\n        }\n      }\n    }\n  }, {\n    key: 'startLoad',\n    value: function startLoad(startPosition) {\n      if (this.tracks) {\n        var lastCurrentTime = this.lastCurrentTime;\n        this.stopLoad();\n        if (!this.timer) {\n          this.timer = setInterval(this.ontick, 100);\n        }\n        this.fragLoadError = 0;\n        if (lastCurrentTime > 0 && startPosition === -1) {\n          _logger.logger.log('audio:override startPosition with lastCurrentTime @' + lastCurrentTime.toFixed(3));\n          this.state = State.IDLE;\n        } else {\n          this.lastCurrentTime = this.startPosition ? this.startPosition : startPosition;\n          this.state = State.STARTING;\n        }\n        this.nextLoadPosition = this.startPosition = this.lastCurrentTime;\n        this.tick();\n      } else {\n        this.startPosition = startPosition;\n        this.state = State.STOPPED;\n      }\n    }\n  }, {\n    key: 'stopLoad',\n    value: function stopLoad() {\n      var frag = this.fragCurrent;\n      if (frag) {\n        if (frag.loader) {\n          frag.loader.abort();\n        }\n        this.fragCurrent = null;\n      }\n      this.fragPrevious = null;\n      if (this.demuxer) {\n        this.demuxer.destroy();\n        this.demuxer = null;\n      }\n      this.state = State.STOPPED;\n    }\n  }, {\n    key: 'tick',\n    value: function tick() {\n      this.ticks++;\n      if (this.ticks === 1) {\n        this.doTick();\n        if (this.ticks > 1) {\n          setTimeout(this.tick, 1);\n        }\n        this.ticks = 0;\n      }\n    }\n  }, {\n    key: 'doTick',\n    value: function doTick() {\n      var _this2 = this;\n\n      var pos,\n          track,\n          trackDetails,\n          hls = this.hls,\n          config = hls.config;\n      //logger.log('audioStream:' + this.state);\n      var now;\n      var retryDate;\n      var isSeeking;\n\n      var _ret = function () {\n        switch (_this2.state) {\n          case State.ERROR:\n          //don't do anything in error state to avoid breaking further ...\n          case State.PAUSED:\n          //don't do anything in paused state either ...\n          case State.BUFFER_FLUSHING:\n            break;\n          case State.STARTING:\n            _this2.state = State.WAITING_TRACK;\n            _this2.loadedmetadata = false;\n            break;\n          case State.IDLE:\n            var tracks = _this2.tracks;\n            // audio tracks not received => exit loop\n            if (!tracks) {\n              break;\n            }\n            // if video not attached AND\n            // start fragment already requested OR start frag prefetch disable\n            // exit loop\n            // => if media not attached but start frag prefetch is enabled and start frag not requested yet, we will not exit loop\n            if (!_this2.media && (_this2.startFragRequested || !config.startFragPrefetch)) {\n              break;\n            }\n            // determine next candidate fragment to be loaded, based on current position and\n            //  end of buffer position\n            // if we have not yet loaded any fragment, start loading from start position\n            if (_this2.loadedmetadata) {\n              pos = _this2.media.currentTime;\n            } else {\n              pos = _this2.nextLoadPosition;\n            }\n            var media = _this2.mediaBuffer ? _this2.mediaBuffer : _this2.media,\n                bufferInfo = _bufferHelper2.default.bufferInfo(media, pos, config.maxBufferHole),\n                bufferLen = bufferInfo.len,\n                bufferEnd = bufferInfo.end,\n                fragPrevious = _this2.fragPrevious,\n                maxBufLen = config.maxMaxBufferLength,\n                audioSwitch = _this2.audioSwitch,\n                trackId = _this2.trackId;\n\n            // if buffer length is less than maxBufLen try to load a new fragment\n            if (bufferLen < maxBufLen && trackId < tracks.length) {\n              trackDetails = tracks[trackId].details;\n              // if track info not retrieved yet, switch state and wait for track retrieval\n              if (typeof trackDetails === 'undefined') {\n                _this2.state = State.WAITING_TRACK;\n                break;\n              }\n\n              // we just got done loading the final fragment, check if we need to finalize media stream\n              if (!audioSwitch && !trackDetails.live && fragPrevious && fragPrevious.sn === trackDetails.endSN) {\n                // if we are not seeking or if we are seeking but everything (almost) til the end is buffered, let's signal eos\n                // we don't compare exactly media.duration === bufferInfo.end as there could be some subtle media duration difference when switching\n                // between different renditions. using half frag duration should help cope with these cases.\n                if (!_this2.media.seeking || _this2.media.duration - bufferEnd < fragPrevious.duration / 2) {\n                  // Finalize the media stream\n                  _this2.hls.trigger(_events2.default.BUFFER_EOS, { type: 'audio' });\n                  _this2.state = State.ENDED;\n                  break;\n                }\n              }\n\n              // find fragment index, contiguous with end of buffer position\n              var fragments = trackDetails.fragments,\n                  fragLen = fragments.length,\n                  start = fragments[0].start,\n                  end = fragments[fragLen - 1].start + fragments[fragLen - 1].duration,\n                  frag = void 0;\n\n              // When switching audio track, reload audio as close as possible to currentTime\n              if (audioSwitch) {\n                if (trackDetails.live && !trackDetails.PTSKnown) {\n                  _logger.logger.log('switching audiotrack, live stream, unknown PTS,load first fragment');\n                  bufferEnd = 0;\n                } else {\n                  bufferEnd = pos;\n                  // if currentTime (pos) is less than alt audio playlist start time, it means that alt audio is ahead of currentTime\n                  if (trackDetails.PTSKnown && pos < start) {\n                    // if everything is buffered from pos to start or if audio buffer upfront, let's seek to start\n                    if (bufferInfo.end > start || bufferInfo.nextStart) {\n                      _logger.logger.log('alt audio track ahead of main track, seek to start of alt audio track');\n                      _this2.media.currentTime = start + 0.05;\n                    } else {\n                      return {\n                        v: void 0\n                      };\n                    }\n                  }\n                }\n              }\n              if (trackDetails.initSegment && !trackDetails.initSegment.data) {\n                frag = trackDetails.initSegment;\n              }\n              // if bufferEnd before start of playlist, load first fragment\n              else if (bufferEnd <= start) {\n                  frag = fragments[0];\n                  if (trackDetails.live && frag.loadIdx && frag.loadIdx === _this2.fragLoadIdx) {\n                    // we just loaded this first fragment, and we are still lagging behind the start of the live playlist\n                    // let's force seek to start\n                    var nextBuffered = bufferInfo.nextStart ? bufferInfo.nextStart : start;\n                    _logger.logger.log('no alt audio available @currentTime:' + _this2.media.currentTime + ', seeking @' + (nextBuffered + 0.05));\n                    _this2.media.currentTime = nextBuffered + 0.05;\n                    return {\n                      v: void 0\n                    };\n                  }\n                } else {\n                  (function () {\n                    var foundFrag = void 0;\n                    var maxFragLookUpTolerance = config.maxFragLookUpTolerance;\n                    var fragNext = fragPrevious ? fragments[fragPrevious.sn - fragments[0].sn + 1] : undefined;\n                    var fragmentWithinToleranceTest = function fragmentWithinToleranceTest(candidate) {\n                      // offset should be within fragment boundary - config.maxFragLookUpTolerance\n                      // this is to cope with situations like\n                      // bufferEnd = 9.991\n                      // frag[Ø] : [0,10]\n                      // frag[1] : [10,20]\n                      // bufferEnd is within frag[0] range ... although what we are expecting is to return frag[1] here\n                      //              frag start               frag start+duration\n                      //                  |-----------------------------|\n                      //              <--->                         <--->\n                      //  ...--------><-----------------------------><---------....\n                      // previous frag         matching fragment         next frag\n                      //  return -1             return 0                 return 1\n                      //logger.log(`level/sn/start/end/bufEnd:${level}/${candidate.sn}/${candidate.start}/${(candidate.start+candidate.duration)}/${bufferEnd}`);\n                      // Set the lookup tolerance to be small enough to detect the current segment - ensures we don't skip over very small segments\n                      var candidateLookupTolerance = Math.min(maxFragLookUpTolerance, candidate.duration);\n                      if (candidate.start + candidate.duration - candidateLookupTolerance <= bufferEnd) {\n                        return 1;\n                      } // if maxFragLookUpTolerance will have negative value then don't return -1 for first element\n                      else if (candidate.start - candidateLookupTolerance > bufferEnd && candidate.start) {\n                          return -1;\n                        }\n                      return 0;\n                    };\n\n                    if (bufferEnd < end) {\n                      if (bufferEnd > end - maxFragLookUpTolerance) {\n                        maxFragLookUpTolerance = 0;\n                      }\n                      // Prefer the next fragment if it's within tolerance\n                      if (fragNext && !fragmentWithinToleranceTest(fragNext)) {\n                        foundFrag = fragNext;\n                      } else {\n                        foundFrag = _binarySearch2.default.search(fragments, fragmentWithinToleranceTest);\n                      }\n                    } else {\n                      // reach end of playlist\n                      foundFrag = fragments[fragLen - 1];\n                    }\n                    if (foundFrag) {\n                      frag = foundFrag;\n                      start = foundFrag.start;\n                      //logger.log('find SN matching with pos:' +  bufferEnd + ':' + frag.sn);\n                      if (fragPrevious && frag.level === fragPrevious.level && frag.sn === fragPrevious.sn) {\n                        if (frag.sn < trackDetails.endSN) {\n                          frag = fragments[frag.sn + 1 - trackDetails.startSN];\n                          _logger.logger.log('SN just loaded, load next one: ' + frag.sn);\n                        } else {\n                          frag = null;\n                        }\n                      }\n                    }\n                  })();\n                }\n              if (frag) {\n                //logger.log('      loading frag ' + i +',pos/bufEnd:' + pos.toFixed(3) + '/' + bufferEnd.toFixed(3));\n                if (frag.decryptdata && frag.decryptdata.uri != null && frag.decryptdata.key == null) {\n                  _logger.logger.log('Loading key for ' + frag.sn + ' of [' + trackDetails.startSN + ' ,' + trackDetails.endSN + '],track ' + trackId);\n                  _this2.state = State.KEY_LOADING;\n                  hls.trigger(_events2.default.KEY_LOADING, { frag: frag });\n                } else {\n                  _logger.logger.log('Loading ' + frag.sn + ' of [' + trackDetails.startSN + ' ,' + trackDetails.endSN + '],track ' + trackId + ', currentTime:' + pos + ',bufferEnd:' + bufferEnd.toFixed(3));\n                  // ensure that we are not reloading the same fragments in loop ...\n                  if (_this2.fragLoadIdx !== undefined) {\n                    _this2.fragLoadIdx++;\n                  } else {\n                    _this2.fragLoadIdx = 0;\n                  }\n                  if (frag.loadCounter) {\n                    frag.loadCounter++;\n                    var maxThreshold = config.fragLoadingLoopThreshold;\n                    // if this frag has already been loaded 3 times, and if it has been reloaded recently\n                    if (frag.loadCounter > maxThreshold && Math.abs(_this2.fragLoadIdx - frag.loadIdx) < maxThreshold) {\n                      hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR, fatal: false, frag: frag });\n                      return {\n                        v: void 0\n                      };\n                    }\n                  } else {\n                    frag.loadCounter = 1;\n                  }\n                  frag.loadIdx = _this2.fragLoadIdx;\n                  _this2.fragCurrent = frag;\n                  _this2.startFragRequested = true;\n                  if (!isNaN(frag.sn)) {\n                    _this2.nextLoadPosition = frag.start + frag.duration;\n                  }\n                  hls.trigger(_events2.default.FRAG_LOADING, { frag: frag });\n                  _this2.state = State.FRAG_LOADING;\n                }\n              }\n            }\n            break;\n          case State.WAITING_TRACK:\n            track = _this2.tracks[_this2.trackId];\n            // check if playlist is already loaded\n            if (track && track.details) {\n              _this2.state = State.IDLE;\n            }\n            break;\n          case State.FRAG_LOADING_WAITING_RETRY:\n            now = performance.now();\n            retryDate = _this2.retryDate;\n\n            media = _this2.media;\n            isSeeking = media && media.seeking;\n            // if current time is gt than retryDate, or if media seeking let's switch to IDLE state to retry loading\n\n            if (!retryDate || now >= retryDate || isSeeking) {\n              _logger.logger.log('audioStreamController: retryDate reached, switch back to IDLE state');\n              _this2.state = State.IDLE;\n            }\n            break;\n          case State.WAITING_INIT_PTS:\n          case State.STOPPED:\n          case State.FRAG_LOADING:\n          case State.PARSING:\n          case State.PARSED:\n          case State.ENDED:\n            break;\n          default:\n            break;\n        }\n      }();\n\n      if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\") return _ret.v;\n    }\n  }, {\n    key: 'onMediaAttached',\n    value: function onMediaAttached(data) {\n      var media = this.media = this.mediaBuffer = data.media;\n      this.onvseeking = this.onMediaSeeking.bind(this);\n      this.onvended = this.onMediaEnded.bind(this);\n      media.addEventListener('seeking', this.onvseeking);\n      media.addEventListener('ended', this.onvended);\n      var config = this.config;\n      if (this.tracks && config.autoStartLoad) {\n        this.startLoad(config.startPosition);\n      }\n    }\n  }, {\n    key: 'onMediaDetaching',\n    value: function onMediaDetaching() {\n      var media = this.media;\n      if (media && media.ended) {\n        _logger.logger.log('MSE detaching and video ended, reset startPosition');\n        this.startPosition = this.lastCurrentTime = 0;\n      }\n\n      // reset fragment loading counter on MSE detaching to avoid reporting FRAG_LOOP_LOADING_ERROR after error recovery\n      var tracks = this.tracks;\n      if (tracks) {\n        // reset fragment load counter\n        tracks.forEach(function (track) {\n          if (track.details) {\n            track.details.fragments.forEach(function (fragment) {\n              fragment.loadCounter = undefined;\n            });\n          }\n        });\n      }\n      // remove video listeners\n      if (media) {\n        media.removeEventListener('seeking', this.onvseeking);\n        media.removeEventListener('ended', this.onvended);\n        this.onvseeking = this.onvseeked = this.onvended = null;\n      }\n      this.media = this.mediaBuffer = null;\n      this.loadedmetadata = false;\n      this.stopLoad();\n    }\n  }, {\n    key: 'onMediaSeeking',\n    value: function onMediaSeeking() {\n      if (this.state === State.ENDED) {\n        // switch to IDLE state to check for potential new fragment\n        this.state = State.IDLE;\n      }\n      if (this.media) {\n        this.lastCurrentTime = this.media.currentTime;\n      }\n      // avoid reporting fragment loop loading error in case user is seeking several times on same position\n      if (this.fragLoadIdx !== undefined) {\n        this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n      }\n      // tick to speed up processing\n      this.tick();\n    }\n  }, {\n    key: 'onMediaEnded',\n    value: function onMediaEnded() {\n      // reset startPosition and lastCurrentTime to restart playback @ stream beginning\n      this.startPosition = this.lastCurrentTime = 0;\n    }\n  }, {\n    key: 'onAudioTracksUpdated',\n    value: function onAudioTracksUpdated(data) {\n      _logger.logger.log('audio tracks updated');\n      this.tracks = data.audioTracks;\n    }\n  }, {\n    key: 'onAudioTrackSwitching',\n    value: function onAudioTrackSwitching(data) {\n      // if any URL found on new audio track, it is an alternate audio track\n      var altAudio = !!data.url;\n      this.trackId = data.id;\n      this.state = State.IDLE;\n\n      this.fragCurrent = null;\n      this.state = State.PAUSED;\n      this.waitingFragment = null;\n      // destroy useless demuxer when switching audio to main\n      if (!altAudio) {\n        if (this.demuxer) {\n          this.demuxer.destroy();\n          this.demuxer = null;\n        }\n      } else {\n        // switching to audio track, start timer if not already started\n        if (!this.timer) {\n          this.timer = setInterval(this.ontick, 100);\n        }\n      }\n\n      //should we switch tracks ?\n      if (altAudio) {\n        this.audioSwitch = true;\n        //main audio track are handled by stream-controller, just do something if switching to alt audio track\n        this.state = State.IDLE;\n        // increase fragment load Index to avoid frag loop loading error after buffer flush\n        if (this.fragLoadIdx !== undefined) {\n          this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n        }\n      }\n      this.tick();\n    }\n  }, {\n    key: 'onAudioTrackLoaded',\n    value: function onAudioTrackLoaded(data) {\n      var newDetails = data.details,\n          trackId = data.id,\n          track = this.tracks[trackId],\n          duration = newDetails.totalduration,\n          sliding = 0;\n\n      _logger.logger.log('track ' + trackId + ' loaded [' + newDetails.startSN + ',' + newDetails.endSN + '],duration:' + duration);\n\n      if (newDetails.live) {\n        var curDetails = track.details;\n        if (curDetails && newDetails.fragments.length > 0) {\n          // we already have details for that level, merge them\n          _levelHelper2.default.mergeDetails(curDetails, newDetails);\n          sliding = newDetails.fragments[0].start;\n          // TODO\n          //this.liveSyncPosition = this.computeLivePosition(sliding, curDetails);\n          if (newDetails.PTSKnown) {\n            _logger.logger.log('live audio playlist sliding:' + sliding.toFixed(3));\n          } else {\n            _logger.logger.log('live audio playlist - outdated PTS, unknown sliding');\n          }\n        } else {\n          newDetails.PTSKnown = false;\n          _logger.logger.log('live audio playlist - first load, unknown sliding');\n        }\n      } else {\n        newDetails.PTSKnown = false;\n      }\n      track.details = newDetails;\n\n      // compute start position\n      if (!this.startFragRequested) {\n        // compute start position if set to -1. use it straight away if value is defined\n        if (this.startPosition === -1) {\n          // first, check if start time offset has been set in playlist, if yes, use this value\n          var startTimeOffset = newDetails.startTimeOffset;\n          if (!isNaN(startTimeOffset)) {\n            _logger.logger.log('start time offset found in playlist, adjust startPosition to ' + startTimeOffset);\n            this.startPosition = startTimeOffset;\n          } else {\n            this.startPosition = 0;\n          }\n        }\n        this.nextLoadPosition = this.startPosition;\n      }\n      // only switch batck to IDLE state if we were waiting for track to start downloading a new fragment\n      if (this.state === State.WAITING_TRACK) {\n        this.state = State.IDLE;\n      }\n      //trigger handler right now\n      this.tick();\n    }\n  }, {\n    key: 'onKeyLoaded',\n    value: function onKeyLoaded() {\n      if (this.state === State.KEY_LOADING) {\n        this.state = State.IDLE;\n        this.tick();\n      }\n    }\n  }, {\n    key: 'onFragLoaded',\n    value: function onFragLoaded(data) {\n      var fragCurrent = this.fragCurrent,\n          fragLoaded = data.frag;\n      if (this.state === State.FRAG_LOADING && fragCurrent && fragLoaded.type === 'audio' && fragLoaded.level === fragCurrent.level && fragLoaded.sn === fragCurrent.sn) {\n        var track = this.tracks[this.trackId],\n            details = track.details,\n            duration = details.totalduration,\n            trackId = fragCurrent.level,\n            sn = fragCurrent.sn,\n            cc = fragCurrent.cc,\n            audioCodec = this.config.defaultAudioCodec || track.audioCodec || 'mp4a.40.2',\n            stats = this.stats = data.stats;\n        if (sn === 'initSegment') {\n          this.state = State.IDLE;\n\n          stats.tparsed = stats.tbuffered = performance.now();\n          details.initSegment.data = data.payload;\n          this.hls.trigger(_events2.default.FRAG_BUFFERED, { stats: stats, frag: fragCurrent, id: 'audio' });\n          this.tick();\n        } else {\n          this.state = State.PARSING;\n          // transmux the MPEG-TS data to ISO-BMFF segments\n          this.appended = false;\n          if (!this.demuxer) {\n            this.demuxer = new _demuxer2.default(this.hls, 'audio');\n          }\n          //Check if we have video initPTS\n          // If not we need to wait for it\n          var initPTS = this.initPTS[cc];\n          var initSegmentData = details.initSegment ? details.initSegment.data : [];\n          if (initSegmentData || initPTS !== undefined) {\n            this.pendingBuffering = true;\n            _logger.logger.log('Demuxing ' + sn + ' of [' + details.startSN + ' ,' + details.endSN + '],track ' + trackId);\n            // time Offset is accurate if level PTS is known, or if playlist is not sliding (not live)\n            var accurateTimeOffset = false; //details.PTSKnown || !details.live;\n            this.demuxer.push(data.payload, initSegmentData, audioCodec, null, fragCurrent, duration, accurateTimeOffset, initPTS);\n          } else {\n            _logger.logger.log('unknown video PTS for continuity counter ' + cc + ', waiting for video PTS before demuxing audio frag ' + sn + ' of [' + details.startSN + ' ,' + details.endSN + '],track ' + trackId);\n            this.waitingFragment = data;\n            this.state = State.WAITING_INIT_PTS;\n          }\n        }\n      }\n      this.fragLoadError = 0;\n    }\n  }, {\n    key: 'onFragParsingInitSegment',\n    value: function onFragParsingInitSegment(data) {\n      var fragCurrent = this.fragCurrent;\n      var fragNew = data.frag;\n      if (fragCurrent && data.id === 'audio' && fragNew.sn === fragCurrent.sn && fragNew.level === fragCurrent.level && this.state === State.PARSING) {\n        var tracks = data.tracks,\n            track = void 0;\n\n        // delete any video track found on audio demuxer\n        if (tracks.video) {\n          delete tracks.video;\n        }\n\n        // include levelCodec in audio and video tracks\n        track = tracks.audio;\n        if (track) {\n          track.levelCodec = 'mp4a.40.2';\n          track.id = data.id;\n          this.hls.trigger(_events2.default.BUFFER_CODECS, tracks);\n          _logger.logger.log('audio track:audio,container:' + track.container + ',codecs[level/parsed]=[' + track.levelCodec + '/' + track.codec + ']');\n          var initSegment = track.initSegment;\n          if (initSegment) {\n            var appendObj = { type: 'audio', data: initSegment, parent: 'audio', content: 'initSegment' };\n            if (this.audioSwitch) {\n              this.pendingData = [appendObj];\n            } else {\n              this.appended = true;\n              // arm pending Buffering flag before appending a segment\n              this.pendingBuffering = true;\n              this.hls.trigger(_events2.default.BUFFER_APPENDING, appendObj);\n            }\n          }\n          //trigger handler right now\n          this.tick();\n        }\n      }\n    }\n  }, {\n    key: 'onFragParsingData',\n    value: function onFragParsingData(data) {\n      var _this3 = this;\n\n      var fragCurrent = this.fragCurrent;\n      var fragNew = data.frag;\n      if (fragCurrent && data.id === 'audio' && data.type === 'audio' && fragNew.sn === fragCurrent.sn && fragNew.level === fragCurrent.level && this.state === State.PARSING) {\n        (function () {\n          var trackId = _this3.trackId,\n              track = _this3.tracks[trackId],\n              hls = _this3.hls;\n\n          if (isNaN(data.endPTS)) {\n            data.endPTS = data.startPTS + fragCurrent.duration;\n            data.endDTS = data.startDTS + fragCurrent.duration;\n          }\n\n          _logger.logger.log('parsed ' + data.type + ',PTS:[' + data.startPTS.toFixed(3) + ',' + data.endPTS.toFixed(3) + '],DTS:[' + data.startDTS.toFixed(3) + '/' + data.endDTS.toFixed(3) + '],nb:' + data.nb);\n          _levelHelper2.default.updateFragPTSDTS(track.details, fragCurrent.sn, data.startPTS, data.endPTS);\n\n          var audioSwitch = _this3.audioSwitch,\n              media = _this3.media,\n              appendOnBufferFlush = false;\n          //Only flush audio from old audio tracks when PTS is known on new audio track\n          if (audioSwitch && media) {\n            if (media.readyState) {\n              var currentTime = media.currentTime;\n              _logger.logger.log('switching audio track : currentTime:' + currentTime);\n              if (currentTime >= data.startPTS) {\n                _logger.logger.log('switching audio track : flushing all audio');\n                _this3.state = State.BUFFER_FLUSHING;\n                hls.trigger(_events2.default.BUFFER_FLUSHING, { startOffset: 0, endOffset: Number.POSITIVE_INFINITY, type: 'audio' });\n                appendOnBufferFlush = true;\n                //Lets announce that the initial audio track switch flush occur\n                _this3.audioSwitch = false;\n                hls.trigger(_events2.default.AUDIO_TRACK_SWITCHED, { id: trackId });\n              }\n            } else {\n              //Lets announce that the initial audio track switch flush occur\n              _this3.audioSwitch = false;\n              hls.trigger(_events2.default.AUDIO_TRACK_SWITCHED, { id: trackId });\n            }\n          }\n\n          var pendingData = _this3.pendingData;\n          if (!_this3.audioSwitch) {\n            [data.data1, data.data2].forEach(function (buffer) {\n              if (buffer && buffer.length) {\n                pendingData.push({ type: data.type, data: buffer, parent: 'audio', content: 'data' });\n              }\n            });\n            if (!appendOnBufferFlush && pendingData.length) {\n              pendingData.forEach(function (appendObj) {\n                // only append in PARSING state (rationale is that an appending error could happen synchronously on first segment appending)\n                // in that case it is useless to append following segments\n                if (_this3.state === State.PARSING) {\n                  // arm pending Buffering flag before appending a segment\n                  _this3.pendingBuffering = true;\n                  _this3.hls.trigger(_events2.default.BUFFER_APPENDING, appendObj);\n                }\n              });\n              _this3.pendingData = [];\n              _this3.appended = true;\n            }\n          }\n          //trigger handler right now\n          _this3.tick();\n        })();\n      }\n    }\n  }, {\n    key: 'onFragParsed',\n    value: function onFragParsed(data) {\n      var fragCurrent = this.fragCurrent;\n      var fragNew = data.frag;\n      if (fragCurrent && data.id === 'audio' && fragNew.sn === fragCurrent.sn && fragNew.level === fragCurrent.level && this.state === State.PARSING) {\n        this.stats.tparsed = performance.now();\n        this.state = State.PARSED;\n        this._checkAppendedParsed();\n      }\n    }\n  }, {\n    key: 'onBufferCreated',\n    value: function onBufferCreated(data) {\n      var audioTrack = data.tracks.audio;\n      if (audioTrack) {\n        this.mediaBuffer = audioTrack.buffer;\n        this.loadedmetadata = true;\n      }\n    }\n  }, {\n    key: 'onBufferAppended',\n    value: function onBufferAppended(data) {\n      if (data.parent === 'audio') {\n        var state = this.state;\n        if (state === State.PARSING || state === State.PARSED) {\n          // check if all buffers have been appended\n          this.pendingBuffering = data.pending > 0;\n          this._checkAppendedParsed();\n        }\n      }\n    }\n  }, {\n    key: '_checkAppendedParsed',\n    value: function _checkAppendedParsed() {\n      //trigger handler right now\n      if (this.state === State.PARSED && (!this.appended || !this.pendingBuffering)) {\n        var frag = this.fragCurrent,\n            stats = this.stats,\n            hls = this.hls;\n        if (frag) {\n          this.fragPrevious = frag;\n          stats.tbuffered = performance.now();\n          hls.trigger(_events2.default.FRAG_BUFFERED, { stats: stats, frag: frag, id: 'audio' });\n          var media = this.mediaBuffer ? this.mediaBuffer : this.media;\n          _logger.logger.log('audio buffered : ' + _timeRanges2.default.toString(media.buffered));\n          if (this.audioSwitch && this.appended) {\n            this.audioSwitch = false;\n            hls.trigger(_events2.default.AUDIO_TRACK_SWITCHED, { id: this.trackId });\n          }\n          this.state = State.IDLE;\n        }\n        this.tick();\n      }\n    }\n  }, {\n    key: 'onError',\n    value: function onError(data) {\n      var frag = data.frag;\n      // don't handle frag error not related to audio fragment\n      if (frag && frag.type !== 'audio') {\n        return;\n      }\n      switch (data.details) {\n        case _errors.ErrorDetails.FRAG_LOAD_ERROR:\n        case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:\n          if (!data.fatal) {\n            var loadError = this.fragLoadError;\n            if (loadError) {\n              loadError++;\n            } else {\n              loadError = 1;\n            }\n            var config = this.config;\n            if (loadError <= config.fragLoadingMaxRetry) {\n              this.fragLoadError = loadError;\n              // reset load counter to avoid frag loop loading error\n              frag.loadCounter = 0;\n              // exponential backoff capped to config.fragLoadingMaxRetryTimeout\n              var delay = Math.min(Math.pow(2, loadError - 1) * config.fragLoadingRetryDelay, config.fragLoadingMaxRetryTimeout);\n              _logger.logger.warn('audioStreamController: frag loading failed, retry in ' + delay + ' ms');\n              this.retryDate = performance.now() + delay;\n              // retry loading state\n              this.state = State.FRAG_LOADING_WAITING_RETRY;\n            } else {\n              _logger.logger.error('audioStreamController: ' + data.details + ' reaches max retry, redispatch as fatal ...');\n              // redispatch same error but with fatal set to true\n              data.fatal = true;\n              this.hls.trigger(_events2.default.ERROR, data);\n              this.state = State.ERROR;\n            }\n          }\n          break;\n        case _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n        case _errors.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:\n        case _errors.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:\n        case _errors.ErrorDetails.KEY_LOAD_ERROR:\n        case _errors.ErrorDetails.KEY_LOAD_TIMEOUT:\n          //  when in ERROR state, don't switch back to IDLE state in case a non-fatal error is received\n          if (this.state !== State.ERROR) {\n            // if fatal error, stop processing, otherwise move to IDLE to retry loading\n            this.state = data.fatal ? State.ERROR : State.IDLE;\n            _logger.logger.warn('audioStreamController: ' + data.details + ' while loading frag,switch to ' + this.state + ' state ...');\n          }\n          break;\n        case _errors.ErrorDetails.BUFFER_FULL_ERROR:\n          // if in appending state\n          if (data.parent === 'audio' && (this.state === State.PARSING || this.state === State.PARSED)) {\n            var media = this.mediaBuffer,\n                currentTime = this.media.currentTime,\n                mediaBuffered = media && _bufferHelper2.default.isBuffered(media, currentTime) && _bufferHelper2.default.isBuffered(media, currentTime + 0.5);\n            // reduce max buf len if current position is buffered\n            if (mediaBuffered) {\n              var _config = this.config;\n              if (_config.maxMaxBufferLength >= _config.maxBufferLength) {\n                // reduce max buffer length as it might be too high. we do this to avoid loop flushing ...\n                _config.maxMaxBufferLength /= 2;\n                _logger.logger.warn('audio:reduce max buffer length to ' + _config.maxMaxBufferLength + 's');\n                // increase fragment load Index to avoid frag loop loading error after buffer flush\n                this.fragLoadIdx += 2 * _config.fragLoadingLoopThreshold;\n              }\n              this.state = State.IDLE;\n            } else {\n              // current position is not buffered, but browser is still complaining about buffer full error\n              // this happens on IE/Edge, refer to https://github.com/dailymotion/hls.js/pull/708\n              // in that case flush the whole audio buffer to recover\n              _logger.logger.warn('buffer full error also media.currentTime is not buffered, flush audio buffer');\n              this.fragCurrent = null;\n              // flush everything\n              this.state = State.BUFFER_FLUSHING;\n              this.hls.trigger(_events2.default.BUFFER_FLUSHING, { startOffset: 0, endOffset: Number.POSITIVE_INFINITY, type: 'audio' });\n            }\n          }\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: 'onBufferFlushed',\n    value: function onBufferFlushed() {\n      var _this4 = this;\n\n      var pendingData = this.pendingData;\n      if (pendingData && pendingData.length) {\n        _logger.logger.log('appending pending audio data on Buffer Flushed');\n        pendingData.forEach(function (appendObj) {\n          _this4.hls.trigger(_events2.default.BUFFER_APPENDING, appendObj);\n        });\n        this.appended = true;\n        this.pendingData = [];\n        this.state = State.PARSED;\n      } else {\n        // move to IDLE once flush complete. this should trigger new fragment loading\n        this.state = State.IDLE;\n        // reset reference to frag\n        this.fragPrevious = null;\n        this.tick();\n      }\n    }\n  }, {\n    key: 'state',\n    set: function set(nextState) {\n      if (this.state !== nextState) {\n        var previousState = this.state;\n        this._state = nextState;\n        _logger.logger.log('audio stream:' + previousState + '->' + nextState);\n      }\n    },\n    get: function get() {\n      return this._state;\n    }\n  }]);\n\n  return AudioStreamController;\n}(_eventHandler2.default);\n\nexports.default = AudioStreamController;\n\n},{\"25\":25,\"31\":31,\"32\":32,\"33\":33,\"35\":35,\"36\":36,\"46\":46,\"50\":50,\"51\":51}],7:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * audio track controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar AudioTrackController = function (_EventHandler) {\n  _inherits(AudioTrackController, _EventHandler);\n\n  function AudioTrackController(hls) {\n    _classCallCheck(this, AudioTrackController);\n\n    var _this = _possibleConstructorReturn(this, (AudioTrackController.__proto__ || Object.getPrototypeOf(AudioTrackController)).call(this, hls, _events2.default.MANIFEST_LOADING, _events2.default.MANIFEST_LOADED, _events2.default.AUDIO_TRACK_LOADED));\n\n    _this.ticks = 0;\n    _this.ontick = _this.tick.bind(_this);\n    return _this;\n  }\n\n  _createClass(AudioTrackController, [{\n    key: 'destroy',\n    value: function destroy() {\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'tick',\n    value: function tick() {\n      this.ticks++;\n      if (this.ticks === 1) {\n        this.doTick();\n        if (this.ticks > 1) {\n          setTimeout(this.tick, 1);\n        }\n        this.ticks = 0;\n      }\n    }\n  }, {\n    key: 'doTick',\n    value: function doTick() {\n      this.updateTrack(this.trackId);\n    }\n  }, {\n    key: 'onManifestLoading',\n    value: function onManifestLoading() {\n      // reset audio tracks on manifest loading\n      this.tracks = [];\n      this.trackId = -1;\n    }\n  }, {\n    key: 'onManifestLoaded',\n    value: function onManifestLoaded(data) {\n      var _this2 = this;\n\n      var tracks = data.audioTracks || [];\n      var defaultFound = false;\n      this.tracks = tracks;\n      this.hls.trigger(_events2.default.AUDIO_TRACKS_UPDATED, { audioTracks: tracks });\n      // loop through available audio tracks and autoselect default if needed\n      var id = 0;\n      tracks.forEach(function (track) {\n        if (track.default) {\n          _this2.audioTrack = id;\n          defaultFound = true;\n          return;\n        }\n        id++;\n      });\n      if (defaultFound === false && tracks.length) {\n        _logger.logger.log('no default audio track defined, use first audio track as default');\n        this.audioTrack = 0;\n      }\n    }\n  }, {\n    key: 'onAudioTrackLoaded',\n    value: function onAudioTrackLoaded(data) {\n      if (data.id < this.tracks.length) {\n        _logger.logger.log('audioTrack ' + data.id + ' loaded');\n        this.tracks[data.id].details = data.details;\n        // check if current playlist is a live playlist\n        if (data.details.live && !this.timer) {\n          // if live playlist we will have to reload it periodically\n          // set reload period to playlist target duration\n          this.timer = setInterval(this.ontick, 1000 * data.details.targetduration);\n        }\n        if (!data.details.live && this.timer) {\n          // playlist is not live and timer is armed : stopping it\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n      }\n    }\n\n    /** get alternate audio tracks list from playlist **/\n\n  }, {\n    key: 'setAudioTrackInternal',\n    value: function setAudioTrackInternal(newId) {\n      // check if level idx is valid\n      if (newId >= 0 && newId < this.tracks.length) {\n        // stopping live reloading timer if any\n        if (this.timer) {\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n        this.trackId = newId;\n        _logger.logger.log('switching to audioTrack ' + newId);\n        var audioTrack = this.tracks[newId],\n            hls = this.hls,\n            type = audioTrack.type,\n            url = audioTrack.url,\n            eventObj = { id: newId, type: type, url: url };\n        // keep AUDIO_TRACK_SWITCH for legacy reason\n        hls.trigger(_events2.default.AUDIO_TRACK_SWITCH, eventObj);\n        hls.trigger(_events2.default.AUDIO_TRACK_SWITCHING, eventObj);\n        // check if we need to load playlist for this audio Track\n        var details = audioTrack.details;\n        if (url && (details === undefined || details.live === true)) {\n          // track not retrieved yet, or live playlist we need to (re)load it\n          _logger.logger.log('(re)loading playlist for audioTrack ' + newId);\n          hls.trigger(_events2.default.AUDIO_TRACK_LOADING, { url: url, id: newId });\n        }\n      }\n    }\n  }, {\n    key: 'updateTrack',\n    value: function updateTrack(newId) {\n      // check if level idx is valid\n      if (newId >= 0 && newId < this.tracks.length) {\n        // stopping live reloading timer if any\n        if (this.timer) {\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n        this.trackId = newId;\n        _logger.logger.log('updating audioTrack ' + newId);\n        var audioTrack = this.tracks[newId],\n            url = audioTrack.url;\n        // check if we need to load playlist for this audio Track\n        var details = audioTrack.details;\n        if (url && (details === undefined || details.live === true)) {\n          // track not retrieved yet, or live playlist we need to (re)load it\n          _logger.logger.log('(re)loading playlist for audioTrack ' + newId);\n          this.hls.trigger(_events2.default.AUDIO_TRACK_LOADING, { url: url, id: newId });\n        }\n      }\n    }\n  }, {\n    key: 'audioTracks',\n    get: function get() {\n      return this.tracks;\n    }\n\n    /** get index of the selected audio track (index in audio track lists) **/\n\n  }, {\n    key: 'audioTrack',\n    get: function get() {\n      return this.trackId;\n    }\n\n    /** select an audio track, based on its index in audio track lists**/\n    ,\n    set: function set(audioTrackId) {\n      if (this.trackId !== audioTrackId || this.tracks[audioTrackId].details === undefined) {\n        this.setAudioTrackInternal(audioTrackId);\n      }\n    }\n  }]);\n\n  return AudioTrackController;\n}(_eventHandler2.default);\n\nexports.default = AudioTrackController;\n\n},{\"32\":32,\"33\":33,\"50\":50}],8:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _logger = _dereq_(50);\n\nvar _errors = _dereq_(31);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Buffer Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar BufferController = function (_EventHandler) {\n  _inherits(BufferController, _EventHandler);\n\n  function BufferController(hls) {\n    _classCallCheck(this, BufferController);\n\n    // the value that we have set mediasource.duration to\n    // (the actual duration may be tweaked slighly by the browser)\n    var _this = _possibleConstructorReturn(this, (BufferController.__proto__ || Object.getPrototypeOf(BufferController)).call(this, hls, _events2.default.MEDIA_ATTACHING, _events2.default.MEDIA_DETACHING, _events2.default.MANIFEST_PARSED, _events2.default.BUFFER_RESET, _events2.default.BUFFER_APPENDING, _events2.default.BUFFER_CODECS, _events2.default.BUFFER_EOS, _events2.default.BUFFER_FLUSHING, _events2.default.LEVEL_PTS_UPDATED, _events2.default.LEVEL_UPDATED));\n\n    _this._msDuration = null;\n    // the value that we want to set mediaSource.duration to\n    _this._levelDuration = null;\n\n    // Source Buffer listeners\n    _this.onsbue = _this.onSBUpdateEnd.bind(_this);\n    _this.onsbe = _this.onSBUpdateError.bind(_this);\n    _this.pendingTracks = {};\n    _this.tracks = {};\n    return _this;\n  }\n\n  _createClass(BufferController, [{\n    key: 'destroy',\n    value: function destroy() {\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'onLevelPtsUpdated',\n    value: function onLevelPtsUpdated(data) {\n      var type = data.type;\n      var audioTrack = this.tracks.audio;\n\n      // Adjusting `SourceBuffer.timestampOffset` (desired point in the timeline where the next frames should be appended)\n      // in Chrome browser when we detect MPEG audio container and time delta between level PTS and `SourceBuffer.timestampOffset`\n      // is greater than 100ms (this is enough to handle seek for VOD or level change for LIVE videos). At the time of change we issue\n      // `SourceBuffer.abort()` and adjusting `SourceBuffer.timestampOffset` if `SourceBuffer.updating` is false or awaiting `updateend`\n      // event if SB is in updating state.\n      // More info here: https://github.com/dailymotion/hls.js/issues/332#issuecomment-257986486\n\n      if (type === 'audio' && audioTrack && audioTrack.container === 'audio/mpeg') {\n        // Chrome audio mp3 track\n        var audioBuffer = this.sourceBuffer.audio;\n        var delta = Math.abs(audioBuffer.timestampOffset - data.start);\n\n        // adjust timestamp offset if time delta is greater than 100ms\n        if (delta > 0.1) {\n          var updating = audioBuffer.updating;\n\n          try {\n            audioBuffer.abort();\n          } catch (err) {\n            updating = true;\n            _logger.logger.warn('can not abort audio buffer: ' + err);\n          }\n\n          if (!updating) {\n            _logger.logger.warn('change mpeg audio timestamp offset from ' + audioBuffer.timestampOffset + ' to ' + data.start);\n            audioBuffer.timestampOffset = data.start;\n          } else {\n            this.audioTimestampOffset = data.start;\n          }\n        }\n      }\n    }\n  }, {\n    key: 'onManifestParsed',\n    value: function onManifestParsed(data) {\n      var audioExpected = data.audio,\n          videoExpected = data.video,\n          sourceBufferNb = 0;\n      // in case of alt audio 2 BUFFER_CODECS events will be triggered, one per stream controller\n      // sourcebuffers will be created all at once when the expected nb of tracks will be reached\n      // in case alt audio is not used, only one BUFFER_CODEC event will be fired from main stream controller\n      // it will contain the expected nb of source buffers, no need to compute it\n      if (data.altAudio && (audioExpected || videoExpected)) {\n        sourceBufferNb = (audioExpected ? 1 : 0) + (videoExpected ? 1 : 0);\n        _logger.logger.log(sourceBufferNb + ' sourceBuffer(s) expected');\n      }\n      this.sourceBufferNb = sourceBufferNb;\n    }\n  }, {\n    key: 'onMediaAttaching',\n    value: function onMediaAttaching(data) {\n      var media = this.media = data.media;\n      if (media) {\n        // setup the media source\n        var ms = this.mediaSource = new MediaSource();\n        //Media Source listeners\n        this.onmso = this.onMediaSourceOpen.bind(this);\n        this.onmse = this.onMediaSourceEnded.bind(this);\n        this.onmsc = this.onMediaSourceClose.bind(this);\n        ms.addEventListener('sourceopen', this.onmso);\n        ms.addEventListener('sourceended', this.onmse);\n        ms.addEventListener('sourceclose', this.onmsc);\n        // link video and media Source\n        media.src = URL.createObjectURL(ms);\n      }\n    }\n  }, {\n    key: 'onMediaDetaching',\n    value: function onMediaDetaching() {\n      _logger.logger.log('media source detaching');\n      var ms = this.mediaSource;\n      if (ms) {\n        if (ms.readyState === 'open') {\n          try {\n            // endOfStream could trigger exception if any sourcebuffer is in updating state\n            // we don't really care about checking sourcebuffer state here,\n            // as we are anyway detaching the MediaSource\n            // let's just avoid this exception to propagate\n            ms.endOfStream();\n          } catch (err) {\n            _logger.logger.warn('onMediaDetaching:' + err.message + ' while calling endOfStream');\n          }\n        }\n        ms.removeEventListener('sourceopen', this.onmso);\n        ms.removeEventListener('sourceended', this.onmse);\n        ms.removeEventListener('sourceclose', this.onmsc);\n\n        // Detach properly the MediaSource from the HTMLMediaElement as\n        // suggested in https://github.com/w3c/media-source/issues/53.\n        if (this.media) {\n          URL.revokeObjectURL(this.media.src);\n          this.media.removeAttribute('src');\n          this.media.load();\n        }\n\n        this.mediaSource = null;\n        this.media = null;\n        this.pendingTracks = {};\n        this.tracks = {};\n        this.sourceBuffer = {};\n        this.flushRange = [];\n        this.segments = [];\n        this.appended = 0;\n      }\n      this.onmso = this.onmse = this.onmsc = null;\n      this.hls.trigger(_events2.default.MEDIA_DETACHED);\n    }\n  }, {\n    key: 'onMediaSourceOpen',\n    value: function onMediaSourceOpen() {\n      _logger.logger.log('media source opened');\n      this.hls.trigger(_events2.default.MEDIA_ATTACHED, { media: this.media });\n      var mediaSource = this.mediaSource;\n      if (mediaSource) {\n        // once received, don't listen anymore to sourceopen event\n        mediaSource.removeEventListener('sourceopen', this.onmso);\n      }\n      this.checkPendingTracks();\n    }\n  }, {\n    key: 'checkPendingTracks',\n    value: function checkPendingTracks() {\n      // if any buffer codecs pending, check if we have enough to create sourceBuffers\n      var pendingTracks = this.pendingTracks,\n          pendingTracksNb = Object.keys(pendingTracks).length;\n      // if any pending tracks and (if nb of pending tracks gt or equal than expected nb or if unknown expected nb)\n      if (pendingTracksNb && (this.sourceBufferNb <= pendingTracksNb || this.sourceBufferNb === 0)) {\n        // ok, let's create them now !\n        this.createSourceBuffers(pendingTracks);\n        this.pendingTracks = {};\n        // append any pending segments now !\n        this.doAppending();\n      }\n    }\n  }, {\n    key: 'onMediaSourceClose',\n    value: function onMediaSourceClose() {\n      _logger.logger.log('media source closed');\n    }\n  }, {\n    key: 'onMediaSourceEnded',\n    value: function onMediaSourceEnded() {\n      _logger.logger.log('media source ended');\n    }\n  }, {\n    key: 'onSBUpdateEnd',\n    value: function onSBUpdateEnd() {\n      // update timestampOffset\n      if (this.audioTimestampOffset) {\n        var audioBuffer = this.sourceBuffer.audio;\n        _logger.logger.warn('change mpeg audio timestamp offset from ' + audioBuffer.timestampOffset + ' to ' + this.audioTimestampOffset);\n        audioBuffer.timestampOffset = this.audioTimestampOffset;\n        delete this.audioTimestampOffset;\n      }\n\n      if (this._needsFlush) {\n        this.doFlush();\n      }\n\n      if (this._needsEos) {\n        this.checkEos();\n      }\n      this.appending = false;\n      var parent = this.parent;\n      // count nb of pending segments waiting for appending on this sourcebuffer\n      var pending = this.segments.reduce(function (counter, segment) {\n        return segment.parent === parent ? counter + 1 : counter;\n      }, 0);\n      this.hls.trigger(_events2.default.BUFFER_APPENDED, { parent: parent, pending: pending });\n\n      // don't append in flushing mode\n      if (!this._needsFlush) {\n        this.doAppending();\n      }\n\n      this.updateMediaElementDuration();\n    }\n  }, {\n    key: 'onSBUpdateError',\n    value: function onSBUpdateError(event) {\n      _logger.logger.error('sourceBuffer error:' + event);\n      // according to http://www.w3.org/TR/media-source/#sourcebuffer-append-error\n      // this error might not always be fatal (it is fatal if decode error is set, in that case\n      // it will be followed by a mediaElement error ...)\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_APPENDING_ERROR, fatal: false });\n      // we don't need to do more than that, as accordin to the spec, updateend will be fired just after\n    }\n  }, {\n    key: 'onBufferReset',\n    value: function onBufferReset() {\n      var sourceBuffer = this.sourceBuffer;\n      for (var type in sourceBuffer) {\n        var sb = sourceBuffer[type];\n        try {\n          this.mediaSource.removeSourceBuffer(sb);\n          sb.removeEventListener('updateend', this.onsbue);\n          sb.removeEventListener('error', this.onsbe);\n        } catch (err) {}\n      }\n      this.sourceBuffer = {};\n      this.flushRange = [];\n      this.segments = [];\n      this.appended = 0;\n    }\n  }, {\n    key: 'onBufferCodecs',\n    value: function onBufferCodecs(tracks) {\n      // if source buffer(s) not created yet, appended buffer tracks in this.pendingTracks\n      // if sourcebuffers already created, do nothing ...\n      if (Object.keys(this.sourceBuffer).length === 0) {\n        for (var trackName in tracks) {\n          this.pendingTracks[trackName] = tracks[trackName];\n        }\n        var mediaSource = this.mediaSource;\n        if (mediaSource && mediaSource.readyState === 'open') {\n          // try to create sourcebuffers if mediasource opened\n          this.checkPendingTracks();\n        }\n      }\n    }\n  }, {\n    key: 'createSourceBuffers',\n    value: function createSourceBuffers(tracks) {\n      var sourceBuffer = this.sourceBuffer,\n          mediaSource = this.mediaSource;\n\n      for (var trackName in tracks) {\n        if (!sourceBuffer[trackName]) {\n          var track = tracks[trackName];\n          // use levelCodec as first priority\n          var codec = track.levelCodec || track.codec;\n          var mimeType = track.container + ';codecs=' + codec;\n          _logger.logger.log('creating sourceBuffer(' + mimeType + ')');\n          try {\n            var sb = sourceBuffer[trackName] = mediaSource.addSourceBuffer(mimeType);\n            sb.addEventListener('updateend', this.onsbue);\n            sb.addEventListener('error', this.onsbe);\n            this.tracks[trackName] = { codec: codec, container: track.container };\n            track.buffer = sb;\n          } catch (err) {\n            _logger.logger.error('error while trying to add sourceBuffer:' + err.message);\n            this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_ADD_CODEC_ERROR, fatal: false, err: err, mimeType: mimeType });\n          }\n        }\n      }\n      this.hls.trigger(_events2.default.BUFFER_CREATED, { tracks: tracks });\n    }\n  }, {\n    key: 'onBufferAppending',\n    value: function onBufferAppending(data) {\n      if (!this._needsFlush) {\n        if (!this.segments) {\n          this.segments = [data];\n        } else {\n          this.segments.push(data);\n        }\n        this.doAppending();\n      }\n    }\n  }, {\n    key: 'onBufferAppendFail',\n    value: function onBufferAppendFail(data) {\n      _logger.logger.error('sourceBuffer error:', data.event);\n      // according to http://www.w3.org/TR/media-source/#sourcebuffer-append-error\n      // this error might not always be fatal (it is fatal if decode error is set, in that case\n      // it will be followed by a mediaElement error ...)\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_APPENDING_ERROR, fatal: false });\n    }\n\n    // on BUFFER_EOS mark matching sourcebuffer(s) as ended and trigger checkEos()\n\n  }, {\n    key: 'onBufferEos',\n    value: function onBufferEos(data) {\n      var sb = this.sourceBuffer;\n      var dataType = data.type;\n      for (var type in sb) {\n        if (!dataType || type === dataType) {\n          if (!sb[type].ended) {\n            sb[type].ended = true;\n            _logger.logger.log(type + ' sourceBuffer now EOS');\n          }\n        }\n      }\n      this.checkEos();\n    }\n\n    // if all source buffers are marked as ended, signal endOfStream() to MediaSource.\n\n  }, {\n    key: 'checkEos',\n    value: function checkEos() {\n      var sb = this.sourceBuffer,\n          mediaSource = this.mediaSource;\n      if (!mediaSource || mediaSource.readyState !== 'open') {\n        this._needsEos = false;\n        return;\n      }\n      for (var type in sb) {\n        var sbobj = sb[type];\n        if (!sbobj.ended) {\n          return;\n        }\n        if (sbobj.updating) {\n          this._needsEos = true;\n          return;\n        }\n      }\n      _logger.logger.log('all media data available, signal endOfStream() to MediaSource and stop loading fragment');\n      //Notify the media element that it now has all of the media data\n      try {\n        mediaSource.endOfStream();\n      } catch (e) {\n        _logger.logger.warn('exception while calling mediaSource.endOfStream()');\n      }\n      this._needsEos = false;\n    }\n  }, {\n    key: 'onBufferFlushing',\n    value: function onBufferFlushing(data) {\n      this.flushRange.push({ start: data.startOffset, end: data.endOffset, type: data.type });\n      // attempt flush immediatly\n      this.flushBufferCounter = 0;\n      this.doFlush();\n    }\n  }, {\n    key: 'onLevelUpdated',\n    value: function onLevelUpdated(event) {\n      var details = event.details;\n      if (details.fragments.length === 0) {\n        return;\n      }\n      this._levelDuration = details.totalduration + details.fragments[0].start;\n      this.updateMediaElementDuration();\n    }\n\n    // https://github.com/dailymotion/hls.js/issues/355\n\n  }, {\n    key: 'updateMediaElementDuration',\n    value: function updateMediaElementDuration() {\n      var media = this.media,\n          mediaSource = this.mediaSource,\n          sourceBuffer = this.sourceBuffer,\n          levelDuration = this._levelDuration;\n      if (levelDuration === null || !media || !mediaSource || !sourceBuffer || media.readyState === 0 || mediaSource.readyState !== 'open') {\n        return;\n      }\n      for (var type in sourceBuffer) {\n        if (sourceBuffer[type].updating) {\n          // can't set duration whilst a buffer is updating\n          return;\n        }\n      }\n      if (this._msDuration === null) {\n        // initialise to the value that the media source is reporting\n        this._msDuration = mediaSource.duration;\n      }\n      var duration = media.duration;\n      // levelDuration was the last value we set.\n      // not using mediaSource.duration as the browser may tweak this value\n      // only update mediasource duration if its value increase, this is to avoid\n      // flushing already buffered portion when switching between quality level\n      if (levelDuration > this._msDuration && levelDuration > duration || duration === Infinity || isNaN(duration)) {\n        _logger.logger.log('Updating mediasource duration to ' + levelDuration.toFixed(3));\n        this._msDuration = mediaSource.duration = levelDuration;\n      }\n    }\n  }, {\n    key: 'doFlush',\n    value: function doFlush() {\n      // loop through all buffer ranges to flush\n      while (this.flushRange.length) {\n        var range = this.flushRange[0];\n        // flushBuffer will abort any buffer append in progress and flush Audio/Video Buffer\n        if (this.flushBuffer(range.start, range.end, range.type)) {\n          // range flushed, remove from flush array\n          this.flushRange.shift();\n          this.flushBufferCounter = 0;\n        } else {\n          this._needsFlush = true;\n          // avoid looping, wait for SB update end to retrigger a flush\n          return;\n        }\n      }\n      if (this.flushRange.length === 0) {\n        // everything flushed\n        this._needsFlush = false;\n\n        // let's recompute this.appended, which is used to avoid flush looping\n        var appended = 0;\n        var sourceBuffer = this.sourceBuffer;\n        try {\n          for (var type in sourceBuffer) {\n            appended += sourceBuffer[type].buffered.length;\n          }\n        } catch (error) {\n          // error could be thrown while accessing buffered, in case sourcebuffer has already been removed from MediaSource\n          // this is harmess at this stage, catch this to avoid reporting an internal exception\n          _logger.logger.error('error while accessing sourceBuffer.buffered');\n        }\n        this.appended = appended;\n        this.hls.trigger(_events2.default.BUFFER_FLUSHED);\n      }\n    }\n  }, {\n    key: 'doAppending',\n    value: function doAppending() {\n      var hls = this.hls,\n          sourceBuffer = this.sourceBuffer,\n          segments = this.segments;\n      if (Object.keys(sourceBuffer).length) {\n        if (this.media.error) {\n          this.segments = [];\n          _logger.logger.error('trying to append although a media error occured, flush segment and abort');\n          return;\n        }\n        if (this.appending) {\n          //logger.log(`sb appending in progress`);\n          return;\n        }\n        if (segments && segments.length) {\n          var segment = segments.shift();\n          try {\n            var type = segment.type,\n                sb = sourceBuffer[type];\n            if (sb) {\n              if (!sb.updating) {\n                // reset sourceBuffer ended flag before appending segment\n                sb.ended = false;\n                //logger.log(`appending ${segment.content} ${type} SB, size:${segment.data.length}, ${segment.parent}`);\n                this.parent = segment.parent;\n                sb.appendBuffer(segment.data);\n                this.appendError = 0;\n                this.appended++;\n                this.appending = true;\n              } else {\n                segments.unshift(segment);\n              }\n            } else {\n              // in case we don't have any source buffer matching with this segment type,\n              // it means that Mediasource fails to create sourcebuffer\n              // discard this segment, and trigger update end\n              this.onSBUpdateEnd();\n            }\n          } catch (err) {\n            // in case any error occured while appending, put back segment in segments table\n            _logger.logger.error('error while trying to append buffer:' + err.message);\n            segments.unshift(segment);\n            var event = { type: _errors.ErrorTypes.MEDIA_ERROR, parent: segment.parent };\n            if (err.code !== 22) {\n              if (this.appendError) {\n                this.appendError++;\n              } else {\n                this.appendError = 1;\n              }\n              event.details = _errors.ErrorDetails.BUFFER_APPEND_ERROR;\n              /* with UHD content, we could get loop of quota exceeded error until\n                browser is able to evict some data from sourcebuffer. retrying help recovering this\n              */\n              if (this.appendError > hls.config.appendErrorMaxRetry) {\n                _logger.logger.log('fail ' + hls.config.appendErrorMaxRetry + ' times to append segment in sourceBuffer');\n                segments = [];\n                event.fatal = true;\n                hls.trigger(_events2.default.ERROR, event);\n                return;\n              } else {\n                event.fatal = false;\n                hls.trigger(_events2.default.ERROR, event);\n              }\n            } else {\n              // QuotaExceededError: http://www.w3.org/TR/html5/infrastructure.html#quotaexceedederror\n              // let's stop appending any segments, and report BUFFER_FULL_ERROR error\n              this.segments = [];\n              event.details = _errors.ErrorDetails.BUFFER_FULL_ERROR;\n              event.fatal = false;\n              hls.trigger(_events2.default.ERROR, event);\n              return;\n            }\n          }\n        }\n      }\n    }\n\n    /*\n      flush specified buffered range,\n      return true once range has been flushed.\n      as sourceBuffer.remove() is asynchronous, flushBuffer will be retriggered on sourceBuffer update end\n    */\n\n  }, {\n    key: 'flushBuffer',\n    value: function flushBuffer(startOffset, endOffset, typeIn) {\n      var sb,\n          i,\n          bufStart,\n          bufEnd,\n          flushStart,\n          flushEnd,\n          sourceBuffer = this.sourceBuffer;\n      if (Object.keys(sourceBuffer).length) {\n        _logger.logger.log('flushBuffer,pos/start/end: ' + this.media.currentTime.toFixed(3) + '/' + startOffset + '/' + endOffset);\n        // safeguard to avoid infinite looping : don't try to flush more than the nb of appended segments\n        if (this.flushBufferCounter < this.appended) {\n          for (var type in sourceBuffer) {\n            // check if sourcebuffer type is defined (typeIn): if yes, let's only flush this one\n            // if no, let's flush all sourcebuffers\n            if (typeIn && type !== typeIn) {\n              continue;\n            }\n            sb = sourceBuffer[type];\n            // we are going to flush buffer, mark source buffer as 'not ended'\n            sb.ended = false;\n            if (!sb.updating) {\n              try {\n                for (i = 0; i < sb.buffered.length; i++) {\n                  bufStart = sb.buffered.start(i);\n                  bufEnd = sb.buffered.end(i);\n                  // workaround firefox not able to properly flush multiple buffered range.\n                  if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1 && endOffset === Number.POSITIVE_INFINITY) {\n                    flushStart = startOffset;\n                    flushEnd = endOffset;\n                  } else {\n                    flushStart = Math.max(bufStart, startOffset);\n                    flushEnd = Math.min(bufEnd, endOffset);\n                  }\n                  /* sometimes sourcebuffer.remove() does not flush\n                     the exact expected time range.\n                     to avoid rounding issues/infinite loop,\n                     only flush buffer range of length greater than 500ms.\n                  */\n                  if (Math.min(flushEnd, bufEnd) - flushStart > 0.5) {\n                    this.flushBufferCounter++;\n                    _logger.logger.log('flush ' + type + ' [' + flushStart + ',' + flushEnd + '], of [' + bufStart + ',' + bufEnd + '], pos:' + this.media.currentTime);\n                    sb.remove(flushStart, flushEnd);\n                    return false;\n                  }\n                }\n              } catch (e) {\n                _logger.logger.warn('exception while accessing sourcebuffer, it might have been removed from MediaSource');\n              }\n            } else {\n              //logger.log('abort ' + type + ' append in progress');\n              // this will abort any appending in progress\n              //sb.abort();\n              _logger.logger.warn('cannot flush, sb updating in progress');\n              return false;\n            }\n          }\n        } else {\n          _logger.logger.warn('abort flushing too many retries');\n        }\n        _logger.logger.log('buffer flushed');\n      }\n      // everything flushed !\n      return true;\n    }\n  }]);\n\n  return BufferController;\n}(_eventHandler2.default);\n\nexports.default = BufferController;\n\n},{\"31\":31,\"32\":32,\"33\":33,\"50\":50}],9:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * cap stream level to media size dimension controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar CapLevelController = function (_EventHandler) {\n  _inherits(CapLevelController, _EventHandler);\n\n  function CapLevelController(hls) {\n    _classCallCheck(this, CapLevelController);\n\n    return _possibleConstructorReturn(this, (CapLevelController.__proto__ || Object.getPrototypeOf(CapLevelController)).call(this, hls, _events2.default.FPS_DROP_LEVEL_CAPPING, _events2.default.MEDIA_ATTACHING, _events2.default.MANIFEST_PARSED));\n  }\n\n  _createClass(CapLevelController, [{\n    key: 'destroy',\n    value: function destroy() {\n      if (this.hls.config.capLevelToPlayerSize) {\n        this.media = this.restrictedLevels = null;\n        this.autoLevelCapping = Number.POSITIVE_INFINITY;\n        if (this.timer) {\n          this.timer = clearInterval(this.timer);\n        }\n      }\n    }\n  }, {\n    key: 'onFpsDropLevelCapping',\n    value: function onFpsDropLevelCapping(data) {\n      if (!this.restrictedLevels) {\n        this.restrictedLevels = [];\n      }\n      if (!this.isLevelRestricted(data.droppedLevel)) {\n        this.restrictedLevels.push(data.droppedLevel);\n      }\n    }\n  }, {\n    key: 'onMediaAttaching',\n    value: function onMediaAttaching(data) {\n      this.media = data.media instanceof HTMLVideoElement ? data.media : null;\n    }\n  }, {\n    key: 'onManifestParsed',\n    value: function onManifestParsed(data) {\n      var hls = this.hls;\n      if (hls.config.capLevelToPlayerSize) {\n        this.autoLevelCapping = Number.POSITIVE_INFINITY;\n        this.levels = data.levels;\n        hls.firstLevel = this.getMaxLevel(data.firstLevel);\n        clearInterval(this.timer);\n        this.timer = setInterval(this.detectPlayerSize.bind(this), 1000);\n        this.detectPlayerSize();\n      }\n    }\n  }, {\n    key: 'detectPlayerSize',\n    value: function detectPlayerSize() {\n      if (this.media) {\n        var levelsLength = this.levels ? this.levels.length : 0;\n        if (levelsLength) {\n          var hls = this.hls;\n          hls.autoLevelCapping = this.getMaxLevel(levelsLength - 1);\n          if (hls.autoLevelCapping > this.autoLevelCapping) {\n            // if auto level capping has a higher value for the previous one, flush the buffer using nextLevelSwitch\n            // usually happen when the user go to the fullscreen mode.\n            hls.streamController.nextLevelSwitch();\n          }\n          this.autoLevelCapping = hls.autoLevelCapping;\n        }\n      }\n    }\n\n    /*\n    * returns level should be the one with the dimensions equal or greater than the media (player) dimensions (so the video will be downscaled)\n    */\n\n  }, {\n    key: 'getMaxLevel',\n    value: function getMaxLevel(capLevelIndex) {\n      var result = 0,\n          i = void 0,\n          level = void 0,\n          mWidth = this.mediaWidth,\n          mHeight = this.mediaHeight,\n          lWidth = 0,\n          lHeight = 0;\n\n      for (i = 0; i <= capLevelIndex; i++) {\n        level = this.levels[i];\n        if (this.isLevelRestricted(i)) {\n          break;\n        }\n        result = i;\n        lWidth = level.width;\n        lHeight = level.height;\n        if (mWidth <= lWidth || mHeight <= lHeight) {\n          break;\n        }\n      }\n      return result;\n    }\n  }, {\n    key: 'isLevelRestricted',\n    value: function isLevelRestricted(level) {\n      return this.restrictedLevels && this.restrictedLevels.indexOf(level) !== -1 ? true : false;\n    }\n  }, {\n    key: 'contentScaleFactor',\n    get: function get() {\n      var pixelRatio = 1;\n      try {\n        pixelRatio = window.devicePixelRatio;\n      } catch (e) {}\n      return pixelRatio;\n    }\n  }, {\n    key: 'mediaWidth',\n    get: function get() {\n      var width = void 0;\n      var media = this.media;\n      if (media) {\n        width = media.width || media.clientWidth || media.offsetWidth;\n        width *= this.contentScaleFactor;\n      }\n      return width;\n    }\n  }, {\n    key: 'mediaHeight',\n    get: function get() {\n      var height = void 0;\n      var media = this.media;\n      if (media) {\n        height = media.height || media.clientHeight || media.offsetHeight;\n        height *= this.contentScaleFactor;\n      }\n      return height;\n    }\n  }]);\n\n  return CapLevelController;\n}(_eventHandler2.default);\n\nexports.default = CapLevelController;\n\n},{\"32\":32,\"33\":33}],10:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * EWMA Bandwidth Estimator\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *  - heavily inspired from shaka-player\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Tracks bandwidth samples and estimates available bandwidth.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Based on the minimum of two exponentially-weighted moving averages with\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * different half-lives.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _ewma = _dereq_(49);\n\nvar _ewma2 = _interopRequireDefault(_ewma);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar EwmaBandWidthEstimator = function () {\n  function EwmaBandWidthEstimator(hls, slow, fast, defaultEstimate) {\n    _classCallCheck(this, EwmaBandWidthEstimator);\n\n    this.hls = hls;\n    this.defaultEstimate_ = defaultEstimate;\n    this.minWeight_ = 0.001;\n    this.minDelayMs_ = 50;\n    this.slow_ = new _ewma2.default(slow);\n    this.fast_ = new _ewma2.default(fast);\n  }\n\n  _createClass(EwmaBandWidthEstimator, [{\n    key: 'sample',\n    value: function sample(durationMs, numBytes) {\n      durationMs = Math.max(durationMs, this.minDelayMs_);\n      var bandwidth = 8000 * numBytes / durationMs,\n\n      //console.log('instant bw:'+ Math.round(bandwidth));\n      // we weight sample using loading duration....\n      weight = durationMs / 1000;\n      this.fast_.sample(weight, bandwidth);\n      this.slow_.sample(weight, bandwidth);\n    }\n  }, {\n    key: 'canEstimate',\n    value: function canEstimate() {\n      var fast = this.fast_;\n      return fast && fast.getTotalWeight() >= this.minWeight_;\n    }\n  }, {\n    key: 'getEstimate',\n    value: function getEstimate() {\n      if (this.canEstimate()) {\n        //console.log('slow estimate:'+ Math.round(this.slow_.getEstimate()));\n        //console.log('fast estimate:'+ Math.round(this.fast_.getEstimate()));\n        // Take the minimum of these two estimates.  This should have the effect of\n        // adapting down quickly, but up more slowly.\n        return Math.min(this.fast_.getEstimate(), this.slow_.getEstimate());\n      } else {\n        return this.defaultEstimate_;\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {}\n  }]);\n\n  return EwmaBandWidthEstimator;\n}();\n\nexports.default = EwmaBandWidthEstimator;\n\n},{\"49\":49}],11:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * FPS Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar FPSController = function (_EventHandler) {\n  _inherits(FPSController, _EventHandler);\n\n  function FPSController(hls) {\n    _classCallCheck(this, FPSController);\n\n    return _possibleConstructorReturn(this, (FPSController.__proto__ || Object.getPrototypeOf(FPSController)).call(this, hls, _events2.default.MEDIA_ATTACHING));\n  }\n\n  _createClass(FPSController, [{\n    key: 'destroy',\n    value: function destroy() {\n      if (this.timer) {\n        clearInterval(this.timer);\n      }\n      this.isVideoPlaybackQualityAvailable = false;\n    }\n  }, {\n    key: 'onMediaAttaching',\n    value: function onMediaAttaching(data) {\n      var config = this.hls.config;\n      if (config.capLevelOnFPSDrop) {\n        var video = this.video = data.media instanceof HTMLVideoElement ? data.media : null;\n        if (typeof video.getVideoPlaybackQuality === 'function') {\n          this.isVideoPlaybackQualityAvailable = true;\n        }\n        clearInterval(this.timer);\n        this.timer = setInterval(this.checkFPSInterval.bind(this), config.fpsDroppedMonitoringPeriod);\n      }\n    }\n  }, {\n    key: 'checkFPS',\n    value: function checkFPS(video, decodedFrames, droppedFrames) {\n      var currentTime = performance.now();\n      if (decodedFrames) {\n        if (this.lastTime) {\n          var currentPeriod = currentTime - this.lastTime,\n              currentDropped = droppedFrames - this.lastDroppedFrames,\n              currentDecoded = decodedFrames - this.lastDecodedFrames,\n              droppedFPS = 1000 * currentDropped / currentPeriod,\n              hls = this.hls;\n          hls.trigger(_events2.default.FPS_DROP, { currentDropped: currentDropped, currentDecoded: currentDecoded, totalDroppedFrames: droppedFrames });\n          if (droppedFPS > 0) {\n            //logger.log('checkFPS : droppedFPS/decodedFPS:' + droppedFPS/(1000 * currentDecoded / currentPeriod));\n            if (currentDropped > hls.config.fpsDroppedMonitoringThreshold * currentDecoded) {\n              var currentLevel = hls.currentLevel;\n              _logger.logger.warn('drop FPS ratio greater than max allowed value for currentLevel: ' + currentLevel);\n              if (currentLevel > 0 && (hls.autoLevelCapping === -1 || hls.autoLevelCapping >= currentLevel)) {\n                currentLevel = currentLevel - 1;\n                hls.trigger(_events2.default.FPS_DROP_LEVEL_CAPPING, { level: currentLevel, droppedLevel: hls.currentLevel });\n                hls.autoLevelCapping = currentLevel;\n                hls.streamController.nextLevelSwitch();\n              }\n            }\n          }\n        }\n        this.lastTime = currentTime;\n        this.lastDroppedFrames = droppedFrames;\n        this.lastDecodedFrames = decodedFrames;\n      }\n    }\n  }, {\n    key: 'checkFPSInterval',\n    value: function checkFPSInterval() {\n      var video = this.video;\n      if (video) {\n        if (this.isVideoPlaybackQualityAvailable) {\n          var videoPlaybackQuality = video.getVideoPlaybackQuality();\n          this.checkFPS(video, videoPlaybackQuality.totalVideoFrames, videoPlaybackQuality.droppedVideoFrames);\n        } else {\n          this.checkFPS(video, video.webkitDecodedFrameCount, video.webkitDroppedFrameCount);\n        }\n      }\n    }\n  }]);\n\n  return FPSController;\n}(_eventHandler2.default);\n\nexports.default = FPSController;\n\n},{\"32\":32,\"33\":33,\"50\":50}],12:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _logger = _dereq_(50);\n\nvar _errors = _dereq_(31);\n\nvar _bufferHelper = _dereq_(35);\n\nvar _bufferHelper2 = _interopRequireDefault(_bufferHelper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Level Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar LevelController = function (_EventHandler) {\n  _inherits(LevelController, _EventHandler);\n\n  function LevelController(hls) {\n    _classCallCheck(this, LevelController);\n\n    var _this = _possibleConstructorReturn(this, (LevelController.__proto__ || Object.getPrototypeOf(LevelController)).call(this, hls, _events2.default.MANIFEST_LOADED, _events2.default.LEVEL_LOADED, _events2.default.FRAG_LOADED, _events2.default.ERROR));\n\n    _this.ontick = _this.tick.bind(_this);\n    _this._manualLevel = -1;\n    return _this;\n  }\n\n  _createClass(LevelController, [{\n    key: 'destroy',\n    value: function destroy() {\n      if (this.timer) {\n        clearTimeout(this.timer);\n        this.timer = null;\n      }\n      this._manualLevel = -1;\n    }\n  }, {\n    key: 'startLoad',\n    value: function startLoad() {\n      this.canload = true;\n      var levels = this._levels;\n      // clean up live level details to force reload them, and reset load errors\n      if (levels) {\n        levels.forEach(function (level) {\n          level.loadError = 0;\n          var levelDetails = level.details;\n          if (levelDetails && levelDetails.live) {\n            level.details = undefined;\n          }\n        });\n      }\n      // speed up live playlist refresh if timer exists\n      if (this.timer) {\n        this.tick();\n      }\n    }\n  }, {\n    key: 'stopLoad',\n    value: function stopLoad() {\n      this.canload = false;\n    }\n  }, {\n    key: 'onManifestLoaded',\n    value: function onManifestLoaded(data) {\n      var levels0 = [],\n          levels = [],\n          bitrateStart,\n          bitrateSet = {},\n          videoCodecFound = false,\n          audioCodecFound = false,\n          hls = this.hls,\n          brokenmp4inmp3 = /chrome|firefox/.test(navigator.userAgent.toLowerCase()),\n          checkSupported = function checkSupported(type, codec) {\n        return MediaSource.isTypeSupported(type + '/mp4;codecs=' + codec);\n      };\n\n      // regroup redundant level together\n      data.levels.forEach(function (level) {\n        if (level.videoCodec) {\n          videoCodecFound = true;\n        }\n        // erase audio codec info if browser does not support mp4a.40.34. demuxer will autodetect codec and fallback to mpeg/audio\n        if (brokenmp4inmp3 && level.audioCodec && level.audioCodec.indexOf('mp4a.40.34') !== -1) {\n          level.audioCodec = undefined;\n        }\n        if (level.audioCodec || level.attrs && level.attrs.AUDIO) {\n          audioCodecFound = true;\n        }\n        var redundantLevelId = bitrateSet[level.bitrate];\n        if (redundantLevelId === undefined) {\n          bitrateSet[level.bitrate] = levels0.length;\n          level.url = [level.url];\n          level.urlId = 0;\n          levels0.push(level);\n        } else {\n          levels0[redundantLevelId].url.push(level.url);\n        }\n      });\n\n      // remove audio-only level if we also have levels with audio+video codecs signalled\n      if (videoCodecFound && audioCodecFound) {\n        levels0.forEach(function (level) {\n          if (level.videoCodec) {\n            levels.push(level);\n          }\n        });\n      } else {\n        levels = levels0;\n      }\n      // only keep level with supported audio/video codecs\n      levels = levels.filter(function (level) {\n        var audioCodec = level.audioCodec,\n            videoCodec = level.videoCodec;\n        return (!audioCodec || checkSupported('audio', audioCodec)) && (!videoCodec || checkSupported('video', videoCodec));\n      });\n\n      if (levels.length) {\n        // start bitrate is the first bitrate of the manifest\n        bitrateStart = levels[0].bitrate;\n        // sort level on bitrate\n        levels.sort(function (a, b) {\n          return a.bitrate - b.bitrate;\n        });\n        this._levels = levels;\n        // find index of first level in sorted levels\n        for (var i = 0; i < levels.length; i++) {\n          if (levels[i].bitrate === bitrateStart) {\n            this._firstLevel = i;\n            _logger.logger.log('manifest loaded,' + levels.length + ' level(s) found, first bitrate:' + bitrateStart);\n            break;\n          }\n        }\n        hls.trigger(_events2.default.MANIFEST_PARSED, { levels: levels, firstLevel: this._firstLevel, stats: data.stats, audio: audioCodecFound, video: videoCodecFound, altAudio: data.audioTracks.length > 0 });\n      } else {\n        hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR, fatal: true, url: hls.url, reason: 'no level with compatible codecs found in manifest' });\n      }\n      return;\n    }\n  }, {\n    key: 'setLevelInternal',\n    value: function setLevelInternal(newLevel) {\n      var levels = this._levels;\n      var hls = this.hls;\n      // check if level idx is valid\n      if (newLevel >= 0 && newLevel < levels.length) {\n        // stopping live reloading timer if any\n        if (this.timer) {\n          clearTimeout(this.timer);\n          this.timer = null;\n        }\n        if (this._level !== newLevel) {\n          _logger.logger.log('switching to level ' + newLevel);\n          this._level = newLevel;\n          var levelProperties = levels[newLevel];\n          levelProperties.level = newLevel;\n          // LEVEL_SWITCH to be deprecated in next major release\n          hls.trigger(_events2.default.LEVEL_SWITCH, levelProperties);\n          hls.trigger(_events2.default.LEVEL_SWITCHING, levelProperties);\n        }\n        var level = levels[newLevel],\n            levelDetails = level.details;\n        // check if we need to load playlist for this level\n        if (!levelDetails || levelDetails.live === true) {\n          // level not retrieved yet, or live playlist we need to (re)load it\n          var urlId = level.urlId;\n          hls.trigger(_events2.default.LEVEL_LOADING, { url: level.url[urlId], level: newLevel, id: urlId });\n        }\n      } else {\n        // invalid level id given, trigger error\n        hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.OTHER_ERROR, details: _errors.ErrorDetails.LEVEL_SWITCH_ERROR, level: newLevel, fatal: false, reason: 'invalid level idx' });\n      }\n    }\n  }, {\n    key: 'onError',\n    value: function onError(data) {\n      if (data.fatal) {\n        return;\n      }\n\n      var details = data.details,\n          hls = this.hls,\n          levelId = void 0,\n          level = void 0,\n          levelError = false;\n      // try to recover not fatal errors\n      switch (details) {\n        case _errors.ErrorDetails.FRAG_LOAD_ERROR:\n        case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:\n        case _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n        case _errors.ErrorDetails.KEY_LOAD_ERROR:\n        case _errors.ErrorDetails.KEY_LOAD_TIMEOUT:\n          levelId = data.frag.level;\n          break;\n        case _errors.ErrorDetails.LEVEL_LOAD_ERROR:\n        case _errors.ErrorDetails.LEVEL_LOAD_TIMEOUT:\n          levelId = data.context.level;\n          levelError = true;\n          break;\n        case _errors.ErrorDetails.REMUX_ALLOC_ERROR:\n          levelId = data.level;\n          break;\n        default:\n          break;\n      }\n      /* try to switch to a redundant stream if any available.\n       * if no redundant stream available, emergency switch down (if in auto mode and current level not 0)\n       * otherwise, we cannot recover this network error ...\n       */\n      if (levelId !== undefined) {\n        level = this._levels[levelId];\n        if (!level.loadError) {\n          level.loadError = 1;\n        } else {\n          level.loadError++;\n        }\n        // if any redundant streams available and if we haven't try them all (level.loadError is reseted on successful frag/level load.\n        // if level.loadError reaches nbRedundantLevel it means that we tried them all, no hope  => let's switch down\n        var nbRedundantLevel = level.url.length;\n        if (nbRedundantLevel > 1 && level.loadError < nbRedundantLevel) {\n          level.urlId = (level.urlId + 1) % nbRedundantLevel;\n          level.details = undefined;\n          _logger.logger.warn('level controller,' + details + ' for level ' + levelId + ': switching to redundant stream id ' + level.urlId);\n        } else {\n          // we could try to recover if in auto mode and current level not lowest level (0)\n          var recoverable = this._manualLevel === -1 && levelId;\n          if (recoverable) {\n            _logger.logger.warn('level controller,' + details + ': switch-down for next fragment');\n            hls.nextAutoLevel = Math.max(0, levelId - 1);\n          } else if (level && level.details && level.details.live) {\n            _logger.logger.warn('level controller,' + details + ' on live stream, discard');\n            if (levelError) {\n              // reset this._level so that another call to set level() will retrigger a frag load\n              this._level = undefined;\n            }\n            // other errors are handled by stream controller\n          } else if (details === _errors.ErrorDetails.LEVEL_LOAD_ERROR || details === _errors.ErrorDetails.LEVEL_LOAD_TIMEOUT) {\n            var media = hls.media,\n\n            // 0.5 : tolerance needed as some browsers stalls playback before reaching buffered end\n            mediaBuffered = media && _bufferHelper2.default.isBuffered(media, media.currentTime) && _bufferHelper2.default.isBuffered(media, media.currentTime + 0.5);\n            if (mediaBuffered) {\n              var retryDelay = hls.config.levelLoadingRetryDelay;\n              _logger.logger.warn('level controller,' + details + ', but media buffered, retry in ' + retryDelay + 'ms');\n              this.timer = setTimeout(this.ontick, retryDelay);\n            } else {\n              _logger.logger.error('cannot recover ' + details + ' error');\n              this._level = undefined;\n              // stopping live reloading timer if any\n              if (this.timer) {\n                clearTimeout(this.timer);\n                this.timer = null;\n              }\n              // redispatch same error but with fatal set to true\n              data.fatal = true;\n              hls.trigger(_events2.default.ERROR, data);\n            }\n          }\n        }\n      }\n    }\n\n    // reset level load error counter on successful frag loaded\n\n  }, {\n    key: 'onFragLoaded',\n    value: function onFragLoaded(data) {\n      var fragLoaded = data.frag;\n      if (fragLoaded && fragLoaded.type === 'main') {\n        var level = this._levels[fragLoaded.level];\n        if (level) {\n          level.loadError = 0;\n        }\n      }\n    }\n  }, {\n    key: 'onLevelLoaded',\n    value: function onLevelLoaded(data) {\n      var levelId = data.level;\n      // only process level loaded events matching with expected level\n      if (levelId === this._level) {\n        var curLevel = this._levels[levelId];\n        // reset level load error counter on successful level loaded\n        curLevel.loadError = 0;\n        var newDetails = data.details;\n        // if current playlist is a live playlist, arm a timer to reload it\n        if (newDetails.live) {\n          var reloadInterval = 1000 * (newDetails.averagetargetduration ? newDetails.averagetargetduration : newDetails.targetduration),\n              curDetails = curLevel.details;\n          if (curDetails && newDetails.endSN === curDetails.endSN) {\n            // follow HLS Spec, If the client reloads a Playlist file and finds that it has not\n            // changed then it MUST wait for a period of one-half the target\n            // duration before retrying.\n            reloadInterval /= 2;\n            _logger.logger.log('same live playlist, reload twice faster');\n          }\n          // decrement reloadInterval with level loading delay\n          reloadInterval -= performance.now() - data.stats.trequest;\n          // in any case, don't reload more than every second\n          reloadInterval = Math.max(1000, Math.round(reloadInterval));\n          _logger.logger.log('live playlist, reload in ' + reloadInterval + ' ms');\n          this.timer = setTimeout(this.ontick, reloadInterval);\n        } else {\n          this.timer = null;\n        }\n      }\n    }\n  }, {\n    key: 'tick',\n    value: function tick() {\n      var levelId = this._level;\n      if (levelId !== undefined && this.canload) {\n        var level = this._levels[levelId],\n            urlId = level.urlId;\n        this.hls.trigger(_events2.default.LEVEL_LOADING, { url: level.url[urlId], level: levelId, id: urlId });\n      }\n    }\n  }, {\n    key: 'levels',\n    get: function get() {\n      return this._levels;\n    }\n  }, {\n    key: 'level',\n    get: function get() {\n      return this._level;\n    },\n    set: function set(newLevel) {\n      var levels = this._levels;\n      if (levels && levels.length > newLevel) {\n        if (this._level !== newLevel || levels[newLevel].details === undefined) {\n          this.setLevelInternal(newLevel);\n        }\n      }\n    }\n  }, {\n    key: 'manualLevel',\n    get: function get() {\n      return this._manualLevel;\n    },\n    set: function set(newLevel) {\n      this._manualLevel = newLevel;\n      if (this._startLevel === undefined) {\n        this._startLevel = newLevel;\n      }\n      if (newLevel !== -1) {\n        this.level = newLevel;\n      }\n    }\n  }, {\n    key: 'firstLevel',\n    get: function get() {\n      return this._firstLevel;\n    },\n    set: function set(newLevel) {\n      this._firstLevel = newLevel;\n    }\n  }, {\n    key: 'startLevel',\n    get: function get() {\n      // hls.startLevel takes precedence over config.startLevel\n      // if none of these values are defined, fallback on this._firstLevel (first quality level appearing in variant manifest)\n      if (this._startLevel === undefined) {\n        var configStartLevel = this.hls.config.startLevel;\n        if (configStartLevel !== undefined) {\n          return configStartLevel;\n        } else {\n          return this._firstLevel;\n        }\n      } else {\n        return this._startLevel;\n      }\n    },\n    set: function set(newLevel) {\n      this._startLevel = newLevel;\n    }\n  }, {\n    key: 'nextLoadLevel',\n    get: function get() {\n      if (this._manualLevel !== -1) {\n        return this._manualLevel;\n      } else {\n        return this.hls.nextAutoLevel;\n      }\n    },\n    set: function set(nextLevel) {\n      this.level = nextLevel;\n      if (this._manualLevel === -1) {\n        this.hls.nextAutoLevel = nextLevel;\n      }\n    }\n  }]);\n\n  return LevelController;\n}(_eventHandler2.default);\n\nexports.default = LevelController;\n\n},{\"31\":31,\"32\":32,\"33\":33,\"35\":35,\"50\":50}],13:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _binarySearch = _dereq_(46);\n\nvar _binarySearch2 = _interopRequireDefault(_binarySearch);\n\nvar _bufferHelper = _dereq_(35);\n\nvar _bufferHelper2 = _interopRequireDefault(_bufferHelper);\n\nvar _demuxer = _dereq_(25);\n\nvar _demuxer2 = _interopRequireDefault(_demuxer);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _levelHelper = _dereq_(36);\n\nvar _levelHelper2 = _interopRequireDefault(_levelHelper);\n\nvar _timeRanges = _dereq_(51);\n\nvar _timeRanges2 = _interopRequireDefault(_timeRanges);\n\nvar _errors = _dereq_(31);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Stream Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar State = {\n  STOPPED: 'STOPPED',\n  IDLE: 'IDLE',\n  KEY_LOADING: 'KEY_LOADING',\n  FRAG_LOADING: 'FRAG_LOADING',\n  FRAG_LOADING_WAITING_RETRY: 'FRAG_LOADING_WAITING_RETRY',\n  WAITING_LEVEL: 'WAITING_LEVEL',\n  PARSING: 'PARSING',\n  PARSED: 'PARSED',\n  BUFFER_FLUSHING: 'BUFFER_FLUSHING',\n  ENDED: 'ENDED',\n  ERROR: 'ERROR'\n};\n\nvar StreamController = function (_EventHandler) {\n  _inherits(StreamController, _EventHandler);\n\n  function StreamController(hls) {\n    _classCallCheck(this, StreamController);\n\n    var _this = _possibleConstructorReturn(this, (StreamController.__proto__ || Object.getPrototypeOf(StreamController)).call(this, hls, _events2.default.MEDIA_ATTACHED, _events2.default.MEDIA_DETACHING, _events2.default.MANIFEST_LOADING, _events2.default.MANIFEST_PARSED, _events2.default.LEVEL_LOADED, _events2.default.KEY_LOADED, _events2.default.FRAG_LOADED, _events2.default.FRAG_LOAD_EMERGENCY_ABORTED, _events2.default.FRAG_PARSING_INIT_SEGMENT, _events2.default.FRAG_PARSING_DATA, _events2.default.FRAG_PARSED, _events2.default.ERROR, _events2.default.AUDIO_TRACK_SWITCHING, _events2.default.AUDIO_TRACK_SWITCHED, _events2.default.BUFFER_CREATED, _events2.default.BUFFER_APPENDED, _events2.default.BUFFER_FLUSHED));\n\n    _this.config = hls.config;\n    _this.audioCodecSwap = false;\n    _this.ticks = 0;\n    _this._state = State.STOPPED;\n    _this.ontick = _this.tick.bind(_this);\n    return _this;\n  }\n\n  _createClass(StreamController, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.stopLoad();\n      if (this.timer) {\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n      _eventHandler2.default.prototype.destroy.call(this);\n      this.state = State.STOPPED;\n    }\n  }, {\n    key: 'startLoad',\n    value: function startLoad(startPosition) {\n      if (this.levels) {\n        var lastCurrentTime = this.lastCurrentTime,\n            hls = this.hls;\n        this.stopLoad();\n        if (!this.timer) {\n          this.timer = setInterval(this.ontick, 100);\n        }\n        this.level = -1;\n        this.fragLoadError = 0;\n        if (!this.startFragRequested) {\n          // determine load level\n          var startLevel = hls.startLevel;\n          if (startLevel === -1) {\n            // -1 : guess start Level by doing a bitrate test by loading first fragment of lowest quality level\n            startLevel = 0;\n            this.bitrateTest = true;\n          }\n          // set new level to playlist loader : this will trigger start level load\n          // hls.nextLoadLevel remains until it is set to a new value or until a new frag is successfully loaded\n          this.level = hls.nextLoadLevel = startLevel;\n          this.loadedmetadata = false;\n        }\n        // if startPosition undefined but lastCurrentTime set, set startPosition to last currentTime\n        if (lastCurrentTime > 0 && startPosition === -1) {\n          _logger.logger.log('override startPosition with lastCurrentTime @' + lastCurrentTime.toFixed(3));\n          startPosition = lastCurrentTime;\n        }\n        this.state = State.IDLE;\n        this.nextLoadPosition = this.startPosition = this.lastCurrentTime = startPosition;\n        this.tick();\n      } else {\n        _logger.logger.warn('cannot start loading as manifest not parsed yet');\n        this.state = State.STOPPED;\n      }\n    }\n  }, {\n    key: 'stopLoad',\n    value: function stopLoad() {\n      var frag = this.fragCurrent;\n      if (frag) {\n        if (frag.loader) {\n          frag.loader.abort();\n        }\n        this.fragCurrent = null;\n      }\n      this.fragPrevious = null;\n      if (this.demuxer) {\n        this.demuxer.destroy();\n        this.demuxer = null;\n      }\n      this.state = State.STOPPED;\n    }\n  }, {\n    key: 'tick',\n    value: function tick() {\n      this.ticks++;\n      if (this.ticks === 1) {\n        this.doTick();\n        if (this.ticks > 1) {\n          setTimeout(this.tick, 1);\n        }\n        this.ticks = 0;\n      }\n    }\n  }, {\n    key: 'doTick',\n    value: function doTick() {\n      switch (this.state) {\n        case State.ERROR:\n          //don't do anything in error state to avoid breaking further ...\n          break;\n        case State.BUFFER_FLUSHING:\n          // in buffer flushing state, reset fragLoadError counter\n          this.fragLoadError = 0;\n          break;\n        case State.IDLE:\n          // when this returns false there was an error and we shall return immediatly\n          // from current tick\n          if (!this._doTickIdle()) {\n            return;\n          }\n          break;\n        case State.WAITING_LEVEL:\n          var level = this.levels[this.level];\n          // check if playlist is already loaded\n          if (level && level.details) {\n            this.state = State.IDLE;\n          }\n          break;\n        case State.FRAG_LOADING_WAITING_RETRY:\n          var now = performance.now();\n          var retryDate = this.retryDate;\n          // if current time is gt than retryDate, or if media seeking let's switch to IDLE state to retry loading\n          if (!retryDate || now >= retryDate || this.media && this.media.seeking) {\n            _logger.logger.log('mediaController: retryDate reached, switch back to IDLE state');\n            this.state = State.IDLE;\n          }\n          break;\n        case State.ERROR:\n        case State.STOPPED:\n        case State.FRAG_LOADING:\n        case State.PARSING:\n        case State.PARSED:\n        case State.ENDED:\n          break;\n        default:\n          break;\n      }\n      // check buffer\n      this._checkBuffer();\n      // check/update current fragment\n      this._checkFragmentChanged();\n    }\n\n    // Ironically the \"idle\" state is the on we do the most logic in it seems ....\n    // NOTE: Maybe we could rather schedule a check for buffer length after half of the currently\n    //       played segment, or on pause/play/seek instead of naively checking every 100ms?\n\n  }, {\n    key: '_doTickIdle',\n    value: function _doTickIdle() {\n      var hls = this.hls,\n          config = hls.config,\n          media = this.media;\n\n      // if video not attached AND\n      // start fragment already requested OR start frag prefetch disable\n      // exit loop\n      // => if start level loaded and media not attached but start frag prefetch is enabled and start frag not requested yet, we will not exit loop\n      if (this.levelLastLoaded !== undefined && !media && (this.startFragRequested || !config.startFragPrefetch)) {\n        return true;\n      }\n\n      // if we have not yet loaded any fragment, start loading from start position\n      var pos = void 0;\n      if (this.loadedmetadata) {\n        pos = media.currentTime;\n      } else {\n        pos = this.nextLoadPosition;\n      }\n      // determine next load level\n      var level = hls.nextLoadLevel,\n          levelInfo = this.levels[level],\n          levelBitrate = levelInfo.bitrate,\n          maxBufLen = void 0;\n\n      // compute max Buffer Length that we could get from this load level, based on level bitrate. don't buffer more than 60 MB and more than 30s\n      if (levelBitrate) {\n        maxBufLen = Math.max(8 * config.maxBufferSize / levelBitrate, config.maxBufferLength);\n      } else {\n        maxBufLen = config.maxBufferLength;\n      }\n      maxBufLen = Math.min(maxBufLen, config.maxMaxBufferLength);\n\n      // determine next candidate fragment to be loaded, based on current position and end of buffer position\n      // ensure up to `config.maxMaxBufferLength` of buffer upfront\n\n      var bufferInfo = _bufferHelper2.default.bufferInfo(this.mediaBuffer ? this.mediaBuffer : media, pos, config.maxBufferHole),\n          bufferLen = bufferInfo.len;\n      // Stay idle if we are still with buffer margins\n      if (bufferLen >= maxBufLen) {\n        return true;\n      }\n\n      // if buffer length is less than maxBufLen try to load a new fragment ...\n      _logger.logger.trace('buffer length of ' + bufferLen.toFixed(3) + ' is below max of ' + maxBufLen.toFixed(3) + '. checking for more payload ...');\n\n      // set next load level : this will trigger a playlist load if needed\n      this.level = hls.nextLoadLevel = level;\n\n      var levelDetails = levelInfo.details;\n      // if level info not retrieved yet, switch state and wait for level retrieval\n      // if live playlist, ensure that new playlist has been refreshed to avoid loading/try to load\n      // a useless and outdated fragment (that might even introduce load error if it is already out of the live playlist)\n      if (typeof levelDetails === 'undefined' || levelDetails.live && this.levelLastLoaded !== level) {\n        this.state = State.WAITING_LEVEL;\n        return true;\n      }\n\n      // we just got done loading the final fragment, check if we need to finalize media stream\n      var fragPrevious = this.fragPrevious;\n      if (!levelDetails.live && fragPrevious && fragPrevious.sn === levelDetails.endSN) {\n        // if everything (almost) til the end is buffered, let's signal eos\n        // we don't compare exactly media.duration === bufferInfo.end as there could be some subtle media duration difference\n        // using half frag duration should help cope with these cases.\n        // also cope with almost zero last frag duration (max last frag duration with 200ms) refer to https://github.com/dailymotion/hls.js/pull/657\n        if (media.duration - Math.max(bufferInfo.end, fragPrevious.start) <= Math.max(0.2, fragPrevious.duration / 2)) {\n          // Finalize the media stream\n          var data = {};\n          if (this.altAudio) {\n            data.type = 'video';\n          }\n          this.hls.trigger(_events2.default.BUFFER_EOS, data);\n          this.state = State.ENDED;\n          return true;\n        }\n      }\n\n      // if we have the levelDetails for the selected variant, lets continue enrichen our stream (load keys/fragments or trigger EOS, etc..)\n      return this._fetchPayloadOrEos(pos, bufferInfo, levelDetails);\n    }\n  }, {\n    key: '_fetchPayloadOrEos',\n    value: function _fetchPayloadOrEos(pos, bufferInfo, levelDetails) {\n      var fragPrevious = this.fragPrevious,\n          level = this.level,\n          fragments = levelDetails.fragments,\n          fragLen = fragments.length;\n\n      // empty playlist\n      if (fragLen === 0) {\n        return false;\n      }\n\n      // find fragment index, contiguous with end of buffer position\n      var start = fragments[0].start,\n          end = fragments[fragLen - 1].start + fragments[fragLen - 1].duration,\n          bufferEnd = bufferInfo.end,\n          frag = void 0;\n\n      if (levelDetails.initSegment && !levelDetails.initSegment.data) {\n        frag = levelDetails.initSegment;\n      } else {\n        // in case of live playlist we need to ensure that requested position is not located before playlist start\n        if (levelDetails.live) {\n          var initialLiveManifestSize = this.config.initialLiveManifestSize;\n          if (fragLen < initialLiveManifestSize) {\n            _logger.logger.warn('Can not start playback of a level, reason: not enough fragments ' + fragLen + ' < ' + initialLiveManifestSize);\n            return false;\n          }\n\n          frag = this._ensureFragmentAtLivePoint(levelDetails, bufferEnd, start, end, fragPrevious, fragments, fragLen);\n          // if it explicitely returns null don't load any fragment and exit function now\n          if (frag === null) {\n            return false;\n          }\n        } else {\n          // VoD playlist: if bufferEnd before start of playlist, load first fragment\n          if (bufferEnd < start) {\n            frag = fragments[0];\n          }\n        }\n      }\n      if (!frag) {\n        frag = this._findFragment(start, fragPrevious, fragLen, fragments, bufferEnd, end, levelDetails);\n      }\n      if (frag) {\n        return this._loadFragmentOrKey(frag, level, levelDetails, pos, bufferEnd);\n      }\n      return true;\n    }\n  }, {\n    key: '_ensureFragmentAtLivePoint',\n    value: function _ensureFragmentAtLivePoint(levelDetails, bufferEnd, start, end, fragPrevious, fragments, fragLen) {\n      var config = this.hls.config,\n          media = this.media;\n\n      var frag = void 0;\n\n      // check if requested position is within seekable boundaries :\n      //logger.log(`start/pos/bufEnd/seeking:${start.toFixed(3)}/${pos.toFixed(3)}/${bufferEnd.toFixed(3)}/${this.media.seeking}`);\n      var maxLatency = config.liveMaxLatencyDuration !== undefined ? config.liveMaxLatencyDuration : config.liveMaxLatencyDurationCount * levelDetails.targetduration;\n\n      if (bufferEnd < Math.max(start - config.maxFragLookUpTolerance, end - maxLatency)) {\n        var liveSyncPosition = this.liveSyncPosition = this.computeLivePosition(start, levelDetails);\n        _logger.logger.log('buffer end: ' + bufferEnd.toFixed(3) + ' is located too far from the end of live sliding playlist, reset currentTime to : ' + liveSyncPosition.toFixed(3));\n        bufferEnd = liveSyncPosition;\n        if (media && media.readyState && media.duration > liveSyncPosition) {\n          media.currentTime = liveSyncPosition;\n        }\n      }\n\n      // if end of buffer greater than live edge, don't load any fragment\n      // this could happen if live playlist intermittently slides in the past.\n      // level 1 loaded [182580161,182580167]\n      // level 1 loaded [182580162,182580169]\n      // Loading 182580168 of [182580162 ,182580169],level 1 ..\n      // Loading 182580169 of [182580162 ,182580169],level 1 ..\n      // level 1 loaded [182580162,182580168] <============= here we should have bufferEnd > end. in that case break to avoid reloading 182580168\n      // level 1 loaded [182580164,182580171]\n      //\n      // don't return null in case media not loaded yet (readystate === 0)\n      if (levelDetails.PTSKnown && bufferEnd > end && media && media.readyState) {\n        return null;\n      }\n\n      if (this.startFragRequested && !levelDetails.PTSKnown) {\n        /* we are switching level on live playlist, but we don't have any PTS info for that quality level ...\n           try to load frag matching with next SN.\n           even if SN are not synchronized between playlists, loading this frag will help us\n           compute playlist sliding and find the right one after in case it was not the right consecutive one */\n        if (fragPrevious) {\n          var targetSN = fragPrevious.sn + 1;\n          if (targetSN >= levelDetails.startSN && targetSN <= levelDetails.endSN) {\n            frag = fragments[targetSN - levelDetails.startSN];\n            _logger.logger.log('live playlist, switching playlist, load frag with next SN: ' + frag.sn);\n          }\n        }\n        if (!frag) {\n          /* we have no idea about which fragment should be loaded.\n             so let's load mid fragment. it will help computing playlist sliding and find the right one\n          */\n          frag = fragments[Math.min(fragLen - 1, Math.round(fragLen / 2))];\n          _logger.logger.log('live playlist, switching playlist, unknown, load middle frag : ' + frag.sn);\n        }\n      }\n      return frag;\n    }\n  }, {\n    key: '_findFragment',\n    value: function _findFragment(start, fragPrevious, fragLen, fragments, bufferEnd, end, levelDetails) {\n      var config = this.hls.config;\n      var frag = void 0;\n      var foundFrag = void 0;\n      var maxFragLookUpTolerance = config.maxFragLookUpTolerance;\n      var fragNext = fragPrevious ? fragments[fragPrevious.sn - fragments[0].sn + 1] : undefined;\n      var fragmentWithinToleranceTest = function fragmentWithinToleranceTest(candidate) {\n        // offset should be within fragment boundary - config.maxFragLookUpTolerance\n        // this is to cope with situations like\n        // bufferEnd = 9.991\n        // frag[Ø] : [0,10]\n        // frag[1] : [10,20]\n        // bufferEnd is within frag[0] range ... although what we are expecting is to return frag[1] here\n        //              frag start               frag start+duration\n        //                  |-----------------------------|\n        //              <--->                         <--->\n        //  ...--------><-----------------------------><---------....\n        // previous frag         matching fragment         next frag\n        //  return -1             return 0                 return 1\n        //logger.log(`level/sn/start/end/bufEnd:${level}/${candidate.sn}/${candidate.start}/${(candidate.start+candidate.duration)}/${bufferEnd}`);\n        // Set the lookup tolerance to be small enough to detect the current segment - ensures we don't skip over very small segments\n        var candidateLookupTolerance = Math.min(maxFragLookUpTolerance, candidate.duration);\n        if (candidate.start + candidate.duration - candidateLookupTolerance <= bufferEnd) {\n          return 1;\n        } // if maxFragLookUpTolerance will have negative value then don't return -1 for first element\n        else if (candidate.start - candidateLookupTolerance > bufferEnd && candidate.start) {\n            return -1;\n          }\n        return 0;\n      };\n\n      if (bufferEnd < end) {\n        if (bufferEnd > end - maxFragLookUpTolerance) {\n          maxFragLookUpTolerance = 0;\n        }\n        // Prefer the next fragment if it's within tolerance\n        if (fragNext && !fragmentWithinToleranceTest(fragNext)) {\n          foundFrag = fragNext;\n        } else {\n          foundFrag = _binarySearch2.default.search(fragments, fragmentWithinToleranceTest);\n        }\n      } else {\n        // reach end of playlist\n        foundFrag = fragments[fragLen - 1];\n      }\n      if (foundFrag) {\n        frag = foundFrag;\n        var curSNIdx = frag.sn - levelDetails.startSN;\n        var sameLevel = fragPrevious && frag.level === fragPrevious.level;\n        var prevFrag = fragments[curSNIdx - 1];\n        var nextFrag = fragments[curSNIdx + 1];\n        //logger.log('find SN matching with pos:' +  bufferEnd + ':' + frag.sn);\n        if (sameLevel && frag.sn === fragPrevious.sn) {\n          if (frag.sn < levelDetails.endSN) {\n            var deltaPTS = fragPrevious.deltaPTS;\n            // if there is a significant delta between audio and video, larger than max allowed hole,\n            // and if previous remuxed fragment did not start with a keyframe. (fragPrevious.dropped)\n            // let's try to load previous fragment again to get last keyframe\n            // then we will reload again current fragment (that way we should be able to fill the buffer hole ...)\n            if (deltaPTS && deltaPTS > config.maxBufferHole && fragPrevious.dropped && curSNIdx) {\n              frag = prevFrag;\n              _logger.logger.warn('SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this');\n              // decrement previous frag load counter to avoid frag loop loading error when next fragment will get reloaded\n              fragPrevious.loadCounter--;\n            } else {\n              frag = nextFrag;\n              _logger.logger.log('SN just loaded, load next one: ' + frag.sn);\n            }\n          } else {\n            frag = null;\n          }\n        } else if (frag.dropped && !sameLevel) {\n          // Only backtrack a max of 1 consecutive fragment to prevent sliding back too far when little or no frags start with keyframes\n          if (nextFrag && nextFrag.backtracked) {\n            _logger.logger.warn('Already backtracked from fragment ' + (curSNIdx + 1) + ', will not backtrack to fragment ' + curSNIdx + '. Loading fragment ' + (curSNIdx + 1));\n            frag = nextFrag;\n          } else {\n            // If a fragment has dropped frames and it's in a different level/sequence, load the previous fragment to try and find the keyframe\n            // Reset the dropped count now since it won't be reset until we parse the fragment again, which prevents infinite backtracking on the same segment\n            _logger.logger.warn('Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe');\n            frag.dropped = 0;\n            if (prevFrag && prevFrag.loadCounter) {\n              prevFrag.loadCounter--;\n              frag = prevFrag;\n            } else {\n              frag = null;\n            }\n          }\n        }\n      }\n      return frag;\n    }\n  }, {\n    key: '_loadFragmentOrKey',\n    value: function _loadFragmentOrKey(frag, level, levelDetails, pos, bufferEnd) {\n      var hls = this.hls,\n          config = hls.config;\n\n      //logger.log('loading frag ' + i +',pos/bufEnd:' + pos.toFixed(3) + '/' + bufferEnd.toFixed(3));\n      if (frag.decryptdata && frag.decryptdata.uri != null && frag.decryptdata.key == null) {\n        _logger.logger.log('Loading key for ' + frag.sn + ' of [' + levelDetails.startSN + ' ,' + levelDetails.endSN + '],level ' + level);\n        this.state = State.KEY_LOADING;\n        hls.trigger(_events2.default.KEY_LOADING, { frag: frag });\n      } else {\n        _logger.logger.log('Loading ' + frag.sn + ' of [' + levelDetails.startSN + ' ,' + levelDetails.endSN + '],level ' + level + ', currentTime:' + pos.toFixed(3) + ',bufferEnd:' + bufferEnd.toFixed(3));\n        // ensure that we are not reloading the same fragments in loop ...\n        if (this.fragLoadIdx !== undefined) {\n          this.fragLoadIdx++;\n        } else {\n          this.fragLoadIdx = 0;\n        }\n        if (frag.loadCounter) {\n          frag.loadCounter++;\n          var maxThreshold = config.fragLoadingLoopThreshold;\n          // if this frag has already been loaded 3 times, and if it has been reloaded recently\n          if (frag.loadCounter > maxThreshold && Math.abs(this.fragLoadIdx - frag.loadIdx) < maxThreshold) {\n            hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR, fatal: false, frag: frag });\n            return false;\n          }\n        } else {\n          frag.loadCounter = 1;\n        }\n        frag.loadIdx = this.fragLoadIdx;\n        this.fragCurrent = frag;\n        this.startFragRequested = true;\n        if (!isNaN(frag.sn)) {\n          this.nextLoadPosition = frag.start + frag.duration;\n        }\n        frag.autoLevel = hls.autoLevelEnabled;\n        frag.bitrateTest = this.bitrateTest;\n        hls.trigger(_events2.default.FRAG_LOADING, { frag: frag });\n        // lazy demuxer init, as this could take some time ... do it during frag loading\n        if (!this.demuxer) {\n          this.demuxer = new _demuxer2.default(hls, 'main');\n        }\n        this.state = State.FRAG_LOADING;\n        return true;\n      }\n    }\n  }, {\n    key: 'getBufferRange',\n    value: function getBufferRange(position) {\n      return _binarySearch2.default.search(this.bufferRange, function (range) {\n        if (position < range.start) {\n          return -1;\n        } else if (position > range.end) {\n          return 1;\n        }\n        return 0;\n      });\n    }\n  }, {\n    key: 'followingBufferRange',\n    value: function followingBufferRange(range) {\n      if (range) {\n        // try to get range of next fragment (500ms after this range)\n        return this.getBufferRange(range.end + 0.5);\n      }\n      return null;\n    }\n  }, {\n    key: '_checkFragmentChanged',\n    value: function _checkFragmentChanged() {\n      var rangeCurrent,\n          currentTime,\n          video = this.media;\n      if (video && video.readyState && video.seeking === false) {\n        currentTime = video.currentTime;\n        /* if video element is in seeked state, currentTime can only increase.\n          (assuming that playback rate is positive ...)\n          As sometimes currentTime jumps back to zero after a\n          media decode error, check this, to avoid seeking back to\n          wrong position after a media decode error\n        */\n        if (currentTime > video.playbackRate * this.lastCurrentTime) {\n          this.lastCurrentTime = currentTime;\n        }\n        if (_bufferHelper2.default.isBuffered(video, currentTime)) {\n          rangeCurrent = this.getBufferRange(currentTime);\n        } else if (_bufferHelper2.default.isBuffered(video, currentTime + 0.1)) {\n          /* ensure that FRAG_CHANGED event is triggered at startup,\n            when first video frame is displayed and playback is paused.\n            add a tolerance of 100ms, in case current position is not buffered,\n            check if current pos+100ms is buffered and use that buffer range\n            for FRAG_CHANGED event reporting */\n          rangeCurrent = this.getBufferRange(currentTime + 0.1);\n        }\n        if (rangeCurrent) {\n          var fragPlaying = rangeCurrent.frag;\n          if (fragPlaying !== this.fragPlaying) {\n            this.hls.trigger(_events2.default.FRAG_CHANGED, { frag: fragPlaying });\n            var fragPlayingLevel = fragPlaying.level;\n            if (!this.fragPlaying || this.fragPlaying.level !== fragPlayingLevel) {\n              this.hls.trigger(_events2.default.LEVEL_SWITCHED, { level: fragPlayingLevel });\n            }\n            this.fragPlaying = fragPlaying;\n          }\n        }\n      }\n    }\n\n    /*\n      on immediate level switch :\n       - pause playback if playing\n       - cancel any pending load request\n       - and trigger a buffer flush\n    */\n\n  }, {\n    key: 'immediateLevelSwitch',\n    value: function immediateLevelSwitch() {\n      _logger.logger.log('immediateLevelSwitch');\n      if (!this.immediateSwitch) {\n        this.immediateSwitch = true;\n        var media = this.media,\n            previouslyPaused = void 0;\n        if (media) {\n          previouslyPaused = media.paused;\n          media.pause();\n        } else {\n          // don't restart playback after instant level switch in case media not attached\n          previouslyPaused = true;\n        }\n        this.previouslyPaused = previouslyPaused;\n      }\n      var fragCurrent = this.fragCurrent;\n      if (fragCurrent && fragCurrent.loader) {\n        fragCurrent.loader.abort();\n      }\n      this.fragCurrent = null;\n      // increase fragment load Index to avoid frag loop loading error after buffer flush\n      this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n      // flush everything\n      this.flushMainBuffer(0, Number.POSITIVE_INFINITY);\n    }\n\n    /*\n       on immediate level switch end, after new fragment has been buffered :\n        - nudge video decoder by slightly adjusting video currentTime (if currentTime buffered)\n        - resume the playback if needed\n    */\n\n  }, {\n    key: 'immediateLevelSwitchEnd',\n    value: function immediateLevelSwitchEnd() {\n      var media = this.media;\n      if (media && media.buffered.length) {\n        this.immediateSwitch = false;\n        if (_bufferHelper2.default.isBuffered(media, media.currentTime)) {\n          // only nudge if currentTime is buffered\n          media.currentTime -= 0.0001;\n        }\n        if (!this.previouslyPaused) {\n          media.play();\n        }\n      }\n    }\n  }, {\n    key: 'nextLevelSwitch',\n    value: function nextLevelSwitch() {\n      /* try to switch ASAP without breaking video playback :\n         in order to ensure smooth but quick level switching,\n        we need to find the next flushable buffer range\n        we should take into account new segment fetch time\n      */\n      var media = this.media;\n      // ensure that media is defined and that metadata are available (to retrieve currentTime)\n      if (media && media.readyState) {\n        var fetchdelay = void 0,\n            currentRange = void 0,\n            nextRange = void 0;\n        // increase fragment load Index to avoid frag loop loading error after buffer flush\n        this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n        currentRange = this.getBufferRange(media.currentTime);\n        if (currentRange && currentRange.start > 1) {\n          // flush buffer preceding current fragment (flush until current fragment start offset)\n          // minus 1s to avoid video freezing, that could happen if we flush keyframe of current video ...\n          this.flushMainBuffer(0, currentRange.start - 1);\n        }\n        if (!media.paused) {\n          // add a safety delay of 1s\n          var nextLevelId = this.hls.nextLoadLevel,\n              nextLevel = this.levels[nextLevelId],\n              fragLastKbps = this.fragLastKbps;\n          if (fragLastKbps && this.fragCurrent) {\n            fetchdelay = this.fragCurrent.duration * nextLevel.bitrate / (1000 * fragLastKbps) + 1;\n          } else {\n            fetchdelay = 0;\n          }\n        } else {\n          fetchdelay = 0;\n        }\n        //logger.log('fetchdelay:'+fetchdelay);\n        // find buffer range that will be reached once new fragment will be fetched\n        nextRange = this.getBufferRange(media.currentTime + fetchdelay);\n        if (nextRange) {\n          // we can flush buffer range following this one without stalling playback\n          nextRange = this.followingBufferRange(nextRange);\n          if (nextRange) {\n            // if we are here, we can also cancel any loading/demuxing in progress, as they are useless\n            var fragCurrent = this.fragCurrent;\n            if (fragCurrent && fragCurrent.loader) {\n              fragCurrent.loader.abort();\n            }\n            this.fragCurrent = null;\n            // flush position is the start position of this new buffer\n            this.flushMainBuffer(nextRange.start, Number.POSITIVE_INFINITY);\n          }\n        }\n      }\n    }\n  }, {\n    key: 'flushMainBuffer',\n    value: function flushMainBuffer(startOffset, endOffset) {\n      this.state = State.BUFFER_FLUSHING;\n      var flushScope = { startOffset: startOffset, endOffset: endOffset };\n      // if alternate audio tracks are used, only flush video, otherwise flush everything\n      if (this.altAudio) {\n        flushScope.type = 'video';\n      }\n      this.hls.trigger(_events2.default.BUFFER_FLUSHING, flushScope);\n    }\n  }, {\n    key: 'onMediaAttached',\n    value: function onMediaAttached(data) {\n      var media = this.media = this.mediaBuffer = data.media;\n      this.onvseeking = this.onMediaSeeking.bind(this);\n      this.onvseeked = this.onMediaSeeked.bind(this);\n      this.onvended = this.onMediaEnded.bind(this);\n      media.addEventListener('seeking', this.onvseeking);\n      media.addEventListener('seeked', this.onvseeked);\n      media.addEventListener('ended', this.onvended);\n      var config = this.config;\n      if (this.levels && config.autoStartLoad) {\n        this.hls.startLoad(config.startPosition);\n      }\n    }\n  }, {\n    key: 'onMediaDetaching',\n    value: function onMediaDetaching() {\n      var media = this.media;\n      if (media && media.ended) {\n        _logger.logger.log('MSE detaching and video ended, reset startPosition');\n        this.startPosition = this.lastCurrentTime = 0;\n      }\n\n      // reset fragment loading counter on MSE detaching to avoid reporting FRAG_LOOP_LOADING_ERROR after error recovery\n      var levels = this.levels;\n      if (levels) {\n        // reset fragment load counter\n        levels.forEach(function (level) {\n          if (level.details) {\n            level.details.fragments.forEach(function (fragment) {\n              fragment.loadCounter = undefined;\n              fragment.backtracked = undefined;\n            });\n          }\n        });\n      }\n      // remove video listeners\n      if (media) {\n        media.removeEventListener('seeking', this.onvseeking);\n        media.removeEventListener('seeked', this.onvseeked);\n        media.removeEventListener('ended', this.onvended);\n        this.onvseeking = this.onvseeked = this.onvended = null;\n      }\n      this.media = this.mediaBuffer = null;\n      this.loadedmetadata = false;\n      this.stopLoad();\n    }\n  }, {\n    key: 'onMediaSeeking',\n    value: function onMediaSeeking() {\n      var media = this.media,\n          currentTime = media ? media.currentTime : undefined,\n          config = this.config;\n      _logger.logger.log('media seeking to ' + currentTime.toFixed(3));\n      if (this.state === State.FRAG_LOADING) {\n        var mediaBuffer = this.mediaBuffer ? this.mediaBuffer : media;\n        var bufferInfo = _bufferHelper2.default.bufferInfo(mediaBuffer, currentTime, this.config.maxBufferHole),\n            fragCurrent = this.fragCurrent;\n        // check if we are seeking to a unbuffered area AND if frag loading is in progress\n        if (bufferInfo.len === 0 && fragCurrent) {\n          var tolerance = config.maxFragLookUpTolerance,\n              fragStartOffset = fragCurrent.start - tolerance,\n              fragEndOffset = fragCurrent.start + fragCurrent.duration + tolerance;\n          // check if we seek position will be out of currently loaded frag range : if out cancel frag load, if in, don't do anything\n          if (currentTime < fragStartOffset || currentTime > fragEndOffset) {\n            if (fragCurrent.loader) {\n              _logger.logger.log('seeking outside of buffer while fragment load in progress, cancel fragment load');\n              fragCurrent.loader.abort();\n            }\n            this.fragCurrent = null;\n            this.fragPrevious = null;\n            // switch to IDLE state to load new fragment\n            this.state = State.IDLE;\n          } else {\n            _logger.logger.log('seeking outside of buffer but within currently loaded fragment range');\n          }\n        }\n      } else if (this.state === State.ENDED) {\n        // switch to IDLE state to check for potential new fragment\n        this.state = State.IDLE;\n      }\n      if (media) {\n        this.lastCurrentTime = currentTime;\n      }\n      // avoid reporting fragment loop loading error in case user is seeking several times on same position\n      if (this.state !== State.FRAG_LOADING && this.fragLoadIdx !== undefined) {\n        this.fragLoadIdx += 2 * config.fragLoadingLoopThreshold;\n      }\n      // in case seeking occurs although no media buffered, adjust startPosition and nextLoadPosition to seek target\n      if (!this.loadedmetadata) {\n        this.nextLoadPosition = this.startPosition = currentTime;\n      }\n      // tick to speed up processing\n      this.tick();\n    }\n  }, {\n    key: 'onMediaSeeked',\n    value: function onMediaSeeked() {\n      _logger.logger.log('media seeked to ' + this.media.currentTime.toFixed(3));\n      // tick to speed up FRAGMENT_PLAYING triggering\n      this.tick();\n    }\n  }, {\n    key: 'onMediaEnded',\n    value: function onMediaEnded() {\n      _logger.logger.log('media ended');\n      // reset startPosition and lastCurrentTime to restart playback @ stream beginning\n      this.startPosition = this.lastCurrentTime = 0;\n    }\n  }, {\n    key: 'onManifestLoading',\n    value: function onManifestLoading() {\n      // reset buffer on manifest loading\n      _logger.logger.log('trigger BUFFER_RESET');\n      this.hls.trigger(_events2.default.BUFFER_RESET);\n      this.bufferRange = [];\n      this.stalled = false;\n      this.startPosition = this.lastCurrentTime = 0;\n    }\n  }, {\n    key: 'onManifestParsed',\n    value: function onManifestParsed(data) {\n      var aac = false,\n          heaac = false,\n          codec;\n      data.levels.forEach(function (level) {\n        // detect if we have different kind of audio codecs used amongst playlists\n        codec = level.audioCodec;\n        if (codec) {\n          if (codec.indexOf('mp4a.40.2') !== -1) {\n            aac = true;\n          }\n          if (codec.indexOf('mp4a.40.5') !== -1) {\n            heaac = true;\n          }\n        }\n      });\n      this.audioCodecSwitch = aac && heaac;\n      if (this.audioCodecSwitch) {\n        _logger.logger.log('both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC');\n      }\n      this.levels = data.levels;\n      this.startLevelLoaded = false;\n      this.startFragRequested = false;\n      var config = this.config;\n      if (config.autoStartLoad) {\n        this.hls.startLoad(config.startPosition);\n      }\n    }\n  }, {\n    key: 'onLevelLoaded',\n    value: function onLevelLoaded(data) {\n      var newDetails = data.details,\n          newLevelId = data.level,\n          curLevel = this.levels[newLevelId],\n          duration = newDetails.totalduration,\n          sliding = 0;\n\n      _logger.logger.log('level ' + newLevelId + ' loaded [' + newDetails.startSN + ',' + newDetails.endSN + '],duration:' + duration);\n      this.levelLastLoaded = newLevelId;\n\n      if (newDetails.live) {\n        var curDetails = curLevel.details;\n        if (curDetails && newDetails.fragments.length > 0) {\n          // we already have details for that level, merge them\n          _levelHelper2.default.mergeDetails(curDetails, newDetails);\n          sliding = newDetails.fragments[0].start;\n          this.liveSyncPosition = this.computeLivePosition(sliding, curDetails);\n          if (newDetails.PTSKnown) {\n            _logger.logger.log('live playlist sliding:' + sliding.toFixed(3));\n          } else {\n            _logger.logger.log('live playlist - outdated PTS, unknown sliding');\n          }\n        } else {\n          newDetails.PTSKnown = false;\n          _logger.logger.log('live playlist - first load, unknown sliding');\n        }\n      } else {\n        newDetails.PTSKnown = false;\n      }\n      // override level info\n      curLevel.details = newDetails;\n      this.hls.trigger(_events2.default.LEVEL_UPDATED, { details: newDetails, level: newLevelId });\n\n      if (this.startFragRequested === false) {\n        // compute start position if set to -1. use it straight away if value is defined\n        if (this.startPosition === -1 || this.lastCurrentTime === -1) {\n          // first, check if start time offset has been set in playlist, if yes, use this value\n          var startTimeOffset = newDetails.startTimeOffset;\n          if (!isNaN(startTimeOffset)) {\n            if (startTimeOffset < 0) {\n              _logger.logger.log('negative start time offset ' + startTimeOffset + ', count from end of last fragment');\n              startTimeOffset = sliding + duration + startTimeOffset;\n            }\n            _logger.logger.log('start time offset found in playlist, adjust startPosition to ' + startTimeOffset);\n            this.startPosition = startTimeOffset;\n          } else {\n            // if live playlist, set start position to be fragment N-this.config.liveSyncDurationCount (usually 3)\n            if (newDetails.live) {\n              this.startPosition = this.computeLivePosition(sliding, newDetails);\n              _logger.logger.log('configure startPosition to ' + this.startPosition);\n            } else {\n              this.startPosition = 0;\n            }\n          }\n          this.lastCurrentTime = this.startPosition;\n        }\n        this.nextLoadPosition = this.startPosition;\n      }\n      // only switch batck to IDLE state if we were waiting for level to start downloading a new fragment\n      if (this.state === State.WAITING_LEVEL) {\n        this.state = State.IDLE;\n      }\n      //trigger handler right now\n      this.tick();\n    }\n  }, {\n    key: 'onKeyLoaded',\n    value: function onKeyLoaded() {\n      if (this.state === State.KEY_LOADING) {\n        this.state = State.IDLE;\n        this.tick();\n      }\n    }\n  }, {\n    key: 'onFragLoaded',\n    value: function onFragLoaded(data) {\n      var fragCurrent = this.fragCurrent,\n          fragLoaded = data.frag;\n      if (this.state === State.FRAG_LOADING && fragCurrent && fragLoaded.type === 'main' && fragLoaded.level === fragCurrent.level && fragLoaded.sn === fragCurrent.sn) {\n        var stats = data.stats,\n            currentLevel = this.levels[fragCurrent.level],\n            details = currentLevel.details;\n        _logger.logger.log('Loaded  ' + fragCurrent.sn + ' of [' + details.startSN + ' ,' + details.endSN + '],level ' + fragCurrent.level);\n        // reset frag bitrate test in any case after frag loaded event\n        this.bitrateTest = false;\n        this.stats = stats;\n        // if this frag was loaded to perform a bitrate test AND if hls.nextLoadLevel is greater than 0\n        // then this means that we should be able to load a fragment at a higher quality level\n        if (fragLoaded.bitrateTest === true && this.hls.nextLoadLevel) {\n          // switch back to IDLE state ... we just loaded a fragment to determine adequate start bitrate and initialize autoswitch algo\n          this.state = State.IDLE;\n          this.startFragRequested = false;\n          stats.tparsed = stats.tbuffered = performance.now();\n          this.hls.trigger(_events2.default.FRAG_BUFFERED, { stats: stats, frag: fragCurrent, id: 'main' });\n          this.tick();\n        } else if (fragLoaded.sn === 'initSegment') {\n          this.state = State.IDLE;\n          stats.tparsed = stats.tbuffered = performance.now();\n          details.initSegment.data = data.payload;\n          this.hls.trigger(_events2.default.FRAG_BUFFERED, { stats: stats, frag: fragCurrent, id: 'main' });\n          this.tick();\n        } else {\n          this.state = State.PARSING;\n          // transmux the MPEG-TS data to ISO-BMFF segments\n          var duration = details.totalduration,\n              level = fragCurrent.level,\n              sn = fragCurrent.sn,\n              audioCodec = this.config.defaultAudioCodec || currentLevel.audioCodec;\n          if (this.audioCodecSwap) {\n            _logger.logger.log('swapping playlist audio codec');\n            if (audioCodec === undefined) {\n              audioCodec = this.lastAudioCodec;\n            }\n            if (audioCodec) {\n              if (audioCodec.indexOf('mp4a.40.5') !== -1) {\n                audioCodec = 'mp4a.40.2';\n              } else {\n                audioCodec = 'mp4a.40.5';\n              }\n            }\n          }\n          this.pendingBuffering = true;\n          this.appended = false;\n          _logger.logger.log('Parsing ' + sn + ' of [' + details.startSN + ' ,' + details.endSN + '],level ' + level + ', cc ' + fragCurrent.cc);\n          var demuxer = this.demuxer;\n          if (!demuxer) {\n            demuxer = this.demuxer = new _demuxer2.default(this.hls, 'main');\n          }\n          // time Offset is accurate if level PTS is known, or if playlist is not sliding (not live) and if media is not seeking (this is to overcome potential timestamp drifts between playlists and fragments)\n          var media = this.media;\n          var mediaSeeking = media && media.seeking;\n          var accurateTimeOffset = !mediaSeeking && (details.PTSKnown || !details.live);\n          var initSegmentData = details.initSegment ? details.initSegment.data : [];\n          demuxer.push(data.payload, initSegmentData, audioCodec, currentLevel.videoCodec, fragCurrent, duration, accurateTimeOffset, undefined);\n        }\n      }\n      this.fragLoadError = 0;\n    }\n  }, {\n    key: 'onFragParsingInitSegment',\n    value: function onFragParsingInitSegment(data) {\n      var fragCurrent = this.fragCurrent;\n      var fragNew = data.frag;\n      if (fragCurrent && data.id === 'main' && fragNew.sn === fragCurrent.sn && fragNew.level === fragCurrent.level && this.state === State.PARSING) {\n        var tracks = data.tracks,\n            trackName,\n            track;\n\n        // if audio track is expected to come from audio stream controller, discard any coming from main\n        if (tracks.audio && this.altAudio) {\n          delete tracks.audio;\n        }\n        // include levelCodec in audio and video tracks\n        track = tracks.audio;\n        if (track) {\n          var audioCodec = this.levels[this.level].audioCodec,\n              ua = navigator.userAgent.toLowerCase();\n          if (audioCodec && this.audioCodecSwap) {\n            _logger.logger.log('swapping playlist audio codec');\n            if (audioCodec.indexOf('mp4a.40.5') !== -1) {\n              audioCodec = 'mp4a.40.2';\n            } else {\n              audioCodec = 'mp4a.40.5';\n            }\n          }\n          // in case AAC and HE-AAC audio codecs are signalled in manifest\n          // force HE-AAC , as it seems that most browsers prefers that way,\n          // except for mono streams OR on FF\n          // these conditions might need to be reviewed ...\n          if (this.audioCodecSwitch) {\n            // don't force HE-AAC if mono stream\n            if (track.metadata.channelCount !== 1 &&\n            // don't force HE-AAC if firefox\n            ua.indexOf('firefox') === -1) {\n              audioCodec = 'mp4a.40.5';\n            }\n          }\n          // HE-AAC is broken on Android, always signal audio codec as AAC even if variant manifest states otherwise\n          if (ua.indexOf('android') !== -1 && track.container !== 'audio/mpeg') {\n            // Exclude mpeg audio\n            audioCodec = 'mp4a.40.2';\n            _logger.logger.log('Android: force audio codec to ' + audioCodec);\n          }\n          track.levelCodec = audioCodec;\n          track.id = data.id;\n        }\n        track = tracks.video;\n        if (track) {\n          track.levelCodec = this.levels[this.level].videoCodec;\n          track.id = data.id;\n        }\n\n        // if remuxer specify that a unique track needs to generated,\n        // let's merge all tracks together\n        if (data.unique) {\n          var mergedTrack = {\n            codec: '',\n            levelCodec: ''\n          };\n          for (trackName in data.tracks) {\n            track = tracks[trackName];\n            mergedTrack.container = track.container;\n            if (mergedTrack.codec) {\n              mergedTrack.codec += ',';\n              mergedTrack.levelCodec += ',';\n            }\n            if (track.codec) {\n              mergedTrack.codec += track.codec;\n            }\n            if (track.levelCodec) {\n              mergedTrack.levelCodec += track.levelCodec;\n            }\n          }\n          tracks = { audiovideo: mergedTrack };\n        }\n        this.hls.trigger(_events2.default.BUFFER_CODECS, tracks);\n        // loop through tracks that are going to be provided to bufferController\n        for (trackName in tracks) {\n          track = tracks[trackName];\n          _logger.logger.log('main track:' + trackName + ',container:' + track.container + ',codecs[level/parsed]=[' + track.levelCodec + '/' + track.codec + ']');\n          var initSegment = track.initSegment;\n          if (initSegment) {\n            this.appended = true;\n            // arm pending Buffering flag before appending a segment\n            this.pendingBuffering = true;\n            this.hls.trigger(_events2.default.BUFFER_APPENDING, { type: trackName, data: initSegment, parent: 'main', content: 'initSegment' });\n          }\n        }\n        //trigger handler right now\n        this.tick();\n      }\n    }\n  }, {\n    key: 'onFragParsingData',\n    value: function onFragParsingData(data) {\n      var _this2 = this;\n\n      var fragCurrent = this.fragCurrent;\n      var fragNew = data.frag;\n      if (fragCurrent && data.id === 'main' && fragNew.sn === fragCurrent.sn && fragNew.level === fragCurrent.level && !(data.type === 'audio' && this.altAudio) && // filter out main audio if audio track is loaded through audio stream controller\n      this.state === State.PARSING) {\n        var level = this.levels[this.level],\n            frag = fragCurrent;\n        if (isNaN(data.endPTS)) {\n          data.endPTS = data.startPTS + fragCurrent.duration;\n          data.endDTS = data.startDTS + fragCurrent.duration;\n        }\n\n        _logger.logger.log('Parsed ' + data.type + ',PTS:[' + data.startPTS.toFixed(3) + ',' + data.endPTS.toFixed(3) + '],DTS:[' + data.startDTS.toFixed(3) + '/' + data.endDTS.toFixed(3) + '],nb:' + data.nb + ',dropped:' + (data.dropped || 0));\n\n        // Detect gaps in a fragment  and try to fix it by finding a keyframe in the previous fragment (see _findFragments)\n        if (data.type === 'video') {\n          frag.dropped = data.dropped;\n          if (frag.dropped) {\n            if (!frag.backtracked) {\n              // Return back to the IDLE state without appending to buffer\n              // Causes findFragments to backtrack a segment and find the keyframe\n              // Audio fragments arriving before video sets the nextLoadPosition, causing _findFragments to skip the backtracked fragment\n              frag.backtracked = true;\n              this.nextLoadPosition = data.startPTS;\n              this.state = State.IDLE;\n              this.tick();\n              return;\n            } else {\n              _logger.logger.warn('Already backtracked on this fragment, appending with the gap');\n            }\n          } else {\n            // Only reset the backtracked flag if we've loaded the frag without any dropped frames\n            frag.backtracked = false;\n          }\n        }\n\n        var drift = _levelHelper2.default.updateFragPTSDTS(level.details, frag.sn, data.startPTS, data.endPTS, data.startDTS, data.endDTS),\n            hls = this.hls;\n        hls.trigger(_events2.default.LEVEL_PTS_UPDATED, { details: level.details, level: this.level, drift: drift, type: data.type, start: data.startPTS, end: data.endPTS });\n\n        // has remuxer dropped video frames located before first keyframe ?\n        [data.data1, data.data2].forEach(function (buffer) {\n          // only append in PARSING state (rationale is that an appending error could happen synchronously on first segment appending)\n          // in that case it is useless to append following segments\n          if (buffer && buffer.length && _this2.state === State.PARSING) {\n            _this2.appended = true;\n            // arm pending Buffering flag before appending a segment\n            _this2.pendingBuffering = true;\n            hls.trigger(_events2.default.BUFFER_APPENDING, { type: data.type, data: buffer, parent: 'main', content: 'data' });\n          }\n        });\n        //trigger handler right now\n        this.tick();\n      }\n    }\n  }, {\n    key: 'onFragParsed',\n    value: function onFragParsed(data) {\n      var fragCurrent = this.fragCurrent;\n      var fragNew = data.frag;\n      if (fragCurrent && data.id === 'main' && fragNew.sn === fragCurrent.sn && fragNew.level === fragCurrent.level && this.state === State.PARSING) {\n        this.stats.tparsed = performance.now();\n        this.state = State.PARSED;\n        this._checkAppendedParsed();\n      }\n    }\n  }, {\n    key: 'onAudioTrackSwitching',\n    value: function onAudioTrackSwitching(data) {\n      // if any URL found on new audio track, it is an alternate audio track\n      var altAudio = !!data.url,\n          trackId = data.id;\n      // if we switch on main audio, ensure that main fragment scheduling is synced with media.buffered\n      // don't do anything if we switch to alt audio: audio stream controller is handling it.\n      // we will just have to change buffer scheduling on audioTrackSwitched\n      if (!altAudio) {\n        if (this.mediaBuffer !== this.media) {\n          _logger.logger.log('switching on main audio, use media.buffered to schedule main fragment loading');\n          this.mediaBuffer = this.media;\n          var fragCurrent = this.fragCurrent;\n          // we need to refill audio buffer from main: cancel any frag loading to speed up audio switch\n          if (fragCurrent.loader) {\n            _logger.logger.log('switching to main audio track, cancel main fragment load');\n            fragCurrent.loader.abort();\n          }\n          this.fragCurrent = null;\n          this.fragPrevious = null;\n          // destroy demuxer to force init segment generation (following audio switch)\n          if (this.demuxer) {\n            this.demuxer.destroy();\n            this.demuxer = null;\n          }\n          // switch to IDLE state to load new fragment\n          this.state = State.IDLE;\n        }\n        var hls = this.hls;\n        // switching to main audio, flush all audio and trigger track switched\n        hls.trigger(_events2.default.BUFFER_FLUSHING, { startOffset: 0, endOffset: Number.POSITIVE_INFINITY, type: 'audio' });\n        hls.trigger(_events2.default.AUDIO_TRACK_SWITCHED, { id: trackId });\n        this.altAudio = false;\n      }\n    }\n  }, {\n    key: 'onAudioTrackSwitched',\n    value: function onAudioTrackSwitched(data) {\n      var trackId = data.id,\n          altAudio = !!this.hls.audioTracks[trackId].url;\n      if (altAudio) {\n        var videoBuffer = this.videoBuffer;\n        // if we switched on alternate audio, ensure that main fragment scheduling is synced with video sourcebuffer buffered\n        if (videoBuffer && this.mediaBuffer !== videoBuffer) {\n          _logger.logger.log('switching on alternate audio, use video.buffered to schedule main fragment loading');\n          this.mediaBuffer = videoBuffer;\n        }\n      }\n      this.altAudio = altAudio;\n      this.tick();\n    }\n  }, {\n    key: 'onBufferCreated',\n    value: function onBufferCreated(data) {\n      var tracks = data.tracks,\n          mediaTrack = void 0,\n          name = void 0,\n          alternate = false;\n      for (var type in tracks) {\n        var track = tracks[type];\n        if (track.id === 'main') {\n          name = type;\n          mediaTrack = track;\n          // keep video source buffer reference\n          if (type === 'video') {\n            this.videoBuffer = tracks[type].buffer;\n          }\n        } else {\n          alternate = true;\n        }\n      }\n      if (alternate && mediaTrack) {\n        _logger.logger.log('alternate track found, use ' + name + '.buffered to schedule main fragment loading');\n        this.mediaBuffer = mediaTrack.buffer;\n      } else {\n        this.mediaBuffer = this.media;\n      }\n    }\n  }, {\n    key: 'onBufferAppended',\n    value: function onBufferAppended(data) {\n      if (data.parent === 'main') {\n        var state = this.state;\n        if (state === State.PARSING || state === State.PARSED) {\n          // check if all buffers have been appended\n          this.pendingBuffering = data.pending > 0;\n          this._checkAppendedParsed();\n        }\n      }\n    }\n  }, {\n    key: '_checkAppendedParsed',\n    value: function _checkAppendedParsed() {\n      var _this3 = this;\n\n      //trigger handler right now\n      if (this.state === State.PARSED && (!this.appended || !this.pendingBuffering)) {\n        var frag = this.fragCurrent;\n        if (frag) {\n          (function () {\n            var media = _this3.mediaBuffer ? _this3.mediaBuffer : _this3.media;\n            _logger.logger.log('main buffered : ' + _timeRanges2.default.toString(media.buffered));\n            // filter potentially evicted bufferRange. this is to avoid memleak on live streams\n            var bufferRange = _this3.bufferRange.filter(function (range) {\n              return _bufferHelper2.default.isBuffered(media, (range.start + range.end) / 2);\n            });\n            // push new range\n            bufferRange.push({ type: frag.type, start: frag.startPTS, end: frag.endPTS, frag: frag });\n            // sort, as we use BinarySearch for lookup in getBufferRange ...\n            _this3.bufferRange = bufferRange.sort(function (a, b) {\n              return a.start - b.start;\n            });\n            _this3.fragPrevious = frag;\n            var stats = _this3.stats;\n            stats.tbuffered = performance.now();\n            // we should get rid of this.fragLastKbps\n            _this3.fragLastKbps = Math.round(8 * stats.total / (stats.tbuffered - stats.tfirst));\n            _this3.hls.trigger(_events2.default.FRAG_BUFFERED, { stats: stats, frag: frag, id: 'main' });\n            _this3.state = State.IDLE;\n          })();\n        }\n        this.tick();\n      }\n    }\n  }, {\n    key: 'onError',\n    value: function onError(data) {\n      var frag = data.frag || this.fragCurrent;\n      // don't handle frag error not related to main fragment\n      if (frag && frag.type !== 'main') {\n        return;\n      }\n      var media = this.media,\n\n      // 0.5 : tolerance needed as some browsers stalls playback before reaching buffered end\n      mediaBuffered = media && _bufferHelper2.default.isBuffered(media, media.currentTime) && _bufferHelper2.default.isBuffered(media, media.currentTime + 0.5);\n      switch (data.details) {\n        case _errors.ErrorDetails.FRAG_LOAD_ERROR:\n        case _errors.ErrorDetails.FRAG_LOAD_TIMEOUT:\n        case _errors.ErrorDetails.KEY_LOAD_ERROR:\n        case _errors.ErrorDetails.KEY_LOAD_TIMEOUT:\n          if (!data.fatal) {\n            var loadError = this.fragLoadError;\n            if (loadError) {\n              loadError++;\n            } else {\n              loadError = 1;\n            }\n            var config = this.config;\n            // keep retrying / don't raise fatal network error if current position is buffered or if in automode with current level not 0\n            if (loadError <= config.fragLoadingMaxRetry || mediaBuffered || frag.autoLevel && frag.level) {\n              this.fragLoadError = loadError;\n              // reset load counter to avoid frag loop loading error\n              frag.loadCounter = 0;\n              // exponential backoff capped to config.fragLoadingMaxRetryTimeout\n              var delay = Math.min(Math.pow(2, loadError - 1) * config.fragLoadingRetryDelay, config.fragLoadingMaxRetryTimeout);\n              _logger.logger.warn('mediaController: frag loading failed, retry in ' + delay + ' ms');\n              this.retryDate = performance.now() + delay;\n              // retry loading state\n              // if loadedmetadata is not set, it means that we are emergency switch down on first frag\n              // in that case, reset startFragRequested flag\n              if (!this.loadedmetadata) {\n                this.startFragRequested = false;\n                this.nextLoadPosition = this.startPosition;\n              }\n              this.state = State.FRAG_LOADING_WAITING_RETRY;\n            } else {\n              _logger.logger.error('mediaController: ' + data.details + ' reaches max retry, redispatch as fatal ...');\n              // redispatch same error but with fatal set to true\n              data.fatal = true;\n              this.hls.trigger(_events2.default.ERROR, data);\n              this.state = State.ERROR;\n            }\n          }\n          break;\n        case _errors.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n          if (!data.fatal) {\n            // if buffer is not empty\n            if (mediaBuffered) {\n              // try to reduce max buffer length : rationale is that we could get\n              // frag loop loading error because of buffer eviction\n              this._reduceMaxBufferLength(frag.duration);\n              this.state = State.IDLE;\n            } else {\n              // buffer empty. report as fatal if in manual mode or if lowest level.\n              // level controller takes care of emergency switch down logic\n              if (!frag.autoLevel || frag.level === 0) {\n                // redispatch same error but with fatal set to true\n                data.fatal = true;\n                this.hls.trigger(_events2.default.ERROR, data);\n                this.state = State.ERROR;\n              }\n            }\n          }\n          break;\n        case _errors.ErrorDetails.LEVEL_LOAD_ERROR:\n        case _errors.ErrorDetails.LEVEL_LOAD_TIMEOUT:\n          if (this.state !== State.ERROR) {\n            if (data.fatal) {\n              // if fatal error, stop processing\n              this.state = State.ERROR;\n              _logger.logger.warn('streamController: ' + data.details + ',switch to ' + this.state + ' state ...');\n            } else {\n              // in cas of non fatal error while waiting level load to be completed, switch back to IDLE\n              if (this.state === State.WAITING_LEVEL) {\n                this.state = State.IDLE;\n              }\n            }\n          }\n          break;\n        case _errors.ErrorDetails.BUFFER_FULL_ERROR:\n          // if in appending state\n          if (data.parent === 'main' && (this.state === State.PARSING || this.state === State.PARSED)) {\n            // reduce max buf len if current position is buffered\n            if (mediaBuffered) {\n              this._reduceMaxBufferLength(this.config.maxBufferLength);\n              this.state = State.IDLE;\n            } else {\n              // current position is not buffered, but browser is still complaining about buffer full error\n              // this happens on IE/Edge, refer to https://github.com/dailymotion/hls.js/pull/708\n              // in that case flush the whole buffer to recover\n              _logger.logger.warn('buffer full error also media.currentTime is not buffered, flush everything');\n              this.fragCurrent = null;\n              // flush everything\n              this.flushMainBuffer(0, Number.POSITIVE_INFINITY);\n            }\n          }\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: '_reduceMaxBufferLength',\n    value: function _reduceMaxBufferLength(minLength) {\n      var config = this.config;\n      if (config.maxMaxBufferLength >= minLength) {\n        // reduce max buffer length as it might be too high. we do this to avoid loop flushing ...\n        config.maxMaxBufferLength /= 2;\n        _logger.logger.warn('main:reduce max buffer length to ' + config.maxMaxBufferLength + 's');\n        // increase fragment load Index to avoid frag loop loading error after buffer flush\n        this.fragLoadIdx += 2 * config.fragLoadingLoopThreshold;\n      }\n    }\n  }, {\n    key: '_checkBuffer',\n    value: function _checkBuffer() {\n      var media = this.media;\n      // if ready state different from HAVE_NOTHING (numeric value 0), we are allowed to seek\n      if (media && media.readyState) {\n        var currentTime = media.currentTime,\n            mediaBuffer = this.mediaBuffer ? this.mediaBuffer : media,\n            buffered = mediaBuffer.buffered;\n        // adjust currentTime to start position on loaded metadata\n        if (!this.loadedmetadata && buffered.length && !media.seeking) {\n          this.loadedmetadata = true;\n          // only adjust currentTime if different from startPosition or if startPosition not buffered\n          // at that stage, there should be only one buffered range, as we reach that code after first fragment has been buffered\n          var startPosition = this.startPosition,\n              startPositionBuffered = _bufferHelper2.default.isBuffered(mediaBuffer, startPosition);\n          // if currentTime not matching with expected startPosition or startPosition not buffered\n          if (currentTime !== startPosition || !startPositionBuffered) {\n            _logger.logger.log('target start position:' + startPosition);\n            // if startPosition not buffered, let's seek to buffered.start(0)\n            if (!startPositionBuffered) {\n              startPosition = buffered.start(0);\n              _logger.logger.log('target start position not buffered, seek to buffered.start(0) ' + startPosition);\n            }\n            _logger.logger.log('adjust currentTime from ' + currentTime + ' to ' + startPosition);\n            media.currentTime = startPosition;\n          }\n        } else if (this.immediateSwitch) {\n          this.immediateLevelSwitchEnd();\n        } else {\n          var bufferInfo = _bufferHelper2.default.bufferInfo(media, currentTime, 0),\n              expectedPlaying = !(media.paused || // not playing when media is paused\n          media.ended || // not playing when media is ended\n          media.buffered.length === 0),\n              // not playing if nothing buffered\n          jumpThreshold = 0.5,\n              // tolerance needed as some browsers stalls playback before reaching buffered range end\n          playheadMoving = currentTime !== this.lastCurrentTime,\n              config = this.config;\n\n          if (playheadMoving) {\n            // played moving, but was previously stalled => now not stuck anymore\n            if (this.stallReported) {\n              _logger.logger.warn('playback not stuck anymore @' + currentTime + ', after ' + Math.round(performance.now() - this.stalled) + 'ms');\n              this.stallReported = false;\n            }\n            this.stalled = undefined;\n            this.nudgeRetry = 0;\n          } else {\n            // playhead not moving\n            if (expectedPlaying) {\n              // playhead not moving BUT media expected to play\n              var tnow = performance.now();\n              var hls = this.hls;\n              if (!this.stalled) {\n                // stall just detected, store current time\n                this.stalled = tnow;\n                this.stallReported = false;\n              } else {\n                // playback already stalled, check stalling duration\n                // if stalling for more than a given threshold, let's try to recover\n                var stalledDuration = tnow - this.stalled;\n                var bufferLen = bufferInfo.len;\n                var nudgeRetry = this.nudgeRetry || 0;\n                // have we reached stall deadline ?\n                if (bufferLen <= jumpThreshold && stalledDuration > config.lowBufferWatchdogPeriod * 1000) {\n                  // report stalled error once\n                  if (!this.stallReported) {\n                    this.stallReported = true;\n                    _logger.logger.warn('playback stalling in low buffer @' + currentTime);\n                    hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_STALLED_ERROR, fatal: false, buffer: bufferLen });\n                  }\n                  // if buffer len is below threshold, try to jump to start of next buffer range if close\n                  // no buffer available @ currentTime, check if next buffer is close (within a config.maxSeekHole second range)\n                  var nextBufferStart = bufferInfo.nextStart,\n                      delta = nextBufferStart - currentTime;\n                  if (nextBufferStart && delta < config.maxSeekHole && delta > 0) {\n                    this.nudgeRetry = ++nudgeRetry;\n                    var nudgeOffset = nudgeRetry * config.nudgeOffset;\n                    // next buffer is close ! adjust currentTime to nextBufferStart\n                    // this will ensure effective video decoding\n                    _logger.logger.log('adjust currentTime from ' + media.currentTime + ' to next buffered @ ' + nextBufferStart + ' + nudge ' + nudgeOffset);\n                    media.currentTime = nextBufferStart + nudgeOffset;\n                    // reset stalled so to rearm watchdog timer\n                    this.stalled = undefined;\n                    hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_SEEK_OVER_HOLE, fatal: false, hole: nextBufferStart + nudgeOffset - currentTime });\n                  }\n                } else if (bufferLen > jumpThreshold && stalledDuration > config.highBufferWatchdogPeriod * 1000) {\n                  // report stalled error once\n                  if (!this.stallReported) {\n                    this.stallReported = true;\n                    _logger.logger.warn('playback stalling in high buffer @' + currentTime);\n                    hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_STALLED_ERROR, fatal: false, buffer: bufferLen });\n                  }\n                  // reset stalled so to rearm watchdog timer\n                  this.stalled = undefined;\n                  this.nudgeRetry = ++nudgeRetry;\n                  if (nudgeRetry < config.nudgeMaxRetry) {\n                    var _currentTime = media.currentTime;\n                    var targetTime = _currentTime + nudgeRetry * config.nudgeOffset;\n                    _logger.logger.log('adjust currentTime from ' + _currentTime + ' to ' + targetTime);\n                    // playback stalled in buffered area ... let's nudge currentTime to try to overcome this\n                    media.currentTime = targetTime;\n                    hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_NUDGE_ON_STALL, fatal: false });\n                  } else {\n                    _logger.logger.error('still stuck in high buffer @' + currentTime + ' after ' + config.nudgeMaxRetry + ', raise fatal error');\n                    hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.BUFFER_STALLED_ERROR, fatal: true });\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: 'onFragLoadEmergencyAborted',\n    value: function onFragLoadEmergencyAborted() {\n      this.state = State.IDLE;\n      // if loadedmetadata is not set, it means that we are emergency switch down on first frag\n      // in that case, reset startFragRequested flag\n      if (!this.loadedmetadata) {\n        this.startFragRequested = false;\n        this.nextLoadPosition = this.startPosition;\n      }\n      this.tick();\n    }\n  }, {\n    key: 'onBufferFlushed',\n    value: function onBufferFlushed() {\n      /* after successful buffer flushing, filter flushed fragments from bufferRange\n        use mediaBuffered instead of media (so that we will check against video.buffered ranges in case of alt audio track)\n      */\n      var media = this.mediaBuffer ? this.mediaBuffer : this.media;\n      this.bufferRange = this.bufferRange.filter(function (range) {\n        return _bufferHelper2.default.isBuffered(media, (range.start + range.end) / 2);\n      });\n\n      // increase fragment load Index to avoid frag loop loading error after buffer flush\n      this.fragLoadIdx += 2 * this.config.fragLoadingLoopThreshold;\n      // move to IDLE once flush complete. this should trigger new fragment loading\n      this.state = State.IDLE;\n      // reset reference to frag\n      this.fragPrevious = null;\n    }\n  }, {\n    key: 'swapAudioCodec',\n    value: function swapAudioCodec() {\n      this.audioCodecSwap = !this.audioCodecSwap;\n    }\n  }, {\n    key: 'computeLivePosition',\n    value: function computeLivePosition(sliding, levelDetails) {\n      var targetLatency = this.config.liveSyncDuration !== undefined ? this.config.liveSyncDuration : this.config.liveSyncDurationCount * levelDetails.targetduration;\n      return sliding + Math.max(0, levelDetails.totalduration - targetLatency);\n    }\n  }, {\n    key: 'state',\n    set: function set(nextState) {\n      if (this.state !== nextState) {\n        var previousState = this.state;\n        this._state = nextState;\n        _logger.logger.log('main stream:' + previousState + '->' + nextState);\n        this.hls.trigger(_events2.default.STREAM_STATE_TRANSITION, { previousState: previousState, nextState: nextState });\n      }\n    },\n    get: function get() {\n      return this._state;\n    }\n  }, {\n    key: 'currentLevel',\n    get: function get() {\n      var media = this.media;\n      if (media) {\n        var range = this.getBufferRange(media.currentTime);\n        if (range) {\n          return range.frag.level;\n        }\n      }\n      return -1;\n    }\n  }, {\n    key: 'nextBufferRange',\n    get: function get() {\n      var media = this.media;\n      if (media) {\n        // first get end range of current fragment\n        return this.followingBufferRange(this.getBufferRange(media.currentTime));\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: 'nextLevel',\n    get: function get() {\n      var range = this.nextBufferRange;\n      if (range) {\n        return range.frag.level;\n      } else {\n        return -1;\n      }\n    }\n  }, {\n    key: 'liveSyncPosition',\n    get: function get() {\n      return this._liveSyncPosition;\n    },\n    set: function set(value) {\n      this._liveSyncPosition = value;\n    }\n  }]);\n\n  return StreamController;\n}(_eventHandler2.default);\n\nexports.default = StreamController;\n\n},{\"25\":25,\"31\":31,\"32\":32,\"33\":33,\"35\":35,\"36\":36,\"46\":46,\"50\":50,\"51\":51}],14:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Subtitle Stream Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar SubtitleStreamController = function (_EventHandler) {\n  _inherits(SubtitleStreamController, _EventHandler);\n\n  function SubtitleStreamController(hls) {\n    _classCallCheck(this, SubtitleStreamController);\n\n    var _this = _possibleConstructorReturn(this, (SubtitleStreamController.__proto__ || Object.getPrototypeOf(SubtitleStreamController)).call(this, hls, _events2.default.ERROR, _events2.default.SUBTITLE_TRACKS_UPDATED, _events2.default.SUBTITLE_TRACK_SWITCH, _events2.default.SUBTITLE_TRACK_LOADED, _events2.default.SUBTITLE_FRAG_PROCESSED));\n\n    _this.config = hls.config;\n    _this.vttFragSNsProcessed = {};\n    _this.vttFragQueues = undefined;\n    _this.currentlyProcessing = null;\n    _this.currentTrackId = -1;\n    return _this;\n  }\n\n  _createClass(SubtitleStreamController, [{\n    key: 'destroy',\n    value: function destroy() {\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n\n    // Remove all queued items and create a new, empty queue for each track.\n\n  }, {\n    key: 'clearVttFragQueues',\n    value: function clearVttFragQueues() {\n      var _this2 = this;\n\n      this.vttFragQueues = {};\n      this.tracks.forEach(function (track) {\n        _this2.vttFragQueues[track.id] = [];\n      });\n    }\n\n    // If no frag is being processed and queue isn't empty, initiate processing of next frag in line.\n\n  }, {\n    key: 'nextFrag',\n    value: function nextFrag() {\n      if (this.currentlyProcessing === null && this.currentTrackId > -1 && this.vttFragQueues[this.currentTrackId].length) {\n        var frag = this.currentlyProcessing = this.vttFragQueues[this.currentTrackId].shift();\n        this.hls.trigger(_events2.default.FRAG_LOADING, { frag: frag });\n      }\n    }\n\n    // When fragment has finished processing, add sn to list of completed if successful.\n\n  }, {\n    key: 'onSubtitleFragProcessed',\n    value: function onSubtitleFragProcessed(data) {\n      if (data.success) {\n        this.vttFragSNsProcessed[data.frag.trackId].push(data.frag.sn);\n      }\n      this.currentlyProcessing = null;\n      this.nextFrag();\n    }\n\n    // If something goes wrong, procede to next frag, if we were processing one.\n\n  }, {\n    key: 'onError',\n    value: function onError(data) {\n      var frag = data.frag;\n      // don't handle frag error not related to subtitle fragment\n      if (frag && frag.type !== 'subtitle') {\n        return;\n      }\n      if (this.currentlyProcessing) {\n        this.currentlyProcessing = null;\n        this.nextFrag();\n      }\n    }\n\n    // Got all new subtitle tracks.\n\n  }, {\n    key: 'onSubtitleTracksUpdated',\n    value: function onSubtitleTracksUpdated(data) {\n      var _this3 = this;\n\n      _logger.logger.log('subtitle tracks updated');\n      this.tracks = data.subtitleTracks;\n      this.clearVttFragQueues();\n      this.vttFragSNsProcessed = {};\n      this.tracks.forEach(function (track) {\n        _this3.vttFragSNsProcessed[track.id] = [];\n      });\n    }\n  }, {\n    key: 'onSubtitleTrackSwitch',\n    value: function onSubtitleTrackSwitch(data) {\n      this.currentTrackId = data.id;\n      this.clearVttFragQueues();\n    }\n\n    // Got a new set of subtitle fragments.\n\n  }, {\n    key: 'onSubtitleTrackLoaded',\n    value: function onSubtitleTrackLoaded(data) {\n      var processedFragSNs = this.vttFragSNsProcessed[data.id],\n          fragQueue = this.vttFragQueues[data.id],\n          currentFragSN = !!this.currentlyProcessing ? this.currentlyProcessing.sn : -1;\n\n      var alreadyProcessed = function alreadyProcessed(frag) {\n        return processedFragSNs.indexOf(frag.sn) > -1;\n      };\n\n      var alreadyInQueue = function alreadyInQueue(frag) {\n        return fragQueue.some(function (fragInQueue) {\n          return fragInQueue.sn === frag.sn;\n        });\n      };\n\n      // Add all fragments that haven't been, aren't currently being and aren't waiting to be processed, to queue.\n      data.details.fragments.forEach(function (frag) {\n        if (!(alreadyProcessed(frag) || frag.sn === currentFragSN || alreadyInQueue(frag))) {\n          // Frags don't know their subtitle track ID, so let's just add that...\n          frag.trackId = data.id;\n          fragQueue.push(frag);\n        }\n      });\n\n      this.nextFrag();\n    }\n  }]);\n\n  return SubtitleStreamController;\n}(_eventHandler2.default);\n\nexports.default = SubtitleStreamController;\n\n},{\"32\":32,\"33\":33,\"50\":50}],15:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * audio track controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar SubtitleTrackController = function (_EventHandler) {\n  _inherits(SubtitleTrackController, _EventHandler);\n\n  function SubtitleTrackController(hls) {\n    _classCallCheck(this, SubtitleTrackController);\n\n    var _this = _possibleConstructorReturn(this, (SubtitleTrackController.__proto__ || Object.getPrototypeOf(SubtitleTrackController)).call(this, hls, _events2.default.MEDIA_ATTACHED, _events2.default.MEDIA_DETACHING, _events2.default.MANIFEST_LOADING, _events2.default.MANIFEST_LOADED, _events2.default.SUBTITLE_TRACK_LOADED));\n\n    _this.tracks = [];\n    _this.trackId = -1;\n    _this.media = undefined;\n    return _this;\n  }\n\n  _createClass(SubtitleTrackController, [{\n    key: 'destroy',\n    value: function destroy() {\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n\n    // Listen for subtitle track change, then extract the current track ID.\n\n  }, {\n    key: 'onMediaAttached',\n    value: function onMediaAttached(data) {\n      var _this2 = this;\n\n      this.media = data.media;\n      if (!this.media) {\n        return;\n      }\n\n      this.media.textTracks.addEventListener('change', function () {\n        // Media is undefined when switching streams via loadSource()\n        if (!_this2.media) {\n          return;\n        }\n\n        var trackId = -1;\n        var tracks = _this2.media.textTracks;\n        for (var id = 0; id < tracks.length; id++) {\n          if (tracks[id].mode === 'showing') {\n            trackId = id;\n          }\n        }\n        // Setting current subtitleTrack will invoke code.\n        _this2.subtitleTrack = trackId;\n      });\n    }\n  }, {\n    key: 'onMediaDetaching',\n    value: function onMediaDetaching() {\n      // TODO: Remove event listeners.\n      this.media = undefined;\n    }\n\n    // Reset subtitle tracks on manifest loading\n\n  }, {\n    key: 'onManifestLoading',\n    value: function onManifestLoading() {\n      this.tracks = [];\n      this.trackId = -1;\n    }\n\n    // Fired whenever a new manifest is loaded.\n\n  }, {\n    key: 'onManifestLoaded',\n    value: function onManifestLoaded(data) {\n      var _this3 = this;\n\n      var tracks = data.subtitles || [];\n      var defaultFound = false;\n      this.tracks = tracks;\n      this.trackId = -1;\n      this.hls.trigger(_events2.default.SUBTITLE_TRACKS_UPDATED, { subtitleTracks: tracks });\n\n      // loop through available subtitle tracks and autoselect default if needed\n      // TODO: improve selection logic to handle forced, etc\n      tracks.forEach(function (track) {\n        if (track.default) {\n          _this3.subtitleTrack = track.id;\n          defaultFound = true;\n        }\n      });\n    }\n\n    // Trigger subtitle track playlist reload.\n\n  }, {\n    key: 'onTick',\n    value: function onTick() {\n      var trackId = this.trackId;\n      var subtitleTrack = this.tracks[trackId];\n      if (!subtitleTrack) {\n        return;\n      }\n\n      var details = subtitleTrack.details;\n      // check if we need to load playlist for this subtitle Track\n      if (details === undefined || details.live === true) {\n        // track not retrieved yet, or live playlist we need to (re)load it\n        _logger.logger.log('(re)loading playlist for subtitle track ' + trackId);\n        this.hls.trigger(_events2.default.SUBTITLE_TRACK_LOADING, { url: subtitleTrack.url, id: trackId });\n      }\n    }\n  }, {\n    key: 'onSubtitleTrackLoaded',\n    value: function onSubtitleTrackLoaded(data) {\n      var _this4 = this;\n\n      if (data.id < this.tracks.length) {\n        _logger.logger.log('subtitle track ' + data.id + ' loaded');\n        this.tracks[data.id].details = data.details;\n        // check if current playlist is a live playlist\n        if (data.details.live && !this.timer) {\n          // if live playlist we will have to reload it periodically\n          // set reload period to playlist target duration\n          this.timer = setInterval(function () {\n            _this4.onTick();\n          }, 1000 * data.details.targetduration, this);\n        }\n        if (!data.details.live && this.timer) {\n          // playlist is not live and timer is armed : stopping it\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n      }\n    }\n\n    /** get alternate subtitle tracks list from playlist **/\n\n  }, {\n    key: 'setSubtitleTrackInternal',\n    value: function setSubtitleTrackInternal(newId) {\n      // check if level idx is valid\n      if (newId >= 0 && newId < this.tracks.length) {\n        // stopping live reloading timer if any\n        if (this.timer) {\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n        this.trackId = newId;\n        _logger.logger.log('switching to subtitle track ' + newId);\n        var subtitleTrack = this.tracks[newId];\n        this.hls.trigger(_events2.default.SUBTITLE_TRACK_SWITCH, { id: newId });\n        // check if we need to load playlist for this subtitle Track\n        var details = subtitleTrack.details;\n        if (details === undefined || details.live === true) {\n          // track not retrieved yet, or live playlist we need to (re)load it\n          _logger.logger.log('(re)loading playlist for subtitle track ' + newId);\n          this.hls.trigger(_events2.default.SUBTITLE_TRACK_LOADING, { url: subtitleTrack.url, id: newId });\n        }\n      }\n    }\n  }, {\n    key: 'subtitleTracks',\n    get: function get() {\n      return this.tracks;\n    }\n\n    /** get index of the selected subtitle track (index in subtitle track lists) **/\n\n  }, {\n    key: 'subtitleTrack',\n    get: function get() {\n      return this.trackId;\n    }\n\n    /** select a subtitle track, based on its index in subtitle track lists**/\n    ,\n    set: function set(subtitleTrackId) {\n      if (this.trackId !== subtitleTrackId) {\n        // || this.tracks[subtitleTrackId].details === undefined) {\n        this.setSubtitleTrackInternal(subtitleTrackId);\n      }\n    }\n  }]);\n\n  return SubtitleTrackController;\n}(_eventHandler2.default);\n\nexports.default = SubtitleTrackController;\n\n},{\"32\":32,\"33\":33,\"50\":50}],16:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _cea608Parser = _dereq_(47);\n\nvar _cea608Parser2 = _interopRequireDefault(_cea608Parser);\n\nvar _webvttParser = _dereq_(54);\n\nvar _webvttParser2 = _interopRequireDefault(_webvttParser);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Timeline Controller\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nfunction clearCurrentCues(track) {\n  if (track && track.cues) {\n    while (track.cues.length > 0) {\n      track.removeCue(track.cues[0]);\n    }\n  }\n}\n\nfunction reuseVttTextTrack(inUseTrack, manifestTrack) {\n  return inUseTrack && inUseTrack.label === manifestTrack.name && !(inUseTrack.textTrack1 || inUseTrack.textTrack2);\n}\n\nfunction intersection(x1, x2, y1, y2) {\n  return Math.min(x2, y2) - Math.max(x1, y1);\n}\n\nvar TimelineController = function (_EventHandler) {\n  _inherits(TimelineController, _EventHandler);\n\n  function TimelineController(hls) {\n    _classCallCheck(this, TimelineController);\n\n    var _this = _possibleConstructorReturn(this, (TimelineController.__proto__ || Object.getPrototypeOf(TimelineController)).call(this, hls, _events2.default.MEDIA_ATTACHING, _events2.default.MEDIA_DETACHING, _events2.default.FRAG_PARSING_USERDATA, _events2.default.MANIFEST_LOADING, _events2.default.MANIFEST_LOADED, _events2.default.FRAG_LOADED, _events2.default.LEVEL_SWITCHING, _events2.default.INIT_PTS_FOUND));\n\n    _this.hls = hls;\n    _this.config = hls.config;\n    _this.enabled = true;\n    _this.Cues = hls.config.cueHandler;\n    _this.textTracks = [];\n    _this.tracks = [];\n    _this.unparsedVttFrags = [];\n    _this.initPTS = undefined;\n    _this.cueRanges = [];\n\n    if (_this.config.enableCEA708Captions) {\n      var self = _this;\n      var sendAddTrackEvent = function sendAddTrackEvent(track, media) {\n        var e = null;\n        try {\n          e = new window.Event('addtrack');\n        } catch (err) {\n          //for IE11\n          e = document.createEvent('Event');\n          e.initEvent('addtrack', false, false);\n        }\n        e.track = track;\n        media.dispatchEvent(e);\n      };\n\n      var channel1 = {\n        'newCue': function newCue(startTime, endTime, screen) {\n          if (!self.textTrack1) {\n            //Enable reuse of existing text track.\n            var existingTrack1 = self.getExistingTrack('1');\n            if (!existingTrack1) {\n              self.textTrack1 = self.createTextTrack('captions', 'English', 'en');\n              self.textTrack1.textTrack1 = true;\n            } else {\n              self.textTrack1 = existingTrack1;\n              self.clearCurrentCues(self.textTrack1);\n\n              sendAddTrackEvent(self.textTrack1, self.media);\n            }\n          }\n          self.addCues('textTrack1', startTime, endTime, screen);\n        }\n      };\n\n      var channel2 = {\n        'newCue': function newCue(startTime, endTime, screen) {\n          if (!self.textTrack2) {\n            //Enable reuse of existing text track.\n            var existingTrack2 = self.getExistingTrack('2');\n            if (!existingTrack2) {\n              self.textTrack2 = self.createTextTrack('captions', 'Spanish', 'es');\n              self.textTrack2.textTrack2 = true;\n            } else {\n              self.textTrack2 = existingTrack2;\n\n              sendAddTrackEvent(self.textTrack2, self.media);\n            }\n          }\n          self.addCues('textTrack2', startTime, endTime, screen);\n        }\n      };\n\n      _this.cea608Parser = new _cea608Parser2.default(0, channel1, channel2);\n    }\n    return _this;\n  }\n\n  _createClass(TimelineController, [{\n    key: 'addCues',\n    value: function addCues(channel, startTime, endTime, screen) {\n      // skip cues which overlap more than 50% with previously parsed time ranges\n      var ranges = this.cueRanges;\n      var merged = false;\n      for (var i = ranges.length; i--;) {\n        var cueRange = ranges[i];\n        var overlap = intersection(cueRange[0], cueRange[1], startTime, endTime);\n        if (overlap >= 0) {\n          cueRange[0] = Math.min(cueRange[0], startTime);\n          cueRange[1] = Math.max(cueRange[1], endTime);\n          merged = true;\n          if (overlap / (endTime - startTime) > 0.5) {\n            return;\n          }\n        }\n      }\n      if (!merged) {\n        ranges.push([startTime, endTime]);\n      }\n      this.Cues.newCue(this[channel], startTime, endTime, screen);\n    }\n\n    // Triggered when an initial PTS is found; used for synchronisation of WebVTT.\n\n  }, {\n    key: 'onInitPtsFound',\n    value: function onInitPtsFound(data) {\n      var _this2 = this;\n\n      if (typeof this.initPTS === 'undefined') {\n        this.initPTS = data.initPTS;\n      }\n\n      // Due to asynchrony, initial PTS may arrive later than the first VTT fragments are loaded.\n      // Parse any unparsed fragments upon receiving the initial PTS.\n      if (this.unparsedVttFrags.length) {\n        this.unparsedVttFrags.forEach(function (frag) {\n          _this2.onFragLoaded(frag);\n        });\n        this.unparsedVttFrags = [];\n      }\n    }\n  }, {\n    key: 'getExistingTrack',\n    value: function getExistingTrack(channelNumber) {\n      var media = this.media;\n      if (media) {\n        for (var i = 0; i < media.textTracks.length; i++) {\n          var textTrack = media.textTracks[i];\n          var propName = 'textTrack' + channelNumber;\n          if (textTrack[propName] === true) {\n            return textTrack;\n          }\n        }\n      }\n      return null;\n    }\n  }, {\n    key: 'createTextTrack',\n    value: function createTextTrack(kind, label, lang) {\n      if (this.media) {\n        return this.media.addTextTrack(kind, label, lang);\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'onMediaAttaching',\n    value: function onMediaAttaching(data) {\n      this.media = data.media;\n    }\n  }, {\n    key: 'onMediaDetaching',\n    value: function onMediaDetaching() {\n      clearCurrentCues(this.textTrack1);\n      clearCurrentCues(this.textTrack2);\n    }\n  }, {\n    key: 'onManifestLoading',\n    value: function onManifestLoading() {\n      this.lastSn = -1; // Detect discontiguity in fragment parsing\n      this.prevCC = -1;\n      this.vttCCs = { ccOffset: 0, presentationOffset: 0 }; // Detect discontinuity in subtitle manifests\n    }\n  }, {\n    key: 'onManifestLoaded',\n    value: function onManifestLoaded(data) {\n      var _this3 = this;\n\n      this.textTracks = [];\n      this.unparsedVttFrags = this.unparsedVttFrags || [];\n      this.initPTS = undefined;\n      this.cueRanges = [];\n\n      if (this.config.enableWebVTT) {\n        (function () {\n          _this3.tracks = data.subtitles || [];\n          var inUseTracks = _this3.media ? _this3.media.textTracks : [];\n\n          _this3.tracks.forEach(function (track, index) {\n            var textTrack = void 0;\n            var inUseTrack = inUseTracks[index];\n            // Reuse tracks with the same label, but do not reuse 608/708 tracks\n            if (reuseVttTextTrack(inUseTrack, track)) {\n              textTrack = inUseTrack;\n            } else {\n              textTrack = _this3.createTextTrack('subtitles', track.name, track.lang);\n            }\n            textTrack.mode = track.default ? 'showing' : 'hidden';\n            _this3.textTracks.push(textTrack);\n          });\n        })();\n      }\n    }\n  }, {\n    key: 'onLevelSwitching',\n    value: function onLevelSwitching() {\n      this.enabled = this.hls.currentLevel.closedCaptions !== 'NONE';\n    }\n  }, {\n    key: 'onFragLoaded',\n    value: function onFragLoaded(data) {\n      var _this4 = this;\n\n      var frag = data.frag,\n          payload = data.payload;\n      if (frag.type === 'main') {\n        var sn = frag.sn;\n        // if this frag isn't contiguous, clear the parser so cues with bad start/end times aren't added to the textTrack\n        if (sn !== this.lastSn + 1) {\n          this.cea608Parser.reset();\n        }\n        this.lastSn = sn;\n      }\n      // If fragment is subtitle type, parse as WebVTT.\n      else if (frag.type === 'subtitle') {\n          if (payload.byteLength) {\n            var _ret2 = function () {\n              // We need an initial synchronisation PTS. Store fragments as long as none has arrived.\n              if (typeof _this4.initPTS === 'undefined') {\n                _this4.unparsedVttFrags.push(data);\n                return {\n                  v: void 0\n                };\n              }\n              var vttCCs = _this4.vttCCs;\n              if (!vttCCs[frag.cc]) {\n                vttCCs[frag.cc] = { start: frag.start, prevCC: _this4.prevCC, new: true };\n                _this4.prevCC = frag.cc;\n              }\n              var textTracks = _this4.textTracks,\n                  hls = _this4.hls;\n\n              // Parse the WebVTT file contents.\n              _webvttParser2.default.parse(payload, _this4.initPTS, vttCCs, frag.cc, function (cues) {\n                // Add cues and trigger event with success true.\n                cues.forEach(function (cue) {\n                  textTracks[frag.trackId].addCue(cue);\n                });\n                hls.trigger(_events2.default.SUBTITLE_FRAG_PROCESSED, { success: true, frag: frag });\n              }, function (e) {\n                // Something went wrong while parsing. Trigger event with success false.\n                _logger.logger.log('Failed to parse VTT cue: ' + e);\n                hls.trigger(_events2.default.SUBTITLE_FRAG_PROCESSED, { success: false, frag: frag });\n              });\n            }();\n\n            if ((typeof _ret2 === 'undefined' ? 'undefined' : _typeof(_ret2)) === \"object\") return _ret2.v;\n          } else {\n            // In case there is no payload, finish unsuccessfully.\n            this.hls.trigger(_events2.default.SUBTITLE_FRAG_PROCESSED, { success: false, frag: frag });\n          }\n        }\n    }\n  }, {\n    key: 'onFragParsingUserdata',\n    value: function onFragParsingUserdata(data) {\n      // push all of the CEA-708 messages into the interpreter\n      // immediately. It will create the proper timestamps based on our PTS value\n      if (this.enabled && this.config.enableCEA708Captions) {\n        for (var i = 0; i < data.samples.length; i++) {\n          var ccdatas = this.extractCea608Data(data.samples[i].bytes);\n          this.cea608Parser.addData(data.samples[i].pts, ccdatas);\n        }\n      }\n    }\n  }, {\n    key: 'extractCea608Data',\n    value: function extractCea608Data(byteArray) {\n      var count = byteArray[0] & 31;\n      var position = 2;\n      var tmpByte, ccbyte1, ccbyte2, ccValid, ccType;\n      var actualCCBytes = [];\n\n      for (var j = 0; j < count; j++) {\n        tmpByte = byteArray[position++];\n        ccbyte1 = 0x7F & byteArray[position++];\n        ccbyte2 = 0x7F & byteArray[position++];\n        ccValid = (4 & tmpByte) !== 0;\n        ccType = 3 & tmpByte;\n\n        if (ccbyte1 === 0 && ccbyte2 === 0) {\n          continue;\n        }\n\n        if (ccValid) {\n          if (ccType === 0) // || ccType === 1\n            {\n              actualCCBytes.push(ccbyte1);\n              actualCCBytes.push(ccbyte2);\n            }\n        }\n      }\n      return actualCCBytes;\n    }\n  }]);\n\n  return TimelineController;\n}(_eventHandler2.default);\n\nexports.default = TimelineController;\n\n},{\"32\":32,\"33\":33,\"47\":47,\"50\":50,\"54\":54}],17:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AESCrypto = function () {\n  function AESCrypto(subtle, iv) {\n    _classCallCheck(this, AESCrypto);\n\n    this.subtle = subtle;\n    this.aesIV = iv;\n  }\n\n  _createClass(AESCrypto, [{\n    key: 'decrypt',\n    value: function decrypt(data, key) {\n      return this.subtle.decrypt({ name: 'AES-CBC', iv: this.aesIV }, key, data);\n    }\n  }]);\n\n  return AESCrypto;\n}();\n\nexports.default = AESCrypto;\n\n},{}],18:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AESDecryptor = function () {\n  function AESDecryptor() {\n    _classCallCheck(this, AESDecryptor);\n\n    // Static after running initTable\n    this.rcon = [0x0, 0x1, 0x2, 0x4, 0x8, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36];\n\n    this.subMix = [];\n    this.subMix[0] = new Uint32Array(256);\n    this.subMix[1] = new Uint32Array(256);\n    this.subMix[2] = new Uint32Array(256);\n    this.subMix[3] = new Uint32Array(256);\n\n    this.invSubMix = [];\n    this.invSubMix[0] = new Uint32Array(256);\n    this.invSubMix[1] = new Uint32Array(256);\n    this.invSubMix[2] = new Uint32Array(256);\n    this.invSubMix[3] = new Uint32Array(256);\n\n    this.sBox = new Uint32Array(256);\n    this.invSBox = new Uint32Array(256);\n\n    // Changes during runtime\n    this.key = new Uint32Array(0);\n\n    this.initTable();\n  }\n\n  // Using view.getUint32() also swaps the byte order.\n\n\n  _createClass(AESDecryptor, [{\n    key: 'uint8ArrayToUint32Array_',\n    value: function uint8ArrayToUint32Array_(arrayBuffer) {\n      var view = new DataView(arrayBuffer);\n      var newArray = new Uint32Array(4);\n      for (var i = 0; i < newArray.length; i++) {\n        newArray[i] = view.getUint32(i * 4);\n      }\n      return newArray;\n    }\n  }, {\n    key: 'initTable',\n    value: function initTable() {\n      var sBox = this.sBox;\n      var invSBox = this.invSBox;\n      var subMix0 = this.subMix[0];\n      var subMix1 = this.subMix[1];\n      var subMix2 = this.subMix[2];\n      var subMix3 = this.subMix[3];\n      var invSubMix0 = this.invSubMix[0];\n      var invSubMix1 = this.invSubMix[1];\n      var invSubMix2 = this.invSubMix[2];\n      var invSubMix3 = this.invSubMix[3];\n\n      var d = new Uint32Array(256);\n      var x = 0;\n      var xi = 0;\n      var i = 0;\n      for (i = 0; i < 256; i++) {\n        if (i < 128) {\n          d[i] = i << 1;\n        } else {\n          d[i] = i << 1 ^ 0x11b;\n        }\n      }\n\n      for (i = 0; i < 256; i++) {\n        var sx = xi ^ xi << 1 ^ xi << 2 ^ xi << 3 ^ xi << 4;\n        sx = sx >>> 8 ^ sx & 0xff ^ 0x63;\n        sBox[x] = sx;\n        invSBox[sx] = x;\n\n        // Compute multiplication\n        var x2 = d[x];\n        var x4 = d[x2];\n        var x8 = d[x4];\n\n        // Compute sub/invSub bytes, mix columns tables\n        var t = d[sx] * 0x101 ^ sx * 0x1010100;\n        subMix0[x] = t << 24 | t >>> 8;\n        subMix1[x] = t << 16 | t >>> 16;\n        subMix2[x] = t << 8 | t >>> 24;\n        subMix3[x] = t;\n\n        // Compute inv sub bytes, inv mix columns tables\n        t = x8 * 0x1010101 ^ x4 * 0x10001 ^ x2 * 0x101 ^ x * 0x1010100;\n        invSubMix0[sx] = t << 24 | t >>> 8;\n        invSubMix1[sx] = t << 16 | t >>> 16;\n        invSubMix2[sx] = t << 8 | t >>> 24;\n        invSubMix3[sx] = t;\n\n        // Compute next counter\n        if (!x) {\n          x = xi = 1;\n        } else {\n          x = x2 ^ d[d[d[x8 ^ x2]]];\n          xi ^= d[d[xi]];\n        }\n      }\n    }\n  }, {\n    key: 'expandKey',\n    value: function expandKey(keyBuffer) {\n      // convert keyBuffer to Uint32Array\n      var key = this.uint8ArrayToUint32Array_(keyBuffer);\n      var sameKey = true;\n      var offset = 0;\n\n      while (offset < key.length && sameKey) {\n        sameKey = key[offset] === this.key[offset];\n        offset++;\n      }\n\n      if (sameKey) {\n        return;\n      }\n\n      this.key = key;\n      var keySize = this.keySize = key.length;\n\n      if (keySize !== 4 && keySize !== 6 && keySize !== 8) {\n        throw new Error('Invalid aes key size=' + keySize);\n      }\n\n      var ksRows = this.ksRows = (keySize + 6 + 1) * 4;\n      var ksRow = void 0;\n      var invKsRow = void 0;\n\n      var keySchedule = this.keySchedule = new Uint32Array(this.ksRows);\n      var invKeySchedule = this.invKeySchedule = new Uint32Array(this.ksRows);\n      var sbox = this.sBox;\n      var rcon = this.rcon;\n\n      var invSubMix0 = this.invSubMix[0];\n      var invSubMix1 = this.invSubMix[1];\n      var invSubMix2 = this.invSubMix[2];\n      var invSubMix3 = this.invSubMix[3];\n\n      var prev = void 0;\n      var t = void 0;\n\n      for (ksRow = 0; ksRow < ksRows; ksRow++) {\n        if (ksRow < keySize) {\n          prev = keySchedule[ksRow] = key[ksRow];\n          continue;\n        }\n        t = prev;\n\n        if (ksRow % keySize === 0) {\n          // Rot word\n          t = t << 8 | t >>> 24;\n\n          // Sub word\n          t = sbox[t >>> 24] << 24 | sbox[t >>> 16 & 0xff] << 16 | sbox[t >>> 8 & 0xff] << 8 | sbox[t & 0xff];\n\n          // Mix Rcon\n          t ^= rcon[ksRow / keySize | 0] << 24;\n        } else if (keySize > 6 && ksRow % keySize === 4) {\n          // Sub word\n          t = sbox[t >>> 24] << 24 | sbox[t >>> 16 & 0xff] << 16 | sbox[t >>> 8 & 0xff] << 8 | sbox[t & 0xff];\n        }\n\n        keySchedule[ksRow] = prev = (keySchedule[ksRow - keySize] ^ t) >>> 0;\n      }\n\n      for (invKsRow = 0; invKsRow < ksRows; invKsRow++) {\n        ksRow = ksRows - invKsRow;\n        if (invKsRow & 3) {\n          t = keySchedule[ksRow];\n        } else {\n          t = keySchedule[ksRow - 4];\n        }\n\n        if (invKsRow < 4 || ksRow <= 4) {\n          invKeySchedule[invKsRow] = t;\n        } else {\n          invKeySchedule[invKsRow] = invSubMix0[sbox[t >>> 24]] ^ invSubMix1[sbox[t >>> 16 & 0xff]] ^ invSubMix2[sbox[t >>> 8 & 0xff]] ^ invSubMix3[sbox[t & 0xff]];\n        }\n\n        invKeySchedule[invKsRow] = invKeySchedule[invKsRow] >>> 0;\n      }\n    }\n\n    // Adding this as a method greatly improves performance.\n\n  }, {\n    key: 'networkToHostOrderSwap',\n    value: function networkToHostOrderSwap(word) {\n      return word << 24 | (word & 0xff00) << 8 | (word & 0xff0000) >> 8 | word >>> 24;\n    }\n  }, {\n    key: 'decrypt',\n    value: function decrypt(inputArrayBuffer, offset, aesIV) {\n      var nRounds = this.keySize + 6;\n      var invKeySchedule = this.invKeySchedule;\n      var invSBOX = this.invSBox;\n\n      var invSubMix0 = this.invSubMix[0];\n      var invSubMix1 = this.invSubMix[1];\n      var invSubMix2 = this.invSubMix[2];\n      var invSubMix3 = this.invSubMix[3];\n\n      var initVector = this.uint8ArrayToUint32Array_(aesIV);\n      var initVector0 = initVector[0];\n      var initVector1 = initVector[1];\n      var initVector2 = initVector[2];\n      var initVector3 = initVector[3];\n\n      var inputInt32 = new Int32Array(inputArrayBuffer);\n      var outputInt32 = new Int32Array(inputInt32.length);\n\n      var t0 = void 0,\n          t1 = void 0,\n          t2 = void 0,\n          t3 = void 0;\n      var s0 = void 0,\n          s1 = void 0,\n          s2 = void 0,\n          s3 = void 0;\n      var inputWords0 = void 0,\n          inputWords1 = void 0,\n          inputWords2 = void 0,\n          inputWords3 = void 0;\n\n      var ksRow, i;\n\n      while (offset < inputInt32.length) {\n        inputWords0 = this.networkToHostOrderSwap(inputInt32[offset]);\n        inputWords1 = this.networkToHostOrderSwap(inputInt32[offset + 1]);\n        inputWords2 = this.networkToHostOrderSwap(inputInt32[offset + 2]);\n        inputWords3 = this.networkToHostOrderSwap(inputInt32[offset + 3]);\n\n        s0 = inputWords0 ^ invKeySchedule[0];\n        s1 = inputWords3 ^ invKeySchedule[1];\n        s2 = inputWords2 ^ invKeySchedule[2];\n        s3 = inputWords1 ^ invKeySchedule[3];\n\n        ksRow = 4;\n\n        // Iterate through the rounds of decryption\n        for (i = 1; i < nRounds; i++) {\n          t0 = invSubMix0[s0 >>> 24] ^ invSubMix1[s1 >> 16 & 0xff] ^ invSubMix2[s2 >> 8 & 0xff] ^ invSubMix3[s3 & 0xff] ^ invKeySchedule[ksRow];\n          t1 = invSubMix0[s1 >>> 24] ^ invSubMix1[s2 >> 16 & 0xff] ^ invSubMix2[s3 >> 8 & 0xff] ^ invSubMix3[s0 & 0xff] ^ invKeySchedule[ksRow + 1];\n          t2 = invSubMix0[s2 >>> 24] ^ invSubMix1[s3 >> 16 & 0xff] ^ invSubMix2[s0 >> 8 & 0xff] ^ invSubMix3[s1 & 0xff] ^ invKeySchedule[ksRow + 2];\n          t3 = invSubMix0[s3 >>> 24] ^ invSubMix1[s0 >> 16 & 0xff] ^ invSubMix2[s1 >> 8 & 0xff] ^ invSubMix3[s2 & 0xff] ^ invKeySchedule[ksRow + 3];\n          // Update state\n          s0 = t0;\n          s1 = t1;\n          s2 = t2;\n          s3 = t3;\n\n          ksRow = ksRow + 4;\n        }\n\n        // Shift rows, sub bytes, add round key\n        t0 = invSBOX[s0 >>> 24] << 24 ^ invSBOX[s1 >> 16 & 0xff] << 16 ^ invSBOX[s2 >> 8 & 0xff] << 8 ^ invSBOX[s3 & 0xff] ^ invKeySchedule[ksRow];\n        t1 = invSBOX[s1 >>> 24] << 24 ^ invSBOX[s2 >> 16 & 0xff] << 16 ^ invSBOX[s3 >> 8 & 0xff] << 8 ^ invSBOX[s0 & 0xff] ^ invKeySchedule[ksRow + 1];\n        t2 = invSBOX[s2 >>> 24] << 24 ^ invSBOX[s3 >> 16 & 0xff] << 16 ^ invSBOX[s0 >> 8 & 0xff] << 8 ^ invSBOX[s1 & 0xff] ^ invKeySchedule[ksRow + 2];\n        t3 = invSBOX[s3 >>> 24] << 24 ^ invSBOX[s0 >> 16 & 0xff] << 16 ^ invSBOX[s1 >> 8 & 0xff] << 8 ^ invSBOX[s2 & 0xff] ^ invKeySchedule[ksRow + 3];\n        ksRow = ksRow + 3;\n\n        // Write\n        outputInt32[offset] = this.networkToHostOrderSwap(t0 ^ initVector0);\n        outputInt32[offset + 1] = this.networkToHostOrderSwap(t3 ^ initVector1);\n        outputInt32[offset + 2] = this.networkToHostOrderSwap(t2 ^ initVector2);\n        outputInt32[offset + 3] = this.networkToHostOrderSwap(t1 ^ initVector3);\n\n        // reset initVector to last 4 unsigned int\n        initVector0 = inputWords0;\n        initVector1 = inputWords1;\n        initVector2 = inputWords2;\n        initVector3 = inputWords3;\n\n        offset = offset + 4;\n      }\n\n      return outputInt32.buffer;\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.key = undefined;\n      this.keySize = undefined;\n      this.ksRows = undefined;\n\n      this.sBox = undefined;\n      this.invSBox = undefined;\n      this.subMix = undefined;\n      this.invSubMix = undefined;\n      this.keySchedule = undefined;\n      this.invKeySchedule = undefined;\n\n      this.rcon = undefined;\n    }\n  }]);\n\n  return AESDecryptor;\n}();\n\nexports.default = AESDecryptor;\n\n},{}],19:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _aesCrypto = _dereq_(17);\n\nvar _aesCrypto2 = _interopRequireDefault(_aesCrypto);\n\nvar _fastAesKey = _dereq_(20);\n\nvar _fastAesKey2 = _interopRequireDefault(_fastAesKey);\n\nvar _aesDecryptor = _dereq_(18);\n\nvar _aesDecryptor2 = _interopRequireDefault(_aesDecryptor);\n\nvar _errors = _dereq_(31);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*globals self: false */\n\nvar Decrypter = function () {\n  function Decrypter(observer, config) {\n    _classCallCheck(this, Decrypter);\n\n    this.observer = observer;\n    this.config = config;\n    this.logEnabled = true;\n    try {\n      var browserCrypto = crypto ? crypto : self.crypto;\n      this.subtle = browserCrypto.subtle || browserCrypto.webkitSubtle;\n    } catch (e) {}\n    this.disableWebCrypto = !this.subtle;\n  }\n\n  _createClass(Decrypter, [{\n    key: 'isSync',\n    value: function isSync() {\n      return this.disableWebCrypto && this.config.enableSoftwareAES;\n    }\n  }, {\n    key: 'decrypt',\n    value: function decrypt(data, key, iv, callback) {\n      var _this = this;\n\n      if (this.disableWebCrypto && this.config.enableSoftwareAES) {\n        if (this.logEnabled) {\n          _logger.logger.log('JS AES decrypt');\n          this.logEnabled = false;\n        }\n        var decryptor = this.decryptor;\n        if (!decryptor) {\n          this.decryptor = decryptor = new _aesDecryptor2.default();\n        }\n        decryptor.expandKey(key);\n        callback(decryptor.decrypt(data, 0, iv));\n      } else {\n        (function () {\n          if (_this.logEnabled) {\n            _logger.logger.log('WebCrypto AES decrypt');\n            _this.logEnabled = false;\n          }\n          var subtle = _this.subtle;\n          if (_this.key !== key) {\n            _this.key = key;\n            _this.fastAesKey = new _fastAesKey2.default(subtle, key);\n          }\n\n          _this.fastAesKey.expandKey().then(function (aesKey) {\n            // decrypt using web crypto\n            var crypto = new _aesCrypto2.default(subtle, iv);\n            crypto.decrypt(data, aesKey).catch(function (err) {\n              _this.onWebCryptoError(err, data, key, iv, callback);\n            }).then(function (result) {\n              callback(result);\n            });\n          }).catch(function (err) {\n            _this.onWebCryptoError(err, data, key, iv, callback);\n          });\n        })();\n      }\n    }\n  }, {\n    key: 'onWebCryptoError',\n    value: function onWebCryptoError(err, data, key, iv, callback) {\n      if (this.config.enableSoftwareAES) {\n        _logger.logger.log('WebCrypto Error, disable WebCrypto API');\n        this.disableWebCrypto = true;\n        this.logEnabled = true;\n        this.decrypt(data, key, iv, callback);\n      } else {\n        _logger.logger.error('decrypting error : ' + err.message);\n        this.observer.trigger(Event.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_DECRYPT_ERROR, fatal: true, reason: err.message });\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      var decryptor = this.decryptor;\n      if (decryptor) {\n        decryptor.destroy();\n        this.decryptor = undefined;\n      }\n    }\n  }]);\n\n  return Decrypter;\n}();\n\nexports.default = Decrypter;\n\n},{\"17\":17,\"18\":18,\"20\":20,\"31\":31,\"50\":50}],20:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FastAESKey = function () {\n  function FastAESKey(subtle, key) {\n    _classCallCheck(this, FastAESKey);\n\n    this.subtle = subtle;\n    this.key = key;\n  }\n\n  _createClass(FastAESKey, [{\n    key: 'expandKey',\n    value: function expandKey() {\n      return this.subtle.importKey('raw', this.key, { name: 'AES-CBC' }, false, ['encrypt', 'decrypt']);\n    }\n  }]);\n\n  return FastAESKey;\n}();\n\nexports.default = FastAESKey;\n\n},{}],21:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * AAC demuxer\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\n\nvar _adts = _dereq_(22);\n\nvar _adts2 = _interopRequireDefault(_adts);\n\nvar _logger = _dereq_(50);\n\nvar _id = _dereq_(27);\n\nvar _id2 = _interopRequireDefault(_id);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AACDemuxer = function () {\n  function AACDemuxer(observer, remuxer, config) {\n    _classCallCheck(this, AACDemuxer);\n\n    this.observer = observer;\n    this.config = config;\n    this.remuxer = remuxer;\n  }\n\n  _createClass(AACDemuxer, [{\n    key: 'resetInitSegment',\n    value: function resetInitSegment(initSegment, audioCodec, videoCodec, duration) {\n      this._aacTrack = { container: 'audio/adts', type: 'audio', id: -1, sequenceNumber: 0, isAAC: true, samples: [], len: 0, manifestCodec: audioCodec, duration: duration };\n    }\n  }, {\n    key: 'resetTimeStamp',\n    value: function resetTimeStamp() {}\n  }, {\n    key: 'append',\n\n\n    // feed incoming data to the front of the parsing pipeline\n    value: function append(data, timeOffset, contiguous, accurateTimeOffset) {\n      var track,\n          id3 = new _id2.default(data),\n          pts = 90 * id3.timeStamp,\n          config,\n          frameLength,\n          frameDuration,\n          frameIndex,\n          offset,\n          headerLength,\n          stamp,\n          len,\n          aacSample;\n\n      track = this._aacTrack;\n\n      // look for ADTS header (0xFFFx)\n      for (offset = id3.length, len = data.length; offset < len - 1; offset++) {\n        if (data[offset] === 0xff && (data[offset + 1] & 0xf0) === 0xf0) {\n          break;\n        }\n      }\n\n      if (!track.audiosamplerate) {\n        config = _adts2.default.getAudioConfig(this.observer, data, offset, track.manifestCodec);\n        track.config = config.config;\n        track.audiosamplerate = config.samplerate;\n        track.channelCount = config.channelCount;\n        track.codec = config.codec;\n        _logger.logger.log('parsed codec:' + track.codec + ',rate:' + config.samplerate + ',nb channel:' + config.channelCount);\n      }\n      frameIndex = 0;\n      frameDuration = 1024 * 90000 / track.audiosamplerate;\n      while (offset + 5 < len) {\n        // The protection skip bit tells us if we have 2 bytes of CRC data at the end of the ADTS header\n        headerLength = !!(data[offset + 1] & 0x01) ? 7 : 9;\n        // retrieve frame size\n        frameLength = (data[offset + 3] & 0x03) << 11 | data[offset + 4] << 3 | (data[offset + 5] & 0xE0) >>> 5;\n        frameLength -= headerLength;\n        //stamp = pes.pts;\n\n        if (frameLength > 0 && offset + headerLength + frameLength <= len) {\n          stamp = pts + frameIndex * frameDuration;\n          //logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n          aacSample = { unit: data.subarray(offset + headerLength, offset + headerLength + frameLength), pts: stamp, dts: stamp };\n          track.samples.push(aacSample);\n          track.len += frameLength;\n          offset += frameLength + headerLength;\n          frameIndex++;\n          // look for ADTS header (0xFFFx)\n          for (; offset < len - 1; offset++) {\n            if (data[offset] === 0xff && (data[offset + 1] & 0xf0) === 0xf0) {\n              break;\n            }\n          }\n        } else {\n          break;\n        }\n      }\n      this.remuxer.remux(track, { samples: [] }, { samples: [{ pts: pts, dts: pts, unit: id3.payload }] }, { samples: [] }, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {}\n  }], [{\n    key: 'probe',\n    value: function probe(data) {\n      // check if data contains ID3 timestamp and ADTS sync worc\n      var id3 = new _id2.default(data),\n          offset,\n          len;\n      if (id3.hasTimeStamp) {\n        // look for ADTS header (0xFFFx)\n        for (offset = id3.length, len = data.length; offset < len - 1; offset++) {\n          if (data[offset] === 0xff && (data[offset + 1] & 0xf0) === 0xf0) {\n            //logger.log('ADTS sync word found !');\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n  }]);\n\n  return AACDemuxer;\n}();\n\nexports.default = AACDemuxer;\n\n},{\"22\":22,\"27\":27,\"50\":50}],22:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *  ADTS parser helper\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\n\nvar _logger = _dereq_(50);\n\nvar _errors = _dereq_(31);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ADTS = function () {\n  function ADTS() {\n    _classCallCheck(this, ADTS);\n  }\n\n  _createClass(ADTS, null, [{\n    key: 'getAudioConfig',\n    value: function getAudioConfig(observer, data, offset, audioCodec) {\n      var adtsObjectType,\n          // :int\n      adtsSampleingIndex,\n          // :int\n      adtsExtensionSampleingIndex,\n          // :int\n      adtsChanelConfig,\n          // :int\n      config,\n          userAgent = navigator.userAgent.toLowerCase(),\n          manifestCodec = audioCodec,\n          adtsSampleingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n      // byte 2\n      adtsObjectType = ((data[offset + 2] & 0xC0) >>> 6) + 1;\n      adtsSampleingIndex = (data[offset + 2] & 0x3C) >>> 2;\n      if (adtsSampleingIndex > adtsSampleingRates.length - 1) {\n        observer.trigger(Event.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_PARSING_ERROR, fatal: true, reason: 'invalid ADTS sampling index:' + adtsSampleingIndex });\n        return;\n      }\n      adtsChanelConfig = (data[offset + 2] & 0x01) << 2;\n      // byte 3\n      adtsChanelConfig |= (data[offset + 3] & 0xC0) >>> 6;\n      _logger.logger.log('manifest codec:' + audioCodec + ',ADTS data:type:' + adtsObjectType + ',sampleingIndex:' + adtsSampleingIndex + '[' + adtsSampleingRates[adtsSampleingIndex] + 'Hz],channelConfig:' + adtsChanelConfig);\n      // firefox: freq less than 24kHz = AAC SBR (HE-AAC)\n      if (/firefox/i.test(userAgent)) {\n        if (adtsSampleingIndex >= 6) {\n          adtsObjectType = 5;\n          config = new Array(4);\n          // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n          // there is a factor 2 between frame sample rate and output sample rate\n          // multiply frequency by 2 (see table below, equivalent to substract 3)\n          adtsExtensionSampleingIndex = adtsSampleingIndex - 3;\n        } else {\n          adtsObjectType = 2;\n          config = new Array(2);\n          adtsExtensionSampleingIndex = adtsSampleingIndex;\n        }\n        // Android : always use AAC\n      } else if (userAgent.indexOf('android') !== -1) {\n        adtsObjectType = 2;\n        config = new Array(2);\n        adtsExtensionSampleingIndex = adtsSampleingIndex;\n      } else {\n        /*  for other browsers (Chrome/Vivaldi/Opera ...)\n            always force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)\n        */\n        adtsObjectType = 5;\n        config = new Array(4);\n        // if (manifest codec is HE-AAC or HE-AACv2) OR (manifest codec not specified AND frequency less than 24kHz)\n        if (audioCodec && (audioCodec.indexOf('mp4a.40.29') !== -1 || audioCodec.indexOf('mp4a.40.5') !== -1) || !audioCodec && adtsSampleingIndex >= 6) {\n          // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n          // there is a factor 2 between frame sample rate and output sample rate\n          // multiply frequency by 2 (see table below, equivalent to substract 3)\n          adtsExtensionSampleingIndex = adtsSampleingIndex - 3;\n        } else {\n          // if (manifest codec is AAC) AND (frequency less than 24kHz AND nb channel is 1) OR (manifest codec not specified and mono audio)\n          // Chrome fails to play back with low frequency AAC LC mono when initialized with HE-AAC.  This is not a problem with stereo.\n          if (audioCodec && audioCodec.indexOf('mp4a.40.2') !== -1 && adtsSampleingIndex >= 6 && adtsChanelConfig === 1 || !audioCodec && adtsChanelConfig === 1) {\n            adtsObjectType = 2;\n            config = new Array(2);\n          }\n          adtsExtensionSampleingIndex = adtsSampleingIndex;\n        }\n      }\n      /* refer to http://wiki.multimedia.cx/index.php?title=MPEG-4_Audio#Audio_Specific_Config\n          ISO 14496-3 (AAC).pdf - Table 1.13 — Syntax of AudioSpecificConfig()\n        Audio Profile / Audio Object Type\n        0: Null\n        1: AAC Main\n        2: AAC LC (Low Complexity)\n        3: AAC SSR (Scalable Sample Rate)\n        4: AAC LTP (Long Term Prediction)\n        5: SBR (Spectral Band Replication)\n        6: AAC Scalable\n       sampling freq\n        0: 96000 Hz\n        1: 88200 Hz\n        2: 64000 Hz\n        3: 48000 Hz\n        4: 44100 Hz\n        5: 32000 Hz\n        6: 24000 Hz\n        7: 22050 Hz\n        8: 16000 Hz\n        9: 12000 Hz\n        10: 11025 Hz\n        11: 8000 Hz\n        12: 7350 Hz\n        13: Reserved\n        14: Reserved\n        15: frequency is written explictly\n        Channel Configurations\n        These are the channel configurations:\n        0: Defined in AOT Specifc Config\n        1: 1 channel: front-center\n        2: 2 channels: front-left, front-right\n      */\n      // audioObjectType = profile => profile, the MPEG-4 Audio Object Type minus 1\n      config[0] = adtsObjectType << 3;\n      // samplingFrequencyIndex\n      config[0] |= (adtsSampleingIndex & 0x0E) >> 1;\n      config[1] |= (adtsSampleingIndex & 0x01) << 7;\n      // channelConfiguration\n      config[1] |= adtsChanelConfig << 3;\n      if (adtsObjectType === 5) {\n        // adtsExtensionSampleingIndex\n        config[1] |= (adtsExtensionSampleingIndex & 0x0E) >> 1;\n        config[2] = (adtsExtensionSampleingIndex & 0x01) << 7;\n        // adtsObjectType (force to 2, chrome is checking that object type is less than 5 ???\n        //    https://chromium.googlesource.com/chromium/src.git/+/master/media/formats/mp4/aac.cc\n        config[2] |= 2 << 2;\n        config[3] = 0;\n      }\n      return { config: config, samplerate: adtsSampleingRates[adtsSampleingIndex], channelCount: adtsChanelConfig, codec: 'mp4a.40.' + adtsObjectType, manifestCodec: manifestCodec };\n    }\n  }]);\n\n  return ADTS;\n}();\n\nexports.default = ADTS;\n\n},{\"31\":31,\"50\":50}],23:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*  inline demuxer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *   probe fragments and instantiate appropriate demuxer depending on content type (TSDemuxer, AACDemuxer, ...)\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _errors = _dereq_(31);\n\nvar _decrypter = _dereq_(19);\n\nvar _decrypter2 = _interopRequireDefault(_decrypter);\n\nvar _aacdemuxer = _dereq_(21);\n\nvar _aacdemuxer2 = _interopRequireDefault(_aacdemuxer);\n\nvar _mp4demuxer = _dereq_(28);\n\nvar _mp4demuxer2 = _interopRequireDefault(_mp4demuxer);\n\nvar _tsdemuxer = _dereq_(30);\n\nvar _tsdemuxer2 = _interopRequireDefault(_tsdemuxer);\n\nvar _mp4Remuxer = _dereq_(43);\n\nvar _mp4Remuxer2 = _interopRequireDefault(_mp4Remuxer);\n\nvar _passthroughRemuxer = _dereq_(44);\n\nvar _passthroughRemuxer2 = _interopRequireDefault(_passthroughRemuxer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DemuxerInline = function () {\n  function DemuxerInline(observer, typeSupported, config) {\n    _classCallCheck(this, DemuxerInline);\n\n    this.observer = observer;\n    this.typeSupported = typeSupported;\n    this.config = config;\n  }\n\n  _createClass(DemuxerInline, [{\n    key: 'destroy',\n    value: function destroy() {\n      var demuxer = this.demuxer;\n      if (demuxer) {\n        demuxer.destroy();\n      }\n    }\n  }, {\n    key: 'push',\n    value: function push(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS) {\n      if (data.byteLength > 0 && decryptdata != null && decryptdata.key != null && decryptdata.method === 'AES-128') {\n        var decrypter = this.decrypter;\n        if (decrypter == null) {\n          decrypter = this.decrypter = new _decrypter2.default(this.observer, this.config);\n        }\n        var localthis = this;\n        // performance.now() not available on WebWorker, at least on Safari Desktop\n        var startTime;\n        try {\n          startTime = performance.now();\n        } catch (error) {\n          startTime = Date.now();\n        }\n        decrypter.decrypt(data, decryptdata.key.buffer, decryptdata.iv.buffer, function (decryptedData) {\n          var endTime;\n          try {\n            endTime = performance.now();\n          } catch (error) {\n            endTime = Date.now();\n          }\n          localthis.observer.trigger(_events2.default.FRAG_DECRYPTED, { stats: { tstart: startTime, tdecrypt: endTime } });\n          localthis.pushDecrypted(new Uint8Array(decryptedData), decryptdata, new Uint8Array(initSegment), audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS);\n        });\n      } else {\n        this.pushDecrypted(new Uint8Array(data), decryptdata, new Uint8Array(initSegment), audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS);\n      }\n    }\n  }, {\n    key: 'pushDecrypted',\n    value: function pushDecrypted(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS) {\n      var demuxer = this.demuxer;\n      if (!demuxer ||\n      // in case of continuity change, we might switch from content type (AAC container to TS container for example)\n      // so let's check that current demuxer is still valid\n      discontinuity && !this.probe(data)) {\n        var observer = this.observer;\n        var typeSupported = this.typeSupported;\n        var config = this.config;\n        var muxConfig = [{ demux: _tsdemuxer2.default, remux: _mp4Remuxer2.default }, { demux: _aacdemuxer2.default, remux: _mp4Remuxer2.default }, { demux: _mp4demuxer2.default, remux: _passthroughRemuxer2.default }];\n\n        // probe for content type\n        for (var i in muxConfig) {\n          var mux = muxConfig[i];\n          var probe = mux.demux.probe;\n          if (probe(data)) {\n            var _remuxer = this.remuxer = new mux.remux(observer, config, typeSupported);\n            demuxer = new mux.demux(observer, _remuxer, config, typeSupported);\n            this.probe = probe;\n            break;\n          }\n        }\n        if (!demuxer) {\n          observer.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_PARSING_ERROR, fatal: true, reason: 'no demux matching with content found' });\n          return;\n        }\n        this.demuxer = demuxer;\n      }\n      var remuxer = this.remuxer;\n\n      if (discontinuity || trackSwitch) {\n        demuxer.resetInitSegment(initSegment, audioCodec, videoCodec, duration);\n        remuxer.resetInitSegment();\n      }\n      if (discontinuity) {\n        demuxer.resetTimeStamp();\n        remuxer.resetTimeStamp(defaultInitPTS);\n      }\n      if (typeof demuxer.setDecryptData === 'function') {\n        demuxer.setDecryptData(decryptdata);\n      }\n      demuxer.append(data, timeOffset, contiguous, accurateTimeOffset);\n    }\n  }]);\n\n  return DemuxerInline;\n}();\n\nexports.default = DemuxerInline;\n\n},{\"19\":19,\"21\":21,\"28\":28,\"30\":30,\"31\":31,\"33\":33,\"43\":43,\"44\":44}],24:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _demuxerInline = _dereq_(23);\n\nvar _demuxerInline2 = _interopRequireDefault(_demuxerInline);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_(50);\n\nvar _events3 = _dereq_(1);\n\nvar _events4 = _interopRequireDefault(_events3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* demuxer web worker.\n *  - listen to worker message, and trigger DemuxerInline upon reception of Fragments.\n *  - provides MP4 Boxes back to main thread using [transferable objects](https://developers.google.com/web/updates/2011/12/Transferable-Objects-Lightning-Fast) in order to minimize message passing overhead.\n */\n\nvar DemuxerWorker = function DemuxerWorker(self) {\n  // observer setup\n  var observer = new _events4.default();\n  observer.trigger = function trigger(event) {\n    for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      data[_key - 1] = arguments[_key];\n    }\n\n    observer.emit.apply(observer, [event, event].concat(data));\n  };\n\n  observer.off = function off(event) {\n    for (var _len2 = arguments.length, data = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      data[_key2 - 1] = arguments[_key2];\n    }\n\n    observer.removeListener.apply(observer, [event].concat(data));\n  };\n\n  var forwardMessage = function forwardMessage(ev, data) {\n    self.postMessage({ event: ev, data: data });\n  };\n\n  self.addEventListener('message', function (ev) {\n    var data = ev.data;\n    //console.log('demuxer cmd:' + data.cmd);\n    switch (data.cmd) {\n      case 'init':\n        var config = JSON.parse(data.config);\n        self.demuxer = new _demuxerInline2.default(observer, data.typeSupported, config);\n        try {\n          (0, _logger.enableLogs)(config.debug === true);\n        } catch (err) {\n          console.warn('demuxerWorker: unable to enable logs');\n        }\n        // signal end of worker init\n        forwardMessage('init', null);\n        break;\n      case 'demux':\n        self.demuxer.push(data.data, data.decryptdata, data.initSegment, data.audioCodec, data.videoCodec, data.timeOffset, data.discontinuity, data.trackSwitch, data.contiguous, data.duration, data.accurateTimeOffset, data.defaultInitPTS);\n        break;\n      default:\n        break;\n    }\n  });\n\n  // forward events to main thread\n  observer.on(_events2.default.FRAG_DECRYPTED, forwardMessage);\n  observer.on(_events2.default.FRAG_PARSING_INIT_SEGMENT, forwardMessage);\n  observer.on(_events2.default.FRAG_PARSED, forwardMessage);\n  observer.on(_events2.default.ERROR, forwardMessage);\n  observer.on(_events2.default.FRAG_PARSING_METADATA, forwardMessage);\n  observer.on(_events2.default.FRAG_PARSING_USERDATA, forwardMessage);\n  observer.on(_events2.default.INIT_PTS_FOUND, forwardMessage);\n\n  // special case for FRAG_PARSING_DATA: pass data1/data2 as transferable object (no copy)\n  observer.on(_events2.default.FRAG_PARSING_DATA, function (ev, data) {\n    var transferable = [];\n    var message = { event: ev, data: data };\n    if (data.data1) {\n      message.data1 = data.data1.buffer;\n      transferable.push(data.data1.buffer);\n      delete data.data1;\n    }\n    if (data.data2) {\n      message.data2 = data.data2.buffer;\n      transferable.push(data.data2.buffer);\n      delete data.data2;\n    }\n    self.postMessage(message, transferable);\n  });\n};\n\nexports.default = DemuxerWorker;\n\n},{\"1\":1,\"23\":23,\"33\":33,\"50\":50}],25:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _demuxerInline = _dereq_(23);\n\nvar _demuxerInline2 = _interopRequireDefault(_demuxerInline);\n\nvar _demuxerWorker = _dereq_(24);\n\nvar _demuxerWorker2 = _interopRequireDefault(_demuxerWorker);\n\nvar _logger = _dereq_(50);\n\nvar _errors = _dereq_(31);\n\nvar _events3 = _dereq_(1);\n\nvar _events4 = _interopRequireDefault(_events3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Demuxer = function () {\n  function Demuxer(hls, id) {\n    _classCallCheck(this, Demuxer);\n\n    this.hls = hls;\n    this.id = id;\n    // observer setup\n    var observer = this.observer = new _events4.default();\n    var config = hls.config;\n    observer.trigger = function trigger(event) {\n      for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        data[_key - 1] = arguments[_key];\n      }\n\n      observer.emit.apply(observer, [event, event].concat(data));\n    };\n\n    observer.off = function off(event) {\n      for (var _len2 = arguments.length, data = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        data[_key2 - 1] = arguments[_key2];\n      }\n\n      observer.removeListener.apply(observer, [event].concat(data));\n    };\n\n    var forwardMessage = function (ev, data) {\n      data = data || {};\n      data.frag = this.frag;\n      data.id = this.id;\n      hls.trigger(ev, data);\n    }.bind(this);\n\n    // forward events to main thread\n    observer.on(_events2.default.FRAG_DECRYPTED, forwardMessage);\n    observer.on(_events2.default.FRAG_PARSING_INIT_SEGMENT, forwardMessage);\n    observer.on(_events2.default.FRAG_PARSING_DATA, forwardMessage);\n    observer.on(_events2.default.FRAG_PARSED, forwardMessage);\n    observer.on(_events2.default.ERROR, forwardMessage);\n    observer.on(_events2.default.FRAG_PARSING_METADATA, forwardMessage);\n    observer.on(_events2.default.FRAG_PARSING_USERDATA, forwardMessage);\n    observer.on(_events2.default.INIT_PTS_FOUND, forwardMessage);\n\n    var typeSupported = {\n      mp4: MediaSource.isTypeSupported('video/mp4'),\n      mpeg: MediaSource.isTypeSupported('audio/mpeg'),\n      mp3: MediaSource.isTypeSupported('audio/mp4; codecs=\"mp3\"')\n    };\n    if (config.enableWorker && typeof Worker !== 'undefined') {\n      _logger.logger.log('demuxing in webworker');\n      var w = void 0;\n      try {\n        var work = _dereq_(3);\n        w = this.w = work(_demuxerWorker2.default);\n        this.onwmsg = this.onWorkerMessage.bind(this);\n        w.addEventListener('message', this.onwmsg);\n        w.onerror = function (event) {\n          hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.OTHER_ERROR, details: _errors.ErrorDetails.INTERNAL_EXCEPTION, fatal: true, event: 'demuxerWorker', err: { message: event.message + ' (' + event.filename + ':' + event.lineno + ')' } });\n        };\n        w.postMessage({ cmd: 'init', typeSupported: typeSupported, id: id, config: JSON.stringify(config) });\n      } catch (err) {\n        _logger.logger.error('error while initializing DemuxerWorker, fallback on DemuxerInline');\n        if (w) {\n          // revoke the Object URL that was used to create demuxer worker, so as not to leak it\n          URL.revokeObjectURL(w.objectURL);\n        }\n        this.demuxer = new _demuxerInline2.default(observer, id, typeSupported, config);\n        this.w = undefined;\n      }\n    } else {\n      this.demuxer = new _demuxerInline2.default(observer, id, typeSupported, config);\n    }\n  }\n\n  _createClass(Demuxer, [{\n    key: 'destroy',\n    value: function destroy() {\n      var w = this.w;\n      if (w) {\n        w.removeEventListener('message', this.onwmsg);\n        w.terminate();\n        this.w = null;\n      } else {\n        var demuxer = this.demuxer;\n        if (demuxer) {\n          demuxer.destroy();\n          this.demuxer = null;\n        }\n      }\n      var observer = this.observer;\n      if (observer) {\n        observer.removeAllListeners();\n        this.observer = null;\n      }\n    }\n  }, {\n    key: 'push',\n    value: function push(data, initSegment, audioCodec, videoCodec, frag, duration, accurateTimeOffset, defaultInitPTS) {\n      var w = this.w;\n      var timeOffset = !isNaN(frag.startDTS) ? frag.startDTS : frag.start;\n      var decryptdata = frag.decryptdata;\n      var lastFrag = this.frag;\n      var discontinuity = !(lastFrag && frag.cc === lastFrag.cc);\n      var trackSwitch = !(lastFrag && frag.level === lastFrag.level);\n      var nextSN = lastFrag && frag.sn === lastFrag.sn + 1;\n      var contiguous = !discontinuity && !trackSwitch && nextSN;\n      if (discontinuity) {\n        _logger.logger.log(this.id + ':discontinuity detected');\n      }\n      if (trackSwitch) {\n        _logger.logger.log(this.id + ':switch detected');\n      }\n      this.frag = frag;\n      if (w) {\n        // post fragment payload as transferable objects (no copy)\n        w.postMessage({ cmd: 'demux', data: data, decryptdata: decryptdata, initSegment: initSegment, audioCodec: audioCodec, videoCodec: videoCodec, timeOffset: timeOffset, discontinuity: discontinuity, trackSwitch: trackSwitch, contiguous: contiguous, duration: duration, accurateTimeOffset: accurateTimeOffset, defaultInitPTS: defaultInitPTS }, [data]);\n      } else {\n        var demuxer = this.demuxer;\n        if (demuxer) {\n          demuxer.push(data, decryptdata, initSegment, audioCodec, videoCodec, timeOffset, discontinuity, trackSwitch, contiguous, duration, accurateTimeOffset, defaultInitPTS);\n        }\n      }\n    }\n  }, {\n    key: 'onWorkerMessage',\n    value: function onWorkerMessage(ev) {\n      var data = ev.data,\n          hls = this.hls;\n      //console.log('onWorkerMessage:' + data.event);\n      switch (data.event) {\n        case 'init':\n          // revoke the Object URL that was used to create demuxer worker, so as not to leak it\n          URL.revokeObjectURL(this.w.objectURL);\n          break;\n        // special case for FRAG_PARSING_DATA: data1 and data2 are transferable objects\n        case _events2.default.FRAG_PARSING_DATA:\n          data.data.data1 = new Uint8Array(data.data1);\n          if (data.data2) {\n            data.data.data2 = new Uint8Array(data.data2);\n          }\n        /* falls through */\n        default:\n          data.data = data.data || {};\n          data.data.frag = this.frag;\n          data.data.id = this.id;\n          hls.trigger(data.event, data.data);\n          break;\n      }\n    }\n  }]);\n\n  return Demuxer;\n}();\n\nexports.default = Demuxer;\n\n},{\"1\":1,\"23\":23,\"24\":24,\"3\":3,\"31\":31,\"33\":33,\"50\":50}],26:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Parser for exponential Golomb codes, a variable-bitwidth number encoding scheme used by h264.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _logger = _dereq_(50);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ExpGolomb = function () {\n  function ExpGolomb(data) {\n    _classCallCheck(this, ExpGolomb);\n\n    this.data = data;\n    // the number of bytes left to examine in this.data\n    this.bytesAvailable = data.byteLength;\n    // the current word being examined\n    this.word = 0; // :uint\n    // the number of bits left to examine in the current word\n    this.bitsAvailable = 0; // :uint\n  }\n\n  // ():void\n\n\n  _createClass(ExpGolomb, [{\n    key: 'loadWord',\n    value: function loadWord() {\n      var data = this.data,\n          bytesAvailable = this.bytesAvailable,\n          position = data.byteLength - bytesAvailable,\n          workingBytes = new Uint8Array(4),\n          availableBytes = Math.min(4, bytesAvailable);\n      if (availableBytes === 0) {\n        throw new Error('no bytes available');\n      }\n      workingBytes.set(data.subarray(position, position + availableBytes));\n      this.word = new DataView(workingBytes.buffer).getUint32(0);\n      // track the amount of this.data that has been processed\n      this.bitsAvailable = availableBytes * 8;\n      this.bytesAvailable -= availableBytes;\n    }\n\n    // (count:int):void\n\n  }, {\n    key: 'skipBits',\n    value: function skipBits(count) {\n      var skipBytes; // :int\n      if (this.bitsAvailable > count) {\n        this.word <<= count;\n        this.bitsAvailable -= count;\n      } else {\n        count -= this.bitsAvailable;\n        skipBytes = count >> 3;\n        count -= skipBytes >> 3;\n        this.bytesAvailable -= skipBytes;\n        this.loadWord();\n        this.word <<= count;\n        this.bitsAvailable -= count;\n      }\n    }\n\n    // (size:int):uint\n\n  }, {\n    key: 'readBits',\n    value: function readBits(size) {\n      var bits = Math.min(this.bitsAvailable, size),\n          // :uint\n      valu = this.word >>> 32 - bits; // :uint\n      if (size > 32) {\n        _logger.logger.error('Cannot read more than 32 bits at a time');\n      }\n      this.bitsAvailable -= bits;\n      if (this.bitsAvailable > 0) {\n        this.word <<= bits;\n      } else if (this.bytesAvailable > 0) {\n        this.loadWord();\n      }\n      bits = size - bits;\n      if (bits > 0 && this.bitsAvailable) {\n        return valu << bits | this.readBits(bits);\n      } else {\n        return valu;\n      }\n    }\n\n    // ():uint\n\n  }, {\n    key: 'skipLZ',\n    value: function skipLZ() {\n      var leadingZeroCount; // :uint\n      for (leadingZeroCount = 0; leadingZeroCount < this.bitsAvailable; ++leadingZeroCount) {\n        if (0 !== (this.word & 0x80000000 >>> leadingZeroCount)) {\n          // the first bit of working word is 1\n          this.word <<= leadingZeroCount;\n          this.bitsAvailable -= leadingZeroCount;\n          return leadingZeroCount;\n        }\n      }\n      // we exhausted word and still have not found a 1\n      this.loadWord();\n      return leadingZeroCount + this.skipLZ();\n    }\n\n    // ():void\n\n  }, {\n    key: 'skipUEG',\n    value: function skipUEG() {\n      this.skipBits(1 + this.skipLZ());\n    }\n\n    // ():void\n\n  }, {\n    key: 'skipEG',\n    value: function skipEG() {\n      this.skipBits(1 + this.skipLZ());\n    }\n\n    // ():uint\n\n  }, {\n    key: 'readUEG',\n    value: function readUEG() {\n      var clz = this.skipLZ(); // :uint\n      return this.readBits(clz + 1) - 1;\n    }\n\n    // ():int\n\n  }, {\n    key: 'readEG',\n    value: function readEG() {\n      var valu = this.readUEG(); // :int\n      if (0x01 & valu) {\n        // the number is odd if the low order bit is set\n        return 1 + valu >>> 1; // add 1 to make it even, and divide by 2\n      } else {\n        return -1 * (valu >>> 1); // divide by two then make it negative\n      }\n    }\n\n    // Some convenience functions\n    // :Boolean\n\n  }, {\n    key: 'readBoolean',\n    value: function readBoolean() {\n      return 1 === this.readBits(1);\n    }\n\n    // ():int\n\n  }, {\n    key: 'readUByte',\n    value: function readUByte() {\n      return this.readBits(8);\n    }\n\n    // ():int\n\n  }, {\n    key: 'readUShort',\n    value: function readUShort() {\n      return this.readBits(16);\n    }\n    // ():int\n\n  }, {\n    key: 'readUInt',\n    value: function readUInt() {\n      return this.readBits(32);\n    }\n\n    /**\n     * Advance the ExpGolomb decoder past a scaling list. The scaling\n     * list is optionally transmitted as part of a sequence parameter\n     * set and is not relevant to transmuxing.\n     * @param count {number} the number of entries in this scaling list\n     * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\n     */\n\n  }, {\n    key: 'skipScalingList',\n    value: function skipScalingList(count) {\n      var lastScale = 8,\n          nextScale = 8,\n          j,\n          deltaScale;\n      for (j = 0; j < count; j++) {\n        if (nextScale !== 0) {\n          deltaScale = this.readEG();\n          nextScale = (lastScale + deltaScale + 256) % 256;\n        }\n        lastScale = nextScale === 0 ? lastScale : nextScale;\n      }\n    }\n\n    /**\n     * Read a sequence parameter set and return some interesting video\n     * properties. A sequence parameter set is the H264 metadata that\n     * describes the properties of upcoming video frames.\n     * @param data {Uint8Array} the bytes of a sequence parameter set\n     * @return {object} an object with configuration parsed from the\n     * sequence parameter set, including the dimensions of the\n     * associated video frames.\n     */\n\n  }, {\n    key: 'readSPS',\n    value: function readSPS() {\n      var frameCropLeftOffset = 0,\n          frameCropRightOffset = 0,\n          frameCropTopOffset = 0,\n          frameCropBottomOffset = 0,\n          profileIdc,\n          profileCompat,\n          levelIdc,\n          numRefFramesInPicOrderCntCycle,\n          picWidthInMbsMinus1,\n          picHeightInMapUnitsMinus1,\n          frameMbsOnlyFlag,\n          scalingListCount,\n          i,\n          readUByte = this.readUByte.bind(this),\n          readBits = this.readBits.bind(this),\n          readUEG = this.readUEG.bind(this),\n          readBoolean = this.readBoolean.bind(this),\n          skipBits = this.skipBits.bind(this),\n          skipEG = this.skipEG.bind(this),\n          skipUEG = this.skipUEG.bind(this),\n          skipScalingList = this.skipScalingList.bind(this);\n\n      readUByte();\n      profileIdc = readUByte(); // profile_idc\n      profileCompat = readBits(5); // constraint_set[0-4]_flag, u(5)\n      skipBits(3); // reserved_zero_3bits u(3),\n      levelIdc = readUByte(); //level_idc u(8)\n      skipUEG(); // seq_parameter_set_id\n      // some profiles have more optional data we don't need\n      if (profileIdc === 100 || profileIdc === 110 || profileIdc === 122 || profileIdc === 244 || profileIdc === 44 || profileIdc === 83 || profileIdc === 86 || profileIdc === 118 || profileIdc === 128) {\n        var chromaFormatIdc = readUEG();\n        if (chromaFormatIdc === 3) {\n          skipBits(1); // separate_colour_plane_flag\n        }\n        skipUEG(); // bit_depth_luma_minus8\n        skipUEG(); // bit_depth_chroma_minus8\n        skipBits(1); // qpprime_y_zero_transform_bypass_flag\n        if (readBoolean()) {\n          // seq_scaling_matrix_present_flag\n          scalingListCount = chromaFormatIdc !== 3 ? 8 : 12;\n          for (i = 0; i < scalingListCount; i++) {\n            if (readBoolean()) {\n              // seq_scaling_list_present_flag[ i ]\n              if (i < 6) {\n                skipScalingList(16);\n              } else {\n                skipScalingList(64);\n              }\n            }\n          }\n        }\n      }\n      skipUEG(); // log2_max_frame_num_minus4\n      var picOrderCntType = readUEG();\n      if (picOrderCntType === 0) {\n        readUEG(); //log2_max_pic_order_cnt_lsb_minus4\n      } else if (picOrderCntType === 1) {\n        skipBits(1); // delta_pic_order_always_zero_flag\n        skipEG(); // offset_for_non_ref_pic\n        skipEG(); // offset_for_top_to_bottom_field\n        numRefFramesInPicOrderCntCycle = readUEG();\n        for (i = 0; i < numRefFramesInPicOrderCntCycle; i++) {\n          skipEG(); // offset_for_ref_frame[ i ]\n        }\n      }\n      skipUEG(); // max_num_ref_frames\n      skipBits(1); // gaps_in_frame_num_value_allowed_flag\n      picWidthInMbsMinus1 = readUEG();\n      picHeightInMapUnitsMinus1 = readUEG();\n      frameMbsOnlyFlag = readBits(1);\n      if (frameMbsOnlyFlag === 0) {\n        skipBits(1); // mb_adaptive_frame_field_flag\n      }\n      skipBits(1); // direct_8x8_inference_flag\n      if (readBoolean()) {\n        // frame_cropping_flag\n        frameCropLeftOffset = readUEG();\n        frameCropRightOffset = readUEG();\n        frameCropTopOffset = readUEG();\n        frameCropBottomOffset = readUEG();\n      }\n      var pixelRatio = [1, 1];\n      if (readBoolean()) {\n        // vui_parameters_present_flag\n        if (readBoolean()) {\n          // aspect_ratio_info_present_flag\n          var aspectRatioIdc = readUByte();\n          switch (aspectRatioIdc) {\n            case 1:\n              pixelRatio = [1, 1];break;\n            case 2:\n              pixelRatio = [12, 11];break;\n            case 3:\n              pixelRatio = [10, 11];break;\n            case 4:\n              pixelRatio = [16, 11];break;\n            case 5:\n              pixelRatio = [40, 33];break;\n            case 6:\n              pixelRatio = [24, 11];break;\n            case 7:\n              pixelRatio = [20, 11];break;\n            case 8:\n              pixelRatio = [32, 11];break;\n            case 9:\n              pixelRatio = [80, 33];break;\n            case 10:\n              pixelRatio = [18, 11];break;\n            case 11:\n              pixelRatio = [15, 11];break;\n            case 12:\n              pixelRatio = [64, 33];break;\n            case 13:\n              pixelRatio = [160, 99];break;\n            case 14:\n              pixelRatio = [4, 3];break;\n            case 15:\n              pixelRatio = [3, 2];break;\n            case 16:\n              pixelRatio = [2, 1];break;\n            case 255:\n              {\n                pixelRatio = [readUByte() << 8 | readUByte(), readUByte() << 8 | readUByte()];\n                break;\n              }\n          }\n        }\n      }\n      return {\n        width: Math.ceil((picWidthInMbsMinus1 + 1) * 16 - frameCropLeftOffset * 2 - frameCropRightOffset * 2),\n        height: (2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16 - (frameMbsOnlyFlag ? 2 : 4) * (frameCropTopOffset + frameCropBottomOffset),\n        pixelRatio: pixelRatio\n      };\n    }\n  }, {\n    key: 'readSliceType',\n    value: function readSliceType() {\n      // skip NALu type\n      this.readUByte();\n      // discard first_mb_in_slice\n      this.readUEG();\n      // return slice_type\n      return this.readUEG();\n    }\n  }]);\n\n  return ExpGolomb;\n}();\n\nexports.default = ExpGolomb;\n\n},{\"50\":50}],27:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * ID3 parser\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\n\nvar _logger = _dereq_(50);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n//import Hex from '../utils/hex';\n\nvar ID3 = function () {\n  function ID3(data) {\n    _classCallCheck(this, ID3);\n\n    this._hasTimeStamp = false;\n    var offset = 0,\n        byte1,\n        byte2,\n        byte3,\n        byte4,\n        tagSize,\n        endPos,\n        header,\n        len;\n    do {\n      header = this.readUTF(data, offset, 3);\n      offset += 3;\n      // first check for ID3 header\n      if (header === 'ID3') {\n        // skip 24 bits\n        offset += 3;\n        // retrieve tag(s) length\n        byte1 = data[offset++] & 0x7f;\n        byte2 = data[offset++] & 0x7f;\n        byte3 = data[offset++] & 0x7f;\n        byte4 = data[offset++] & 0x7f;\n        tagSize = (byte1 << 21) + (byte2 << 14) + (byte3 << 7) + byte4;\n        endPos = offset + tagSize;\n        //logger.log(`ID3 tag found, size/end: ${tagSize}/${endPos}`);\n\n        // read ID3 tags\n        this._parseID3Frames(data, offset, endPos);\n        offset = endPos;\n      } else if (header === '3DI') {\n        // http://id3.org/id3v2.4.0-structure chapter 3.4.   ID3v2 footer\n        offset += 7;\n        _logger.logger.log('3DI footer found, end: ' + offset);\n      } else {\n        offset -= 3;\n        len = offset;\n        if (len) {\n          //logger.log(`ID3 len: ${len}`);\n          if (!this.hasTimeStamp) {\n            _logger.logger.warn('ID3 tag found, but no timestamp');\n          }\n          this._length = len;\n          this._payload = data.subarray(0, len);\n        }\n        return;\n      }\n    } while (true);\n  }\n\n  _createClass(ID3, [{\n    key: 'readUTF',\n    value: function readUTF(data, start, len) {\n\n      var result = '',\n          offset = start,\n          end = start + len;\n      do {\n        result += String.fromCharCode(data[offset++]);\n      } while (offset < end);\n      return result;\n    }\n  }, {\n    key: '_parseID3Frames',\n    value: function _parseID3Frames(data, offset, endPos) {\n      var tagId, tagLen, tagStart, tagFlags, timestamp;\n      while (offset + 8 <= endPos) {\n        tagId = this.readUTF(data, offset, 4);\n        offset += 4;\n\n        tagLen = data[offset++] << 24 + data[offset++] << 16 + data[offset++] << 8 + data[offset++];\n\n        tagFlags = data[offset++] << 8 + data[offset++];\n\n        tagStart = offset;\n        //logger.log(\"ID3 tag id:\" + tagId);\n        switch (tagId) {\n          case 'PRIV':\n            //logger.log('parse frame:' + Hex.hexDump(data.subarray(offset,endPos)));\n            // owner should be \"com.apple.streaming.transportStreamTimestamp\"\n            if (this.readUTF(data, offset, 44) === 'com.apple.streaming.transportStreamTimestamp') {\n              offset += 44;\n              // smelling even better ! we found the right descriptor\n              // skip null character (string end) + 3 first bytes\n              offset += 4;\n\n              // timestamp is 33 bit expressed as a big-endian eight-octet number, with the upper 31 bits set to zero.\n              var pts33Bit = data[offset++] & 0x1;\n              this._hasTimeStamp = true;\n\n              timestamp = ((data[offset++] << 23) + (data[offset++] << 15) + (data[offset++] << 7) + data[offset++]) / 45;\n\n              if (pts33Bit) {\n                timestamp += 47721858.84; // 2^32 / 90\n              }\n              timestamp = Math.round(timestamp);\n              _logger.logger.trace('ID3 timestamp found: ' + timestamp);\n              this._timeStamp = timestamp;\n            }\n            break;\n          default:\n            break;\n        }\n      }\n    }\n  }, {\n    key: 'hasTimeStamp',\n    get: function get() {\n      return this._hasTimeStamp;\n    }\n  }, {\n    key: 'timeStamp',\n    get: function get() {\n      return this._timeStamp;\n    }\n  }, {\n    key: 'length',\n    get: function get() {\n      return this._length;\n    }\n  }, {\n    key: 'payload',\n    get: function get() {\n      return this._payload;\n    }\n  }]);\n\n  return ID3;\n}();\n\nexports.default = ID3;\n\n},{\"50\":50}],28:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * MP4 demuxer\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n//import {logger} from '../utils/logger';\n\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MP4Demuxer = function () {\n  function MP4Demuxer(observer, remuxer) {\n    _classCallCheck(this, MP4Demuxer);\n\n    this.observer = observer;\n    this.remuxer = remuxer;\n  }\n\n  _createClass(MP4Demuxer, [{\n    key: 'resetTimeStamp',\n    value: function resetTimeStamp() {}\n  }, {\n    key: 'resetInitSegment',\n    value: function resetInitSegment(initSegment, audioCodec, videoCodec, duration) {\n      //jshint unused:false\n      var initData = this.initData = MP4Demuxer.parseInitSegment(initSegment);\n      var tracks = {};\n      if (initData.audio) {\n        tracks.audio = { container: 'audio/mp4', codec: audioCodec, initSegment: initSegment };\n      }\n      if (initData.video) {\n        tracks.video = { container: 'video/mp4', codec: videoCodec, initSegment: initSegment };\n      }\n      this.observer.trigger(_events2.default.FRAG_PARSING_INIT_SEGMENT, { unique: false, tracks: tracks });\n    }\n  }, {\n    key: 'append',\n\n\n    // feed incoming data to the front of the parsing pipeline\n    value: function append(data, timeOffset, contiguous, accurateTimeOffset) {\n      var initData = this.initData;\n      var startDTS = MP4Demuxer.startDTS(initData, data);\n      this.remuxer.remux(initData.audio, initData.video, null, null, startDTS, contiguous, accurateTimeOffset, data);\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {}\n  }], [{\n    key: 'probe',\n    value: function probe(data) {\n      if (data.length >= 8) {\n        var dataType = MP4Demuxer.bin2str(data.subarray(4, 8));\n        return ['moof', 'ftyp', 'styp'].indexOf(dataType) >= 0;\n      }\n      return false;\n    }\n  }, {\n    key: 'bin2str',\n    value: function bin2str(buffer) {\n      return String.fromCharCode.apply(null, buffer);\n    }\n\n    // Find the data for a box specified by its path\n\n  }, {\n    key: 'findBox',\n    value: function findBox(data, path) {\n      var results = [],\n          i,\n          size,\n          type,\n          end,\n          subresults;\n\n      if (!path.length) {\n        // short-circuit the search for empty paths\n        return null;\n      }\n\n      for (i = 0; i < data.byteLength;) {\n        size = data[i] << 24;\n        size |= data[i + 1] << 16;\n        size |= data[i + 2] << 8;\n        size |= data[i + 3];\n\n        type = MP4Demuxer.bin2str(data.subarray(i + 4, i + 8));\n\n        end = size > 1 ? i + size : data.byteLength;\n\n        if (type === path[0]) {\n          if (path.length === 1) {\n            // this is the end of the path and we've found the box we were\n            // looking for\n            results.push(data.subarray(i + 8, end));\n          } else {\n            // recursively search for the next box along the path\n            subresults = MP4Demuxer.findBox(data.subarray(i + 8, end), path.slice(1));\n            if (subresults.length) {\n              results = results.concat(subresults);\n            }\n          }\n        }\n        i = end;\n      }\n\n      // we've finished searching all of data\n      return results;\n    }\n\n    /**\n     * Parses an MP4 initialization segment and extracts stream type and\n     * timescale values for any declared tracks. Timescale values indicate the\n     * number of clock ticks per second to assume for time-based values\n     * elsewhere in the MP4.\n     *\n     * To determine the start time of an MP4, you need two pieces of\n     * information: the timescale unit and the earliest base media decode\n     * time. Multiple timescales can be specified within an MP4 but the\n     * base media decode time is always expressed in the timescale from\n     * the media header box for the track:\n     * ```\n     * moov > trak > mdia > mdhd.timescale\n     * moov > trak > mdia > hdlr\n     * ```\n     * @param init {Uint8Array} the bytes of the init segment\n     * @return {object} a hash of track type to timescale values or null if\n     * the init segment is malformed.\n     */\n\n  }, {\n    key: 'parseInitSegment',\n    value: function parseInitSegment(initSegment) {\n      var result = [];\n      var traks = MP4Demuxer.findBox(initSegment, ['moov', 'trak']);\n\n      traks.forEach(function (trak) {\n        var tkhd = MP4Demuxer.findBox(trak, ['tkhd'])[0];\n        if (tkhd) {\n          var version = tkhd[0];\n          var index = version === 0 ? 12 : 20;\n          var trackId = tkhd[index] << 24 | tkhd[index + 1] << 16 | tkhd[index + 2] << 8 | tkhd[index + 3];\n\n          trackId = trackId < 0 ? 4294967296 + trackId : trackId;\n\n          var mdhd = MP4Demuxer.findBox(trak, ['mdia', 'mdhd'])[0];\n          if (mdhd) {\n            version = mdhd[0];\n            index = version === 0 ? 12 : 20;\n            var timescale = mdhd[index] << 24 | mdhd[index + 1] << 16 | mdhd[index + 2] << 8 | mdhd[index + 3];\n\n            var hdlr = MP4Demuxer.findBox(trak, ['mdia', 'hdlr'])[0];\n            if (hdlr) {\n              var hdlrType = MP4Demuxer.bin2str(hdlr.subarray(8, 12));\n              var type = { 'soun': 'audio', 'vide': 'video' }[hdlrType];\n              if (type) {\n                result[trackId] = { timescale: timescale, type: type };\n                result[type] = { timescale: timescale, id: trackId };\n              }\n            }\n          }\n        }\n      });\n      return result;\n    }\n\n    /**\n     * Determine the base media decode start time, in seconds, for an MP4\n     * fragment. If multiple fragments are specified, the earliest time is\n     * returned.\n     *\n     * The base media decode time can be parsed from track fragment\n     * metadata:\n     * ```\n     * moof > traf > tfdt.baseMediaDecodeTime\n     * ```\n     * It requires the timescale value from the mdhd to interpret.\n     *\n     * @param timescale {object} a hash of track ids to timescale values.\n     * @return {number} the earliest base media decode start time for the\n     * fragment, in seconds\n     */\n\n  }, {\n    key: 'startDTS',\n    value: function startDTS(initData, fragment) {\n      var trafs, baseTimes, result;\n\n      // we need info from two childrend of each track fragment box\n      trafs = MP4Demuxer.findBox(fragment, ['moof', 'traf']);\n\n      // determine the start times for each track\n      baseTimes = [].concat.apply([], trafs.map(function (traf) {\n        return MP4Demuxer.findBox(traf, ['tfhd']).map(function (tfhd) {\n          var id, scale, baseTime;\n\n          // get the track id from the tfhd\n          id = tfhd[4] << 24 | tfhd[5] << 16 | tfhd[6] << 8 | tfhd[7];\n          // assume a 90kHz clock if no timescale was specified\n          scale = initData[id].timescale || 90e3;\n\n          // get the base media decode time from the tfdt\n          baseTime = MP4Demuxer.findBox(traf, ['tfdt']).map(function (tfdt) {\n            var version, result;\n\n            version = tfdt[0];\n            result = tfdt[4] << 24 | tfdt[5] << 16 | tfdt[6] << 8 | tfdt[7];\n            if (version === 1) {\n              result *= Math.pow(2, 32);\n              result += tfdt[8] << 24 | tfdt[9] << 16 | tfdt[10] << 8 | tfdt[11];\n            }\n            return result;\n          })[0];\n          baseTime = baseTime || Infinity;\n\n          // convert base time to seconds\n          return baseTime / scale;\n        });\n      }));\n\n      // return the minimum\n      result = Math.min.apply(null, baseTimes);\n      return isFinite(result) ? result : 0;\n    }\n  }]);\n\n  return MP4Demuxer;\n}();\n\nexports.default = MP4Demuxer;\n\n},{\"33\":33}],29:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * SAMPLE-AES decrypter\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _decrypter = _dereq_(19);\n\nvar _decrypter2 = _interopRequireDefault(_decrypter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SampleAesDecrypter = function () {\n  function SampleAesDecrypter(observer, config, decryptdata, discardEPB) {\n    _classCallCheck(this, SampleAesDecrypter);\n\n    this.decryptdata = decryptdata;\n    this.discardEPB = discardEPB;\n    this.decrypter = new _decrypter2.default(observer, config);\n  }\n\n  _createClass(SampleAesDecrypter, [{\n    key: 'decryptBuffer',\n    value: function decryptBuffer(encryptedData, callback) {\n      this.decrypter.decrypt(encryptedData, this.decryptdata.key.buffer, this.decryptdata.iv.buffer, callback);\n    }\n\n    // AAC - encrypt all full 16 bytes blocks starting from offset 16\n\n  }, {\n    key: 'decryptAacSample',\n    value: function decryptAacSample(samples, sampleIndex, callback, sync) {\n      var curUnit = samples[sampleIndex].unit;\n      var encryptedData = curUnit.subarray(16, curUnit.length - curUnit.length % 16);\n      var encryptedBuffer = encryptedData.buffer.slice(encryptedData.byteOffset, encryptedData.byteOffset + encryptedData.length);\n\n      var localthis = this;\n      this.decryptBuffer(encryptedBuffer, function (decryptedData) {\n        decryptedData = new Uint8Array(decryptedData);\n        curUnit.set(decryptedData, 16);\n\n        if (!sync) {\n          localthis.decryptAacSamples(samples, sampleIndex + 1, callback);\n        }\n      });\n    }\n  }, {\n    key: 'decryptAacSamples',\n    value: function decryptAacSamples(samples, sampleIndex, callback) {\n      for (;; sampleIndex++) {\n        if (sampleIndex >= samples.length) {\n          callback();\n          return;\n        }\n\n        if (samples[sampleIndex].unit.length < 32) {\n          continue;\n        }\n\n        var sync = this.decrypter.isSync();\n\n        this.decryptAacSample(samples, sampleIndex, callback, sync);\n\n        if (!sync) {\n          return;\n        }\n      }\n    }\n\n    // AVC - encrypt one 16 bytes block out of ten, starting from offset 32\n\n  }, {\n    key: 'getAvcEncryptedData',\n    value: function getAvcEncryptedData(decodedData) {\n      var encryptedDataLen = Math.floor((decodedData.length - 48) / 160) * 16 + 16;\n      var encryptedData = new Int8Array(encryptedDataLen);\n      var outputPos = 0;\n      for (var inputPos = 32; inputPos <= decodedData.length - 16; inputPos += 160, outputPos += 16) {\n        encryptedData.set(decodedData.subarray(inputPos, inputPos + 16), outputPos);\n      }\n      return encryptedData;\n    }\n  }, {\n    key: 'getAvcDecryptedUnit',\n    value: function getAvcDecryptedUnit(decodedData, decryptedData) {\n      decryptedData = new Uint8Array(decryptedData);\n      var inputPos = 0;\n      for (var outputPos = 32; outputPos <= decodedData.length - 16; outputPos += 160, inputPos += 16) {\n        decodedData.set(decryptedData.subarray(inputPos, inputPos + 16), outputPos);\n      }\n      return decodedData;\n    }\n  }, {\n    key: 'decryptAvcSample',\n    value: function decryptAvcSample(samples, sampleIndex, unitIndex, callback, curUnit, sync) {\n      var decodedData = this.discardEPB(curUnit.data);\n      var encryptedData = this.getAvcEncryptedData(decodedData);\n      var localthis = this;\n\n      this.decryptBuffer(encryptedData.buffer, function (decryptedData) {\n        curUnit.data = localthis.getAvcDecryptedUnit(decodedData, decryptedData);\n\n        if (!sync) {\n          localthis.decryptAvcSamples(samples, sampleIndex, unitIndex + 1, callback);\n        }\n      });\n    }\n  }, {\n    key: 'decryptAvcSamples',\n    value: function decryptAvcSamples(samples, sampleIndex, unitIndex, callback) {\n      for (;; sampleIndex++, unitIndex = 0) {\n        if (sampleIndex >= samples.length) {\n          callback();\n          return;\n        }\n\n        var curUnits = samples[sampleIndex].units.units;\n        for (;; unitIndex++) {\n          if (unitIndex >= curUnits.length) {\n            break;\n          }\n\n          var curUnit = curUnits[unitIndex];\n          if (curUnit.length <= 48 || curUnit.type !== 1 && curUnit.type !== 5) {\n            continue;\n          }\n\n          var sync = this.decrypter.isSync();\n\n          this.decryptAvcSample(samples, sampleIndex, unitIndex, callback, curUnit, sync);\n\n          if (!sync) {\n            return;\n          }\n        }\n      }\n    }\n  }]);\n\n  return SampleAesDecrypter;\n}();\n\nexports.default = SampleAesDecrypter;\n\n},{\"19\":19}],30:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * highly optimized TS demuxer:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * parse PAT, PMT\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * extract PES packet from audio and video PIDs\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * extract AVC/H264 NAL units and AAC/ADTS samples from PES packet\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * trigger the remuxer upon parsing completion\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * it also tries to workaround as best as it can audio codec switch (HE-AAC to AAC and vice versa), without having to restart the MediaSource.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * it also controls the remuxing process :\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * upon discontinuity or level switch detection, it will also notifies the remuxer so that it can reset its state.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n// import Hex from '../utils/hex';\n\n\nvar _adts = _dereq_(22);\n\nvar _adts2 = _interopRequireDefault(_adts);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _expGolomb = _dereq_(26);\n\nvar _expGolomb2 = _interopRequireDefault(_expGolomb);\n\nvar _sampleAes = _dereq_(29);\n\nvar _sampleAes2 = _interopRequireDefault(_sampleAes);\n\nvar _logger = _dereq_(50);\n\nvar _errors = _dereq_(31);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TSDemuxer = function () {\n  function TSDemuxer(observer, remuxer, config, typeSupported) {\n    _classCallCheck(this, TSDemuxer);\n\n    this.observer = observer;\n    this.config = config;\n    this.typeSupported = typeSupported;\n    this.remuxer = remuxer;\n    this.sampleAes = null;\n  }\n\n  _createClass(TSDemuxer, [{\n    key: 'setDecryptData',\n    value: function setDecryptData(decryptdata) {\n      if (decryptdata != null && decryptdata.key != null && decryptdata.method === 'SAMPLE-AES') {\n        this.sampleAes = new _sampleAes2.default(this.observer, this.config, decryptdata, this.discardEPB);\n      } else {\n        this.sampleAes = null;\n      }\n    }\n  }, {\n    key: 'resetInitSegment',\n    value: function resetInitSegment(initSegment, audioCodec, videoCodec, duration) {\n      this.pmtParsed = false;\n      this._pmtId = -1;\n      this._avcTrack = { container: 'video/mp2t', type: 'video', id: -1, sequenceNumber: 0, samples: [], len: 0, dropped: 0 };\n      this._audioTrack = { container: 'video/mp2t', type: 'audio', id: -1, sequenceNumber: 0, samples: [], len: 0, isAAC: true };\n      this._id3Track = { type: 'id3', id: -1, sequenceNumber: 0, samples: [], len: 0 };\n      this._txtTrack = { type: 'text', id: -1, sequenceNumber: 0, samples: [], len: 0 };\n      // flush any partial content\n      this.aacOverFlow = null;\n      this.aacLastPTS = null;\n      this.avcSample = null;\n      this.audioCodec = audioCodec;\n      this.videoCodec = videoCodec;\n      this._duration = duration;\n    }\n  }, {\n    key: 'resetTimeStamp',\n    value: function resetTimeStamp() {}\n\n    // feed incoming data to the front of the parsing pipeline\n\n  }, {\n    key: 'append',\n    value: function append(data, timeOffset, contiguous, accurateTimeOffset) {\n      var start,\n          len = data.length,\n          stt,\n          pid,\n          atf,\n          offset,\n          pes,\n          unknownPIDs = false;\n      this.contiguous = contiguous;\n      var pmtParsed = this.pmtParsed,\n          avcTrack = this._avcTrack,\n          audioTrack = this._audioTrack,\n          id3Track = this._id3Track,\n          avcId = avcTrack.id,\n          audioId = audioTrack.id,\n          id3Id = id3Track.id,\n          pmtId = this._pmtId,\n          avcData = avcTrack.pesData,\n          audioData = audioTrack.pesData,\n          id3Data = id3Track.pesData,\n          parsePAT = this._parsePAT,\n          parsePMT = this._parsePMT,\n          parsePES = this._parsePES,\n          parseAVCPES = this._parseAVCPES.bind(this),\n          parseAACPES = this._parseAACPES.bind(this),\n          parseMPEGPES = this._parseMPEGPES.bind(this),\n          parseID3PES = this._parseID3PES.bind(this);\n\n      // don't parse last TS packet if incomplete\n      len -= len % 188;\n      // loop through TS packets\n      for (start = 0; start < len; start += 188) {\n        if (data[start] === 0x47) {\n          stt = !!(data[start + 1] & 0x40);\n          // pid is a 13-bit field starting at the last bit of TS[1]\n          pid = ((data[start + 1] & 0x1f) << 8) + data[start + 2];\n          atf = (data[start + 3] & 0x30) >> 4;\n          // if an adaption field is present, its length is specified by the fifth byte of the TS packet header.\n          if (atf > 1) {\n            offset = start + 5 + data[start + 4];\n            // continue if there is only adaptation field\n            if (offset === start + 188) {\n              continue;\n            }\n          } else {\n            offset = start + 4;\n          }\n          switch (pid) {\n            case avcId:\n              if (stt) {\n                if (avcData && (pes = parsePES(avcData))) {\n                  parseAVCPES(pes, false);\n                }\n                avcData = { data: [], size: 0 };\n              }\n              if (avcData) {\n                avcData.data.push(data.subarray(offset, start + 188));\n                avcData.size += start + 188 - offset;\n              }\n              break;\n            case audioId:\n              if (stt) {\n                if (audioData && (pes = parsePES(audioData))) {\n                  if (audioTrack.isAAC) {\n                    parseAACPES(pes);\n                  } else {\n                    parseMPEGPES(pes);\n                  }\n                }\n                audioData = { data: [], size: 0 };\n              }\n              if (audioData) {\n                audioData.data.push(data.subarray(offset, start + 188));\n                audioData.size += start + 188 - offset;\n              }\n              break;\n            case id3Id:\n              if (stt) {\n                if (id3Data && (pes = parsePES(id3Data))) {\n                  parseID3PES(pes);\n                }\n                id3Data = { data: [], size: 0 };\n              }\n              if (id3Data) {\n                id3Data.data.push(data.subarray(offset, start + 188));\n                id3Data.size += start + 188 - offset;\n              }\n              break;\n            case 0:\n              if (stt) {\n                offset += data[offset] + 1;\n              }\n              pmtId = this._pmtId = parsePAT(data, offset);\n              break;\n            case pmtId:\n              if (stt) {\n                offset += data[offset] + 1;\n              }\n              var parsedPIDs = parsePMT(data, offset, this.typeSupported.mpeg === true || this.typeSupported.mp3 === true, this.sampleAes != null);\n\n              // only update track id if track PID found while parsing PMT\n              // this is to avoid resetting the PID to -1 in case\n              // track PID transiently disappears from the stream\n              // this could happen in case of transient missing audio samples for example\n              avcId = parsedPIDs.avc;\n              if (avcId > 0) {\n                avcTrack.id = avcId;\n              }\n              audioId = parsedPIDs.audio;\n              if (audioId > 0) {\n                audioTrack.id = audioId;\n                audioTrack.isAAC = parsedPIDs.isAAC;\n              }\n              id3Id = parsedPIDs.id3;\n              if (id3Id > 0) {\n                id3Track.id = id3Id;\n              }\n              if (unknownPIDs && !pmtParsed) {\n                _logger.logger.log('reparse from beginning');\n                unknownPIDs = false;\n                // we set it to -188, the += 188 in the for loop will reset start to 0\n                start = -188;\n              }\n              pmtParsed = this.pmtParsed = true;\n              break;\n            case 17:\n            case 0x1fff:\n              break;\n            default:\n              unknownPIDs = true;\n              break;\n          }\n        } else {\n          this.observer.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'TS packet did not start with 0x47' });\n        }\n      }\n      // try to parse last PES packets\n      if (avcData && (pes = parsePES(avcData))) {\n        parseAVCPES(pes, true);\n        avcTrack.pesData = null;\n      } else {\n        // either avcData null or PES truncated, keep it for next frag parsing\n        avcTrack.pesData = avcData;\n      }\n\n      if (audioData && (pes = parsePES(audioData))) {\n        if (audioTrack.isAAC) {\n          parseAACPES(pes);\n        } else {\n          parseMPEGPES(pes);\n        }\n        audioTrack.pesData = null;\n      } else {\n        if (audioData && audioData.size) {\n          _logger.logger.log('last AAC PES packet truncated,might overlap between fragments');\n        }\n        // either audioData null or PES truncated, keep it for next frag parsing\n        audioTrack.pesData = audioData;\n      }\n\n      if (id3Data && (pes = parsePES(id3Data))) {\n        parseID3PES(pes);\n        id3Track.pesData = null;\n      } else {\n        // either id3Data null or PES truncated, keep it for next frag parsing\n        id3Track.pesData = id3Data;\n      }\n\n      if (this.sampleAes == null) {\n        this.remuxer.remux(audioTrack, avcTrack, id3Track, this._txtTrack, timeOffset, contiguous, accurateTimeOffset);\n      } else {\n        this.decryptAndRemux(audioTrack, avcTrack, id3Track, this._txtTrack, timeOffset, contiguous, accurateTimeOffset);\n      }\n    }\n  }, {\n    key: 'decryptAndRemux',\n    value: function decryptAndRemux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n      var _this = this;\n\n      if (audioTrack.samples && audioTrack.isAAC) {\n        (function () {\n          var localthis = _this;\n          _this.sampleAes.decryptAacSamples(audioTrack.samples, 0, function () {\n            localthis.decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n          });\n        })();\n      } else {\n        this.decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n      }\n    }\n  }, {\n    key: 'decryptAndRemuxAvc',\n    value: function decryptAndRemuxAvc(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n      var _this2 = this;\n\n      if (videoTrack.samples) {\n        (function () {\n          var localthis = _this2;\n          _this2.sampleAes.decryptAvcSamples(videoTrack.samples, 0, 0, function () {\n            localthis.remuxer.remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n          });\n        })();\n      } else {\n        this.remuxer.remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset);\n      }\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this._initPTS = this._initDTS = undefined;\n      this._duration = 0;\n    }\n  }, {\n    key: '_parsePAT',\n    value: function _parsePAT(data, offset) {\n      // skip the PSI header and parse the first PMT entry\n      return (data[offset + 10] & 0x1F) << 8 | data[offset + 11];\n      //logger.log('PMT PID:'  + this._pmtId);\n    }\n  }, {\n    key: '_parsePMT',\n    value: function _parsePMT(data, offset, mpegSupported, isSampleAes) {\n      var sectionLength,\n          tableEnd,\n          programInfoLength,\n          pid,\n          result = { audio: -1, avc: -1, id3: -1, isAAC: true };\n      sectionLength = (data[offset + 1] & 0x0f) << 8 | data[offset + 2];\n      tableEnd = offset + 3 + sectionLength - 4;\n      // to determine where the table is, we have to figure out how\n      // long the program info descriptors are\n      programInfoLength = (data[offset + 10] & 0x0f) << 8 | data[offset + 11];\n      // advance the offset to the first entry in the mapping table\n      offset += 12 + programInfoLength;\n      while (offset < tableEnd) {\n        pid = (data[offset + 1] & 0x1F) << 8 | data[offset + 2];\n        switch (data[offset]) {\n          case 0xcf:\n            // SAMPLE-AES AAC\n            if (!isSampleAes) {\n              _logger.logger.log('unkown stream type:' + data[offset]);\n              break;\n            }\n          /* falls through */\n\n          // ISO/IEC 13818-7 ADTS AAC (MPEG-2 lower bit-rate audio)\n          case 0x0f:\n            //logger.log('AAC PID:'  + pid);\n            if (result.audio === -1) {\n              result.audio = pid;\n            }\n            break;\n\n          // Packetized metadata (ID3)\n          case 0x15:\n            //logger.log('ID3 PID:'  + pid);\n            if (result.id3 === -1) {\n              result.id3 = pid;\n            }\n            break;\n\n          case 0xdb:\n            // SAMPLE-AES AVC\n            if (!isSampleAes) {\n              _logger.logger.log('unkown stream type:' + data[offset]);\n              break;\n            }\n          /* falls through */\n\n          // ITU-T Rec. H.264 and ISO/IEC 14496-10 (lower bit-rate video)\n          case 0x1b:\n            //logger.log('AVC PID:'  + pid);\n            if (result.avc === -1) {\n              result.avc = pid;\n            }\n            break;\n\n          // ISO/IEC 11172-3 (MPEG-1 audio)\n          // or ISO/IEC 13818-3 (MPEG-2 halved sample rate audio)\n          case 0x03:\n          case 0x04:\n            //logger.log('MPEG PID:'  + pid);\n            if (!mpegSupported) {\n              _logger.logger.log('MPEG audio found, not supported in this browser for now');\n            } else if (result.audio === -1) {\n              result.audio = pid;\n              result.isAAC = false;\n            }\n            break;\n\n          case 0x24:\n            _logger.logger.warn('HEVC stream type found, not supported for now');\n            break;\n\n          default:\n            _logger.logger.log('unkown stream type:' + data[offset]);\n            break;\n        }\n        // move to the next table entry\n        // skip past the elementary stream descriptors, if present\n        offset += ((data[offset + 3] & 0x0F) << 8 | data[offset + 4]) + 5;\n      }\n      return result;\n    }\n  }, {\n    key: '_parsePES',\n    value: function _parsePES(stream) {\n      var i = 0,\n          frag,\n          pesFlags,\n          pesPrefix,\n          pesLen,\n          pesHdrLen,\n          pesData,\n          pesPts,\n          pesDts,\n          payloadStartOffset,\n          data = stream.data;\n      // safety check\n      if (!stream || stream.size === 0) {\n        return null;\n      }\n\n      // we might need up to 19 bytes to read PES header\n      // if first chunk of data is less than 19 bytes, let's merge it with following ones until we get 19 bytes\n      // usually only one merge is needed (and this is rare ...)\n      while (data[0].length < 19 && data.length > 1) {\n        var newData = new Uint8Array(data[0].length + data[1].length);\n        newData.set(data[0]);\n        newData.set(data[1], data[0].length);\n        data[0] = newData;\n        data.splice(1, 1);\n      }\n      //retrieve PTS/DTS from first fragment\n      frag = data[0];\n      pesPrefix = (frag[0] << 16) + (frag[1] << 8) + frag[2];\n      if (pesPrefix === 1) {\n        pesLen = (frag[4] << 8) + frag[5];\n        // if PES parsed length is not zero and greater than total received length, stop parsing. PES might be truncated\n        // minus 6 : PES header size\n        if (pesLen && pesLen > stream.size - 6) {\n          return null;\n        }\n        pesFlags = frag[7];\n        if (pesFlags & 0xC0) {\n          /* PES header described here : http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n              as PTS / DTS is 33 bit we cannot use bitwise operator in JS,\n              as Bitwise operators treat their operands as a sequence of 32 bits */\n          pesPts = (frag[9] & 0x0E) * 536870912 + // 1 << 29\n          (frag[10] & 0xFF) * 4194304 + // 1 << 22\n          (frag[11] & 0xFE) * 16384 + // 1 << 14\n          (frag[12] & 0xFF) * 128 + // 1 << 7\n          (frag[13] & 0xFE) / 2;\n          // check if greater than 2^32 -1\n          if (pesPts > 4294967295) {\n            // decrement 2^33\n            pesPts -= 8589934592;\n          }\n          if (pesFlags & 0x40) {\n            pesDts = (frag[14] & 0x0E) * 536870912 + // 1 << 29\n            (frag[15] & 0xFF) * 4194304 + // 1 << 22\n            (frag[16] & 0xFE) * 16384 + // 1 << 14\n            (frag[17] & 0xFF) * 128 + // 1 << 7\n            (frag[18] & 0xFE) / 2;\n            // check if greater than 2^32 -1\n            if (pesDts > 4294967295) {\n              // decrement 2^33\n              pesDts -= 8589934592;\n            }\n            if (pesPts - pesDts > 60 * 90000) {\n              _logger.logger.warn(Math.round((pesPts - pesDts) / 90000) + 's delta between PTS and DTS, align them');\n              pesPts = pesDts;\n            }\n          } else {\n            pesDts = pesPts;\n          }\n        }\n        pesHdrLen = frag[8];\n        // 9 bytes : 6 bytes for PES header + 3 bytes for PES extension\n        payloadStartOffset = pesHdrLen + 9;\n\n        stream.size -= payloadStartOffset;\n        //reassemble PES packet\n        pesData = new Uint8Array(stream.size);\n        for (var j = 0, dataLen = data.length; j < dataLen; j++) {\n          frag = data[j];\n          var len = frag.byteLength;\n          if (payloadStartOffset) {\n            if (payloadStartOffset > len) {\n              // trim full frag if PES header bigger than frag\n              payloadStartOffset -= len;\n              continue;\n            } else {\n              // trim partial frag if PES header smaller than frag\n              frag = frag.subarray(payloadStartOffset);\n              len -= payloadStartOffset;\n              payloadStartOffset = 0;\n            }\n          }\n          pesData.set(frag, i);\n          i += len;\n        }\n        if (pesLen) {\n          // payload size : remove PES header + PES extension\n          pesLen -= pesHdrLen + 3;\n        }\n        return { data: pesData, pts: pesPts, dts: pesDts, len: pesLen };\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: 'pushAccesUnit',\n    value: function pushAccesUnit(avcSample, avcTrack) {\n      if (avcSample.units.units.length && avcSample.frame) {\n        // only push AVC sample if starting with a keyframe is not mandatory OR\n        //    if keyframe already found in this fragment OR\n        //       keyframe found in last fragment (track.sps) AND\n        //          samples already appended (we already found a keyframe in this fragment) OR fragment is contiguous\n        if (!this.config.forceKeyFrameOnDiscontinuity || avcSample.key === true || avcTrack.sps && (avcTrack.samples.length || this.contiguous)) {\n          avcTrack.samples.push(avcSample);\n        } else {\n          // dropped samples, track it\n          avcTrack.dropped++;\n        }\n      }\n      if (avcSample.debug.length) {\n        _logger.logger.log(avcSample.pts + '/' + avcSample.dts + ':' + avcSample.debug + ',' + avcSample.units.length);\n      }\n    }\n  }, {\n    key: '_parseAVCPES',\n    value: function _parseAVCPES(pes, last) {\n      var _this3 = this;\n\n      //logger.log('parse new PES');\n      var track = this._avcTrack,\n          units = this._parseAVCNALu(pes.data),\n          debug = false,\n          expGolombDecoder,\n          avcSample = this.avcSample,\n          push,\n          i;\n      //free pes.data to save up some memory\n      pes.data = null;\n\n      units.forEach(function (unit) {\n        switch (unit.type) {\n          //NDR\n          case 1:\n            push = true;\n            if (debug && avcSample) {\n              avcSample.debug += 'NDR ';\n            }\n            avcSample.frame = true;\n            // retrieve slice type by parsing beginning of NAL unit (follow H264 spec, slice_header definition) to detect keyframe embedded in NDR\n            var data = unit.data;\n            if (data.length > 4) {\n              var sliceType = new _expGolomb2.default(data).readSliceType();\n              // 2 : I slice, 4 : SI slice, 7 : I slice, 9: SI slice\n              // SI slice : A slice that is coded using intra prediction only and using quantisation of the prediction samples.\n              // An SI slice can be coded such that its decoded samples can be constructed identically to an SP slice.\n              // I slice: A slice that is not an SI slice that is decoded using intra prediction only.\n              //if (sliceType === 2 || sliceType === 7) {\n              if (sliceType === 2 || sliceType === 4 || sliceType === 7 || sliceType === 9) {\n                avcSample.key = true;\n              }\n            }\n            break;\n          //IDR\n          case 5:\n            push = true;\n            // handle PES not starting with AUD\n            if (!avcSample) {\n              avcSample = _this3.avcSample = _this3._createAVCSample(true, pes.pts, pes.dts, '');\n            }\n            if (debug) {\n              avcSample.debug += 'IDR ';\n            }\n            avcSample.key = true;\n            avcSample.frame = true;\n            break;\n          //SEI\n          case 6:\n            push = true;\n            if (debug && avcSample) {\n              avcSample.debug += 'SEI ';\n            }\n            expGolombDecoder = new _expGolomb2.default(_this3.discardEPB(unit.data));\n\n            // skip frameType\n            expGolombDecoder.readUByte();\n\n            var payloadType = 0;\n            var payloadSize = 0;\n            var endOfCaptions = false;\n            var b = 0;\n\n            while (!endOfCaptions && expGolombDecoder.bytesAvailable > 1) {\n              payloadType = 0;\n              do {\n                b = expGolombDecoder.readUByte();\n                payloadType += b;\n              } while (b === 0xFF);\n\n              // Parse payload size.\n              payloadSize = 0;\n              do {\n                b = expGolombDecoder.readUByte();\n                payloadSize += b;\n              } while (b === 0xFF);\n\n              // TODO: there can be more than one payload in an SEI packet...\n              // TODO: need to read type and size in a while loop to get them all\n              if (payloadType === 4 && expGolombDecoder.bytesAvailable !== 0) {\n\n                endOfCaptions = true;\n\n                var countryCode = expGolombDecoder.readUByte();\n\n                if (countryCode === 181) {\n                  var providerCode = expGolombDecoder.readUShort();\n\n                  if (providerCode === 49) {\n                    var userStructure = expGolombDecoder.readUInt();\n\n                    if (userStructure === 0x47413934) {\n                      var userDataType = expGolombDecoder.readUByte();\n\n                      // Raw CEA-608 bytes wrapped in CEA-708 packet\n                      if (userDataType === 3) {\n                        var firstByte = expGolombDecoder.readUByte();\n                        var secondByte = expGolombDecoder.readUByte();\n\n                        var totalCCs = 31 & firstByte;\n                        var byteArray = [firstByte, secondByte];\n\n                        for (i = 0; i < totalCCs; i++) {\n                          // 3 bytes per CC\n                          byteArray.push(expGolombDecoder.readUByte());\n                          byteArray.push(expGolombDecoder.readUByte());\n                          byteArray.push(expGolombDecoder.readUByte());\n                        }\n\n                        _this3._insertSampleInOrder(_this3._txtTrack.samples, { type: 3, pts: pes.pts, bytes: byteArray });\n                      }\n                    }\n                  }\n                }\n              } else if (payloadSize < expGolombDecoder.bytesAvailable) {\n                for (i = 0; i < payloadSize; i++) {\n                  expGolombDecoder.readUByte();\n                }\n              }\n            }\n            break;\n          //SPS\n          case 7:\n            push = true;\n            if (debug && avcSample) {\n              avcSample.debug += 'SPS ';\n            }\n            if (!track.sps) {\n              expGolombDecoder = new _expGolomb2.default(unit.data);\n              var config = expGolombDecoder.readSPS();\n              track.width = config.width;\n              track.height = config.height;\n              track.pixelRatio = config.pixelRatio;\n              track.sps = [unit.data];\n              track.duration = _this3._duration;\n              var codecarray = unit.data.subarray(1, 4);\n              var codecstring = 'avc1.';\n              for (i = 0; i < 3; i++) {\n                var h = codecarray[i].toString(16);\n                if (h.length < 2) {\n                  h = '0' + h;\n                }\n                codecstring += h;\n              }\n              track.codec = codecstring;\n            }\n            break;\n          //PPS\n          case 8:\n            push = true;\n            if (debug && avcSample) {\n              avcSample.debug += 'PPS ';\n            }\n            if (!track.pps) {\n              track.pps = [unit.data];\n            }\n            break;\n          // AUD\n          case 9:\n            push = false;\n            if (avcSample) {\n              _this3.pushAccesUnit(avcSample, track);\n            }\n            avcSample = _this3.avcSample = _this3._createAVCSample(false, pes.pts, pes.dts, debug ? 'AUD ' : '');\n            break;\n          // Filler Data\n          case 12:\n            push = false;\n            break;\n          default:\n            push = false;\n            if (avcSample) {\n              avcSample.debug += 'unknown NAL ' + unit.type + ' ';\n            }\n            break;\n        }\n        if (avcSample && push) {\n          var _units = avcSample.units;\n          _units.units.push(unit);\n        }\n      });\n      // if last PES packet, push samples\n      if (last && avcSample) {\n        this.pushAccesUnit(avcSample, track);\n        this.avcSample = null;\n      }\n    }\n  }, {\n    key: '_createAVCSample',\n    value: function _createAVCSample(key, pts, dts, debug) {\n      return { key: key, pts: pts, dts: dts, units: { units: [], length: 0 }, debug: debug };\n    }\n  }, {\n    key: '_insertSampleInOrder',\n    value: function _insertSampleInOrder(arr, data) {\n      var len = arr.length;\n      if (len > 0) {\n        if (data.pts >= arr[len - 1].pts) {\n          arr.push(data);\n        } else {\n          for (var pos = len - 1; pos >= 0; pos--) {\n            if (data.pts < arr[pos].pts) {\n              arr.splice(pos, 0, data);\n              break;\n            }\n          }\n        }\n      } else {\n        arr.push(data);\n      }\n    }\n  }, {\n    key: '_getLastNalUnit',\n    value: function _getLastNalUnit() {\n      var avcSample = this.avcSample,\n          lastUnit = void 0;\n      // try to fallback to previous sample if current one is empty\n      if (!avcSample || avcSample.units.units.length === 0) {\n        var track = this._avcTrack,\n            samples = track.samples;\n        avcSample = samples[samples.length - 1];\n      }\n      if (avcSample) {\n        var units = avcSample.units.units;\n        lastUnit = units[units.length - 1];\n      }\n      return lastUnit;\n    }\n  }, {\n    key: '_parseAVCNALu',\n    value: function _parseAVCNALu(array) {\n      var i = 0,\n          len = array.byteLength,\n          value,\n          overflow,\n          track = this._avcTrack,\n          state = track.naluState || 0,\n          lastState = state;\n      var units = [],\n          unit,\n          unitType,\n          lastUnitStart = -1,\n          lastUnitType;\n      //logger.log('PES:' + Hex.hexDump(array));\n\n      if (state === -1) {\n        // special use case where we found 3 or 4-byte start codes exactly at the end of previous PES packet\n        lastUnitStart = 0;\n        // NALu type is value read from offset 0\n        lastUnitType = array[0] & 0x1f;\n        state = 0;\n        i = 1;\n      }\n\n      while (i < len) {\n        value = array[i++];\n        // optimization. state 0 and 1 are the predominant case. let's handle them outside of the switch/case\n        if (!state) {\n          state = value ? 0 : 1;\n          continue;\n        }\n        if (state === 1) {\n          state = value ? 0 : 2;\n          continue;\n        }\n        // here we have state either equal to 2 or 3\n        if (!value) {\n          state = 3;\n        } else if (value === 1) {\n          if (lastUnitStart >= 0) {\n            unit = { data: array.subarray(lastUnitStart, i - state - 1), type: lastUnitType };\n            //logger.log('pushing NALU, type/size:' + unit.type + '/' + unit.data.byteLength);\n            units.push(unit);\n          } else {\n            // lastUnitStart is undefined => this is the first start code found in this PES packet\n            // first check if start code delimiter is overlapping between 2 PES packets,\n            // ie it started in last packet (lastState not zero)\n            // and ended at the beginning of this PES packet (i <= 4 - lastState)\n            var lastUnit = this._getLastNalUnit();\n            if (lastUnit) {\n              if (lastState && i <= 4 - lastState) {\n                // start delimiter overlapping between PES packets\n                // strip start delimiter bytes from the end of last NAL unit\n                // check if lastUnit had a state different from zero\n                if (lastUnit.state) {\n                  // strip last bytes\n                  lastUnit.data = lastUnit.data.subarray(0, lastUnit.data.byteLength - lastState);\n                }\n              }\n              // If NAL units are not starting right at the beginning of the PES packet, push preceding data into previous NAL unit.\n              overflow = i - state - 1;\n              if (overflow > 0) {\n                //logger.log('first NALU found with overflow:' + overflow);\n                var tmp = new Uint8Array(lastUnit.data.byteLength + overflow);\n                tmp.set(lastUnit.data, 0);\n                tmp.set(array.subarray(0, overflow), lastUnit.data.byteLength);\n                lastUnit.data = tmp;\n              }\n            }\n          }\n          // check if we can read unit type\n          if (i < len) {\n            unitType = array[i] & 0x1f;\n            //logger.log('find NALU @ offset:' + i + ',type:' + unitType);\n            lastUnitStart = i;\n            lastUnitType = unitType;\n            state = 0;\n          } else {\n            // not enough byte to read unit type. let's read it on next PES parsing\n            state = -1;\n          }\n        } else {\n          state = 0;\n        }\n      }\n      if (lastUnitStart >= 0 && state >= 0) {\n        unit = { data: array.subarray(lastUnitStart, len), type: lastUnitType, state: state };\n        units.push(unit);\n        //logger.log('pushing NALU, type/size/state:' + unit.type + '/' + unit.data.byteLength + '/' + state);\n      }\n      // no NALu found\n      if (units.length === 0) {\n        // append pes.data to previous NAL unit\n        var _lastUnit = this._getLastNalUnit();\n        if (_lastUnit) {\n          var _tmp = new Uint8Array(_lastUnit.data.byteLength + array.byteLength);\n          _tmp.set(_lastUnit.data, 0);\n          _tmp.set(array, _lastUnit.data.byteLength);\n          _lastUnit.data = _tmp;\n        }\n      }\n      track.naluState = state;\n      return units;\n    }\n\n    /**\n     * remove Emulation Prevention bytes from a RBSP\n     */\n\n  }, {\n    key: 'discardEPB',\n    value: function discardEPB(data) {\n      var length = data.byteLength,\n          EPBPositions = [],\n          i = 1,\n          newLength,\n          newData;\n\n      // Find all `Emulation Prevention Bytes`\n      while (i < length - 2) {\n        if (data[i] === 0 && data[i + 1] === 0 && data[i + 2] === 0x03) {\n          EPBPositions.push(i + 2);\n          i += 2;\n        } else {\n          i++;\n        }\n      }\n\n      // If no Emulation Prevention Bytes were found just return the original\n      // array\n      if (EPBPositions.length === 0) {\n        return data;\n      }\n\n      // Create a new array to hold the NAL unit data\n      newLength = length - EPBPositions.length;\n      newData = new Uint8Array(newLength);\n      var sourceIndex = 0;\n\n      for (i = 0; i < newLength; sourceIndex++, i++) {\n        if (sourceIndex === EPBPositions[0]) {\n          // Skip this byte\n          sourceIndex++;\n          // Remove this position index\n          EPBPositions.shift();\n        }\n        newData[i] = data[sourceIndex];\n      }\n      return newData;\n    }\n  }, {\n    key: '_parseAACPES',\n    value: function _parseAACPES(pes) {\n      var track = this._audioTrack,\n          data = pes.data,\n          pts = pes.pts,\n          startOffset = 0,\n          aacOverFlow = this.aacOverFlow,\n          aacLastPTS = this.aacLastPTS,\n          config,\n          frameLength,\n          frameDuration,\n          frameIndex,\n          offset,\n          headerLength,\n          stamp,\n          len,\n          aacSample;\n      if (aacOverFlow) {\n        var tmp = new Uint8Array(aacOverFlow.byteLength + data.byteLength);\n        tmp.set(aacOverFlow, 0);\n        tmp.set(data, aacOverFlow.byteLength);\n        //logger.log(`AAC: append overflowing ${aacOverFlow.byteLength} bytes to beginning of new PES`);\n        data = tmp;\n      }\n      // look for ADTS header (0xFFFx)\n      for (offset = startOffset, len = data.length; offset < len - 1; offset++) {\n        if (data[offset] === 0xff && (data[offset + 1] & 0xf0) === 0xf0) {\n          break;\n        }\n      }\n      // if ADTS header does not start straight from the beginning of the PES payload, raise an error\n      if (offset) {\n        var reason, fatal;\n        if (offset < len - 1) {\n          reason = 'AAC PES did not start with ADTS header,offset:' + offset;\n          fatal = false;\n        } else {\n          reason = 'no ADTS header found in AAC PES';\n          fatal = true;\n        }\n        _logger.logger.warn('parsing error:' + reason);\n        this.observer.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_PARSING_ERROR, fatal: fatal, reason: reason });\n        if (fatal) {\n          return;\n        }\n      }\n      if (!track.audiosamplerate) {\n        var audioCodec = this.audioCodec;\n        config = _adts2.default.getAudioConfig(this.observer, data, offset, audioCodec);\n        track.config = config.config;\n        track.audiosamplerate = config.samplerate;\n        track.channelCount = config.channelCount;\n        track.codec = config.codec;\n        track.manifestCodec = config.manifestCodec;\n        track.duration = this._duration;\n        _logger.logger.log('parsed codec:' + track.codec + ',rate:' + config.samplerate + ',nb channel:' + config.channelCount);\n      }\n      frameIndex = 0;\n      frameDuration = 1024 * 90000 / track.audiosamplerate;\n\n      // if last AAC frame is overflowing, we should ensure timestamps are contiguous:\n      // first sample PTS should be equal to last sample PTS + frameDuration\n      if (aacOverFlow && aacLastPTS) {\n        var newPTS = aacLastPTS + frameDuration;\n        if (Math.abs(newPTS - pts) > 1) {\n          _logger.logger.log('AAC: align PTS for overlapping frames by ' + Math.round((newPTS - pts) / 90));\n          pts = newPTS;\n        }\n      }\n\n      while (offset + 5 < len) {\n        // The protection skip bit tells us if we have 2 bytes of CRC data at the end of the ADTS header\n        headerLength = !!(data[offset + 1] & 0x01) ? 7 : 9;\n        // retrieve frame size\n        frameLength = (data[offset + 3] & 0x03) << 11 | data[offset + 4] << 3 | (data[offset + 5] & 0xE0) >>> 5;\n        frameLength -= headerLength;\n        //stamp = pes.pts;\n\n        if (frameLength > 0 && offset + headerLength + frameLength <= len) {\n          stamp = pts + frameIndex * frameDuration;\n          //logger.log(`AAC frame, offset/length/total/pts:${offset+headerLength}/${frameLength}/${data.byteLength}/${(stamp/90).toFixed(0)}`);\n          aacSample = { unit: data.subarray(offset + headerLength, offset + headerLength + frameLength), pts: stamp, dts: stamp };\n          track.samples.push(aacSample);\n          track.len += frameLength;\n          offset += frameLength + headerLength;\n          frameIndex++;\n          // look for ADTS header (0xFFFx)\n          for (; offset < len - 1; offset++) {\n            if (data[offset] === 0xff && (data[offset + 1] & 0xf0) === 0xf0) {\n              break;\n            }\n          }\n        } else {\n          break;\n        }\n      }\n      if (offset < len) {\n        aacOverFlow = data.subarray(offset, len);\n        //logger.log(`AAC: overflow detected:${len-offset}`);\n      } else {\n        aacOverFlow = null;\n      }\n      this.aacOverFlow = aacOverFlow;\n      this.aacLastPTS = stamp;\n    }\n  }, {\n    key: '_parseMPEGPES',\n    value: function _parseMPEGPES(pes) {\n      var data = pes.data;\n      var pts = pes.pts;\n      var length = data.length;\n      var frameIndex = 0;\n      var offset = 0;\n      var parsed;\n\n      while (offset < length && (parsed = this._parseMpeg(data, offset, length, frameIndex++, pts)) > 0) {\n        offset += parsed;\n      }\n    }\n  }, {\n    key: '_onMpegFrame',\n    value: function _onMpegFrame(data, bitRate, sampleRate, channelCount, frameIndex, pts) {\n      var frameDuration = 1152 / sampleRate * 1000;\n      var stamp = pts + frameIndex * frameDuration;\n      var track = this._audioTrack;\n\n      track.config = [];\n      track.channelCount = channelCount;\n      track.audiosamplerate = sampleRate;\n      track.duration = this._duration;\n      track.samples.push({ unit: data, pts: stamp, dts: stamp });\n      track.len += data.length;\n    }\n  }, {\n    key: '_onMpegNoise',\n    value: function _onMpegNoise(data) {\n      _logger.logger.warn('mpeg audio has noise: ' + data.length + ' bytes');\n    }\n  }, {\n    key: '_parseMpeg',\n    value: function _parseMpeg(data, start, end, frameIndex, pts) {\n      var BitratesMap = [32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160];\n      var SamplingRateMap = [44100, 48000, 32000, 22050, 24000, 16000, 11025, 12000, 8000];\n\n      if (start + 2 > end) {\n        return -1; // we need at least 2 bytes to detect sync pattern\n      }\n      if (data[start] === 0xFF || (data[start + 1] & 0xE0) === 0xE0) {\n        // Using http://www.datavoyage.com/mpgscript/mpeghdr.htm as a reference\n        if (start + 24 > end) {\n          return -1;\n        }\n        var headerB = data[start + 1] >> 3 & 3;\n        var headerC = data[start + 1] >> 1 & 3;\n        var headerE = data[start + 2] >> 4 & 15;\n        var headerF = data[start + 2] >> 2 & 3;\n        var headerG = !!(data[start + 2] & 2);\n        if (headerB !== 1 && headerE !== 0 && headerE !== 15 && headerF !== 3) {\n          var columnInBitrates = headerB === 3 ? 3 - headerC : headerC === 3 ? 3 : 4;\n          var bitRate = BitratesMap[columnInBitrates * 14 + headerE - 1] * 1000;\n          var columnInSampleRates = headerB === 3 ? 0 : headerB === 2 ? 1 : 2;\n          var sampleRate = SamplingRateMap[columnInSampleRates * 3 + headerF];\n          var padding = headerG ? 1 : 0;\n          var channelCount = data[start + 3] >> 6 === 3 ? 1 : 2; // If bits of channel mode are `11` then it is a single channel (Mono)\n          var frameLength = headerC === 3 ? (headerB === 3 ? 12 : 6) * bitRate / sampleRate + padding << 2 : (headerB === 3 ? 144 : 72) * bitRate / sampleRate + padding | 0;\n          if (start + frameLength > end) {\n            return -1;\n          }\n          if (this._onMpegFrame) {\n            this._onMpegFrame(data.subarray(start, start + frameLength), bitRate, sampleRate, channelCount, frameIndex, pts);\n          }\n          return frameLength;\n        }\n      }\n      // noise or ID3, trying to skip\n      var offset = start + 2;\n      while (offset < end) {\n        if (data[offset - 1] === 0xFF && (data[offset] & 0xE0) === 0xE0) {\n          // sync pattern is found\n          if (this._onMpegNoise) {\n            this._onMpegNoise(data.subarray(start, offset - 1));\n          }\n          return offset - start - 1;\n        }\n        offset++;\n      }\n      return -1;\n    }\n  }, {\n    key: '_parseID3PES',\n    value: function _parseID3PES(pes) {\n      this._id3Track.samples.push(pes);\n    }\n  }], [{\n    key: 'probe',\n    value: function probe(data) {\n      // a TS fragment should contain at least 3 TS packets, a PAT, a PMT, and one PID, each starting with 0x47\n      if (data.length >= 3 * 188 && data[0] === 0x47 && data[188] === 0x47 && data[2 * 188] === 0x47) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }]);\n\n  return TSDemuxer;\n}();\n\nexports.default = TSDemuxer;\n\n},{\"22\":22,\"26\":26,\"29\":29,\"31\":31,\"33\":33,\"50\":50}],31:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ErrorTypes = exports.ErrorTypes = {\n  // Identifier for a network error (loading error / timeout ...)\n  NETWORK_ERROR: 'networkError',\n  // Identifier for a media Error (video/parsing/mediasource error)\n  MEDIA_ERROR: 'mediaError',\n  // Identifier for a mux Error (demuxing/remuxing)\n  MUX_ERROR: 'muxError',\n  // Identifier for all other errors\n  OTHER_ERROR: 'otherError'\n};\n\nvar ErrorDetails = exports.ErrorDetails = {\n  // Identifier for a manifest load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_ERROR: 'manifestLoadError',\n  // Identifier for a manifest load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  MANIFEST_LOAD_TIMEOUT: 'manifestLoadTimeOut',\n  // Identifier for a manifest parsing error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_PARSING_ERROR: 'manifestParsingError',\n  // Identifier for a manifest with only incompatible codecs error - data: { url : faulty URL, reason : error reason}\n  MANIFEST_INCOMPATIBLE_CODECS_ERROR: 'manifestIncompatibleCodecsError',\n  // Identifier for a level load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_ERROR: 'levelLoadError',\n  // Identifier for a level load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  LEVEL_LOAD_TIMEOUT: 'levelLoadTimeOut',\n  // Identifier for a level switch error - data: { level : faulty level Id, event : error description}\n  LEVEL_SWITCH_ERROR: 'levelSwitchError',\n  // Identifier for an audio track load error - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_ERROR: 'audioTrackLoadError',\n  // Identifier for an audio track load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\n  AUDIO_TRACK_LOAD_TIMEOUT: 'audioTrackLoadTimeOut',\n  // Identifier for fragment load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  FRAG_LOAD_ERROR: 'fragLoadError',\n  // Identifier for fragment loop loading error - data: { frag : fragment object}\n  FRAG_LOOP_LOADING_ERROR: 'fragLoopLoadingError',\n  // Identifier for fragment load timeout error - data: { frag : fragment object}\n  FRAG_LOAD_TIMEOUT: 'fragLoadTimeOut',\n  // Identifier for a fragment decryption error event - data: {id : demuxer Id,frag: fragment object, reason : parsing error description }\n  FRAG_DECRYPT_ERROR: 'fragDecryptError',\n  // Identifier for a fragment parsing error event - data: { id : demuxer Id, reason : parsing error description }\n  // will be renamed DEMUX_PARSING_ERROR and switched to MUX_ERROR in the next major release\n  FRAG_PARSING_ERROR: 'fragParsingError',\n  // Identifier for a remux alloc error event - data: { id : demuxer Id, frag : fragment object, bytes : nb of bytes on which allocation failed , reason : error text }\n  REMUX_ALLOC_ERROR: 'remuxAllocError',\n  // Identifier for decrypt key load error - data: { frag : fragment object, response : { code: error code, text: error text }}\n  KEY_LOAD_ERROR: 'keyLoadError',\n  // Identifier for decrypt key load timeout error - data: { frag : fragment object}\n  KEY_LOAD_TIMEOUT: 'keyLoadTimeOut',\n  // Triggered when an exception occurs while adding a sourceBuffer to MediaSource - data : {  err : exception , mimeType : mimeType }\n  BUFFER_ADD_CODEC_ERROR: 'bufferAddCodecError',\n  // Identifier for a buffer append error - data: append error description\n  BUFFER_APPEND_ERROR: 'bufferAppendError',\n  // Identifier for a buffer appending error event - data: appending error description\n  BUFFER_APPENDING_ERROR: 'bufferAppendingError',\n  // Identifier for a buffer stalled error event\n  BUFFER_STALLED_ERROR: 'bufferStalledError',\n  // Identifier for a buffer full event\n  BUFFER_FULL_ERROR: 'bufferFullError',\n  // Identifier for a buffer seek over hole event\n  BUFFER_SEEK_OVER_HOLE: 'bufferSeekOverHole',\n  // Identifier for a buffer nudge on stall (playback is stuck although currentTime is in a buffered area)\n  BUFFER_NUDGE_ON_STALL: 'bufferNudgeOnStall',\n  // Identifier for an internal exception happening inside hls.js while handling an event\n  INTERNAL_EXCEPTION: 'internalException',\n  // Malformed WebVTT contents\n  WEBVTT_EXCEPTION: 'webVTTException'\n};\n\n},{}],32:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All objects in the event handling chain should inherit from this class\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _logger = _dereq_(50);\n\nvar _errors = _dereq_(31);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar EventHandler = function () {\n  function EventHandler(hls) {\n    _classCallCheck(this, EventHandler);\n\n    this.hls = hls;\n    this.onEvent = this.onEvent.bind(this);\n\n    for (var _len = arguments.length, events = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      events[_key - 1] = arguments[_key];\n    }\n\n    this.handledEvents = events;\n    this.useGenericHandler = true;\n\n    this.registerListeners();\n  }\n\n  _createClass(EventHandler, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.unregisterListeners();\n    }\n  }, {\n    key: 'isEventHandler',\n    value: function isEventHandler() {\n      return _typeof(this.handledEvents) === 'object' && this.handledEvents.length && typeof this.onEvent === 'function';\n    }\n  }, {\n    key: 'registerListeners',\n    value: function registerListeners() {\n      if (this.isEventHandler()) {\n        this.handledEvents.forEach(function (event) {\n          if (event === 'hlsEventGeneric') {\n            throw new Error('Forbidden event name: ' + event);\n          }\n          this.hls.on(event, this.onEvent);\n        }.bind(this));\n      }\n    }\n  }, {\n    key: 'unregisterListeners',\n    value: function unregisterListeners() {\n      if (this.isEventHandler()) {\n        this.handledEvents.forEach(function (event) {\n          this.hls.off(event, this.onEvent);\n        }.bind(this));\n      }\n    }\n\n    /**\n     * arguments: event (string), data (any)\n     */\n\n  }, {\n    key: 'onEvent',\n    value: function onEvent(event, data) {\n      this.onEventGeneric(event, data);\n    }\n  }, {\n    key: 'onEventGeneric',\n    value: function onEventGeneric(event, data) {\n      var eventToFunction = function eventToFunction(event, data) {\n        var funcName = 'on' + event.replace('hls', '');\n        if (typeof this[funcName] !== 'function') {\n          throw new Error('Event ' + event + ' has no generic handler in this ' + this.constructor.name + ' class (tried ' + funcName + ')');\n        }\n        return this[funcName].bind(this, data);\n      };\n      try {\n        eventToFunction.call(this, event, data).call();\n      } catch (err) {\n        _logger.logger.error('internal error happened while processing ' + event + ':' + err.message);\n        this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.OTHER_ERROR, details: _errors.ErrorDetails.INTERNAL_EXCEPTION, fatal: false, event: event, err: err });\n      }\n    }\n  }]);\n\n  return EventHandler;\n}();\n\nexports.default = EventHandler;\n\n},{\"31\":31,\"33\":33,\"50\":50}],33:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  // fired before MediaSource is attaching to media element - data: { media }\n  MEDIA_ATTACHING: 'hlsMediaAttaching',\n  // fired when MediaSource has been succesfully attached to media element - data: { }\n  MEDIA_ATTACHED: 'hlsMediaAttached',\n  // fired before detaching MediaSource from media element - data: { }\n  MEDIA_DETACHING: 'hlsMediaDetaching',\n  // fired when MediaSource has been detached from media element - data: { }\n  MEDIA_DETACHED: 'hlsMediaDetached',\n  // fired when we buffer is going to be resetted\n  BUFFER_RESET: 'hlsBufferReset',\n  // fired when we know about the codecs that we need buffers for to push into - data: {tracks : { container, codec, levelCodec, initSegment, metadata }}\n  BUFFER_CODECS: 'hlsBufferCodecs',\n  // fired when sourcebuffers have been created data: { tracks : tracks}\n  BUFFER_CREATED: 'hlsBufferCreated',\n  // fired when we append a segment to the buffer - data: { segment: segment object }\n  BUFFER_APPENDING: 'hlsBufferAppending',\n  // fired when we are done with appending a media segment to the buffer data : { parent : segment parent that triggered BUFFER_APPENDING , pending : nb of segments waiting for appending for this segment parent}\n  BUFFER_APPENDED: 'hlsBufferAppended',\n  // fired when the stream is finished and we want to notify the media buffer that there will be no more data\n  BUFFER_EOS: 'hlsBufferEos',\n  // fired when the media buffer should be flushed - data {startOffset, endOffset}\n  BUFFER_FLUSHING: 'hlsBufferFlushing',\n  // fired when the media has been flushed\n  BUFFER_FLUSHED: 'hlsBufferFlushed',\n  // fired to signal that a manifest loading starts - data: { url : manifestURL}\n  MANIFEST_LOADING: 'hlsManifestLoading',\n  // fired after manifest has been loaded - data: { levels : [available quality levels] , audioTracks : [ available audio tracks], url : manifestURL, stats : { trequest, tfirst, tload, mtime}}\n  MANIFEST_LOADED: 'hlsManifestLoaded',\n  // fired after manifest has been parsed - data: { levels : [available quality levels] , firstLevel : index of first quality level appearing in Manifest}\n  MANIFEST_PARSED: 'hlsManifestParsed',\n  // fired when a level switch is requested - data: { level : id of new level } // deprecated in favor LEVEL_SWITCHING\n  LEVEL_SWITCH: 'hlsLevelSwitch',\n  // fired when a level switch is requested - data: { level : id of new level }\n  LEVEL_SWITCHING: 'hlsLevelSwitching',\n  // fired when a level switch is effective - data: { level : id of new level }\n  LEVEL_SWITCHED: 'hlsLevelSwitched',\n  // fired when a level playlist loading starts - data: { url : level URL  level : id of level being loaded}\n  LEVEL_LOADING: 'hlsLevelLoading',\n  // fired when a level playlist loading finishes - data: { details : levelDetails object, level : id of loaded level, stats : { trequest, tfirst, tload, mtime} }\n  LEVEL_LOADED: 'hlsLevelLoaded',\n  // fired when a level's details have been updated based on previous details, after it has been loaded. - data: { details : levelDetails object, level : id of updated level }\n  LEVEL_UPDATED: 'hlsLevelUpdated',\n  // fired when a level's PTS information has been updated after parsing a fragment - data: { details : levelDetails object, level : id of updated level, drift: PTS drift observed when parsing last fragment }\n  LEVEL_PTS_UPDATED: 'hlsLevelPtsUpdated',\n  // fired to notify that audio track lists has been updated data: { audioTracks : audioTracks}\n  AUDIO_TRACKS_UPDATED: 'hlsAudioTracksUpdated',\n  // fired when an audio track switch occurs - data: {  id : audio track id} // deprecated in favor AUDIO_TRACK_SWITCHING\n  AUDIO_TRACK_SWITCH: 'hlsAudioTrackSwitch',\n  // fired when an audio track switching is requested - data: {  id : audio track id}\n  AUDIO_TRACK_SWITCHING: 'hlsAudioTrackSwitching',\n  // fired when an audio track switch actually occurs - data: {  id : audio track id}\n  AUDIO_TRACK_SWITCHED: 'hlsAudioTrackSwitched',\n  // fired when an audio track loading starts - data: { url : audio track URL  id : audio track id}\n  AUDIO_TRACK_LOADING: 'hlsAudioTrackLoading',\n  // fired when an audio track loading  finishes - data: { details : levelDetails object, id : audio track id, stats : { trequest, tfirst, tload, mtime} }\n  AUDIO_TRACK_LOADED: 'hlsAudioTrackLoaded',\n  // fired to notify that subtitle track lists has been updated data: { subtitleTracks : subtitleTracks}\n  SUBTITLE_TRACKS_UPDATED: 'hlsSubtitleTracksUpdated',\n  // fired when an subtitle track switch occurs - data: {  id : subtitle track id}\n  SUBTITLE_TRACK_SWITCH: 'hlsSubtitleTrackSwitch',\n  // fired when an subtitle track loading starts - data: { url : subtitle track URL  id : subtitle track id}\n  SUBTITLE_TRACK_LOADING: 'hlsSubtitleTrackLoading',\n  // fired when an subtitle track loading  finishes - data: { details : levelDetails object, id : subtitle track id, stats : { trequest, tfirst, tload, mtime} }\n  SUBTITLE_TRACK_LOADED: 'hlsSubtitleTrackLoaded',\n  // fired when a subtitle fragment has been processed - data: { success : boolean, frag : the processed frag}\n  SUBTITLE_FRAG_PROCESSED: 'hlsSubtitleFragProcessed',\n  // fired when the first timestamp is found. - data: { id : demuxer id, initPTS: initPTS , frag : fragment object}\n  INIT_PTS_FOUND: 'hlsInitPtsFound',\n  // fired when a fragment loading starts - data: { frag : fragment object}\n  FRAG_LOADING: 'hlsFragLoading',\n  // fired when a fragment loading is progressing - data: { frag : fragment object, { trequest, tfirst, loaded}}\n  FRAG_LOAD_PROGRESS: 'hlsFragLoadProgress',\n  // Identifier for fragment load aborting for emergency switch down - data: {frag : fragment object}\n  FRAG_LOAD_EMERGENCY_ABORTED: 'hlsFragLoadEmergencyAborted',\n  // fired when a fragment loading is completed - data: { frag : fragment object, payload : fragment payload, stats : { trequest, tfirst, tload, length}}\n  FRAG_LOADED: 'hlsFragLoaded',\n  // fired when a fragment has finished decrypting - data: { id : demuxer id, frag: fragment object, stats : {tstart,tdecrypt} }\n  FRAG_DECRYPTED: 'hlsFragDecrypted',\n  // fired when Init Segment has been extracted from fragment - data: { id : demuxer id, frag: fragment object, moov : moov MP4 box, codecs : codecs found while parsing fragment}\n  FRAG_PARSING_INIT_SEGMENT: 'hlsFragParsingInitSegment',\n  // fired when parsing sei text is completed - data: { id : demuxer id, , frag: fragment object, samples : [ sei samples pes ] }\n  FRAG_PARSING_USERDATA: 'hlsFragParsingUserdata',\n  // fired when parsing id3 is completed - data: { id : demuxer id, frag: fragment object, samples : [ id3 samples pes ] }\n  FRAG_PARSING_METADATA: 'hlsFragParsingMetadata',\n  // fired when data have been extracted from fragment - data: { id : demuxer id, frag: fragment object, data1 : moof MP4 box or TS fragments, data2 : mdat MP4 box or null}\n  FRAG_PARSING_DATA: 'hlsFragParsingData',\n  // fired when fragment parsing is completed - data: { id : demuxer id,frag: fragment object }\n  FRAG_PARSED: 'hlsFragParsed',\n  // fired when fragment remuxed MP4 boxes have all been appended into SourceBuffer - data: { id : demuxer id,frag : fragment object, stats : { trequest, tfirst, tload, tparsed, tbuffered, length} }\n  FRAG_BUFFERED: 'hlsFragBuffered',\n  // fired when fragment matching with current media position is changing - data : { id : demuxer id, frag : fragment object }\n  FRAG_CHANGED: 'hlsFragChanged',\n  // Identifier for a FPS drop event - data: {curentDropped, currentDecoded, totalDroppedFrames}\n  FPS_DROP: 'hlsFpsDrop',\n  //triggered when FPS drop triggers auto level capping - data: {level, droppedlevel}\n  FPS_DROP_LEVEL_CAPPING: 'hlsFpsDropLevelCapping',\n  // Identifier for an error event - data: { type : error type, details : error details, fatal : if true, hls.js cannot/will not try to recover, if false, hls.js will try to recover,other error specific data}\n  ERROR: 'hlsError',\n  // fired when hls.js instance starts destroying. Different from MEDIA_DETACHED as one could want to detach and reattach a media to the instance of hls.js to handle mid-rolls for example\n  DESTROYING: 'hlsDestroying',\n  // fired when a decrypt key loading starts - data: { frag : fragment object}\n  KEY_LOADING: 'hlsKeyLoading',\n  // fired when a decrypt key loading is completed - data: { frag : fragment object, payload : key payload, stats : { trequest, tfirst, tload, length}}\n  KEY_LOADED: 'hlsKeyLoaded',\n  // fired upon stream controller state transitions - data: {previousState, nextState}\n  STREAM_STATE_TRANSITION: 'hlsStreamStateTransition'\n};\n\n},{}],34:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n *  AAC helper\n */\n\nvar AAC = function () {\n  function AAC() {\n    _classCallCheck(this, AAC);\n  }\n\n  _createClass(AAC, null, [{\n    key: 'getSilentFrame',\n    value: function getSilentFrame(codec, channelCount) {\n      switch (codec) {\n        case 'mp4a.40.2':\n          if (channelCount === 1) {\n            return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n          } else if (channelCount === 2) {\n            return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n          } else if (channelCount === 3) {\n            return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n          } else if (channelCount === 4) {\n            return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n          } else if (channelCount === 5) {\n            return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n          } else if (channelCount === 6) {\n            return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n          }\n          break;\n        // handle HE-AAC below (mp4a.40.5 / mp4a.40.29)\n        default:\n          if (channelCount === 1) {\n            // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n            return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x4e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x1c, 0x6, 0xf1, 0xc1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n          } else if (channelCount === 2) {\n            // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n            return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n          } else if (channelCount === 3) {\n            // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n            return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n          }\n          break;\n      }\n      return null;\n    }\n  }]);\n\n  return AAC;\n}();\n\nexports.default = AAC;\n\n},{}],35:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Buffer Helper class, providing methods dealing buffer length retrieval\n*/\n\nvar BufferHelper = function () {\n  function BufferHelper() {\n    _classCallCheck(this, BufferHelper);\n  }\n\n  _createClass(BufferHelper, null, [{\n    key: \"isBuffered\",\n    value: function isBuffered(media, position) {\n      if (media) {\n        var buffered = media.buffered;\n        for (var i = 0; i < buffered.length; i++) {\n          if (position >= buffered.start(i) && position <= buffered.end(i)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n  }, {\n    key: \"bufferInfo\",\n    value: function bufferInfo(media, pos, maxHoleDuration) {\n      if (media) {\n        var vbuffered = media.buffered,\n            buffered = [],\n            i;\n        for (i = 0; i < vbuffered.length; i++) {\n          buffered.push({ start: vbuffered.start(i), end: vbuffered.end(i) });\n        }\n        return this.bufferedInfo(buffered, pos, maxHoleDuration);\n      } else {\n        return { len: 0, start: pos, end: pos, nextStart: undefined };\n      }\n    }\n  }, {\n    key: \"bufferedInfo\",\n    value: function bufferedInfo(buffered, pos, maxHoleDuration) {\n      var buffered2 = [],\n\n      // bufferStart and bufferEnd are buffer boundaries around current video position\n      bufferLen,\n          bufferStart,\n          bufferEnd,\n          bufferStartNext,\n          i;\n      // sort on buffer.start/smaller end (IE does not always return sorted buffered range)\n      buffered.sort(function (a, b) {\n        var diff = a.start - b.start;\n        if (diff) {\n          return diff;\n        } else {\n          return b.end - a.end;\n        }\n      });\n      // there might be some small holes between buffer time range\n      // consider that holes smaller than maxHoleDuration are irrelevant and build another\n      // buffer time range representations that discards those holes\n      for (i = 0; i < buffered.length; i++) {\n        var buf2len = buffered2.length;\n        if (buf2len) {\n          var buf2end = buffered2[buf2len - 1].end;\n          // if small hole (value between 0 or maxHoleDuration ) or overlapping (negative)\n          if (buffered[i].start - buf2end < maxHoleDuration) {\n            // merge overlapping time ranges\n            // update lastRange.end only if smaller than item.end\n            // e.g.  [ 1, 15] with  [ 2,8] => [ 1,15] (no need to modify lastRange.end)\n            // whereas [ 1, 8] with  [ 2,15] => [ 1,15] ( lastRange should switch from [1,8] to [1,15])\n            if (buffered[i].end > buf2end) {\n              buffered2[buf2len - 1].end = buffered[i].end;\n            }\n          } else {\n            // big hole\n            buffered2.push(buffered[i]);\n          }\n        } else {\n          // first value\n          buffered2.push(buffered[i]);\n        }\n      }\n      for (i = 0, bufferLen = 0, bufferStart = bufferEnd = pos; i < buffered2.length; i++) {\n        var start = buffered2[i].start,\n            end = buffered2[i].end;\n        //logger.log('buf start/end:' + buffered.start(i) + '/' + buffered.end(i));\n        if (pos + maxHoleDuration >= start && pos < end) {\n          // play position is inside this buffer TimeRange, retrieve end of buffer position and buffer length\n          bufferStart = start;\n          bufferEnd = end;\n          bufferLen = bufferEnd - pos;\n        } else if (pos + maxHoleDuration < start) {\n          bufferStartNext = start;\n          break;\n        }\n      }\n      return { len: bufferLen, start: bufferStart, end: bufferEnd, nextStart: bufferStartNext };\n    }\n  }]);\n\n  return BufferHelper;\n}();\n\nexports.default = BufferHelper;\n\n},{}],36:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Level Helper class, providing methods dealing with playlist sliding and drift\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _logger = _dereq_(50);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LevelHelper = function () {\n  function LevelHelper() {\n    _classCallCheck(this, LevelHelper);\n  }\n\n  _createClass(LevelHelper, null, [{\n    key: 'mergeDetails',\n    value: function mergeDetails(oldDetails, newDetails) {\n      var start = Math.max(oldDetails.startSN, newDetails.startSN) - newDetails.startSN,\n          end = Math.min(oldDetails.endSN, newDetails.endSN) - newDetails.startSN,\n          delta = newDetails.startSN - oldDetails.startSN,\n          oldfragments = oldDetails.fragments,\n          newfragments = newDetails.fragments,\n          ccOffset = 0,\n          PTSFrag;\n\n      // check if old/new playlists have fragments in common\n      if (end < start) {\n        newDetails.PTSKnown = false;\n        return;\n      }\n      // loop through overlapping SN and update startPTS , cc, and duration if any found\n      for (var i = start; i <= end; i++) {\n        var oldFrag = oldfragments[delta + i],\n            newFrag = newfragments[i];\n        if (newFrag && oldFrag) {\n          ccOffset = oldFrag.cc - newFrag.cc;\n          if (!isNaN(oldFrag.startPTS)) {\n            newFrag.start = newFrag.startPTS = oldFrag.startPTS;\n            newFrag.endPTS = oldFrag.endPTS;\n            newFrag.duration = oldFrag.duration;\n            PTSFrag = newFrag;\n          }\n        }\n      }\n\n      if (ccOffset) {\n        _logger.logger.log('discontinuity sliding from playlist, take drift into account');\n        for (i = 0; i < newfragments.length; i++) {\n          newfragments[i].cc += ccOffset;\n        }\n      }\n\n      // if at least one fragment contains PTS info, recompute PTS information for all fragments\n      if (PTSFrag) {\n        LevelHelper.updateFragPTSDTS(newDetails, PTSFrag.sn, PTSFrag.startPTS, PTSFrag.endPTS, PTSFrag.startDTS, PTSFrag.endDTS);\n      } else {\n        // ensure that delta is within oldfragments range\n        // also adjust sliding in case delta is 0 (we could have old=[50-60] and new=old=[50-61])\n        // in that case we also need to adjust start offset of all fragments\n        if (delta >= 0 && delta < oldfragments.length) {\n          // adjust start by sliding offset\n          var sliding = oldfragments[delta].start;\n          for (i = 0; i < newfragments.length; i++) {\n            newfragments[i].start += sliding;\n          }\n        }\n      }\n      // if we are here, it means we have fragments overlapping between\n      // old and new level. reliable PTS info is thus relying on old level\n      newDetails.PTSKnown = oldDetails.PTSKnown;\n      return;\n    }\n  }, {\n    key: 'updateFragPTSDTS',\n    value: function updateFragPTSDTS(details, sn, startPTS, endPTS, startDTS, endDTS) {\n      var fragIdx, fragments, frag, i;\n      // exit if sn out of range\n      if (!details || sn < details.startSN || sn > details.endSN) {\n        return 0;\n      }\n      fragIdx = sn - details.startSN;\n      fragments = details.fragments;\n      frag = fragments[fragIdx];\n      if (!isNaN(frag.startPTS)) {\n        // delta PTS between audio and video\n        var deltaPTS = Math.abs(frag.startPTS - startPTS);\n        if (isNaN(frag.deltaPTS)) {\n          frag.deltaPTS = deltaPTS;\n        } else {\n          frag.deltaPTS = Math.max(deltaPTS, frag.deltaPTS);\n        }\n        startPTS = Math.min(startPTS, frag.startPTS);\n        endPTS = Math.max(endPTS, frag.endPTS);\n        startDTS = Math.min(startDTS, frag.startDTS);\n        endDTS = Math.max(endDTS, frag.endDTS);\n      }\n\n      var drift = startPTS - frag.start;\n\n      frag.start = frag.startPTS = startPTS;\n      frag.endPTS = endPTS;\n      frag.startDTS = startDTS;\n      frag.endDTS = endDTS;\n      frag.duration = endPTS - startPTS;\n      // adjust fragment PTS/duration from seqnum-1 to frag 0\n      for (i = fragIdx; i > 0; i--) {\n        LevelHelper.updatePTS(fragments, i, i - 1);\n      }\n\n      // adjust fragment PTS/duration from seqnum to last frag\n      for (i = fragIdx; i < fragments.length - 1; i++) {\n        LevelHelper.updatePTS(fragments, i, i + 1);\n      }\n      details.PTSKnown = true;\n      //logger.log(`                                            frag start/end:${startPTS.toFixed(3)}/${endPTS.toFixed(3)}`);\n\n      return drift;\n    }\n  }, {\n    key: 'updatePTS',\n    value: function updatePTS(fragments, fromIdx, toIdx) {\n      var fragFrom = fragments[fromIdx],\n          fragTo = fragments[toIdx],\n          fragToPTS = fragTo.startPTS;\n      // if we know startPTS[toIdx]\n      if (!isNaN(fragToPTS)) {\n        // update fragment duration.\n        // it helps to fix drifts between playlist reported duration and fragment real duration\n        if (toIdx > fromIdx) {\n          fragFrom.duration = fragToPTS - fragFrom.start;\n          if (fragFrom.duration < 0) {\n            _logger.logger.warn('negative duration computed for frag ' + fragFrom.sn + ',level ' + fragFrom.level + ', there should be some duration drift between playlist and fragment!');\n          }\n        } else {\n          fragTo.duration = fragFrom.start - fragToPTS;\n          if (fragTo.duration < 0) {\n            _logger.logger.warn('negative duration computed for frag ' + fragTo.sn + ',level ' + fragTo.level + ', there should be some duration drift between playlist and fragment!');\n          }\n        }\n      } else {\n        // we dont know startPTS[toIdx]\n        if (toIdx > fromIdx) {\n          fragTo.start = fragFrom.start + fragFrom.duration;\n        } else {\n          fragTo.start = fragFrom.start - fragTo.duration;\n        }\n      }\n    }\n  }]);\n\n  return LevelHelper;\n}();\n\nexports.default = LevelHelper;\n\n},{\"50\":50}],37:[function(_dereq_,module,exports){\n/**\n * HLS interface\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _errors = _dereq_(31);\n\nvar _playlistLoader = _dereq_(41);\n\nvar _playlistLoader2 = _interopRequireDefault(_playlistLoader);\n\nvar _fragmentLoader = _dereq_(39);\n\nvar _fragmentLoader2 = _interopRequireDefault(_fragmentLoader);\n\nvar _keyLoader = _dereq_(40);\n\nvar _keyLoader2 = _interopRequireDefault(_keyLoader);\n\nvar _streamController = _dereq_(13);\n\nvar _streamController2 = _interopRequireDefault(_streamController);\n\nvar _levelController = _dereq_(12);\n\nvar _levelController2 = _interopRequireDefault(_levelController);\n\nvar _logger = _dereq_(50);\n\nvar _events3 = _dereq_(1);\n\nvar _events4 = _interopRequireDefault(_events3);\n\nvar _config = _dereq_(4);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Hls = function () {\n  _createClass(Hls, null, [{\n    key: 'isSupported',\n    value: function isSupported() {\n      window.MediaSource = window.MediaSource || window.WebKitMediaSource;\n      return window.MediaSource && typeof window.MediaSource.isTypeSupported === 'function' && window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n    }\n  }, {\n    key: 'version',\n    get: function get() {\n      // replaced with browserify-versionify transform\n      return '0.7.2';\n    }\n  }, {\n    key: 'Events',\n    get: function get() {\n      return _events2.default;\n    }\n  }, {\n    key: 'ErrorTypes',\n    get: function get() {\n      return _errors.ErrorTypes;\n    }\n  }, {\n    key: 'ErrorDetails',\n    get: function get() {\n      return _errors.ErrorDetails;\n    }\n  }, {\n    key: 'DefaultConfig',\n    get: function get() {\n      if (!Hls.defaultConfig) {\n        return _config.hlsDefaultConfig;\n      }\n      return Hls.defaultConfig;\n    },\n    set: function set(defaultConfig) {\n      Hls.defaultConfig = defaultConfig;\n    }\n  }]);\n\n  function Hls() {\n    var _this = this;\n\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Hls);\n\n    var defaultConfig = Hls.DefaultConfig;\n\n    if ((config.liveSyncDurationCount || config.liveMaxLatencyDurationCount) && (config.liveSyncDuration || config.liveMaxLatencyDuration)) {\n      throw new Error('Illegal hls.js config: don\\'t mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration');\n    }\n\n    for (var prop in defaultConfig) {\n      if (prop in config) {\n        continue;\n      }\n      config[prop] = defaultConfig[prop];\n    }\n\n    if (config.liveMaxLatencyDurationCount !== undefined && config.liveMaxLatencyDurationCount <= config.liveSyncDurationCount) {\n      throw new Error('Illegal hls.js config: \"liveMaxLatencyDurationCount\" must be gt \"liveSyncDurationCount\"');\n    }\n\n    if (config.liveMaxLatencyDuration !== undefined && (config.liveMaxLatencyDuration <= config.liveSyncDuration || config.liveSyncDuration === undefined)) {\n      throw new Error('Illegal hls.js config: \"liveMaxLatencyDuration\" must be gt \"liveSyncDuration\"');\n    }\n\n    (0, _logger.enableLogs)(config.debug);\n    this.config = config;\n    this._autoLevelCapping = -1;\n    // observer setup\n    var observer = this.observer = new _events4.default();\n    observer.trigger = function trigger(event) {\n      for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        data[_key - 1] = arguments[_key];\n      }\n\n      observer.emit.apply(observer, [event, event].concat(data));\n    };\n\n    observer.off = function off(event) {\n      for (var _len2 = arguments.length, data = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        data[_key2 - 1] = arguments[_key2];\n      }\n\n      observer.removeListener.apply(observer, [event].concat(data));\n    };\n    this.on = observer.on.bind(observer);\n    this.off = observer.off.bind(observer);\n    this.trigger = observer.trigger.bind(observer);\n\n    // core controllers and network loaders\n    var abrController = this.abrController = new config.abrController(this);\n    var bufferController = new config.bufferController(this);\n    var capLevelController = new config.capLevelController(this);\n    var fpsController = new config.fpsController(this);\n    var playListLoader = new _playlistLoader2.default(this);\n    var fragmentLoader = new _fragmentLoader2.default(this);\n    var keyLoader = new _keyLoader2.default(this);\n\n    // network controllers\n    var levelController = this.levelController = new _levelController2.default(this);\n    var streamController = this.streamController = new _streamController2.default(this);\n    var networkControllers = [levelController, streamController];\n\n    // optional audio stream controller\n    var Controller = config.audioStreamController;\n    if (Controller) {\n      networkControllers.push(new Controller(this));\n    }\n    this.networkControllers = networkControllers;\n\n    var coreComponents = [playListLoader, fragmentLoader, keyLoader, abrController, bufferController, capLevelController, fpsController];\n\n    // optional audio track and subtitle controller\n    Controller = config.audioTrackController;\n    if (Controller) {\n      var audioTrackController = new Controller(this);\n      this.audioTrackController = audioTrackController;\n      coreComponents.push(audioTrackController);\n    }\n\n    Controller = config.subtitleTrackController;\n    if (Controller) {\n      var subtitleTrackController = new Controller(this);\n      this.subtitleTrackController = subtitleTrackController;\n      coreComponents.push(subtitleTrackController);\n    }\n\n    // optional subtitle controller\n    [config.subtitleStreamController, config.timelineController].forEach(function (Controller) {\n      if (Controller) {\n        coreComponents.push(new Controller(_this));\n      }\n    });\n    this.coreComponents = coreComponents;\n  }\n\n  _createClass(Hls, [{\n    key: 'destroy',\n    value: function destroy() {\n      _logger.logger.log('destroy');\n      this.trigger(_events2.default.DESTROYING);\n      this.detachMedia();\n      this.coreComponents.concat(this.networkControllers).forEach(function (component) {\n        component.destroy();\n      });\n      this.url = null;\n      this.observer.removeAllListeners();\n      this._autoLevelCapping = -1;\n    }\n  }, {\n    key: 'attachMedia',\n    value: function attachMedia(media) {\n      _logger.logger.log('attachMedia');\n      this.media = media;\n      this.trigger(_events2.default.MEDIA_ATTACHING, { media: media });\n    }\n  }, {\n    key: 'detachMedia',\n    value: function detachMedia() {\n      _logger.logger.log('detachMedia');\n      this.trigger(_events2.default.MEDIA_DETACHING);\n      this.media = null;\n    }\n  }, {\n    key: 'loadSource',\n    value: function loadSource(url) {\n      _logger.logger.log('loadSource:' + url);\n      this.url = url;\n      // when attaching to a source URL, trigger a playlist load\n      this.trigger(_events2.default.MANIFEST_LOADING, { url: url });\n    }\n  }, {\n    key: 'startLoad',\n    value: function startLoad() {\n      var startPosition = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n\n      _logger.logger.log('startLoad(' + startPosition + ')');\n      this.networkControllers.forEach(function (controller) {\n        controller.startLoad(startPosition);\n      });\n    }\n  }, {\n    key: 'stopLoad',\n    value: function stopLoad() {\n      _logger.logger.log('stopLoad');\n      this.networkControllers.forEach(function (controller) {\n        controller.stopLoad();\n      });\n    }\n  }, {\n    key: 'swapAudioCodec',\n    value: function swapAudioCodec() {\n      _logger.logger.log('swapAudioCodec');\n      this.streamController.swapAudioCodec();\n    }\n  }, {\n    key: 'recoverMediaError',\n    value: function recoverMediaError() {\n      _logger.logger.log('recoverMediaError');\n      var media = this.media;\n      this.detachMedia();\n      this.attachMedia(media);\n    }\n\n    /** Return all quality levels **/\n\n  }, {\n    key: 'levels',\n    get: function get() {\n      return this.levelController.levels;\n    }\n\n    /** Return current playback quality level **/\n\n  }, {\n    key: 'currentLevel',\n    get: function get() {\n      return this.streamController.currentLevel;\n    }\n\n    /* set quality level immediately (-1 for automatic level selection) */\n    ,\n    set: function set(newLevel) {\n      _logger.logger.log('set currentLevel:' + newLevel);\n      this.loadLevel = newLevel;\n      this.streamController.immediateLevelSwitch();\n    }\n\n    /** Return next playback quality level (quality level of next fragment) **/\n\n  }, {\n    key: 'nextLevel',\n    get: function get() {\n      return this.streamController.nextLevel;\n    }\n\n    /* set quality level for next fragment (-1 for automatic level selection) */\n    ,\n    set: function set(newLevel) {\n      _logger.logger.log('set nextLevel:' + newLevel);\n      this.levelController.manualLevel = newLevel;\n      this.streamController.nextLevelSwitch();\n    }\n\n    /** Return the quality level of current/last loaded fragment **/\n\n  }, {\n    key: 'loadLevel',\n    get: function get() {\n      return this.levelController.level;\n    }\n\n    /* set quality level for current/next loaded fragment (-1 for automatic level selection) */\n    ,\n    set: function set(newLevel) {\n      _logger.logger.log('set loadLevel:' + newLevel);\n      this.levelController.manualLevel = newLevel;\n    }\n\n    /** Return the quality level of next loaded fragment **/\n\n  }, {\n    key: 'nextLoadLevel',\n    get: function get() {\n      return this.levelController.nextLoadLevel;\n    }\n\n    /** set quality level of next loaded fragment **/\n    ,\n    set: function set(level) {\n      this.levelController.nextLoadLevel = level;\n    }\n\n    /** Return first level (index of first level referenced in manifest)\n    **/\n\n  }, {\n    key: 'firstLevel',\n    get: function get() {\n      return Math.max(this.levelController.firstLevel, this.minAutoLevel);\n    }\n\n    /** set first level (index of first level referenced in manifest)\n    **/\n    ,\n    set: function set(newLevel) {\n      _logger.logger.log('set firstLevel:' + newLevel);\n      this.levelController.firstLevel = newLevel;\n    }\n\n    /** Return start level (level of first fragment that will be played back)\n        if not overrided by user, first level appearing in manifest will be used as start level\n        if -1 : automatic start level selection, playback will start from level matching download bandwidth (determined from download of first segment)\n    **/\n\n  }, {\n    key: 'startLevel',\n    get: function get() {\n      return this.levelController.startLevel;\n    }\n\n    /** set  start level (level of first fragment that will be played back)\n        if not overrided by user, first level appearing in manifest will be used as start level\n        if -1 : automatic start level selection, playback will start from level matching download bandwidth (determined from download of first segment)\n    **/\n    ,\n    set: function set(newLevel) {\n      _logger.logger.log('set startLevel:' + newLevel);\n      var hls = this;\n      // if not in automatic start level detection, ensure startLevel is greater than minAutoLevel\n      if (newLevel !== -1) {\n        newLevel = Math.max(newLevel, hls.minAutoLevel);\n      }\n      hls.levelController.startLevel = newLevel;\n    }\n\n    /** Return the capping/max level value that could be used by automatic level selection algorithm **/\n\n  }, {\n    key: 'autoLevelCapping',\n    get: function get() {\n      return this._autoLevelCapping;\n    }\n\n    /** set the capping/max level value that could be used by automatic level selection algorithm **/\n    ,\n    set: function set(newLevel) {\n      _logger.logger.log('set autoLevelCapping:' + newLevel);\n      this._autoLevelCapping = newLevel;\n    }\n\n    /* check if we are in automatic level selection mode */\n\n  }, {\n    key: 'autoLevelEnabled',\n    get: function get() {\n      return this.levelController.manualLevel === -1;\n    }\n\n    /* return manual level */\n\n  }, {\n    key: 'manualLevel',\n    get: function get() {\n      return this.levelController.manualLevel;\n    }\n\n    /* return min level selectable in auto mode according to config.minAutoBitrate */\n\n  }, {\n    key: 'minAutoLevel',\n    get: function get() {\n      var hls = this,\n          levels = hls.levels,\n          minAutoBitrate = hls.config.minAutoBitrate,\n          len = levels ? levels.length : 0;\n      for (var i = 0; i < len; i++) {\n        var levelNextBitrate = levels[i].realBitrate ? Math.max(levels[i].realBitrate, levels[i].bitrate) : levels[i].bitrate;\n        if (levelNextBitrate > minAutoBitrate) {\n          return i;\n        }\n      }\n      return 0;\n    }\n\n    /* return max level selectable in auto mode according to autoLevelCapping */\n\n  }, {\n    key: 'maxAutoLevel',\n    get: function get() {\n      var hls = this;\n      var levels = hls.levels;\n      var autoLevelCapping = hls.autoLevelCapping;\n      var maxAutoLevel = void 0;\n      if (autoLevelCapping === -1 && levels && levels.length) {\n        maxAutoLevel = levels.length - 1;\n      } else {\n        maxAutoLevel = autoLevelCapping;\n      }\n      return maxAutoLevel;\n    }\n\n    // return next auto level\n\n  }, {\n    key: 'nextAutoLevel',\n    get: function get() {\n      var hls = this;\n      // ensure next auto level is between  min and max auto level\n      return Math.min(Math.max(hls.abrController.nextAutoLevel, hls.minAutoLevel), hls.maxAutoLevel);\n    }\n\n    // this setter is used to force next auto level\n    // this is useful to force a switch down in auto mode : in case of load error on level N, hls.js can set nextAutoLevel to N-1 for example)\n    // forced value is valid for one fragment. upon succesful frag loading at forced level, this value will be resetted to -1 by ABR controller\n    ,\n    set: function set(nextLevel) {\n      var hls = this;\n      hls.abrController.nextAutoLevel = Math.max(hls.minAutoLevel, nextLevel);\n    }\n\n    /** get alternate audio tracks list from playlist **/\n\n  }, {\n    key: 'audioTracks',\n    get: function get() {\n      var audioTrackController = this.audioTrackController;\n      return audioTrackController ? audioTrackController.audioTracks : [];\n    }\n\n    /** get index of the selected audio track (index in audio track lists) **/\n\n  }, {\n    key: 'audioTrack',\n    get: function get() {\n      var audioTrackController = this.audioTrackController;\n      return audioTrackController ? audioTrackController.audioTrack : -1;\n    }\n\n    /** select an audio track, based on its index in audio track lists**/\n    ,\n    set: function set(audioTrackId) {\n      var audioTrackController = this.audioTrackController;\n      if (audioTrackController) {\n        audioTrackController.audioTrack = audioTrackId;\n      }\n    }\n  }, {\n    key: 'liveSyncPosition',\n    get: function get() {\n      return this.streamController.liveSyncPosition;\n    }\n\n    /** get alternate subtitle tracks list from playlist **/\n\n  }, {\n    key: 'subtitleTracks',\n    get: function get() {\n      var subtitleTrackController = this.subtitleTrackController;\n      return subtitleTrackController ? subtitleTrackController.subtitleTracks : [];\n    }\n\n    /** get index of the selected subtitle track (index in subtitle track lists) **/\n\n  }, {\n    key: 'subtitleTrack',\n    get: function get() {\n      var subtitleTrackController = this.subtitleTrackController;\n      return subtitleTrackController ? subtitleTrackController.subtitleTrack : -1;\n    }\n\n    /** select an subtitle track, based on its index in subtitle track lists**/\n    ,\n    set: function set(subtitleTrackId) {\n      var subtitleTrackController = this.subtitleTrackController;\n      if (subtitleTrackController) {\n        subtitleTrackController.subtitleTrack = subtitleTrackId;\n      }\n    }\n  }]);\n\n  return Hls;\n}();\n\nexports.default = Hls;\n\n},{\"1\":1,\"12\":12,\"13\":13,\"31\":31,\"33\":33,\"39\":39,\"4\":4,\"40\":40,\"41\":41,\"50\":50}],38:[function(_dereq_,module,exports){\n'use strict';\n\n// This is mostly for support of the es6 module export\n// syntax with the babel compiler, it looks like it doesnt support\n// function exports like we are used to in node/commonjs\nmodule.exports = _dereq_(37).default;\n\n},{\"37\":37}],39:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _errors = _dereq_(31);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Fragment Loader\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar FragmentLoader = function (_EventHandler) {\n  _inherits(FragmentLoader, _EventHandler);\n\n  function FragmentLoader(hls) {\n    _classCallCheck(this, FragmentLoader);\n\n    var _this = _possibleConstructorReturn(this, (FragmentLoader.__proto__ || Object.getPrototypeOf(FragmentLoader)).call(this, hls, _events2.default.FRAG_LOADING));\n\n    _this.loaders = {};\n    return _this;\n  }\n\n  _createClass(FragmentLoader, [{\n    key: 'destroy',\n    value: function destroy() {\n      var loaders = this.loaders;\n      for (var loaderName in loaders) {\n        var loader = loaders[loaderName];\n        if (loader) {\n          loader.destroy();\n        }\n      }\n      this.loaders = {};\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'onFragLoading',\n    value: function onFragLoading(data) {\n      var frag = data.frag,\n          type = frag.type,\n          loader = this.loaders[type],\n          config = this.hls.config;\n\n      frag.loaded = 0;\n      if (loader) {\n        _logger.logger.warn('abort previous fragment loader for type:' + type);\n        loader.abort();\n      }\n      loader = this.loaders[type] = frag.loader = typeof config.fLoader !== 'undefined' ? new config.fLoader(config) : new config.loader(config);\n\n      var loaderContext = void 0,\n          loaderConfig = void 0,\n          loaderCallbacks = void 0;\n      loaderContext = { url: frag.url, frag: frag, responseType: 'arraybuffer', progressData: false };\n      var start = frag.byteRangeStartOffset,\n          end = frag.byteRangeEndOffset;\n      if (!isNaN(start) && !isNaN(end)) {\n        loaderContext.rangeStart = start;\n        loaderContext.rangeEnd = end;\n      }\n      loaderConfig = { timeout: config.fragLoadingTimeOut, maxRetry: 0, retryDelay: 0, maxRetryDelay: config.fragLoadingMaxRetryTimeout };\n      loaderCallbacks = { onSuccess: this.loadsuccess.bind(this), onError: this.loaderror.bind(this), onTimeout: this.loadtimeout.bind(this), onProgress: this.loadprogress.bind(this) };\n      loader.load(loaderContext, loaderConfig, loaderCallbacks);\n    }\n  }, {\n    key: 'loadsuccess',\n    value: function loadsuccess(response, stats, context) {\n      var payload = response.data,\n          frag = context.frag;\n      // detach fragment loader on load success\n      frag.loader = undefined;\n      this.loaders[frag.type] = undefined;\n      this.hls.trigger(_events2.default.FRAG_LOADED, { payload: payload, frag: frag, stats: stats });\n    }\n  }, {\n    key: 'loaderror',\n    value: function loaderror(response, context) {\n      var loader = context.loader;\n      if (loader) {\n        loader.abort();\n      }\n      this.loaders[context.type] = undefined;\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.FRAG_LOAD_ERROR, fatal: false, frag: context.frag, response: response });\n    }\n  }, {\n    key: 'loadtimeout',\n    value: function loadtimeout(stats, context) {\n      var loader = context.loader;\n      if (loader) {\n        loader.abort();\n      }\n      this.loaders[context.type] = undefined;\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.FRAG_LOAD_TIMEOUT, fatal: false, frag: context.frag });\n    }\n\n    // data will be used for progressive parsing\n\n  }, {\n    key: 'loadprogress',\n    value: function loadprogress(stats, context, data) {\n      // jshint ignore:line\n      var frag = context.frag;\n      frag.loaded = stats.loaded;\n      this.hls.trigger(_events2.default.FRAG_LOAD_PROGRESS, { frag: frag, stats: stats });\n    }\n  }]);\n\n  return FragmentLoader;\n}(_eventHandler2.default);\n\nexports.default = FragmentLoader;\n\n},{\"31\":31,\"32\":32,\"33\":33,\"50\":50}],40:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _errors = _dereq_(31);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Decrypt key Loader\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar KeyLoader = function (_EventHandler) {\n  _inherits(KeyLoader, _EventHandler);\n\n  function KeyLoader(hls) {\n    _classCallCheck(this, KeyLoader);\n\n    var _this = _possibleConstructorReturn(this, (KeyLoader.__proto__ || Object.getPrototypeOf(KeyLoader)).call(this, hls, _events2.default.KEY_LOADING));\n\n    _this.loaders = {};\n    _this.decryptkey = null;\n    _this.decrypturl = null;\n    return _this;\n  }\n\n  _createClass(KeyLoader, [{\n    key: 'destroy',\n    value: function destroy() {\n      for (var loaderName in this.loaders) {\n        var loader = this.loaders[loaderName];\n        if (loader) {\n          loader.destroy();\n        }\n      }\n      this.loaders = {};\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'onKeyLoading',\n    value: function onKeyLoading(data) {\n      var frag = data.frag,\n          type = frag.type,\n          loader = this.loaders[type],\n          decryptdata = frag.decryptdata,\n          uri = decryptdata.uri;\n      // if uri is different from previous one or if decrypt key not retrieved yet\n      if (uri !== this.decrypturl || this.decryptkey === null) {\n        var config = this.hls.config;\n\n        if (loader) {\n          _logger.logger.warn('abort previous key loader for type:' + type);\n          loader.abort();\n        }\n        frag.loader = this.loaders[type] = new config.loader(config);\n        this.decrypturl = uri;\n        this.decryptkey = null;\n\n        var loaderContext = void 0,\n            loaderConfig = void 0,\n            loaderCallbacks = void 0;\n        loaderContext = { url: uri, frag: frag, responseType: 'arraybuffer' };\n        loaderConfig = { timeout: config.fragLoadingTimeOut, maxRetry: config.fragLoadingMaxRetry, retryDelay: config.fragLoadingRetryDelay, maxRetryDelay: config.fragLoadingMaxRetryTimeout };\n        loaderCallbacks = { onSuccess: this.loadsuccess.bind(this), onError: this.loaderror.bind(this), onTimeout: this.loadtimeout.bind(this) };\n        frag.loader.load(loaderContext, loaderConfig, loaderCallbacks);\n      } else if (this.decryptkey) {\n        // we already loaded this key, return it\n        decryptdata.key = this.decryptkey;\n        this.hls.trigger(_events2.default.KEY_LOADED, { frag: frag });\n      }\n    }\n  }, {\n    key: 'loadsuccess',\n    value: function loadsuccess(response, stats, context) {\n      var frag = context.frag;\n      this.decryptkey = frag.decryptdata.key = new Uint8Array(response.data);\n      // detach fragment loader on load success\n      frag.loader = undefined;\n      this.loaders[frag.type] = undefined;\n      this.hls.trigger(_events2.default.KEY_LOADED, { frag: frag });\n    }\n  }, {\n    key: 'loaderror',\n    value: function loaderror(response, context) {\n      var frag = context.frag,\n          loader = frag.loader;\n      if (loader) {\n        loader.abort();\n      }\n      this.loaders[context.type] = undefined;\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.KEY_LOAD_ERROR, fatal: false, frag: frag, response: response });\n    }\n  }, {\n    key: 'loadtimeout',\n    value: function loadtimeout(stats, context) {\n      var frag = context.frag,\n          loader = frag.loader;\n      if (loader) {\n        loader.abort();\n      }\n      this.loaders[context.type] = undefined;\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.KEY_LOAD_TIMEOUT, fatal: false, frag: frag });\n    }\n  }]);\n\n  return KeyLoader;\n}(_eventHandler2.default);\n\nexports.default = KeyLoader;\n\n},{\"31\":31,\"32\":32,\"33\":33,\"50\":50}],41:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Playlist Loader\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _urlToolkit = _dereq_(2);\n\nvar _urlToolkit2 = _interopRequireDefault(_urlToolkit);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _eventHandler = _dereq_(32);\n\nvar _eventHandler2 = _interopRequireDefault(_eventHandler);\n\nvar _errors = _dereq_(31);\n\nvar _attrList = _dereq_(45);\n\nvar _attrList2 = _interopRequireDefault(_attrList);\n\nvar _logger = _dereq_(50);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// https://regex101.com is your friend\nvar MASTER_PLAYLIST_REGEX = /#EXT-X-STREAM-INF:([^\\n\\r]*)[\\r\\n]+([^\\r\\n]+)/g;\nvar MASTER_PLAYLIST_MEDIA_REGEX = /#EXT-X-MEDIA:(.*)/g;\nvar LEVEL_PLAYLIST_REGEX_FAST = /#EXTINF:(\\d*(?:\\.\\d+)?)(?:,(.*))?|(?!#)(\\S.+)|#EXT-X-BYTERANGE: *(.+)|#EXT-X-PROGRAM-DATE-TIME:(.+)|#.*/g;\nvar LEVEL_PLAYLIST_REGEX_SLOW = /(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\\d+))|(?:#EXT-X-(TARGETDURATION): *(\\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\\r?\\n?/;\n\nvar LevelKey = function () {\n  function LevelKey() {\n    _classCallCheck(this, LevelKey);\n\n    this.method = null;\n    this.key = null;\n    this.iv = null;\n    this._uri = null;\n  }\n\n  _createClass(LevelKey, [{\n    key: 'uri',\n    get: function get() {\n      if (!this._uri && this.reluri) {\n        this._uri = _urlToolkit2.default.buildAbsoluteURL(this.baseuri, this.reluri);\n      }\n      return this._uri;\n    }\n  }]);\n\n  return LevelKey;\n}();\n\nvar Fragment = function () {\n  function Fragment() {\n    _classCallCheck(this, Fragment);\n\n    this._url = null;\n    this._byteRange = null;\n    this._decryptdata = null;\n    this.tagList = [];\n  }\n\n  _createClass(Fragment, [{\n    key: 'createInitializationVector',\n\n\n    /**\n     * Utility method for parseLevelPlaylist to create an initialization vector for a given segment\n     * @returns {Uint8Array}\n     */\n    value: function createInitializationVector(segmentNumber) {\n      var uint8View = new Uint8Array(16);\n\n      for (var i = 12; i < 16; i++) {\n        uint8View[i] = segmentNumber >> 8 * (15 - i) & 0xff;\n      }\n\n      return uint8View;\n    }\n\n    /**\n     * Utility method for parseLevelPlaylist to get a fragment's decryption data from the currently parsed encryption key data\n     * @param levelkey - a playlist's encryption info\n     * @param segmentNumber - the fragment's segment number\n     * @returns {*} - an object to be applied as a fragment's decryptdata\n     */\n\n  }, {\n    key: 'fragmentDecryptdataFromLevelkey',\n    value: function fragmentDecryptdataFromLevelkey(levelkey, segmentNumber) {\n      var decryptdata = levelkey;\n\n      if (levelkey && levelkey.method && levelkey.uri && !levelkey.iv) {\n        decryptdata = new LevelKey();\n        decryptdata.method = levelkey.method;\n        decryptdata.baseuri = levelkey.baseuri;\n        decryptdata.reluri = levelkey.reluri;\n        decryptdata.iv = this.createInitializationVector(segmentNumber);\n      }\n\n      return decryptdata;\n    }\n  }, {\n    key: 'cloneObj',\n    value: function cloneObj(obj) {\n      return JSON.parse(JSON.stringify(obj));\n    }\n  }, {\n    key: 'url',\n    get: function get() {\n      if (!this._url && this.relurl) {\n        this._url = _urlToolkit2.default.buildAbsoluteURL(this.baseurl, this.relurl);\n      }\n      return this._url;\n    },\n    set: function set(value) {\n      this._url = value;\n    }\n  }, {\n    key: 'programDateTime',\n    get: function get() {\n      if (!this._programDateTime && this.rawProgramDateTime) {\n        this._programDateTime = new Date(Date.parse(this.rawProgramDateTime));\n      }\n      return this._programDateTime;\n    }\n  }, {\n    key: 'byteRange',\n    get: function get() {\n      if (!this._byteRange) {\n        var byteRange = this._byteRange = [];\n        if (this.rawByteRange) {\n          var params = this.rawByteRange.split('@', 2);\n          if (params.length === 1) {\n            var lastByteRangeEndOffset = this.lastByteRangeEndOffset;\n            byteRange[0] = lastByteRangeEndOffset ? lastByteRangeEndOffset : 0;\n          } else {\n            byteRange[0] = parseInt(params[1]);\n          }\n          byteRange[1] = parseInt(params[0]) + byteRange[0];\n        }\n      }\n      return this._byteRange;\n    }\n  }, {\n    key: 'byteRangeStartOffset',\n    get: function get() {\n      return this.byteRange[0];\n    }\n  }, {\n    key: 'byteRangeEndOffset',\n    get: function get() {\n      return this.byteRange[1];\n    }\n  }, {\n    key: 'decryptdata',\n    get: function get() {\n      if (!this._decryptdata) {\n        this._decryptdata = this.fragmentDecryptdataFromLevelkey(this.levelkey, this.sn);\n      }\n      return this._decryptdata;\n    }\n  }]);\n\n  return Fragment;\n}();\n\nvar PlaylistLoader = function (_EventHandler) {\n  _inherits(PlaylistLoader, _EventHandler);\n\n  function PlaylistLoader(hls) {\n    _classCallCheck(this, PlaylistLoader);\n\n    var _this = _possibleConstructorReturn(this, (PlaylistLoader.__proto__ || Object.getPrototypeOf(PlaylistLoader)).call(this, hls, _events2.default.MANIFEST_LOADING, _events2.default.LEVEL_LOADING, _events2.default.AUDIO_TRACK_LOADING, _events2.default.SUBTITLE_TRACK_LOADING));\n\n    _this.loaders = {};\n    return _this;\n  }\n\n  _createClass(PlaylistLoader, [{\n    key: 'destroy',\n    value: function destroy() {\n      for (var loaderName in this.loaders) {\n        var loader = this.loaders[loaderName];\n        if (loader) {\n          loader.destroy();\n        }\n      }\n      this.loaders = {};\n      _eventHandler2.default.prototype.destroy.call(this);\n    }\n  }, {\n    key: 'onManifestLoading',\n    value: function onManifestLoading(data) {\n      this.load(data.url, { type: 'manifest' });\n    }\n  }, {\n    key: 'onLevelLoading',\n    value: function onLevelLoading(data) {\n      this.load(data.url, { type: 'level', level: data.level, id: data.id });\n    }\n  }, {\n    key: 'onAudioTrackLoading',\n    value: function onAudioTrackLoading(data) {\n      this.load(data.url, { type: 'audioTrack', id: data.id });\n    }\n  }, {\n    key: 'onSubtitleTrackLoading',\n    value: function onSubtitleTrackLoading(data) {\n      this.load(data.url, { type: 'subtitleTrack', id: data.id });\n    }\n  }, {\n    key: 'load',\n    value: function load(url, context) {\n      var loader = this.loaders[context.type];\n      if (loader) {\n        var loaderContext = loader.context;\n        if (loaderContext && loaderContext.url === url) {\n          _logger.logger.trace('playlist request ongoing');\n          return;\n        } else {\n          _logger.logger.warn('abort previous loader for type:' + context.type);\n          loader.abort();\n        }\n      }\n      var config = this.hls.config,\n          retry = void 0,\n          timeout = void 0,\n          retryDelay = void 0,\n          maxRetryDelay = void 0;\n      if (context.type === 'manifest') {\n        retry = config.manifestLoadingMaxRetry;\n        timeout = config.manifestLoadingTimeOut;\n        retryDelay = config.manifestLoadingRetryDelay;\n        maxRetryDelay = config.manifestLoadingMaxRetryTimeout;\n      } else {\n        retry = config.levelLoadingMaxRetry;\n        timeout = config.levelLoadingTimeOut;\n        retryDelay = config.levelLoadingRetryDelay;\n        maxRetryDelay = config.levelLoadingMaxRetryTimeout;\n        _logger.logger.log('loading playlist for ' + context.type + ' ' + (context.level || context.id));\n      }\n      loader = this.loaders[context.type] = context.loader = typeof config.pLoader !== 'undefined' ? new config.pLoader(config) : new config.loader(config);\n      context.url = url;\n      context.responseType = '';\n\n      var loaderConfig = void 0,\n          loaderCallbacks = void 0;\n      loaderConfig = { timeout: timeout, maxRetry: retry, retryDelay: retryDelay, maxRetryDelay: maxRetryDelay };\n      loaderCallbacks = { onSuccess: this.loadsuccess.bind(this), onError: this.loaderror.bind(this), onTimeout: this.loadtimeout.bind(this) };\n      loader.load(context, loaderConfig, loaderCallbacks);\n    }\n  }, {\n    key: 'resolve',\n    value: function resolve(url, baseUrl) {\n      return _urlToolkit2.default.buildAbsoluteURL(baseUrl, url);\n    }\n  }, {\n    key: 'parseMasterPlaylist',\n    value: function parseMasterPlaylist(string, baseurl) {\n      var levels = [],\n          result = void 0;\n      MASTER_PLAYLIST_REGEX.lastIndex = 0;\n      while ((result = MASTER_PLAYLIST_REGEX.exec(string)) != null) {\n        var level = {};\n\n        var attrs = level.attrs = new _attrList2.default(result[1]);\n        level.url = this.resolve(result[2], baseurl);\n\n        var resolution = attrs.decimalResolution('RESOLUTION');\n        if (resolution) {\n          level.width = resolution.width;\n          level.height = resolution.height;\n        }\n        level.bitrate = attrs.decimalInteger('AVERAGE-BANDWIDTH') || attrs.decimalInteger('BANDWIDTH');\n        level.name = attrs.NAME;\n\n        var codecs = attrs.CODECS;\n        if (codecs) {\n          codecs = codecs.split(/[ ,]+/);\n          for (var i = 0; i < codecs.length; i++) {\n            var codec = codecs[i];\n            if (codec.indexOf('avc1') !== -1) {\n              level.videoCodec = this.avc1toavcoti(codec);\n            } else {\n              level.audioCodec = codec;\n            }\n          }\n        }\n\n        levels.push(level);\n      }\n      return levels;\n    }\n  }, {\n    key: 'parseMasterPlaylistMedia',\n    value: function parseMasterPlaylistMedia(string, baseurl, type) {\n      var result = void 0,\n          medias = [],\n          id = 0;\n      MASTER_PLAYLIST_MEDIA_REGEX.lastIndex = 0;\n      while ((result = MASTER_PLAYLIST_MEDIA_REGEX.exec(string)) != null) {\n        var media = {};\n        var attrs = new _attrList2.default(result[1]);\n        if (attrs.TYPE === type) {\n          media.groupId = attrs['GROUP-ID'];\n          media.name = attrs.NAME;\n          media.type = type;\n          media.default = attrs.DEFAULT === 'YES';\n          media.autoselect = attrs.AUTOSELECT === 'YES';\n          media.forced = attrs.FORCED === 'YES';\n          if (attrs.URI) {\n            media.url = this.resolve(attrs.URI, baseurl);\n          }\n          media.lang = attrs.LANGUAGE;\n          if (!media.name) {\n            media.name = media.lang;\n          }\n          media.id = id++;\n          medias.push(media);\n        }\n      }\n      return medias;\n    }\n  }, {\n    key: 'avc1toavcoti',\n    value: function avc1toavcoti(codec) {\n      var result,\n          avcdata = codec.split('.');\n      if (avcdata.length > 2) {\n        result = avcdata.shift() + '.';\n        result += parseInt(avcdata.shift()).toString(16);\n        result += ('000' + parseInt(avcdata.shift()).toString(16)).substr(-4);\n      } else {\n        result = codec;\n      }\n      return result;\n    }\n  }, {\n    key: 'parseLevelPlaylist',\n    value: function parseLevelPlaylist(string, baseurl, id, type) {\n      var currentSN = 0,\n          totalduration = 0,\n          level = { type: null, version: null, url: baseurl, fragments: [], live: true, startSN: 0 },\n          levelkey = new LevelKey(),\n          cc = 0,\n          prevFrag = null,\n          frag = new Fragment(),\n          result,\n          i;\n\n      LEVEL_PLAYLIST_REGEX_FAST.lastIndex = 0;\n\n      while ((result = LEVEL_PLAYLIST_REGEX_FAST.exec(string)) !== null) {\n        var duration = result[1];\n        if (duration) {\n          // INF\n          frag.duration = parseFloat(duration);\n          // avoid sliced strings    https://github.com/dailymotion/hls.js/issues/939\n          var title = (' ' + result[2]).slice(1);\n          frag.title = title ? title : null;\n          frag.tagList.push(title ? ['INF', duration, title] : ['INF', duration]);\n        } else if (result[3]) {\n          // url\n          if (!isNaN(frag.duration)) {\n            var sn = currentSN++;\n            frag.type = type;\n            frag.start = totalduration;\n            frag.levelkey = levelkey;\n            frag.sn = sn;\n            frag.level = id;\n            frag.cc = cc;\n            frag.baseurl = baseurl;\n            // avoid sliced strings    https://github.com/dailymotion/hls.js/issues/939\n            frag.relurl = (' ' + result[3]).slice(1);\n\n            level.fragments.push(frag);\n            prevFrag = frag;\n            totalduration += frag.duration;\n\n            frag = new Fragment();\n          }\n        } else if (result[4]) {\n          // X-BYTERANGE\n          frag.rawByteRange = (' ' + result[4]).slice(1);\n          if (prevFrag) {\n            var lastByteRangeEndOffset = prevFrag.byteRangeEndOffset;\n            if (lastByteRangeEndOffset) {\n              frag.lastByteRangeEndOffset = lastByteRangeEndOffset;\n            }\n          }\n        } else if (result[5]) {\n          // PROGRAM-DATE-TIME\n          // avoid sliced strings    https://github.com/dailymotion/hls.js/issues/939\n          frag.rawProgramDateTime = (' ' + result[5]).slice(1);\n          frag.tagList.push(['PROGRAM-DATE-TIME', frag.rawProgramDateTime]);\n        } else {\n          result = result[0].match(LEVEL_PLAYLIST_REGEX_SLOW);\n          for (i = 1; i < result.length; i++) {\n            if (result[i] !== undefined) {\n              break;\n            }\n          }\n\n          // avoid sliced strings    https://github.com/dailymotion/hls.js/issues/939\n          var value1 = (' ' + result[i + 1]).slice(1);\n          var value2 = (' ' + result[i + 2]).slice(1);\n\n          switch (result[i]) {\n            case '#':\n              frag.tagList.push(value2 ? [value1, value2] : [value1]);\n              break;\n            case 'PLAYLIST-TYPE':\n              level.type = value1.toUpperCase();\n              break;\n            case 'MEDIA-SEQUENCE':\n              currentSN = level.startSN = parseInt(value1);\n              break;\n            case 'TARGETDURATION':\n              level.targetduration = parseFloat(value1);\n              break;\n            case 'VERSION':\n              level.version = parseInt(value1);\n              break;\n            case 'EXTM3U':\n              break;\n            case 'ENDLIST':\n              level.live = false;\n              break;\n            case 'DIS':\n              cc++;\n              frag.tagList.push(['DIS']);\n              break;\n            case 'DISCONTINUITY-SEQ':\n              cc = parseInt(value1);\n              break;\n            case 'KEY':\n              // https://tools.ietf.org/html/draft-pantos-http-live-streaming-08#section-3.4.4\n              var decryptparams = value1;\n              var keyAttrs = new _attrList2.default(decryptparams);\n              var decryptmethod = keyAttrs.enumeratedString('METHOD'),\n                  decrypturi = keyAttrs.URI,\n                  decryptiv = keyAttrs.hexadecimalInteger('IV');\n              if (decryptmethod) {\n                levelkey = new LevelKey();\n                if (decrypturi && ['AES-128', 'SAMPLE-AES'].indexOf(decryptmethod) >= 0) {\n                  levelkey.method = decryptmethod;\n                  // URI to get the key\n                  levelkey.baseuri = baseurl;\n                  levelkey.reluri = decrypturi;\n                  levelkey.key = null;\n                  // Initialization Vector (IV)\n                  levelkey.iv = decryptiv;\n                }\n              }\n              break;\n            case 'START':\n              var startParams = value1;\n              var startAttrs = new _attrList2.default(startParams);\n              var startTimeOffset = startAttrs.decimalFloatingPoint('TIME-OFFSET');\n              //TIME-OFFSET can be 0\n              if (!isNaN(startTimeOffset)) {\n                level.startTimeOffset = startTimeOffset;\n              }\n              break;\n            case 'MAP':\n              var mapAttrs = new _attrList2.default(value1);\n              frag.relurl = mapAttrs.URI;\n              frag.rawByteRange = mapAttrs.BYTERANGE;\n              frag.baseurl = baseurl;\n              frag.level = id;\n              frag.type = type;\n              frag.sn = 'initSegment';\n              level.initSegment = frag;\n              frag = new Fragment();\n              break;\n            default:\n              _logger.logger.warn('line parsed but not handled: ' + result);\n              break;\n          }\n        }\n      }\n      frag = prevFrag;\n      //logger.log('found ' + level.fragments.length + ' fragments');\n      if (frag && !frag.relurl) {\n        level.fragments.pop();\n        totalduration -= frag.duration;\n      }\n      level.totalduration = totalduration;\n      level.averagetargetduration = totalduration / level.fragments.length;\n      level.endSN = currentSN - 1;\n      return level;\n    }\n  }, {\n    key: 'loadsuccess',\n    value: function loadsuccess(response, stats, context) {\n      var string = response.data,\n          url = response.url,\n          type = context.type,\n          id = context.id,\n          level = context.level,\n          hls = this.hls;\n\n      this.loaders[type] = undefined;\n      // responseURL not supported on some browsers (it is used to detect URL redirection)\n      // data-uri mode also not supported (but no need to detect redirection)\n      if (url === undefined || url.indexOf('data:') === 0) {\n        // fallback to initial URL\n        url = context.url;\n      }\n      stats.tload = performance.now();\n      //stats.mtime = new Date(target.getResponseHeader('Last-Modified'));\n      if (string.indexOf('#EXTM3U') === 0) {\n        if (string.indexOf('#EXTINF:') > 0) {\n          var isLevel = type !== 'audioTrack' && type !== 'subtitleTrack',\n              levelId = !isNaN(level) ? level : !isNaN(id) ? id : 0,\n              levelDetails = this.parseLevelPlaylist(string, url, levelId, type === 'audioTrack' ? 'audio' : type === 'subtitleTrack' ? 'subtitle' : 'main');\n          levelDetails.tload = stats.tload;\n          if (type === 'manifest') {\n            // first request, stream manifest (no master playlist), fire manifest loaded event with level details\n            hls.trigger(_events2.default.MANIFEST_LOADED, { levels: [{ url: url, details: levelDetails }], audioTracks: [], url: url, stats: stats });\n          }\n          stats.tparsed = performance.now();\n          if (levelDetails.targetduration) {\n            if (isLevel) {\n              hls.trigger(_events2.default.LEVEL_LOADED, { details: levelDetails, level: level || 0, id: id || 0, stats: stats });\n            } else {\n              if (type === 'audioTrack') {\n                hls.trigger(_events2.default.AUDIO_TRACK_LOADED, { details: levelDetails, id: id, stats: stats });\n              } else if (type === 'subtitleTrack') {\n                hls.trigger(_events2.default.SUBTITLE_TRACK_LOADED, { details: levelDetails, id: id, stats: stats });\n              }\n            }\n          } else {\n            hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.MANIFEST_PARSING_ERROR, fatal: true, url: url, reason: 'invalid targetduration' });\n          }\n        } else {\n          var levels = this.parseMasterPlaylist(string, url);\n          // multi level playlist, parse level info\n          if (levels.length) {\n            var audioTracks = this.parseMasterPlaylistMedia(string, url, 'AUDIO');\n            var subtitles = this.parseMasterPlaylistMedia(string, url, 'SUBTITLES');\n            if (audioTracks.length) {\n              // check if we have found an audio track embedded in main playlist (audio track without URI attribute)\n              var embeddedAudioFound = false;\n              audioTracks.forEach(function (audioTrack) {\n                if (!audioTrack.url) {\n                  embeddedAudioFound = true;\n                }\n              });\n              // if no embedded audio track defined, but audio codec signaled in quality level, we need to signal this main audio track\n              // this could happen with playlists with alt audio rendition in which quality levels (main) contains both audio+video. but with mixed audio track not signaled\n              if (embeddedAudioFound === false && levels[0].audioCodec && !levels[0].attrs.AUDIO) {\n                _logger.logger.log('audio codec signaled in quality level, but no embedded audio track signaled, create one');\n                audioTracks.unshift({ type: 'main', name: 'main' });\n              }\n            }\n            hls.trigger(_events2.default.MANIFEST_LOADED, { levels: levels, audioTracks: audioTracks, subtitles: subtitles, url: url, stats: stats });\n          } else {\n            hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.MANIFEST_PARSING_ERROR, fatal: true, url: url, reason: 'no level found in manifest' });\n          }\n        }\n      } else {\n        hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: _errors.ErrorDetails.MANIFEST_PARSING_ERROR, fatal: true, url: url, reason: 'no EXTM3U delimiter' });\n      }\n    }\n  }, {\n    key: 'loaderror',\n    value: function loaderror(response, context) {\n      var details,\n          fatal,\n          loader = context.loader;\n      switch (context.type) {\n        case 'manifest':\n          details = _errors.ErrorDetails.MANIFEST_LOAD_ERROR;\n          fatal = true;\n          break;\n        case 'level':\n          details = _errors.ErrorDetails.LEVEL_LOAD_ERROR;\n          fatal = false;\n          break;\n        case 'audioTrack':\n          details = _errors.ErrorDetails.AUDIO_TRACK_LOAD_ERROR;\n          fatal = false;\n          break;\n      }\n      if (loader) {\n        loader.abort();\n        this.loaders[context.type] = undefined;\n      }\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: details, fatal: fatal, url: loader.url, loader: loader, response: response, context: context });\n    }\n  }, {\n    key: 'loadtimeout',\n    value: function loadtimeout(stats, context) {\n      var details,\n          fatal,\n          loader = context.loader;\n      switch (context.type) {\n        case 'manifest':\n          details = _errors.ErrorDetails.MANIFEST_LOAD_TIMEOUT;\n          fatal = true;\n          break;\n        case 'level':\n          details = _errors.ErrorDetails.LEVEL_LOAD_TIMEOUT;\n          fatal = false;\n          break;\n        case 'audioTrack':\n          details = _errors.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT;\n          fatal = false;\n          break;\n      }\n      if (loader) {\n        loader.abort();\n        this.loaders[context.type] = undefined;\n      }\n      this.hls.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.NETWORK_ERROR, details: details, fatal: fatal, url: loader.url, loader: loader, context: context });\n    }\n  }]);\n\n  return PlaylistLoader;\n}(_eventHandler2.default);\n\nexports.default = PlaylistLoader;\n\n},{\"2\":2,\"31\":31,\"32\":32,\"33\":33,\"45\":45,\"50\":50}],42:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Generate MP4 Box\n*/\n\n//import Hex from '../utils/hex';\nvar MP4 = function () {\n  function MP4() {\n    _classCallCheck(this, MP4);\n  }\n\n  _createClass(MP4, null, [{\n    key: 'init',\n    value: function init() {\n      MP4.types = {\n        avc1: [], // codingname\n        avcC: [],\n        btrt: [],\n        dinf: [],\n        dref: [],\n        esds: [],\n        ftyp: [],\n        hdlr: [],\n        mdat: [],\n        mdhd: [],\n        mdia: [],\n        mfhd: [],\n        minf: [],\n        moof: [],\n        moov: [],\n        mp4a: [],\n        '.mp3': [],\n        mvex: [],\n        mvhd: [],\n        pasp: [],\n        sdtp: [],\n        stbl: [],\n        stco: [],\n        stsc: [],\n        stsd: [],\n        stsz: [],\n        stts: [],\n        tfdt: [],\n        tfhd: [],\n        traf: [],\n        trak: [],\n        trun: [],\n        trex: [],\n        tkhd: [],\n        vmhd: [],\n        smhd: []\n      };\n\n      var i;\n      for (i in MP4.types) {\n        if (MP4.types.hasOwnProperty(i)) {\n          MP4.types[i] = [i.charCodeAt(0), i.charCodeAt(1), i.charCodeAt(2), i.charCodeAt(3)];\n        }\n      }\n\n      var videoHdlr = new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x56, 0x69, 0x64, 0x65, 0x6f, 0x48, 0x61, 0x6e, 0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\n      ]);\n\n      var audioHdlr = new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // pre_defined\n      0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x53, 0x6f, 0x75, 0x6e, 0x64, 0x48, 0x61, 0x6e, 0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\n      ]);\n\n      MP4.HDLR_TYPES = {\n        'video': videoHdlr,\n        'audio': audioHdlr\n      };\n\n      var dref = new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01, // entry_count\n      0x00, 0x00, 0x00, 0x0c, // entry_size\n      0x75, 0x72, 0x6c, 0x20, // 'url' type\n      0x00, // version 0\n      0x00, 0x00, 0x01 // entry_flags\n      ]);\n\n      var stco = new Uint8Array([0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00 // entry_count\n      ]);\n\n      MP4.STTS = MP4.STSC = MP4.STCO = stco;\n\n      MP4.STSZ = new Uint8Array([0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x00, // sample_size\n      0x00, 0x00, 0x00, 0x00]);\n      MP4.VMHD = new Uint8Array([0x00, // version\n      0x00, 0x00, 0x01, // flags\n      0x00, 0x00, // graphicsmode\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00 // opcolor\n      ]);\n      MP4.SMHD = new Uint8Array([0x00, // version\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, // balance\n      0x00, 0x00 // reserved\n      ]);\n\n      MP4.STSD = new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01]); // entry_count\n\n      var majorBrand = new Uint8Array([105, 115, 111, 109]); // isom\n      var avc1Brand = new Uint8Array([97, 118, 99, 49]); // avc1\n      var minorVersion = new Uint8Array([0, 0, 0, 1]);\n\n      MP4.FTYP = MP4.box(MP4.types.ftyp, majorBrand, minorVersion, majorBrand, avc1Brand);\n      MP4.DINF = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, dref));\n    }\n  }, {\n    key: 'box',\n    value: function box(type) {\n      var payload = Array.prototype.slice.call(arguments, 1),\n          size = 8,\n          i = payload.length,\n          len = i,\n          result;\n      // calculate the total size we need to allocate\n      while (i--) {\n        size += payload[i].byteLength;\n      }\n      result = new Uint8Array(size);\n      result[0] = size >> 24 & 0xff;\n      result[1] = size >> 16 & 0xff;\n      result[2] = size >> 8 & 0xff;\n      result[3] = size & 0xff;\n      result.set(type, 4);\n      // copy the payload into the result\n      for (i = 0, size = 8; i < len; i++) {\n        // copy payload[i] array @ offset size\n        result.set(payload[i], size);\n        size += payload[i].byteLength;\n      }\n      return result;\n    }\n  }, {\n    key: 'hdlr',\n    value: function hdlr(type) {\n      return MP4.box(MP4.types.hdlr, MP4.HDLR_TYPES[type]);\n    }\n  }, {\n    key: 'mdat',\n    value: function mdat(data) {\n      return MP4.box(MP4.types.mdat, data);\n    }\n  }, {\n    key: 'mdhd',\n    value: function mdhd(timescale, duration) {\n      duration *= timescale;\n      return MP4.box(MP4.types.mdhd, new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x02, // creation_time\n      0x00, 0x00, 0x00, 0x03, // modification_time\n      timescale >> 24 & 0xFF, timescale >> 16 & 0xFF, timescale >> 8 & 0xFF, timescale & 0xFF, // timescale\n      duration >> 24, duration >> 16 & 0xFF, duration >> 8 & 0xFF, duration & 0xFF, // duration\n      0x55, 0xc4, // 'und' language (undetermined)\n      0x00, 0x00]));\n    }\n  }, {\n    key: 'mdia',\n    value: function mdia(track) {\n      return MP4.box(MP4.types.mdia, MP4.mdhd(track.timescale, track.duration), MP4.hdlr(track.type), MP4.minf(track));\n    }\n  }, {\n    key: 'mfhd',\n    value: function mfhd(sequenceNumber) {\n      return MP4.box(MP4.types.mfhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // flags\n      sequenceNumber >> 24, sequenceNumber >> 16 & 0xFF, sequenceNumber >> 8 & 0xFF, sequenceNumber & 0xFF]));\n    }\n  }, {\n    key: 'minf',\n    value: function minf(track) {\n      if (track.type === 'audio') {\n        return MP4.box(MP4.types.minf, MP4.box(MP4.types.smhd, MP4.SMHD), MP4.DINF, MP4.stbl(track));\n      } else {\n        return MP4.box(MP4.types.minf, MP4.box(MP4.types.vmhd, MP4.VMHD), MP4.DINF, MP4.stbl(track));\n      }\n    }\n  }, {\n    key: 'moof',\n    value: function moof(sn, baseMediaDecodeTime, track) {\n      return MP4.box(MP4.types.moof, MP4.mfhd(sn), MP4.traf(track, baseMediaDecodeTime));\n    }\n    /**\n     * @param tracks... (optional) {array} the tracks associated with this movie\n     */\n\n  }, {\n    key: 'moov',\n    value: function moov(tracks) {\n      var i = tracks.length,\n          boxes = [];\n\n      while (i--) {\n        boxes[i] = MP4.trak(tracks[i]);\n      }\n\n      return MP4.box.apply(null, [MP4.types.moov, MP4.mvhd(tracks[0].timescale, tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)));\n    }\n  }, {\n    key: 'mvex',\n    value: function mvex(tracks) {\n      var i = tracks.length,\n          boxes = [];\n\n      while (i--) {\n        boxes[i] = MP4.trex(tracks[i]);\n      }\n      return MP4.box.apply(null, [MP4.types.mvex].concat(boxes));\n    }\n  }, {\n    key: 'mvhd',\n    value: function mvhd(timescale, duration) {\n      duration *= timescale;\n      var bytes = new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      0x00, 0x00, 0x00, 0x01, // creation_time\n      0x00, 0x00, 0x00, 0x02, // modification_time\n      timescale >> 24 & 0xFF, timescale >> 16 & 0xFF, timescale >> 8 & 0xFF, timescale & 0xFF, // timescale\n      duration >> 24 & 0xFF, duration >> 16 & 0xFF, duration >> 8 & 0xFF, duration & 0xFF, // duration\n      0x00, 0x01, 0x00, 0x00, // 1.0 rate\n      0x01, 0x00, // 1.0 volume\n      0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // pre_defined\n      0xff, 0xff, 0xff, 0xff // next_track_ID\n      ]);\n      return MP4.box(MP4.types.mvhd, bytes);\n    }\n  }, {\n    key: 'sdtp',\n    value: function sdtp(track) {\n      var samples = track.samples || [],\n          bytes = new Uint8Array(4 + samples.length),\n          flags,\n          i;\n      // leave the full box header (4 bytes) all zero\n      // write the sample table\n      for (i = 0; i < samples.length; i++) {\n        flags = samples[i].flags;\n        bytes[i + 4] = flags.dependsOn << 4 | flags.isDependedOn << 2 | flags.hasRedundancy;\n      }\n\n      return MP4.box(MP4.types.sdtp, bytes);\n    }\n  }, {\n    key: 'stbl',\n    value: function stbl(track) {\n      return MP4.box(MP4.types.stbl, MP4.stsd(track), MP4.box(MP4.types.stts, MP4.STTS), MP4.box(MP4.types.stsc, MP4.STSC), MP4.box(MP4.types.stsz, MP4.STSZ), MP4.box(MP4.types.stco, MP4.STCO));\n    }\n  }, {\n    key: 'avc1',\n    value: function avc1(track) {\n      var sps = [],\n          pps = [],\n          i,\n          data,\n          len;\n      // assemble the SPSs\n\n      for (i = 0; i < track.sps.length; i++) {\n        data = track.sps[i];\n        len = data.byteLength;\n        sps.push(len >>> 8 & 0xFF);\n        sps.push(len & 0xFF);\n        sps = sps.concat(Array.prototype.slice.call(data)); // SPS\n      }\n\n      // assemble the PPSs\n      for (i = 0; i < track.pps.length; i++) {\n        data = track.pps[i];\n        len = data.byteLength;\n        pps.push(len >>> 8 & 0xFF);\n        pps.push(len & 0xFF);\n        pps = pps.concat(Array.prototype.slice.call(data));\n      }\n\n      var avcc = MP4.box(MP4.types.avcC, new Uint8Array([0x01, // version\n      sps[3], // profile\n      sps[4], // profile compat\n      sps[5], // level\n      0xfc | 3, // lengthSizeMinusOne, hard-coded to 4 bytes\n      0xE0 | track.sps.length // 3bit reserved (111) + numOfSequenceParameterSets\n      ].concat(sps).concat([track.pps.length // numOfPictureParameterSets\n      ]).concat(pps))),\n          // \"PPS\"\n      width = track.width,\n          height = track.height,\n          hSpacing = track.pixelRatio[0],\n          vSpacing = track.pixelRatio[1];\n      //console.log('avcc:' + Hex.hexDump(avcc));\n      return MP4.box(MP4.types.avc1, new Uint8Array([0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, // pre_defined\n      0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // pre_defined\n      width >> 8 & 0xFF, width & 0xff, // width\n      height >> 8 & 0xFF, height & 0xff, // height\n      0x00, 0x48, 0x00, 0x00, // horizresolution\n      0x00, 0x48, 0x00, 0x00, // vertresolution\n      0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // frame_count\n      0x12, 0x64, 0x61, 0x69, 0x6C, //dailymotion/hls.js\n      0x79, 0x6D, 0x6F, 0x74, 0x69, 0x6F, 0x6E, 0x2F, 0x68, 0x6C, 0x73, 0x2E, 0x6A, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // compressorname\n      0x00, 0x18, // depth = 24\n      0x11, 0x11]), // pre_defined = -1\n      avcc, MP4.box(MP4.types.btrt, new Uint8Array([0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\n      0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\n      0x00, 0x2d, 0xc6, 0xc0])), // avgBitrate\n      MP4.box(MP4.types.pasp, new Uint8Array([hSpacing >> 24, // hSpacing\n      hSpacing >> 16 & 0xFF, hSpacing >> 8 & 0xFF, hSpacing & 0xFF, vSpacing >> 24, // vSpacing\n      vSpacing >> 16 & 0xFF, vSpacing >> 8 & 0xFF, vSpacing & 0xFF])));\n    }\n  }, {\n    key: 'esds',\n    value: function esds(track) {\n      var configlen = track.config.length;\n      return new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n\n      0x03, // descriptor_type\n      0x17 + configlen, // length\n      0x00, 0x01, //es_id\n      0x00, // stream_priority\n\n      0x04, // descriptor_type\n      0x0f + configlen, // length\n      0x40, //codec : mpeg4_audio\n      0x15, // stream_type\n      0x00, 0x00, 0x00, // buffer_size\n      0x00, 0x00, 0x00, 0x00, // maxBitrate\n      0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n      0x05 // descriptor_type\n      ].concat([configlen]).concat(track.config).concat([0x06, 0x01, 0x02])); // GASpecificConfig)); // length + audio config descriptor\n    }\n  }, {\n    key: 'mp4a',\n    value: function mp4a(track) {\n      var audiosamplerate = track.audiosamplerate;\n      return MP4.box(MP4.types.mp4a, new Uint8Array([0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      audiosamplerate >> 8 & 0xFF, audiosamplerate & 0xff, //\n      0x00, 0x00]), MP4.box(MP4.types.esds, MP4.esds(track)));\n    }\n  }, {\n    key: 'mp3',\n    value: function mp3(track) {\n      var audiosamplerate = track.audiosamplerate;\n      return MP4.box(MP4.types['.mp3'], new Uint8Array([0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, 0x00, // reserved\n      0x00, 0x01, // data_reference_index\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, track.channelCount, // channelcount\n      0x00, 0x10, // sampleSize:16bits\n      0x00, 0x00, 0x00, 0x00, // reserved2\n      audiosamplerate >> 8 & 0xFF, audiosamplerate & 0xff, //\n      0x00, 0x00]));\n    }\n  }, {\n    key: 'stsd',\n    value: function stsd(track) {\n      if (track.type === 'audio') {\n        if (!track.isAAC && track.codec === 'mp3') {\n          return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp3(track));\n        }\n        return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp4a(track));\n      } else {\n        return MP4.box(MP4.types.stsd, MP4.STSD, MP4.avc1(track));\n      }\n    }\n  }, {\n    key: 'tkhd',\n    value: function tkhd(track) {\n      var id = track.id,\n          duration = track.duration * track.timescale,\n          width = track.width,\n          height = track.height;\n      return MP4.box(MP4.types.tkhd, new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x07, // flags\n      0x00, 0x00, 0x00, 0x00, // creation_time\n      0x00, 0x00, 0x00, 0x00, // modification_time\n      id >> 24 & 0xFF, id >> 16 & 0xFF, id >> 8 & 0xFF, id & 0xFF, // track_ID\n      0x00, 0x00, 0x00, 0x00, // reserved\n      duration >> 24, duration >> 16 & 0xFF, duration >> 8 & 0xFF, duration & 0xFF, // duration\n      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // reserved\n      0x00, 0x00, // layer\n      0x00, 0x00, // alternate_group\n      0x00, 0x00, // non-audio track volume\n      0x00, 0x00, // reserved\n      0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n      width >> 8 & 0xFF, width & 0xFF, 0x00, 0x00, // width\n      height >> 8 & 0xFF, height & 0xFF, 0x00, 0x00 // height\n      ]));\n    }\n  }, {\n    key: 'traf',\n    value: function traf(track, baseMediaDecodeTime) {\n      var sampleDependencyTable = MP4.sdtp(track),\n          id = track.id;\n      return MP4.box(MP4.types.traf, MP4.box(MP4.types.tfhd, new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      id >> 24, id >> 16 & 0XFF, id >> 8 & 0XFF, id & 0xFF])), MP4.box(MP4.types.tfdt, new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      baseMediaDecodeTime >> 24, baseMediaDecodeTime >> 16 & 0XFF, baseMediaDecodeTime >> 8 & 0XFF, baseMediaDecodeTime & 0xFF])), MP4.trun(track, sampleDependencyTable.length + 16 + // tfhd\n      16 + // tfdt\n      8 + // traf header\n      16 + // mfhd\n      8 + // moof header\n      8), // mdat header\n      sampleDependencyTable);\n    }\n\n    /**\n     * Generate a track box.\n     * @param track {object} a track definition\n     * @return {Uint8Array} the track box\n     */\n\n  }, {\n    key: 'trak',\n    value: function trak(track) {\n      track.duration = track.duration || 0xffffffff;\n      return MP4.box(MP4.types.trak, MP4.tkhd(track), MP4.mdia(track));\n    }\n  }, {\n    key: 'trex',\n    value: function trex(track) {\n      var id = track.id;\n      return MP4.box(MP4.types.trex, new Uint8Array([0x00, // version 0\n      0x00, 0x00, 0x00, // flags\n      id >> 24, id >> 16 & 0XFF, id >> 8 & 0XFF, id & 0xFF, // track_ID\n      0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n      0x00, 0x00, 0x00, 0x00, // default_sample_duration\n      0x00, 0x00, 0x00, 0x00, // default_sample_size\n      0x00, 0x01, 0x00, 0x01 // default_sample_flags\n      ]));\n    }\n  }, {\n    key: 'trun',\n    value: function trun(track, offset) {\n      var samples = track.samples || [],\n          len = samples.length,\n          arraylen = 12 + 16 * len,\n          array = new Uint8Array(arraylen),\n          i,\n          sample,\n          duration,\n          size,\n          flags,\n          cts;\n      offset += 8 + arraylen;\n      array.set([0x00, // version 0\n      0x00, 0x0f, 0x01, // flags\n      len >>> 24 & 0xFF, len >>> 16 & 0xFF, len >>> 8 & 0xFF, len & 0xFF, // sample_count\n      offset >>> 24 & 0xFF, offset >>> 16 & 0xFF, offset >>> 8 & 0xFF, offset & 0xFF // data_offset\n      ], 0);\n      for (i = 0; i < len; i++) {\n        sample = samples[i];\n        duration = sample.duration;\n        size = sample.size;\n        flags = sample.flags;\n        cts = sample.cts;\n        array.set([duration >>> 24 & 0xFF, duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, // sample_duration\n        size >>> 24 & 0xFF, size >>> 16 & 0xFF, size >>> 8 & 0xFF, size & 0xFF, // sample_size\n        flags.isLeading << 2 | flags.dependsOn, flags.isDependedOn << 6 | flags.hasRedundancy << 4 | flags.paddingValue << 1 | flags.isNonSync, flags.degradPrio & 0xF0 << 8, flags.degradPrio & 0x0F, // sample_flags\n        cts >>> 24 & 0xFF, cts >>> 16 & 0xFF, cts >>> 8 & 0xFF, cts & 0xFF // sample_composition_time_offset\n        ], 12 + 16 * i);\n      }\n      return MP4.box(MP4.types.trun, array);\n    }\n  }, {\n    key: 'initSegment',\n    value: function initSegment(tracks) {\n      if (!MP4.types) {\n        MP4.init();\n      }\n      var movie = MP4.moov(tracks),\n          result;\n      result = new Uint8Array(MP4.FTYP.byteLength + movie.byteLength);\n      result.set(MP4.FTYP);\n      result.set(movie, MP4.FTYP.byteLength);\n      return result;\n    }\n  }]);\n\n  return MP4;\n}();\n\nexports.default = MP4;\n\n},{}],43:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * fMP4 remuxer\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _aac = _dereq_(34);\n\nvar _aac2 = _interopRequireDefault(_aac);\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_(50);\n\nvar _mp4Generator = _dereq_(42);\n\nvar _mp4Generator2 = _interopRequireDefault(_mp4Generator);\n\nvar _errors = _dereq_(31);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MP4Remuxer = function () {\n  function MP4Remuxer(observer, config, typeSupported) {\n    _classCallCheck(this, MP4Remuxer);\n\n    this.observer = observer;\n    this.config = config;\n    this.typeSupported = typeSupported;\n    this.ISGenerated = false;\n    this.PES2MP4SCALEFACTOR = 4;\n    this.PES_TIMESCALE = 90000;\n    this.MP4_TIMESCALE = this.PES_TIMESCALE / this.PES2MP4SCALEFACTOR;\n  }\n\n  _createClass(MP4Remuxer, [{\n    key: 'destroy',\n    value: function destroy() {}\n  }, {\n    key: 'resetTimeStamp',\n    value: function resetTimeStamp(defaultTimeStamp) {\n      this._initPTS = this._initDTS = defaultTimeStamp;\n    }\n  }, {\n    key: 'resetInitSegment',\n    value: function resetInitSegment() {\n      this.ISGenerated = false;\n    }\n  }, {\n    key: 'remux',\n    value: function remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset) {\n      // generate Init Segment if needed\n      if (!this.ISGenerated) {\n        this.generateIS(audioTrack, videoTrack, timeOffset);\n      }\n\n      if (this.ISGenerated) {\n        // Purposefully remuxing audio before video, so that remuxVideo can use nextAudioPts, which is\n        // calculated in remuxAudio.\n        //logger.log('nb AAC samples:' + audioTrack.samples.length);\n        if (audioTrack.samples.length) {\n          var audioData = this.remuxAudio(audioTrack, timeOffset, contiguous, accurateTimeOffset);\n          //logger.log('nb AVC samples:' + videoTrack.samples.length);\n          if (videoTrack.samples.length) {\n            var audioTrackLength = void 0;\n            if (audioData) {\n              audioTrackLength = audioData.endPTS - audioData.startPTS;\n            }\n            this.remuxVideo(videoTrack, timeOffset, contiguous, audioTrackLength);\n          }\n        } else {\n          var videoData = void 0;\n          //logger.log('nb AVC samples:' + videoTrack.samples.length);\n          if (videoTrack.samples.length) {\n            videoData = this.remuxVideo(videoTrack, timeOffset, contiguous);\n          }\n          if (videoData && audioTrack.codec) {\n            this.remuxEmptyAudio(audioTrack, timeOffset, contiguous, videoData);\n          }\n        }\n      }\n      //logger.log('nb ID3 samples:' + audioTrack.samples.length);\n      if (id3Track.samples.length) {\n        this.remuxID3(id3Track, timeOffset);\n      }\n      //logger.log('nb ID3 samples:' + audioTrack.samples.length);\n      if (textTrack.samples.length) {\n        this.remuxText(textTrack, timeOffset);\n      }\n      //notify end of parsing\n      this.observer.trigger(_events2.default.FRAG_PARSED);\n    }\n  }, {\n    key: 'generateIS',\n    value: function generateIS(audioTrack, videoTrack, timeOffset) {\n      var observer = this.observer,\n          audioSamples = audioTrack.samples,\n          videoSamples = videoTrack.samples,\n          pesTimeScale = this.PES_TIMESCALE,\n          typeSupported = this.typeSupported,\n          container = 'audio/mp4',\n          tracks = {},\n          data = { tracks: tracks, unique: false },\n          computePTSDTS = this._initPTS === undefined,\n          initPTS,\n          initDTS;\n\n      if (computePTSDTS) {\n        initPTS = initDTS = Infinity;\n      }\n      if (audioTrack.config && audioSamples.length) {\n        audioTrack.timescale = audioTrack.audiosamplerate;\n        // MP4 duration (track duration in seconds multiplied by timescale) is coded on 32 bits\n        // we know that each AAC sample contains 1024 frames....\n        // in order to avoid overflowing the 32 bit counter for large duration, we use smaller timescale (timescale/gcd)\n        // we just need to ensure that AAC sample duration will still be an integer (will be 1024/gcd)\n        if (audioTrack.timescale * audioTrack.duration > Math.pow(2, 32)) {\n          (function () {\n            var greatestCommonDivisor = function greatestCommonDivisor(a, b) {\n              if (!b) {\n                return a;\n              }\n              return greatestCommonDivisor(b, a % b);\n            };\n            audioTrack.timescale = audioTrack.audiosamplerate / greatestCommonDivisor(audioTrack.audiosamplerate, audioTrack.isAAC ? 1024 : 1152);\n          })();\n        }\n        _logger.logger.log('audio mp4 timescale :' + audioTrack.timescale);\n        if (!audioTrack.isAAC) {\n          if (typeSupported.mpeg) {\n            // Chrome and Safari\n            container = 'audio/mpeg';\n            audioTrack.codec = '';\n          } else if (typeSupported.mp3) {\n            // Firefox\n            audioTrack.codec = 'mp3';\n          }\n        }\n        tracks.audio = {\n          container: container,\n          codec: audioTrack.codec,\n          initSegment: !audioTrack.isAAC && typeSupported.mpeg ? new Uint8Array() : _mp4Generator2.default.initSegment([audioTrack]),\n          metadata: {\n            channelCount: audioTrack.channelCount\n          }\n        };\n        if (computePTSDTS) {\n          // remember first PTS of this demuxing context. for audio, PTS = DTS\n          initPTS = initDTS = audioSamples[0].pts - pesTimeScale * timeOffset;\n        }\n      }\n\n      if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\n        videoTrack.timescale = this.MP4_TIMESCALE;\n        tracks.video = {\n          container: 'video/mp4',\n          codec: videoTrack.codec,\n          initSegment: _mp4Generator2.default.initSegment([videoTrack]),\n          metadata: {\n            width: videoTrack.width,\n            height: videoTrack.height\n          }\n        };\n        if (computePTSDTS) {\n          initPTS = Math.min(initPTS, videoSamples[0].pts - pesTimeScale * timeOffset);\n          initDTS = Math.min(initDTS, videoSamples[0].dts - pesTimeScale * timeOffset);\n          this.observer.trigger(_events2.default.INIT_PTS_FOUND, { initPTS: initPTS });\n        }\n      }\n\n      if (Object.keys(tracks).length) {\n        observer.trigger(_events2.default.FRAG_PARSING_INIT_SEGMENT, data);\n        this.ISGenerated = true;\n        if (computePTSDTS) {\n          this._initPTS = initPTS;\n          this._initDTS = initDTS;\n        }\n      } else {\n        observer.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MEDIA_ERROR, details: _errors.ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'no audio/video samples found' });\n      }\n    }\n  }, {\n    key: 'remuxVideo',\n    value: function remuxVideo(track, timeOffset, contiguous, audioTrackLength) {\n      var offset = 8,\n          pesTimeScale = this.PES_TIMESCALE,\n          pes2mp4ScaleFactor = this.PES2MP4SCALEFACTOR,\n          mp4SampleDuration,\n          mdat,\n          moof,\n          firstPTS,\n          firstDTS,\n          nextDTS,\n          lastPTS,\n          lastDTS,\n          inputSamples = track.samples,\n          outputSamples = [],\n          nbSamples = inputSamples.length,\n          ptsNormalize = this._PTSNormalize,\n          initDTS = this._initDTS;\n\n      // for (let i = 0; i < track.samples.length; i++) {\n      //   let avcSample = track.samples[i];\n      //   let units = avcSample.units.units;\n      //   let unitsString = '';\n      //   for (let j = 0; j < units.length ; j++) {\n      //     unitsString += units[j].type + ',';\n      //     if (units[j].data.length < 500) {\n      //       unitsString += Hex.hexDump(units[j].data);\n      //     }\n      //   }\n      //   logger.log(avcSample.pts + '/' + avcSample.dts + ',' + unitsString + avcSample.units.length);\n      // }\n\n      // sort video samples by DTS then PTS order\n      inputSamples.sort(function (a, b) {\n        var deltadts = a.dts - b.dts;\n        return deltadts ? deltadts : a.pts - b.pts;\n      });\n\n      // handle broken streams with PTS < DTS, tolerance up 200ms (18000 in 90kHz timescale)\n      var PTSDTSshift = inputSamples.reduce(function (prev, curr) {\n        return Math.max(Math.min(prev, curr.pts - curr.dts), -18000);\n      }, 0);\n      if (PTSDTSshift < 0) {\n        _logger.logger.warn('PTS < DTS detected in video samples, shifting DTS by ' + Math.round(PTSDTSshift / 90) + ' ms to overcome this issue');\n        for (var i = 0; i < inputSamples.length; i++) {\n          inputSamples[i].dts += PTSDTSshift;\n        }\n      }\n\n      // PTS is coded on 33bits, and can loop from -2^32 to 2^32\n      // ptsNormalize will make PTS/DTS value monotonic, we use last known DTS value as reference value\n      var nextAvcDts = void 0;\n      // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n      if (contiguous) {\n        // if parsed fragment is contiguous with last one, let's use last DTS value as reference\n        nextAvcDts = this.nextAvcDts;\n      } else {\n        // if not contiguous, let's use target timeOffset\n        nextAvcDts = timeOffset * pesTimeScale;\n      }\n\n      // compute first DTS and last DTS, normalize them against reference value\n      var sample = inputSamples[0];\n      firstDTS = Math.max(ptsNormalize(sample.dts - initDTS, nextAvcDts), 0);\n      firstPTS = Math.max(ptsNormalize(sample.pts - initDTS, nextAvcDts), 0);\n\n      // check timestamp continuity accross consecutive fragments (this is to remove inter-fragment gap/hole)\n      var delta = Math.round((firstDTS - nextAvcDts) / 90);\n      // if fragment are contiguous, detect hole/overlapping between fragments\n      if (contiguous) {\n        if (delta) {\n          if (delta > 1) {\n            _logger.logger.log('AVC:' + delta + ' ms hole between fragments detected,filling it');\n          } else if (delta < -1) {\n            _logger.logger.log('AVC:' + -delta + ' ms overlapping between fragments detected');\n          }\n          // remove hole/gap : set DTS to next expected DTS\n          firstDTS = nextAvcDts;\n          inputSamples[0].dts = firstDTS + initDTS;\n          // offset PTS as well, ensure that PTS is smaller or equal than new DTS\n          firstPTS = Math.max(firstPTS - delta, nextAvcDts);\n          inputSamples[0].pts = firstPTS + initDTS;\n          _logger.logger.log('Video/PTS/DTS adjusted: ' + Math.round(firstPTS / 90) + '/' + Math.round(firstDTS / 90) + ',delta:' + delta + ' ms');\n        }\n      }\n      nextDTS = firstDTS;\n\n      // compute lastPTS/lastDTS\n      sample = inputSamples[inputSamples.length - 1];\n      lastDTS = Math.max(ptsNormalize(sample.dts - initDTS, nextAvcDts), 0);\n      lastPTS = Math.max(ptsNormalize(sample.pts - initDTS, nextAvcDts), 0);\n      lastPTS = Math.max(lastPTS, lastDTS);\n\n      var vendor = navigator.vendor,\n          userAgent = navigator.userAgent,\n          isSafari = vendor && vendor.indexOf('Apple') > -1 && userAgent && !userAgent.match('CriOS');\n\n      // on Safari let's signal the same sample duration for all samples\n      // sample duration (as expected by trun MP4 boxes), should be the delta between sample DTS\n      // set this constant duration as being the avg delta between consecutive DTS.\n      if (isSafari) {\n        mp4SampleDuration = Math.round((lastDTS - firstDTS) / (pes2mp4ScaleFactor * (inputSamples.length - 1)));\n      }\n\n      var nbNalu = 0,\n          naluLen = 0;\n      for (var _i = 0; _i < nbSamples; _i++) {\n        // compute total/avc sample length and nb of NAL units\n        var _sample = inputSamples[_i],\n            units = _sample.units.units,\n            nbUnits = units.length,\n            sampleLen = 0;\n        for (var j = 0; j < nbUnits; j++) {\n          sampleLen += units[j].data.length;\n        }\n        naluLen += sampleLen;\n        nbNalu += nbUnits;\n        _sample.length = sampleLen;\n\n        // normalize PTS/DTS\n        if (isSafari) {\n          // sample DTS is computed using a constant decoding offset (mp4SampleDuration) between samples\n          _sample.dts = firstDTS + _i * pes2mp4ScaleFactor * mp4SampleDuration;\n        } else {\n          // ensure sample monotonic DTS\n          _sample.dts = Math.max(ptsNormalize(_sample.dts - initDTS, nextAvcDts), firstDTS);\n          // ensure dts is a multiple of scale factor to avoid rounding issues\n          _sample.dts = Math.round(_sample.dts / pes2mp4ScaleFactor) * pes2mp4ScaleFactor;\n        }\n        // we normalize PTS against nextAvcDts, we also substract initDTS (some streams don't start @ PTS O)\n        // and we ensure that computed value is greater or equal than sample DTS\n        _sample.pts = Math.max(ptsNormalize(_sample.pts - initDTS, nextAvcDts), _sample.dts);\n        // ensure pts is a multiple of scale factor to avoid rounding issues\n        _sample.pts = Math.round(_sample.pts / pes2mp4ScaleFactor) * pes2mp4ScaleFactor;\n      }\n\n      /* concatenate the video data and construct the mdat in place\n        (need 8 more bytes to fill length and mpdat type) */\n      var mdatSize = naluLen + 4 * nbNalu + 8;\n      try {\n        mdat = new Uint8Array(mdatSize);\n      } catch (err) {\n        this.observer.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MUX_ERROR, details: _errors.ErrorDetails.REMUX_ALLOC_ERROR, fatal: false, bytes: mdatSize, reason: 'fail allocating video mdat ' + mdatSize });\n        return;\n      }\n      var view = new DataView(mdat.buffer);\n      view.setUint32(0, mdatSize);\n      mdat.set(_mp4Generator2.default.types.mdat, 4);\n\n      for (var _i2 = 0; _i2 < nbSamples; _i2++) {\n        var avcSample = inputSamples[_i2],\n            avcSampleUnits = avcSample.units.units,\n            mp4SampleLength = 0,\n            compositionTimeOffset = void 0;\n        // convert NALU bitstream to MP4 format (prepend NALU with size field)\n        for (var _j = 0, _nbUnits = avcSampleUnits.length; _j < _nbUnits; _j++) {\n          var unit = avcSampleUnits[_j],\n              unitData = unit.data,\n              unitDataLen = unit.data.byteLength;\n          view.setUint32(offset, unitDataLen);\n          offset += 4;\n          mdat.set(unitData, offset);\n          offset += unitDataLen;\n          mp4SampleLength += 4 + unitDataLen;\n        }\n\n        if (!isSafari) {\n          // expected sample duration is the Decoding Timestamp diff of consecutive samples\n          if (_i2 < nbSamples - 1) {\n            mp4SampleDuration = inputSamples[_i2 + 1].dts - avcSample.dts;\n          } else {\n            var config = this.config,\n                lastFrameDuration = avcSample.dts - inputSamples[_i2 > 0 ? _i2 - 1 : _i2].dts;\n            if (config.stretchShortVideoTrack) {\n              // In some cases, a segment's audio track duration may exceed the video track duration.\n              // Since we've already remuxed audio, and we know how long the audio track is, we look to\n              // see if the delta to the next segment is longer than the minimum of maxBufferHole and\n              // maxSeekHole. If so, playback would potentially get stuck, so we artificially inflate\n              // the duration of the last frame to minimize any potential gap between segments.\n              var maxBufferHole = config.maxBufferHole,\n                  maxSeekHole = config.maxSeekHole,\n                  gapTolerance = Math.floor(Math.min(maxBufferHole, maxSeekHole) * pesTimeScale),\n                  deltaToFrameEnd = (audioTrackLength ? firstPTS + audioTrackLength * pesTimeScale : this.nextAudioPts) - avcSample.pts;\n              if (deltaToFrameEnd > gapTolerance) {\n                // We subtract lastFrameDuration from deltaToFrameEnd to try to prevent any video\n                // frame overlap. maxBufferHole/maxSeekHole should be >> lastFrameDuration anyway.\n                mp4SampleDuration = deltaToFrameEnd - lastFrameDuration;\n                if (mp4SampleDuration < 0) {\n                  mp4SampleDuration = lastFrameDuration;\n                }\n                _logger.logger.log('It is approximately ' + deltaToFrameEnd / 90 + ' ms to the next segment; using duration ' + mp4SampleDuration / 90 + ' ms for the last video frame.');\n              } else {\n                mp4SampleDuration = lastFrameDuration;\n              }\n            } else {\n              mp4SampleDuration = lastFrameDuration;\n            }\n          }\n          mp4SampleDuration /= pes2mp4ScaleFactor;\n          compositionTimeOffset = Math.round((avcSample.pts - avcSample.dts) / pes2mp4ScaleFactor);\n        } else {\n          compositionTimeOffset = Math.max(0, mp4SampleDuration * Math.round((avcSample.pts - avcSample.dts) / (pes2mp4ScaleFactor * mp4SampleDuration)));\n        }\n\n        //console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${avcSample.pts}/${avcSample.dts}/${initDTS}/${ptsnorm}/${dtsnorm}/${(avcSample.pts/4294967296).toFixed(3)}');\n        outputSamples.push({\n          size: mp4SampleLength,\n          // constant duration\n          duration: mp4SampleDuration,\n          cts: compositionTimeOffset,\n          flags: {\n            isLeading: 0,\n            isDependedOn: 0,\n            hasRedundancy: 0,\n            degradPrio: 0,\n            dependsOn: avcSample.key ? 2 : 1,\n            isNonSync: avcSample.key ? 0 : 1\n          }\n        });\n      }\n      // next AVC sample DTS should be equal to last sample DTS + last sample duration (in PES timescale)\n      this.nextAvcDts = lastDTS + mp4SampleDuration * pes2mp4ScaleFactor;\n      var dropped = track.dropped;\n      track.len = 0;\n      track.nbNalu = 0;\n      track.dropped = 0;\n      if (outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\n        var flags = outputSamples[0].flags;\n        // chrome workaround, mark first sample as being a Random Access Point to avoid sourcebuffer append issue\n        // https://code.google.com/p/chromium/issues/detail?id=229412\n        flags.dependsOn = 2;\n        flags.isNonSync = 0;\n      }\n      track.samples = outputSamples;\n      moof = _mp4Generator2.default.moof(track.sequenceNumber++, firstDTS / pes2mp4ScaleFactor, track);\n      track.samples = [];\n\n      var data = {\n        data1: moof,\n        data2: mdat,\n        startPTS: firstPTS / pesTimeScale,\n        endPTS: (lastPTS + pes2mp4ScaleFactor * mp4SampleDuration) / pesTimeScale,\n        startDTS: firstDTS / pesTimeScale,\n        endDTS: this.nextAvcDts / pesTimeScale,\n        type: 'video',\n        nb: outputSamples.length,\n        dropped: dropped\n      };\n      this.observer.trigger(_events2.default.FRAG_PARSING_DATA, data);\n      return data;\n    }\n  }, {\n    key: 'remuxAudio',\n    value: function remuxAudio(track, timeOffset, contiguous, accurateTimeOffset) {\n      var pesTimeScale = this.PES_TIMESCALE,\n          mp4timeScale = track.timescale,\n          pes2mp4ScaleFactor = pesTimeScale / mp4timeScale,\n          expectedSampleDuration = track.timescale * (track.isAAC ? 1024 : 1152) / track.audiosamplerate,\n          pesFrameDuration = expectedSampleDuration * pes2mp4ScaleFactor,\n          ptsNormalize = this._PTSNormalize,\n          initDTS = this._initDTS,\n          rawMPEG = !track.isAAC && this.typeSupported.mpeg;\n\n      var view,\n          offset = rawMPEG ? 0 : 8,\n          audioSample,\n          mp4Sample,\n          unit,\n          mdat,\n          moof,\n          firstPTS,\n          firstDTS,\n          lastDTS,\n          pts,\n          dts,\n          ptsnorm,\n          dtsnorm,\n          outputSamples = [],\n          inputSamples = [],\n          fillFrame,\n          newStamp,\n          nextAudioPts;\n\n      track.samples.sort(function (a, b) {\n        return a.pts - b.pts;\n      });\n      inputSamples = track.samples;\n\n      // for audio samples, also consider consecutive fragments as being contiguous (even if a level switch occurs),\n      // for sake of clarity:\n      // consecutive fragments are frags with\n      //  - less than 100ms gaps between new time offset and next expected PTS OR\n      //  - less than 20 audio frames distance\n      // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n      // this helps ensuring audio continuity\n      // and this also avoids audio glitches/cut when switching quality, or reporting wrong duration on first audio frame\n\n      nextAudioPts = this.nextAudioPts;\n      contiguous |= inputSamples.length && nextAudioPts && (Math.abs(timeOffset - nextAudioPts / pesTimeScale) < 0.1 || Math.abs(inputSamples[0].pts - nextAudioPts - this._initDTS) < 20 * pesFrameDuration);\n\n      if (!contiguous) {\n        // if fragments are not contiguous, let's use timeOffset to compute next Audio PTS\n        nextAudioPts = timeOffset * pesTimeScale;\n      }\n      // If the audio track is missing samples, the frames seem to get \"left-shifted\" within the\n      // resulting mp4 segment, causing sync issues and leaving gaps at the end of the audio segment.\n      // In an effort to prevent this from happening, we inject frames here where there are gaps.\n      // When possible, we inject a silent frame; when that's not possible, we duplicate the last\n      // frame.\n\n      // only inject/drop audio frames in case time offset is accurate\n      if (accurateTimeOffset && track.isAAC) {\n        for (var i = 0, nextPtsNorm = nextAudioPts; i < inputSamples.length;) {\n          // First, let's see how far off this frame is from where we expect it to be\n          var sample = inputSamples[i],\n              ptsNorm = ptsNormalize(sample.pts - initDTS, nextAudioPts),\n              delta = ptsNorm - nextPtsNorm;\n\n          // If we're overlapping by more than a duration, drop this sample\n          if (delta <= -pesFrameDuration) {\n            _logger.logger.warn('Dropping 1 audio frame @ ' + Math.round(nextPtsNorm / 90) / 1000 + 's due to ' + Math.round(Math.abs(delta / 90)) + ' ms overlap.');\n            inputSamples.splice(i, 1);\n            track.len -= sample.unit.length;\n            // Don't touch nextPtsNorm or i\n          }\n          // Otherwise, if we're more than a frame away from where we should be, insert missing frames\n          // also only inject silent audio frames if currentTime !== 0 (nextPtsNorm !== 0)\n          else if (delta >= pesFrameDuration && nextPtsNorm) {\n              var missing = Math.round(delta / pesFrameDuration);\n              _logger.logger.warn('Injecting ' + missing + ' audio frame @ ' + Math.round(nextPtsNorm / 90) / 1000 + 's due to ' + Math.round(delta / 90) + ' ms gap.');\n              for (var j = 0; j < missing; j++) {\n                newStamp = nextPtsNorm + initDTS;\n                newStamp = Math.max(newStamp, initDTS);\n                fillFrame = _aac2.default.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n                if (!fillFrame) {\n                  _logger.logger.log('Unable to get silent frame for given audio codec; duplicating last frame instead.');\n                  fillFrame = sample.unit.subarray();\n                }\n                inputSamples.splice(i, 0, { unit: fillFrame, pts: newStamp, dts: newStamp });\n                track.len += fillFrame.length;\n                nextPtsNorm += pesFrameDuration;\n                i += 1;\n              }\n\n              // Adjust sample to next expected pts\n              sample.pts = sample.dts = nextPtsNorm + initDTS;\n              nextPtsNorm += pesFrameDuration;\n              i += 1;\n            }\n            // Otherwise, we're within half a frame duration, so just adjust pts\n            else {\n                if (Math.abs(delta) > 0.1 * pesFrameDuration) {\n                  //logger.log(`Invalid frame delta ${Math.round(ptsNorm - nextPtsNorm + pesFrameDuration)} at PTS ${Math.round(ptsNorm / 90)} (should be ${Math.round(pesFrameDuration)}).`);\n                }\n                nextPtsNorm += pesFrameDuration;\n                if (i === 0) {\n                  sample.pts = sample.dts = initDTS + nextAudioPts;\n                } else {\n                  sample.pts = sample.dts = inputSamples[i - 1].pts + pesFrameDuration;\n                }\n                i += 1;\n              }\n        }\n      }\n\n      for (var _j2 = 0, _nbSamples = inputSamples.length; _j2 < _nbSamples; _j2++) {\n        audioSample = inputSamples[_j2];\n        unit = audioSample.unit;\n        pts = audioSample.pts - initDTS;\n        dts = audioSample.dts - initDTS;\n        //logger.log(`Audio/PTS:${Math.round(pts/90)}`);\n        // if not first sample\n        if (lastDTS !== undefined) {\n          ptsnorm = ptsNormalize(pts, lastDTS);\n          dtsnorm = ptsNormalize(dts, lastDTS);\n          mp4Sample.duration = Math.round((dtsnorm - lastDTS) / pes2mp4ScaleFactor);\n        } else {\n          ptsnorm = ptsNormalize(pts, nextAudioPts);\n          dtsnorm = ptsNormalize(dts, nextAudioPts);\n          var _delta = Math.round(1000 * (ptsnorm - nextAudioPts) / pesTimeScale),\n              numMissingFrames = 0;\n          // if fragment are contiguous, detect hole/overlapping between fragments\n          // contiguous fragments are consecutive fragments from same quality level (same level, new SN = old SN + 1)\n          if (contiguous && track.isAAC) {\n            // log delta\n            if (_delta) {\n              if (_delta > 0) {\n                numMissingFrames = Math.round((ptsnorm - nextAudioPts) / pesFrameDuration);\n                _logger.logger.log(_delta + ' ms hole between AAC samples detected,filling it');\n                if (numMissingFrames > 0) {\n                  fillFrame = _aac2.default.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n                  if (!fillFrame) {\n                    fillFrame = unit.subarray();\n                  }\n                  track.len += numMissingFrames * fillFrame.length;\n                }\n                // if we have frame overlap, overlapping for more than half a frame duraion\n              } else if (_delta < -12) {\n                // drop overlapping audio frames... browser will deal with it\n                _logger.logger.log(-_delta + ' ms overlapping between AAC samples detected, drop frame');\n                track.len -= unit.byteLength;\n                continue;\n              }\n              // set PTS/DTS to expected PTS/DTS\n              ptsnorm = dtsnorm = nextAudioPts;\n            }\n          }\n          // remember first PTS of our audioSamples, ensure value is positive\n          firstPTS = Math.max(0, ptsnorm);\n          firstDTS = Math.max(0, dtsnorm);\n          if (track.len > 0) {\n            /* concatenate the audio data and construct the mdat in place\n              (need 8 more bytes to fill length and mdat type) */\n\n            var mdatSize = rawMPEG ? track.len : track.len + 8;\n            try {\n              mdat = new Uint8Array(mdatSize);\n            } catch (err) {\n              this.observer.trigger(_events2.default.ERROR, { type: _errors.ErrorTypes.MUX_ERROR, details: _errors.ErrorDetails.REMUX_ALLOC_ERROR, fatal: false, bytes: mdatSize, reason: 'fail allocating audio mdat ' + mdatSize });\n              return;\n            }\n            if (!rawMPEG) {\n              view = new DataView(mdat.buffer);\n              view.setUint32(0, mdatSize);\n              mdat.set(_mp4Generator2.default.types.mdat, 4);\n            }\n          } else {\n            // no audio samples\n            return;\n          }\n          for (var _i3 = 0; _i3 < numMissingFrames; _i3++) {\n            newStamp = ptsnorm - (numMissingFrames - _i3) * pesFrameDuration;\n            fillFrame = _aac2.default.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n            if (!fillFrame) {\n              _logger.logger.log('Unable to get silent frame for given audio codec; duplicating this frame instead.');\n              fillFrame = unit.subarray();\n            }\n            mdat.set(fillFrame, offset);\n            offset += fillFrame.byteLength;\n            mp4Sample = {\n              size: fillFrame.byteLength,\n              cts: 0,\n              duration: 1024,\n              flags: {\n                isLeading: 0,\n                isDependedOn: 0,\n                hasRedundancy: 0,\n                degradPrio: 0,\n                dependsOn: 1\n              }\n            };\n            outputSamples.push(mp4Sample);\n          }\n        }\n        mdat.set(unit, offset);\n        var unitLen = unit.byteLength;\n        offset += unitLen;\n        //console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${audioSample.pts}/${audioSample.dts}/${initDTS}/${ptsnorm}/${dtsnorm}/${(audioSample.pts/4294967296).toFixed(3)}');\n        mp4Sample = {\n          size: unitLen,\n          cts: 0,\n          duration: 0,\n          flags: {\n            isLeading: 0,\n            isDependedOn: 0,\n            hasRedundancy: 0,\n            degradPrio: 0,\n            dependsOn: 1\n          }\n        };\n        outputSamples.push(mp4Sample);\n        lastDTS = dtsnorm;\n      }\n      var lastSampleDuration = 0;\n      var nbSamples = outputSamples.length;\n      //set last sample duration as being identical to previous sample\n      if (nbSamples >= 2) {\n        lastSampleDuration = outputSamples[nbSamples - 2].duration;\n        mp4Sample.duration = lastSampleDuration;\n      }\n      if (nbSamples) {\n        // next audio sample PTS should be equal to last sample PTS + duration\n        this.nextAudioPts = ptsnorm + pes2mp4ScaleFactor * lastSampleDuration;\n        //logger.log('Audio/PTS/PTSend:' + audioSample.pts.toFixed(0) + '/' + this.nextAacDts.toFixed(0));\n        track.len = 0;\n        track.samples = outputSamples;\n        if (rawMPEG) {\n          moof = new Uint8Array();\n        } else {\n          moof = _mp4Generator2.default.moof(track.sequenceNumber++, firstDTS / pes2mp4ScaleFactor, track);\n        }\n        track.samples = [];\n        var audioData = {\n          data1: moof,\n          data2: mdat,\n          startPTS: firstPTS / pesTimeScale,\n          endPTS: this.nextAudioPts / pesTimeScale,\n          startDTS: firstDTS / pesTimeScale,\n          endDTS: (dtsnorm + pes2mp4ScaleFactor * lastSampleDuration) / pesTimeScale,\n          type: 'audio',\n          nb: nbSamples\n        };\n        this.observer.trigger(_events2.default.FRAG_PARSING_DATA, audioData);\n        return audioData;\n      }\n      return null;\n    }\n  }, {\n    key: 'remuxEmptyAudio',\n    value: function remuxEmptyAudio(track, timeOffset, contiguous, videoData) {\n      var pesTimeScale = this.PES_TIMESCALE,\n          mp4timeScale = track.timescale ? track.timescale : track.audiosamplerate,\n          pes2mp4ScaleFactor = pesTimeScale / mp4timeScale,\n          nextAudioPts = this.nextAudioPts,\n\n\n      // sync with video's timestamp\n      startDTS = (nextAudioPts !== undefined ? nextAudioPts : videoData.startDTS * pesTimeScale) + this._initDTS,\n          endDTS = videoData.endDTS * pesTimeScale + this._initDTS,\n\n      // one sample's duration value\n      sampleDuration = 1024,\n          frameDuration = pes2mp4ScaleFactor * sampleDuration,\n\n\n      // samples count of this segment's duration\n      nbSamples = Math.ceil((endDTS - startDTS) / frameDuration),\n\n\n      // silent frame\n      silentFrame = _aac2.default.getSilentFrame(track.manifestCodec || track.codec, track.channelCount);\n\n      _logger.logger.warn('remux empty Audio');\n      // Can't remux if we can't generate a silent frame...\n      if (!silentFrame) {\n        _logger.logger.trace('Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!');\n        return;\n      }\n\n      var samples = [];\n      for (var i = 0; i < nbSamples; i++) {\n        var stamp = startDTS + i * frameDuration;\n        samples.push({ unit: silentFrame, pts: stamp, dts: stamp });\n        track.len += silentFrame.length;\n      }\n      track.samples = samples;\n\n      this.remuxAudio(track, timeOffset, contiguous);\n    }\n  }, {\n    key: 'remuxID3',\n    value: function remuxID3(track, timeOffset) {\n      var length = track.samples.length,\n          sample;\n      // consume samples\n      if (length) {\n        for (var index = 0; index < length; index++) {\n          sample = track.samples[index];\n          // setting id3 pts, dts to relative time\n          // using this._initPTS and this._initDTS to calculate relative time\n          sample.pts = (sample.pts - this._initPTS) / this.PES_TIMESCALE;\n          sample.dts = (sample.dts - this._initDTS) / this.PES_TIMESCALE;\n        }\n        this.observer.trigger(_events2.default.FRAG_PARSING_METADATA, {\n          samples: track.samples\n        });\n      }\n\n      track.samples = [];\n      timeOffset = timeOffset;\n    }\n  }, {\n    key: 'remuxText',\n    value: function remuxText(track, timeOffset) {\n      track.samples.sort(function (a, b) {\n        return a.pts - b.pts;\n      });\n\n      var length = track.samples.length,\n          sample;\n      // consume samples\n      if (length) {\n        for (var index = 0; index < length; index++) {\n          sample = track.samples[index];\n          // setting text pts, dts to relative time\n          // using this._initPTS and this._initDTS to calculate relative time\n          sample.pts = (sample.pts - this._initPTS) / this.PES_TIMESCALE;\n        }\n        this.observer.trigger(_events2.default.FRAG_PARSING_USERDATA, {\n          samples: track.samples\n        });\n      }\n\n      track.samples = [];\n      timeOffset = timeOffset;\n    }\n  }, {\n    key: '_PTSNormalize',\n    value: function _PTSNormalize(value, reference) {\n      var offset;\n      if (reference === undefined) {\n        return value;\n      }\n      if (reference < value) {\n        // - 2^33\n        offset = -8589934592;\n      } else {\n        // + 2^33\n        offset = 8589934592;\n      }\n      /* PTS is 33bit (from 0 to 2^33 -1)\n        if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\n        PTS looping occured. fill the gap */\n      while (Math.abs(value - reference) > 4294967296) {\n        value += offset;\n      }\n      return value;\n    }\n  }]);\n\n  return MP4Remuxer;\n}();\n\nexports.default = MP4Remuxer;\n\n},{\"31\":31,\"33\":33,\"34\":34,\"42\":42,\"50\":50}],44:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * passthrough remuxer\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n\nvar _events = _dereq_(33);\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PassThroughRemuxer = function () {\n  function PassThroughRemuxer(observer) {\n    _classCallCheck(this, PassThroughRemuxer);\n\n    this.observer = observer;\n  }\n\n  _createClass(PassThroughRemuxer, [{\n    key: 'destroy',\n    value: function destroy() {}\n  }, {\n    key: 'resetTimeStamp',\n    value: function resetTimeStamp() {}\n  }, {\n    key: 'resetInitSegment',\n    value: function resetInitSegment() {}\n  }, {\n    key: 'remux',\n    value: function remux(audioTrack, videoTrack, id3Track, textTrack, timeOffset, contiguous, accurateTimeOffset, rawData) {\n      var observer = this.observer;\n      var streamType = '';\n      if (audioTrack) {\n        streamType += 'audio';\n      }\n      if (videoTrack) {\n        streamType += 'video';\n      }\n      observer.trigger(_events2.default.FRAG_PARSING_DATA, {\n        data1: rawData,\n        startPTS: timeOffset,\n        startDTS: timeOffset,\n        type: streamType,\n        nb: 1,\n        dropped: 0\n      });\n      //notify end of parsing\n      observer.trigger(_events2.default.FRAG_PARSED);\n    }\n  }]);\n\n  return PassThroughRemuxer;\n}();\n\nexports.default = PassThroughRemuxer;\n\n},{\"33\":33}],45:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DECIMAL_RESOLUTION_REGEX = /^(\\d+)x(\\d+)$/;\nvar ATTR_LIST_REGEX = /\\s*(.+?)\\s*=((?:\\\".*?\\\")|.*?)(?:,|$)/g;\n\n// adapted from https://github.com/kanongil/node-m3u8parse/blob/master/attrlist.js\n\nvar AttrList = function () {\n  function AttrList(attrs) {\n    _classCallCheck(this, AttrList);\n\n    if (typeof attrs === 'string') {\n      attrs = AttrList.parseAttrList(attrs);\n    }\n    for (var attr in attrs) {\n      if (attrs.hasOwnProperty(attr)) {\n        this[attr] = attrs[attr];\n      }\n    }\n  }\n\n  _createClass(AttrList, [{\n    key: 'decimalInteger',\n    value: function decimalInteger(attrName) {\n      var intValue = parseInt(this[attrName], 10);\n      if (intValue > Number.MAX_SAFE_INTEGER) {\n        return Infinity;\n      }\n      return intValue;\n    }\n  }, {\n    key: 'hexadecimalInteger',\n    value: function hexadecimalInteger(attrName) {\n      if (this[attrName]) {\n        var stringValue = (this[attrName] || '0x').slice(2);\n        stringValue = (stringValue.length & 1 ? '0' : '') + stringValue;\n\n        var value = new Uint8Array(stringValue.length / 2);\n        for (var i = 0; i < stringValue.length / 2; i++) {\n          value[i] = parseInt(stringValue.slice(i * 2, i * 2 + 2), 16);\n        }\n        return value;\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: 'hexadecimalIntegerAsNumber',\n    value: function hexadecimalIntegerAsNumber(attrName) {\n      var intValue = parseInt(this[attrName], 16);\n      if (intValue > Number.MAX_SAFE_INTEGER) {\n        return Infinity;\n      }\n      return intValue;\n    }\n  }, {\n    key: 'decimalFloatingPoint',\n    value: function decimalFloatingPoint(attrName) {\n      return parseFloat(this[attrName]);\n    }\n  }, {\n    key: 'enumeratedString',\n    value: function enumeratedString(attrName) {\n      return this[attrName];\n    }\n  }, {\n    key: 'decimalResolution',\n    value: function decimalResolution(attrName) {\n      var res = DECIMAL_RESOLUTION_REGEX.exec(this[attrName]);\n      if (res === null) {\n        return undefined;\n      }\n      return {\n        width: parseInt(res[1], 10),\n        height: parseInt(res[2], 10)\n      };\n    }\n  }], [{\n    key: 'parseAttrList',\n    value: function parseAttrList(input) {\n      var match,\n          attrs = {};\n      ATTR_LIST_REGEX.lastIndex = 0;\n      while ((match = ATTR_LIST_REGEX.exec(input)) !== null) {\n        var value = match[2],\n            quote = '\"';\n\n        if (value.indexOf(quote) === 0 && value.lastIndexOf(quote) === value.length - 1) {\n          value = value.slice(1, -1);\n        }\n        attrs[match[1]] = value;\n      }\n      return attrs;\n    }\n  }]);\n\n  return AttrList;\n}();\n\nexports.default = AttrList;\n\n},{}],46:[function(_dereq_,module,exports){\n\"use strict\";\n\nvar BinarySearch = {\n    /**\n     * Searches for an item in an array which matches a certain condition.\n     * This requires the condition to only match one item in the array,\n     * and for the array to be ordered.\n     *\n     * @param {Array} list The array to search.\n     * @param {Function} comparisonFunction\n     *      Called and provided a candidate item as the first argument.\n     *      Should return:\n     *          > -1 if the item should be located at a lower index than the provided item.\n     *          > 1 if the item should be located at a higher index than the provided item.\n     *          > 0 if the item is the item you're looking for.\n     *\n     * @return {*} The object if it is found or null otherwise.\n     */\n    search: function search(list, comparisonFunction) {\n        var minIndex = 0;\n        var maxIndex = list.length - 1;\n        var currentIndex = null;\n        var currentElement = null;\n\n        while (minIndex <= maxIndex) {\n            currentIndex = (minIndex + maxIndex) / 2 | 0;\n            currentElement = list[currentIndex];\n\n            var comparisonResult = comparisonFunction(currentElement);\n            if (comparisonResult > 0) {\n                minIndex = currentIndex + 1;\n            } else if (comparisonResult < 0) {\n                maxIndex = currentIndex - 1;\n            } else {\n                return currentElement;\n            }\n        }\n\n        return null;\n    }\n};\n\nmodule.exports = BinarySearch;\n\n},{}],47:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n *\n * This code was ported from the dash.js project at:\n *   https://github.com/Dash-Industry-Forum/dash.js/blob/development/externals/cea608-parser.js\n *   https://github.com/Dash-Industry-Forum/dash.js/commit/8269b26a761e0853bb21d78780ed945144ecdd4d#diff-71bc295a2d6b6b7093a1d3290d53a4b2\n *\n * The original copyright appears below:\n *\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2015-2016, DASH Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  1. Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  2. Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n/**\n *  Exceptions from regular ASCII. CodePoints are mapped to UTF-16 codes\n */\n\nvar specialCea608CharsCodes = {\n    0x2a: 0xe1, // lowercase a, acute accent\n    0x5c: 0xe9, // lowercase e, acute accent\n    0x5e: 0xed, // lowercase i, acute accent\n    0x5f: 0xf3, // lowercase o, acute accent\n    0x60: 0xfa, // lowercase u, acute accent\n    0x7b: 0xe7, // lowercase c with cedilla\n    0x7c: 0xf7, // division symbol\n    0x7d: 0xd1, // uppercase N tilde\n    0x7e: 0xf1, // lowercase n tilde\n    0x7f: 0x2588, // Full block\n    // THIS BLOCK INCLUDES THE 16 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n    // THAT COME FROM HI BYTE=0x11 AND LOW BETWEEN 0x30 AND 0x3F\n    // THIS MEANS THAT \\x50 MUST BE ADDED TO THE VALUES\n    0x80: 0xae, // Registered symbol (R)\n    0x81: 0xb0, // degree sign\n    0x82: 0xbd, // 1/2 symbol\n    0x83: 0xbf, // Inverted (open) question mark\n    0x84: 0x2122, // Trademark symbol (TM)\n    0x85: 0xa2, // Cents symbol\n    0x86: 0xa3, // Pounds sterling\n    0x87: 0x266a, // Music 8'th note\n    0x88: 0xe0, // lowercase a, grave accent\n    0x89: 0x20, // transparent space (regular)\n    0x8a: 0xe8, // lowercase e, grave accent\n    0x8b: 0xe2, // lowercase a, circumflex accent\n    0x8c: 0xea, // lowercase e, circumflex accent\n    0x8d: 0xee, // lowercase i, circumflex accent\n    0x8e: 0xf4, // lowercase o, circumflex accent\n    0x8f: 0xfb, // lowercase u, circumflex accent\n    // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n    // THAT COME FROM HI BYTE=0x12 AND LOW BETWEEN 0x20 AND 0x3F\n    0x90: 0xc1, // capital letter A with acute\n    0x91: 0xc9, // capital letter E with acute\n    0x92: 0xd3, // capital letter O with acute\n    0x93: 0xda, // capital letter U with acute\n    0x94: 0xdc, // capital letter U with diaresis\n    0x95: 0xfc, // lowercase letter U with diaeresis\n    0x96: 0x2018, // opening single quote\n    0x97: 0xa1, // inverted exclamation mark\n    0x98: 0x2a, // asterisk\n    0x99: 0x2019, // closing single quote\n    0x9a: 0x2501, // box drawings heavy horizontal\n    0x9b: 0xa9, // copyright sign\n    0x9c: 0x2120, // Service mark\n    0x9d: 0x2022, // (round) bullet\n    0x9e: 0x201c, // Left double quotation mark\n    0x9f: 0x201d, // Right double quotation mark\n    0xa0: 0xc0, // uppercase A, grave accent\n    0xa1: 0xc2, // uppercase A, circumflex\n    0xa2: 0xc7, // uppercase C with cedilla\n    0xa3: 0xc8, // uppercase E, grave accent\n    0xa4: 0xca, // uppercase E, circumflex\n    0xa5: 0xcb, // capital letter E with diaresis\n    0xa6: 0xeb, // lowercase letter e with diaresis\n    0xa7: 0xce, // uppercase I, circumflex\n    0xa8: 0xcf, // uppercase I, with diaresis\n    0xa9: 0xef, // lowercase i, with diaresis\n    0xaa: 0xd4, // uppercase O, circumflex\n    0xab: 0xd9, // uppercase U, grave accent\n    0xac: 0xf9, // lowercase u, grave accent\n    0xad: 0xdb, // uppercase U, circumflex\n    0xae: 0xab, // left-pointing double angle quotation mark\n    0xaf: 0xbb, // right-pointing double angle quotation mark\n    // THIS BLOCK INCLUDES THE 32 EXTENDED (TWO-BYTE) LINE 21 CHARACTERS\n    // THAT COME FROM HI BYTE=0x13 AND LOW BETWEEN 0x20 AND 0x3F\n    0xb0: 0xc3, // Uppercase A, tilde\n    0xb1: 0xe3, // Lowercase a, tilde\n    0xb2: 0xcd, // Uppercase I, acute accent\n    0xb3: 0xcc, // Uppercase I, grave accent\n    0xb4: 0xec, // Lowercase i, grave accent\n    0xb5: 0xd2, // Uppercase O, grave accent\n    0xb6: 0xf2, // Lowercase o, grave accent\n    0xb7: 0xd5, // Uppercase O, tilde\n    0xb8: 0xf5, // Lowercase o, tilde\n    0xb9: 0x7b, // Open curly brace\n    0xba: 0x7d, // Closing curly brace\n    0xbb: 0x5c, // Backslash\n    0xbc: 0x5e, // Caret\n    0xbd: 0x5f, // Underscore\n    0xbe: 0x7c, // Pipe (vertical line)\n    0xbf: 0x223c, // Tilde operator\n    0xc0: 0xc4, // Uppercase A, umlaut\n    0xc1: 0xe4, // Lowercase A, umlaut\n    0xc2: 0xd6, // Uppercase O, umlaut\n    0xc3: 0xf6, // Lowercase o, umlaut\n    0xc4: 0xdf, // Esszett (sharp S)\n    0xc5: 0xa5, // Yen symbol\n    0xc6: 0xa4, // Generic currency sign\n    0xc7: 0x2503, // Box drawings heavy vertical\n    0xc8: 0xc5, // Uppercase A, ring\n    0xc9: 0xe5, // Lowercase A, ring\n    0xca: 0xd8, // Uppercase O, stroke\n    0xcb: 0xf8, // Lowercase o, strok\n    0xcc: 0x250f, // Box drawings heavy down and right\n    0xcd: 0x2513, // Box drawings heavy down and left\n    0xce: 0x2517, // Box drawings heavy up and right\n    0xcf: 0x251b // Box drawings heavy up and left\n};\n\n/**\n * Utils\n */\nvar getCharForByte = function getCharForByte(byte) {\n    var charCode = byte;\n    if (specialCea608CharsCodes.hasOwnProperty(byte)) {\n        charCode = specialCea608CharsCodes[byte];\n    }\n    return String.fromCharCode(charCode);\n};\n\nvar NR_ROWS = 15,\n    NR_COLS = 100;\n// Tables to look up row from PAC data\nvar rowsLowCh1 = { 0x11: 1, 0x12: 3, 0x15: 5, 0x16: 7, 0x17: 9, 0x10: 11, 0x13: 12, 0x14: 14 };\nvar rowsHighCh1 = { 0x11: 2, 0x12: 4, 0x15: 6, 0x16: 8, 0x17: 10, 0x13: 13, 0x14: 15 };\nvar rowsLowCh2 = { 0x19: 1, 0x1A: 3, 0x1D: 5, 0x1E: 7, 0x1F: 9, 0x18: 11, 0x1B: 12, 0x1C: 14 };\nvar rowsHighCh2 = { 0x19: 2, 0x1A: 4, 0x1D: 6, 0x1E: 8, 0x1F: 10, 0x1B: 13, 0x1C: 15 };\n\nvar backgroundColors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'black', 'transparent'];\n\n/**\n * Simple logger class to be able to write with time-stamps and filter on level.\n */\nvar logger = {\n    verboseFilter: { 'DATA': 3, 'DEBUG': 3, 'INFO': 2, 'WARNING': 2, 'TEXT': 1, 'ERROR': 0 },\n    time: null,\n    verboseLevel: 0, // Only write errors\n    setTime: function setTime(newTime) {\n        this.time = newTime;\n    },\n    log: function log(severity, msg) {\n        var minLevel = this.verboseFilter[severity];\n        if (this.verboseLevel >= minLevel) {\n            console.log(this.time + ' [' + severity + '] ' + msg);\n        }\n    }\n};\n\nvar numArrayToHexArray = function numArrayToHexArray(numArray) {\n    var hexArray = [];\n    for (var j = 0; j < numArray.length; j++) {\n        hexArray.push(numArray[j].toString(16));\n    }\n    return hexArray;\n};\n\nvar PenState = function () {\n    function PenState(foreground, underline, italics, background, flash) {\n        _classCallCheck(this, PenState);\n\n        this.foreground = foreground || 'white';\n        this.underline = underline || false;\n        this.italics = italics || false;\n        this.background = background || 'black';\n        this.flash = flash || false;\n    }\n\n    _createClass(PenState, [{\n        key: 'reset',\n        value: function reset() {\n            this.foreground = 'white';\n            this.underline = false;\n            this.italics = false;\n            this.background = 'black';\n            this.flash = false;\n        }\n    }, {\n        key: 'setStyles',\n        value: function setStyles(styles) {\n            var attribs = ['foreground', 'underline', 'italics', 'background', 'flash'];\n            for (var i = 0; i < attribs.length; i++) {\n                var style = attribs[i];\n                if (styles.hasOwnProperty(style)) {\n                    this[style] = styles[style];\n                }\n            }\n        }\n    }, {\n        key: 'isDefault',\n        value: function isDefault() {\n            return this.foreground === 'white' && !this.underline && !this.italics && this.background === 'black' && !this.flash;\n        }\n    }, {\n        key: 'equals',\n        value: function equals(other) {\n            return this.foreground === other.foreground && this.underline === other.underline && this.italics === other.italics && this.background === other.background && this.flash === other.flash;\n        }\n    }, {\n        key: 'copy',\n        value: function copy(newPenState) {\n            this.foreground = newPenState.foreground;\n            this.underline = newPenState.underline;\n            this.italics = newPenState.italics;\n            this.background = newPenState.background;\n            this.flash = newPenState.flash;\n        }\n    }, {\n        key: 'toString',\n        value: function toString() {\n            return 'color=' + this.foreground + ', underline=' + this.underline + ', italics=' + this.italics + ', background=' + this.background + ', flash=' + this.flash;\n        }\n    }]);\n\n    return PenState;\n}();\n\n/**\n * Unicode character with styling and background.\n * @constructor\n */\n\n\nvar StyledUnicodeChar = function () {\n    function StyledUnicodeChar(uchar, foreground, underline, italics, background, flash) {\n        _classCallCheck(this, StyledUnicodeChar);\n\n        this.uchar = uchar || ' '; // unicode character\n        this.penState = new PenState(foreground, underline, italics, background, flash);\n    }\n\n    _createClass(StyledUnicodeChar, [{\n        key: 'reset',\n        value: function reset() {\n            this.uchar = ' ';\n            this.penState.reset();\n        }\n    }, {\n        key: 'setChar',\n        value: function setChar(uchar, newPenState) {\n            this.uchar = uchar;\n            this.penState.copy(newPenState);\n        }\n    }, {\n        key: 'setPenState',\n        value: function setPenState(newPenState) {\n            this.penState.copy(newPenState);\n        }\n    }, {\n        key: 'equals',\n        value: function equals(other) {\n            return this.uchar === other.uchar && this.penState.equals(other.penState);\n        }\n    }, {\n        key: 'copy',\n        value: function copy(newChar) {\n            this.uchar = newChar.uchar;\n            this.penState.copy(newChar.penState);\n        }\n    }, {\n        key: 'isEmpty',\n        value: function isEmpty() {\n            return this.uchar === ' ' && this.penState.isDefault();\n        }\n    }]);\n\n    return StyledUnicodeChar;\n}();\n\n/**\n * CEA-608 row consisting of NR_COLS instances of StyledUnicodeChar.\n * @constructor\n */\n\n\nvar Row = function () {\n    function Row() {\n        _classCallCheck(this, Row);\n\n        this.chars = [];\n        for (var i = 0; i < NR_COLS; i++) {\n            this.chars.push(new StyledUnicodeChar());\n        }\n        this.pos = 0;\n        this.currPenState = new PenState();\n    }\n\n    _createClass(Row, [{\n        key: 'equals',\n        value: function equals(other) {\n            var equal = true;\n            for (var i = 0; i < NR_COLS; i++) {\n                if (!this.chars[i].equals(other.chars[i])) {\n                    equal = false;\n                    break;\n                }\n            }\n            return equal;\n        }\n    }, {\n        key: 'copy',\n        value: function copy(other) {\n            for (var i = 0; i < NR_COLS; i++) {\n                this.chars[i].copy(other.chars[i]);\n            }\n        }\n    }, {\n        key: 'isEmpty',\n        value: function isEmpty() {\n            var empty = true;\n            for (var i = 0; i < NR_COLS; i++) {\n                if (!this.chars[i].isEmpty()) {\n                    empty = false;\n                    break;\n                }\n            }\n            return empty;\n        }\n\n        /**\n         *  Set the cursor to a valid column.\n         */\n\n    }, {\n        key: 'setCursor',\n        value: function setCursor(absPos) {\n            if (this.pos !== absPos) {\n                this.pos = absPos;\n            }\n            if (this.pos < 0) {\n                logger.log('ERROR', 'Negative cursor position ' + this.pos);\n                this.pos = 0;\n            } else if (this.pos > NR_COLS) {\n                logger.log('ERROR', 'Too large cursor position ' + this.pos);\n                this.pos = NR_COLS;\n            }\n        }\n\n        /**\n         * Move the cursor relative to current position.\n         */\n\n    }, {\n        key: 'moveCursor',\n        value: function moveCursor(relPos) {\n            var newPos = this.pos + relPos;\n            if (relPos > 1) {\n                for (var i = this.pos + 1; i < newPos + 1; i++) {\n                    this.chars[i].setPenState(this.currPenState);\n                }\n            }\n            this.setCursor(newPos);\n        }\n\n        /**\n         * Backspace, move one step back and clear character.\n         */\n\n    }, {\n        key: 'backSpace',\n        value: function backSpace() {\n            this.moveCursor(-1);\n            this.chars[this.pos].setChar(' ', this.currPenState);\n        }\n    }, {\n        key: 'insertChar',\n        value: function insertChar(byte) {\n            if (byte >= 0x90) {\n                //Extended char\n                this.backSpace();\n            }\n            var char = getCharForByte(byte);\n            if (this.pos >= NR_COLS) {\n                logger.log('ERROR', 'Cannot insert ' + byte.toString(16) + ' (' + char + ') at position ' + this.pos + '. Skipping it!');\n                return;\n            }\n            this.chars[this.pos].setChar(char, this.currPenState);\n            this.moveCursor(1);\n        }\n    }, {\n        key: 'clearFromPos',\n        value: function clearFromPos(startPos) {\n            var i;\n            for (i = startPos; i < NR_COLS; i++) {\n                this.chars[i].reset();\n            }\n        }\n    }, {\n        key: 'clear',\n        value: function clear() {\n            this.clearFromPos(0);\n            this.pos = 0;\n            this.currPenState.reset();\n        }\n    }, {\n        key: 'clearToEndOfRow',\n        value: function clearToEndOfRow() {\n            this.clearFromPos(this.pos);\n        }\n    }, {\n        key: 'getTextString',\n        value: function getTextString() {\n            var chars = [];\n            var empty = true;\n            for (var i = 0; i < NR_COLS; i++) {\n                var char = this.chars[i].uchar;\n                if (char !== ' ') {\n                    empty = false;\n                }\n                chars.push(char);\n            }\n            if (empty) {\n                return '';\n            } else {\n                return chars.join('');\n            }\n        }\n    }, {\n        key: 'setPenStyles',\n        value: function setPenStyles(styles) {\n            this.currPenState.setStyles(styles);\n            var currChar = this.chars[this.pos];\n            currChar.setPenState(this.currPenState);\n        }\n    }]);\n\n    return Row;\n}();\n\n/**\n * Keep a CEA-608 screen of 32x15 styled characters\n * @constructor\n*/\n\n\nvar CaptionScreen = function () {\n    function CaptionScreen() {\n        _classCallCheck(this, CaptionScreen);\n\n        this.rows = [];\n        for (var i = 0; i < NR_ROWS; i++) {\n            this.rows.push(new Row()); // Note that we use zero-based numbering (0-14)\n        }\n        this.currRow = NR_ROWS - 1;\n        this.nrRollUpRows = null;\n        this.reset();\n    }\n\n    _createClass(CaptionScreen, [{\n        key: 'reset',\n        value: function reset() {\n            for (var i = 0; i < NR_ROWS; i++) {\n                this.rows[i].clear();\n            }\n            this.currRow = NR_ROWS - 1;\n        }\n    }, {\n        key: 'equals',\n        value: function equals(other) {\n            var equal = true;\n            for (var i = 0; i < NR_ROWS; i++) {\n                if (!this.rows[i].equals(other.rows[i])) {\n                    equal = false;\n                    break;\n                }\n            }\n            return equal;\n        }\n    }, {\n        key: 'copy',\n        value: function copy(other) {\n            for (var i = 0; i < NR_ROWS; i++) {\n                this.rows[i].copy(other.rows[i]);\n            }\n        }\n    }, {\n        key: 'isEmpty',\n        value: function isEmpty() {\n            var empty = true;\n            for (var i = 0; i < NR_ROWS; i++) {\n                if (!this.rows[i].isEmpty()) {\n                    empty = false;\n                    break;\n                }\n            }\n            return empty;\n        }\n    }, {\n        key: 'backSpace',\n        value: function backSpace() {\n            var row = this.rows[this.currRow];\n            row.backSpace();\n        }\n    }, {\n        key: 'clearToEndOfRow',\n        value: function clearToEndOfRow() {\n            var row = this.rows[this.currRow];\n            row.clearToEndOfRow();\n        }\n\n        /**\n         * Insert a character (without styling) in the current row.\n         */\n\n    }, {\n        key: 'insertChar',\n        value: function insertChar(char) {\n            var row = this.rows[this.currRow];\n            row.insertChar(char);\n        }\n    }, {\n        key: 'setPen',\n        value: function setPen(styles) {\n            var row = this.rows[this.currRow];\n            row.setPenStyles(styles);\n        }\n    }, {\n        key: 'moveCursor',\n        value: function moveCursor(relPos) {\n            var row = this.rows[this.currRow];\n            row.moveCursor(relPos);\n        }\n    }, {\n        key: 'setCursor',\n        value: function setCursor(absPos) {\n            logger.log('INFO', 'setCursor: ' + absPos);\n            var row = this.rows[this.currRow];\n            row.setCursor(absPos);\n        }\n    }, {\n        key: 'setPAC',\n        value: function setPAC(pacData) {\n            logger.log('INFO', 'pacData = ' + JSON.stringify(pacData));\n            var newRow = pacData.row - 1;\n            if (this.nrRollUpRows && newRow < this.nrRollUpRows - 1) {\n                newRow = this.nrRollUpRows - 1;\n            }\n\n            //Make sure this only affects Roll-up Captions by checking this.nrRollUpRows\n            if (this.nrRollUpRows && this.currRow !== newRow) {\n                //clear all rows first\n                for (var i = 0; i < NR_ROWS; i++) {\n                    this.rows[i].clear();\n                }\n\n                //Copy this.nrRollUpRows rows from lastOutputScreen and place it in the newRow location\n                //topRowIndex - the start of rows to copy (inclusive index)\n                var topRowIndex = this.currRow + 1 - this.nrRollUpRows;\n                //We only copy if the last position was already shown.\n                //We use the cueStartTime value to check this.\n                var lastOutputScreen = this.lastOutputScreen;\n                if (lastOutputScreen) {\n                    var prevLineTime = lastOutputScreen.rows[topRowIndex].cueStartTime;\n                    if (prevLineTime && prevLineTime < logger.time) {\n                        for (var _i = 0; _i < this.nrRollUpRows; _i++) {\n                            this.rows[newRow - this.nrRollUpRows + _i + 1].copy(lastOutputScreen.rows[topRowIndex + _i]);\n                        }\n                    }\n                }\n            }\n\n            this.currRow = newRow;\n            var row = this.rows[this.currRow];\n            if (pacData.indent !== null) {\n                var indent = pacData.indent;\n                var prevPos = Math.max(indent - 1, 0);\n                row.setCursor(pacData.indent);\n                pacData.color = row.chars[prevPos].penState.foreground;\n            }\n            var styles = { foreground: pacData.color, underline: pacData.underline, italics: pacData.italics, background: 'black', flash: false };\n            this.setPen(styles);\n        }\n\n        /**\n         * Set background/extra foreground, but first do back_space, and then insert space (backwards compatibility).\n         */\n\n    }, {\n        key: 'setBkgData',\n        value: function setBkgData(bkgData) {\n\n            logger.log('INFO', 'bkgData = ' + JSON.stringify(bkgData));\n            this.backSpace();\n            this.setPen(bkgData);\n            this.insertChar(0x20); //Space\n        }\n    }, {\n        key: 'setRollUpRows',\n        value: function setRollUpRows(nrRows) {\n            this.nrRollUpRows = nrRows;\n        }\n    }, {\n        key: 'rollUp',\n        value: function rollUp() {\n            if (this.nrRollUpRows === null) {\n                logger.log('DEBUG', 'roll_up but nrRollUpRows not set yet');\n                return; //Not properly setup\n            }\n            logger.log('TEXT', this.getDisplayText());\n            var topRowIndex = this.currRow + 1 - this.nrRollUpRows;\n            var topRow = this.rows.splice(topRowIndex, 1)[0];\n            topRow.clear();\n            this.rows.splice(this.currRow, 0, topRow);\n            logger.log('INFO', 'Rolling up');\n            //logger.log('TEXT', this.get_display_text())\n        }\n\n        /**\n         * Get all non-empty rows with as unicode text.\n         */\n\n    }, {\n        key: 'getDisplayText',\n        value: function getDisplayText(asOneRow) {\n            asOneRow = asOneRow || false;\n            var displayText = [];\n            var text = '';\n            var rowNr = -1;\n            for (var i = 0; i < NR_ROWS; i++) {\n                var rowText = this.rows[i].getTextString();\n                if (rowText) {\n                    rowNr = i + 1;\n                    if (asOneRow) {\n                        displayText.push('Row ' + rowNr + ': \\'' + rowText + '\\'');\n                    } else {\n                        displayText.push(rowText.trim());\n                    }\n                }\n            }\n            if (displayText.length > 0) {\n                if (asOneRow) {\n                    text = '[' + displayText.join(' | ') + ']';\n                } else {\n                    text = displayText.join('\\n');\n                }\n            }\n            return text;\n        }\n    }, {\n        key: 'getTextAndFormat',\n        value: function getTextAndFormat() {\n            return this.rows;\n        }\n    }]);\n\n    return CaptionScreen;\n}();\n\n//var modes = ['MODE_ROLL-UP', 'MODE_POP-ON', 'MODE_PAINT-ON', 'MODE_TEXT'];\n\nvar Cea608Channel = function () {\n    function Cea608Channel(channelNumber, outputFilter) {\n        _classCallCheck(this, Cea608Channel);\n\n        this.chNr = channelNumber;\n        this.outputFilter = outputFilter;\n        this.mode = null;\n        this.verbose = 0;\n        this.displayedMemory = new CaptionScreen();\n        this.nonDisplayedMemory = new CaptionScreen();\n        this.lastOutputScreen = new CaptionScreen();\n        this.currRollUpRow = this.displayedMemory.rows[NR_ROWS - 1];\n        this.writeScreen = this.displayedMemory;\n        this.mode = null;\n        this.cueStartTime = null; // Keeps track of where a cue started.\n    }\n\n    _createClass(Cea608Channel, [{\n        key: 'reset',\n        value: function reset() {\n            this.mode = null;\n            this.displayedMemory.reset();\n            this.nonDisplayedMemory.reset();\n            this.lastOutputScreen.reset();\n            this.currRollUpRow = this.displayedMemory.rows[NR_ROWS - 1];\n            this.writeScreen = this.displayedMemory;\n            this.mode = null;\n            this.cueStartTime = null;\n            this.lastCueEndTime = null;\n        }\n    }, {\n        key: 'getHandler',\n        value: function getHandler() {\n            return this.outputFilter;\n        }\n    }, {\n        key: 'setHandler',\n        value: function setHandler(newHandler) {\n            this.outputFilter = newHandler;\n        }\n    }, {\n        key: 'setPAC',\n        value: function setPAC(pacData) {\n            this.writeScreen.setPAC(pacData);\n        }\n    }, {\n        key: 'setBkgData',\n        value: function setBkgData(bkgData) {\n            this.writeScreen.setBkgData(bkgData);\n        }\n    }, {\n        key: 'setMode',\n        value: function setMode(newMode) {\n            if (newMode === this.mode) {\n                return;\n            }\n            this.mode = newMode;\n            logger.log('INFO', 'MODE=' + newMode);\n            if (this.mode === 'MODE_POP-ON') {\n                this.writeScreen = this.nonDisplayedMemory;\n            } else {\n                this.writeScreen = this.displayedMemory;\n                this.writeScreen.reset();\n            }\n            if (this.mode !== 'MODE_ROLL-UP') {\n                this.displayedMemory.nrRollUpRows = null;\n                this.nonDisplayedMemory.nrRollUpRows = null;\n            }\n            this.mode = newMode;\n        }\n    }, {\n        key: 'insertChars',\n        value: function insertChars(chars) {\n            for (var i = 0; i < chars.length; i++) {\n                this.writeScreen.insertChar(chars[i]);\n            }\n            var screen = this.writeScreen === this.displayedMemory ? 'DISP' : 'NON_DISP';\n            logger.log('INFO', screen + ': ' + this.writeScreen.getDisplayText(true));\n            if (this.mode === 'MODE_PAINT-ON' || this.mode === 'MODE_ROLL-UP') {\n                logger.log('TEXT', 'DISPLAYED: ' + this.displayedMemory.getDisplayText(true));\n                this.outputDataUpdate();\n            }\n        }\n    }, {\n        key: 'ccRCL',\n        value: function ccRCL() {\n            // Resume Caption Loading (switch mode to Pop On)\n            logger.log('INFO', 'RCL - Resume Caption Loading');\n            this.setMode('MODE_POP-ON');\n        }\n    }, {\n        key: 'ccBS',\n        value: function ccBS() {\n            // BackSpace\n            logger.log('INFO', 'BS - BackSpace');\n            if (this.mode === 'MODE_TEXT') {\n                return;\n            }\n            this.writeScreen.backSpace();\n            if (this.writeScreen === this.displayedMemory) {\n                this.outputDataUpdate();\n            }\n        }\n    }, {\n        key: 'ccAOF',\n        value: function ccAOF() {\n            // Reserved (formerly Alarm Off)\n            return;\n        }\n    }, {\n        key: 'ccAON',\n        value: function ccAON() {\n            // Reserved (formerly Alarm On)\n            return;\n        }\n    }, {\n        key: 'ccDER',\n        value: function ccDER() {\n            // Delete to End of Row\n            logger.log('INFO', 'DER- Delete to End of Row');\n            this.writeScreen.clearToEndOfRow();\n            this.outputDataUpdate();\n        }\n    }, {\n        key: 'ccRU',\n        value: function ccRU(nrRows) {\n            //Roll-Up Captions-2,3,or 4 Rows\n            logger.log('INFO', 'RU(' + nrRows + ') - Roll Up');\n            this.writeScreen = this.displayedMemory;\n            this.setMode('MODE_ROLL-UP');\n            this.writeScreen.setRollUpRows(nrRows);\n        }\n    }, {\n        key: 'ccFON',\n        value: function ccFON() {\n            //Flash On\n            logger.log('INFO', 'FON - Flash On');\n            this.writeScreen.setPen({ flash: true });\n        }\n    }, {\n        key: 'ccRDC',\n        value: function ccRDC() {\n            // Resume Direct Captioning (switch mode to PaintOn)\n            logger.log('INFO', 'RDC - Resume Direct Captioning');\n            this.setMode('MODE_PAINT-ON');\n        }\n    }, {\n        key: 'ccTR',\n        value: function ccTR() {\n            // Text Restart in text mode (not supported, however)\n            logger.log('INFO', 'TR');\n            this.setMode('MODE_TEXT');\n        }\n    }, {\n        key: 'ccRTD',\n        value: function ccRTD() {\n            // Resume Text Display in Text mode (not supported, however)\n            logger.log('INFO', 'RTD');\n            this.setMode('MODE_TEXT');\n        }\n    }, {\n        key: 'ccEDM',\n        value: function ccEDM() {\n            // Erase Displayed Memory\n            logger.log('INFO', 'EDM - Erase Displayed Memory');\n            this.displayedMemory.reset();\n            this.outputDataUpdate();\n        }\n    }, {\n        key: 'ccCR',\n        value: function ccCR() {\n            // Carriage Return\n            logger.log('CR - Carriage Return');\n            this.writeScreen.rollUp();\n            this.outputDataUpdate();\n        }\n    }, {\n        key: 'ccENM',\n        value: function ccENM() {\n            //Erase Non-Displayed Memory\n            logger.log('INFO', 'ENM - Erase Non-displayed Memory');\n            this.nonDisplayedMemory.reset();\n        }\n    }, {\n        key: 'ccEOC',\n        value: function ccEOC() {\n            //End of Caption (Flip Memories)\n            logger.log('INFO', 'EOC - End Of Caption');\n            if (this.mode === 'MODE_POP-ON') {\n                var tmp = this.displayedMemory;\n                this.displayedMemory = this.nonDisplayedMemory;\n                this.nonDisplayedMemory = tmp;\n                this.writeScreen = this.nonDisplayedMemory;\n                logger.log('TEXT', 'DISP: ' + this.displayedMemory.getDisplayText());\n            }\n            this.outputDataUpdate();\n        }\n    }, {\n        key: 'ccTO',\n        value: function ccTO(nrCols) {\n            // Tab Offset 1,2, or 3 columns\n            logger.log('INFO', 'TO(' + nrCols + ') - Tab Offset');\n            this.writeScreen.moveCursor(nrCols);\n        }\n    }, {\n        key: 'ccMIDROW',\n        value: function ccMIDROW(secondByte) {\n            // Parse MIDROW command\n            var styles = { flash: false };\n            styles.underline = secondByte % 2 === 1;\n            styles.italics = secondByte >= 0x2e;\n            if (!styles.italics) {\n                var colorIndex = Math.floor(secondByte / 2) - 0x10;\n                var colors = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta'];\n                styles.foreground = colors[colorIndex];\n            } else {\n                styles.foreground = 'white';\n            }\n            logger.log('INFO', 'MIDROW: ' + JSON.stringify(styles));\n            this.writeScreen.setPen(styles);\n        }\n    }, {\n        key: 'outputDataUpdate',\n        value: function outputDataUpdate() {\n            var t = logger.time;\n            if (t === null) {\n                return;\n            }\n            if (this.outputFilter) {\n                if (this.outputFilter.updateData) {\n                    this.outputFilter.updateData(t, this.displayedMemory);\n                }\n                if (this.cueStartTime === null && !this.displayedMemory.isEmpty()) {\n                    // Start of a new cue\n                    this.cueStartTime = t;\n                } else {\n                    if (!this.displayedMemory.equals(this.lastOutputScreen)) {\n                        if (this.outputFilter.newCue) {\n                            this.outputFilter.newCue(this.cueStartTime, t, this.lastOutputScreen);\n                        }\n                        this.cueStartTime = this.displayedMemory.isEmpty() ? null : t;\n                    }\n                }\n                this.lastOutputScreen.copy(this.displayedMemory);\n            }\n        }\n    }, {\n        key: 'cueSplitAtTime',\n        value: function cueSplitAtTime(t) {\n            if (this.outputFilter) {\n                if (!this.displayedMemory.isEmpty()) {\n                    if (this.outputFilter.newCue) {\n                        this.outputFilter.newCue(this.cueStartTime, t, this.displayedMemory);\n                    }\n                    this.cueStartTime = t;\n                }\n            }\n        }\n    }]);\n\n    return Cea608Channel;\n}();\n\nvar Cea608Parser = function () {\n    function Cea608Parser(field, out1, out2) {\n        _classCallCheck(this, Cea608Parser);\n\n        this.field = field || 1;\n        this.outputs = [out1, out2];\n        this.channels = [new Cea608Channel(1, out1), new Cea608Channel(2, out2)];\n        this.currChNr = -1; // Will be 1 or 2\n        this.lastCmdA = null; // First byte of last command\n        this.lastCmdB = null; // Second byte of last command\n        this.bufferedData = [];\n        this.startTime = null;\n        this.lastTime = null;\n        this.dataCounters = { 'padding': 0, 'char': 0, 'cmd': 0, 'other': 0 };\n    }\n\n    _createClass(Cea608Parser, [{\n        key: 'getHandler',\n        value: function getHandler(index) {\n            return this.channels[index].getHandler();\n        }\n    }, {\n        key: 'setHandler',\n        value: function setHandler(index, newHandler) {\n            this.channels[index].setHandler(newHandler);\n        }\n\n        /**\n         * Add data for time t in forms of list of bytes (unsigned ints). The bytes are treated as pairs.\n         */\n\n    }, {\n        key: 'addData',\n        value: function addData(t, byteList) {\n            var cmdFound,\n                a,\n                b,\n                charsFound = false;\n\n            this.lastTime = t;\n            logger.setTime(t);\n\n            for (var i = 0; i < byteList.length; i += 2) {\n                a = byteList[i] & 0x7f;\n                b = byteList[i + 1] & 0x7f;\n                if (a === 0 && b === 0) {\n                    this.dataCounters.padding += 2;\n                    continue;\n                } else {\n                    logger.log('DATA', '[' + numArrayToHexArray([byteList[i], byteList[i + 1]]) + '] -> (' + numArrayToHexArray([a, b]) + ')');\n                }\n                cmdFound = this.parseCmd(a, b);\n                if (!cmdFound) {\n                    cmdFound = this.parseMidrow(a, b);\n                }\n                if (!cmdFound) {\n                    cmdFound = this.parsePAC(a, b);\n                }\n                if (!cmdFound) {\n                    cmdFound = this.parseBackgroundAttributes(a, b);\n                }\n                if (!cmdFound) {\n                    charsFound = this.parseChars(a, b);\n                    if (charsFound) {\n                        if (this.currChNr && this.currChNr >= 0) {\n                            var channel = this.channels[this.currChNr - 1];\n                            channel.insertChars(charsFound);\n                        } else {\n                            logger.log('WARNING', 'No channel found yet. TEXT-MODE?');\n                        }\n                    }\n                }\n                if (cmdFound) {\n                    this.dataCounters.cmd += 2;\n                } else if (charsFound) {\n                    this.dataCounters.char += 2;\n                } else {\n                    this.dataCounters.other += 2;\n                    logger.log('WARNING', 'Couldn\\'t parse cleaned data ' + numArrayToHexArray([a, b]) + ' orig: ' + numArrayToHexArray([byteList[i], byteList[i + 1]]));\n                }\n            }\n        }\n\n        /**\n         * Parse Command.\n         * @returns {Boolean} Tells if a command was found\n         */\n\n    }, {\n        key: 'parseCmd',\n        value: function parseCmd(a, b) {\n            var chNr = null;\n\n            var cond1 = (a === 0x14 || a === 0x1C) && 0x20 <= b && b <= 0x2F;\n            var cond2 = (a === 0x17 || a === 0x1F) && 0x21 <= b && b <= 0x23;\n            if (!(cond1 || cond2)) {\n                return false;\n            }\n\n            if (a === this.lastCmdA && b === this.lastCmdB) {\n                this.lastCmdA = null;\n                this.lastCmdB = null; // Repeated commands are dropped (once)\n                logger.log('DEBUG', 'Repeated command (' + numArrayToHexArray([a, b]) + ') is dropped');\n                return true;\n            }\n\n            if (a === 0x14 || a === 0x17) {\n                chNr = 1;\n            } else {\n                chNr = 2; // (a === 0x1C || a=== 0x1f)\n            }\n\n            var channel = this.channels[chNr - 1];\n\n            if (a === 0x14 || a === 0x1C) {\n                if (b === 0x20) {\n                    channel.ccRCL();\n                } else if (b === 0x21) {\n                    channel.ccBS();\n                } else if (b === 0x22) {\n                    channel.ccAOF();\n                } else if (b === 0x23) {\n                    channel.ccAON();\n                } else if (b === 0x24) {\n                    channel.ccDER();\n                } else if (b === 0x25) {\n                    channel.ccRU(2);\n                } else if (b === 0x26) {\n                    channel.ccRU(3);\n                } else if (b === 0x27) {\n                    channel.ccRU(4);\n                } else if (b === 0x28) {\n                    channel.ccFON();\n                } else if (b === 0x29) {\n                    channel.ccRDC();\n                } else if (b === 0x2A) {\n                    channel.ccTR();\n                } else if (b === 0x2B) {\n                    channel.ccRTD();\n                } else if (b === 0x2C) {\n                    channel.ccEDM();\n                } else if (b === 0x2D) {\n                    channel.ccCR();\n                } else if (b === 0x2E) {\n                    channel.ccENM();\n                } else if (b === 0x2F) {\n                    channel.ccEOC();\n                }\n            } else {\n                //a == 0x17 || a == 0x1F\n                channel.ccTO(b - 0x20);\n            }\n            this.lastCmdA = a;\n            this.lastCmdB = b;\n            this.currChNr = chNr;\n            return true;\n        }\n\n        /**\n         * Parse midrow styling command\n         * @returns {Boolean}\n         */\n\n    }, {\n        key: 'parseMidrow',\n        value: function parseMidrow(a, b) {\n            var chNr = null;\n\n            if ((a === 0x11 || a === 0x19) && 0x20 <= b && b <= 0x2f) {\n                if (a === 0x11) {\n                    chNr = 1;\n                } else {\n                    chNr = 2;\n                }\n                if (chNr !== this.currChNr) {\n                    logger.log('ERROR', 'Mismatch channel in midrow parsing');\n                    return false;\n                }\n                var channel = this.channels[chNr - 1];\n                channel.ccMIDROW(b);\n                logger.log('DEBUG', 'MIDROW (' + numArrayToHexArray([a, b]) + ')');\n                return true;\n            }\n            return false;\n        }\n        /**\n         * Parse Preable Access Codes (Table 53).\n         * @returns {Boolean} Tells if PAC found\n         */\n\n    }, {\n        key: 'parsePAC',\n        value: function parsePAC(a, b) {\n\n            var chNr = null;\n            var row = null;\n\n            var case1 = (0x11 <= a && a <= 0x17 || 0x19 <= a && a <= 0x1F) && 0x40 <= b && b <= 0x7F;\n            var case2 = (a === 0x10 || a === 0x18) && 0x40 <= b && b <= 0x5F;\n            if (!(case1 || case2)) {\n                return false;\n            }\n\n            if (a === this.lastCmdA && b === this.lastCmdB) {\n                this.lastCmdA = null;\n                this.lastCmdB = null;\n                return true; // Repeated commands are dropped (once)\n            }\n\n            chNr = a <= 0x17 ? 1 : 2;\n\n            if (0x40 <= b && b <= 0x5F) {\n                row = chNr === 1 ? rowsLowCh1[a] : rowsLowCh2[a];\n            } else {\n                // 0x60 <= b <= 0x7F\n                row = chNr === 1 ? rowsHighCh1[a] : rowsHighCh2[a];\n            }\n            var pacData = this.interpretPAC(row, b);\n            var channel = this.channels[chNr - 1];\n            channel.setPAC(pacData);\n            this.lastCmdA = a;\n            this.lastCmdB = b;\n            this.currChNr = chNr;\n            return true;\n        }\n\n        /**\n         * Interpret the second byte of the pac, and return the information.\n         * @returns {Object} pacData with style parameters.\n         */\n\n    }, {\n        key: 'interpretPAC',\n        value: function interpretPAC(row, byte) {\n            var pacIndex = byte;\n            var pacData = { color: null, italics: false, indent: null, underline: false, row: row };\n\n            if (byte > 0x5F) {\n                pacIndex = byte - 0x60;\n            } else {\n                pacIndex = byte - 0x40;\n            }\n            pacData.underline = (pacIndex & 1) === 1;\n            if (pacIndex <= 0xd) {\n                pacData.color = ['white', 'green', 'blue', 'cyan', 'red', 'yellow', 'magenta', 'white'][Math.floor(pacIndex / 2)];\n            } else if (pacIndex <= 0xf) {\n                pacData.italics = true;\n                pacData.color = 'white';\n            } else {\n                pacData.indent = Math.floor((pacIndex - 0x10) / 2) * 4;\n            }\n            return pacData; // Note that row has zero offset. The spec uses 1.\n        }\n\n        /**\n         * Parse characters.\n         * @returns An array with 1 to 2 codes corresponding to chars, if found. null otherwise.\n         */\n\n    }, {\n        key: 'parseChars',\n        value: function parseChars(a, b) {\n\n            var channelNr = null,\n                charCodes = null,\n                charCode1 = null;\n\n            if (a >= 0x19) {\n                channelNr = 2;\n                charCode1 = a - 8;\n            } else {\n                channelNr = 1;\n                charCode1 = a;\n            }\n            if (0x11 <= charCode1 && charCode1 <= 0x13) {\n                // Special character\n                var oneCode = b;\n                if (charCode1 === 0x11) {\n                    oneCode = b + 0x50;\n                } else if (charCode1 === 0x12) {\n                    oneCode = b + 0x70;\n                } else {\n                    oneCode = b + 0x90;\n                }\n                logger.log('INFO', 'Special char \\'' + getCharForByte(oneCode) + '\\' in channel ' + channelNr);\n                charCodes = [oneCode];\n            } else if (0x20 <= a && a <= 0x7f) {\n                charCodes = b === 0 ? [a] : [a, b];\n            }\n            if (charCodes) {\n                var hexCodes = numArrayToHexArray(charCodes);\n                logger.log('DEBUG', 'Char codes =  ' + hexCodes.join(','));\n                this.lastCmdA = null;\n                this.lastCmdB = null;\n            }\n            return charCodes;\n        }\n\n        /**\n        * Parse extended background attributes as well as new foreground color black.\n        * @returns{Boolean} Tells if background attributes are found\n        */\n\n    }, {\n        key: 'parseBackgroundAttributes',\n        value: function parseBackgroundAttributes(a, b) {\n            var bkgData, index, chNr, channel;\n\n            var case1 = (a === 0x10 || a === 0x18) && 0x20 <= b && b <= 0x2f;\n            var case2 = (a === 0x17 || a === 0x1f) && 0x2d <= b && b <= 0x2f;\n            if (!(case1 || case2)) {\n                return false;\n            }\n            bkgData = {};\n            if (a === 0x10 || a === 0x18) {\n                index = Math.floor((b - 0x20) / 2);\n                bkgData.background = backgroundColors[index];\n                if (b % 2 === 1) {\n                    bkgData.background = bkgData.background + '_semi';\n                }\n            } else if (b === 0x2d) {\n                bkgData.background = 'transparent';\n            } else {\n                bkgData.foreground = 'black';\n                if (b === 0x2f) {\n                    bkgData.underline = true;\n                }\n            }\n            chNr = a < 0x18 ? 1 : 2;\n            channel = this.channels[chNr - 1];\n            channel.setBkgData(bkgData);\n            this.lastCmdA = null;\n            this.lastCmdB = null;\n            return true;\n        }\n\n        /**\n         * Reset state of parser and its channels.\n         */\n\n    }, {\n        key: 'reset',\n        value: function reset() {\n            for (var i = 0; i < this.channels.length; i++) {\n                if (this.channels[i]) {\n                    this.channels[i].reset();\n                }\n            }\n            this.lastCmdA = null;\n            this.lastCmdB = null;\n        }\n\n        /**\n         * Trigger the generation of a cue, and the start of a new one if displayScreens are not empty.\n         */\n\n    }, {\n        key: 'cueSplitAtTime',\n        value: function cueSplitAtTime(t) {\n            for (var i = 0; i < this.channels.length; i++) {\n                if (this.channels[i]) {\n                    this.channels[i].cueSplitAtTime(t);\n                }\n            }\n        }\n    }]);\n\n    return Cea608Parser;\n}();\n\nexports.default = Cea608Parser;\n\n},{}],48:[function(_dereq_,module,exports){\n'use strict';\n\nvar _vttparser = _dereq_(53);\n\nvar Cues = {\n\n  newCue: function newCue(track, startTime, endTime, captionScreen) {\n    var row;\n    var cue;\n    var indenting;\n    var indent;\n    var text;\n    var VTTCue = window.VTTCue || window.TextTrackCue;\n\n    for (var r = 0; r < captionScreen.rows.length; r++) {\n      row = captionScreen.rows[r];\n      indenting = true;\n      indent = 0;\n      text = '';\n\n      if (!row.isEmpty()) {\n        for (var c = 0; c < row.chars.length; c++) {\n          if (row.chars[c].uchar.match(/\\s/) && indenting) {\n            indent++;\n          } else {\n            text += row.chars[c].uchar;\n            indenting = false;\n          }\n        }\n        //To be used for cleaning-up orphaned roll-up captions\n        row.cueStartTime = startTime;\n        cue = new VTTCue(startTime, endTime, (0, _vttparser.fixLineBreaks)(text.trim()));\n\n        if (indent >= 16) {\n          indent--;\n        } else {\n          indent++;\n        }\n\n        // VTTCue.line get's flakey when using controls, so let's now include line 13&14\n        // also, drop line 1 since it's to close to the top\n        if (navigator.userAgent.match(/Firefox\\//)) {\n          cue.line = r + 1;\n        } else {\n          cue.line = r > 7 ? r - 2 : r + 1;\n        }\n        cue.align = 'left';\n        // Clamp the position between 0 and 100 - if out of these bounds, Firefox throws an exception and captions break\n        cue.position = Math.max(0, Math.min(100, 100 * (indent / 32) + (navigator.userAgent.match(/Firefox\\//) ? 50 : 0)));\n        track.addCue(cue);\n      }\n    }\n  }\n\n};\n\nmodule.exports = Cues;\n\n},{\"53\":53}],49:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n * compute an Exponential Weighted moving average\n * - https://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average\n *  - heavily inspired from shaka-player\n */\n\nvar EWMA = function () {\n\n  //  About half of the estimated value will be from the last |halfLife| samples by weight.\n  function EWMA(halfLife) {\n    _classCallCheck(this, EWMA);\n\n    // Larger values of alpha expire historical data more slowly.\n    this.alpha_ = halfLife ? Math.exp(Math.log(0.5) / halfLife) : 0;\n    this.estimate_ = 0;\n    this.totalWeight_ = 0;\n  }\n\n  _createClass(EWMA, [{\n    key: \"sample\",\n    value: function sample(weight, value) {\n      var adjAlpha = Math.pow(this.alpha_, weight);\n      this.estimate_ = value * (1 - adjAlpha) + adjAlpha * this.estimate_;\n      this.totalWeight_ += weight;\n    }\n  }, {\n    key: \"getTotalWeight\",\n    value: function getTotalWeight() {\n      return this.totalWeight_;\n    }\n  }, {\n    key: \"getEstimate\",\n    value: function getEstimate() {\n      if (this.alpha_) {\n        var zeroFactor = 1 - Math.pow(this.alpha_, this.totalWeight_);\n        return this.estimate_ / zeroFactor;\n      } else {\n        return this.estimate_;\n      }\n    }\n  }]);\n\n  return EWMA;\n}();\n\nexports.default = EWMA;\n\n},{}],50:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction noop() {}\n\nvar fakeLogger = {\n  trace: noop,\n  debug: noop,\n  log: noop,\n  warn: noop,\n  info: noop,\n  error: noop\n};\n\nvar exportedLogger = fakeLogger;\n\n/*globals self: false */\n\n//let lastCallTime;\n// function formatMsgWithTimeInfo(type, msg) {\n//   const now = Date.now();\n//   const diff = lastCallTime ? '+' + (now - lastCallTime) : '0';\n//   lastCallTime = now;\n//   msg = (new Date(now)).toISOString() + ' | [' +  type + '] > ' + msg + ' ( ' + diff + ' ms )';\n//   return msg;\n// }\n\nfunction formatMsg(type, msg) {\n  msg = '[' + type + '] > ' + msg;\n  return msg;\n}\n\nfunction consolePrintFn(type) {\n  var func = self.console[type];\n  if (func) {\n    return function () {\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (args[0]) {\n        args[0] = formatMsg(type, args[0]);\n      }\n      func.apply(self.console, args);\n    };\n  }\n  return noop;\n}\n\nfunction exportLoggerFunctions(debugConfig) {\n  for (var _len2 = arguments.length, functions = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    functions[_key2 - 1] = arguments[_key2];\n  }\n\n  functions.forEach(function (type) {\n    exportedLogger[type] = debugConfig[type] ? debugConfig[type].bind(debugConfig) : consolePrintFn(type);\n  });\n}\n\nvar enableLogs = exports.enableLogs = function enableLogs(debugConfig) {\n  if (debugConfig === true || (typeof debugConfig === 'undefined' ? 'undefined' : _typeof(debugConfig)) === 'object') {\n    exportLoggerFunctions(debugConfig,\n    // Remove out from list here to hard-disable a log-level\n    //'trace',\n    'debug', 'log', 'info', 'warn', 'error');\n    // Some browsers don't allow to use bind on console object anyway\n    // fallback to default if needed\n    try {\n      exportedLogger.log();\n    } catch (e) {\n      exportedLogger = fakeLogger;\n    }\n  } else {\n    exportedLogger = fakeLogger;\n  }\n};\n\nvar logger = exports.logger = exportedLogger;\n\n},{}],51:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n *  TimeRanges to string helper\n */\n\nvar TimeRanges = function () {\n  function TimeRanges() {\n    _classCallCheck(this, TimeRanges);\n  }\n\n  _createClass(TimeRanges, null, [{\n    key: 'toString',\n    value: function toString(r) {\n      var log = '',\n          len = r.length;\n      for (var i = 0; i < len; i++) {\n        log += '[' + r.start(i).toFixed(3) + ',' + r.end(i).toFixed(3) + ']';\n      }\n      return log;\n    }\n  }]);\n\n  return TimeRanges;\n}();\n\nexports.default = TimeRanges;\n\n},{}],52:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Copyright 2013 vtt.js Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexports.default = function () {\n  if (typeof window !== 'undefined' && window.VTTCue) {\n    return window.VTTCue;\n  }\n\n  var autoKeyword = 'auto';\n  var directionSetting = {\n    '': true,\n    lr: true,\n    rl: true\n  };\n  var alignSetting = {\n    start: true,\n    middle: true,\n    end: true,\n    left: true,\n    right: true\n  };\n\n  function findDirectionSetting(value) {\n    if (typeof value !== 'string') {\n      return false;\n    }\n    var dir = directionSetting[value.toLowerCase()];\n    return dir ? value.toLowerCase() : false;\n  }\n\n  function findAlignSetting(value) {\n    if (typeof value !== 'string') {\n      return false;\n    }\n    var align = alignSetting[value.toLowerCase()];\n    return align ? value.toLowerCase() : false;\n  }\n\n  function extend(obj) {\n    var i = 1;\n    for (; i < arguments.length; i++) {\n      var cobj = arguments[i];\n      for (var p in cobj) {\n        obj[p] = cobj[p];\n      }\n    }\n\n    return obj;\n  }\n\n  function VTTCue(startTime, endTime, text) {\n    var cue = this;\n    var isIE8 = function () {\n      if (typeof navigator === 'undefined') {\n        return;\n      }\n      return (/MSIE\\s8\\.0/.test(navigator.userAgent)\n      );\n    }();\n    var baseObj = {};\n\n    if (isIE8) {\n      cue = document.createElement('custom');\n    } else {\n      baseObj.enumerable = true;\n    }\n\n    /**\n     * Shim implementation specific properties. These properties are not in\n     * the spec.\n     */\n\n    // Lets us know when the VTTCue's data has changed in such a way that we need\n    // to recompute its display state. This lets us compute its display state\n    // lazily.\n    cue.hasBeenReset = false;\n\n    /**\n     * VTTCue and TextTrackCue properties\n     * http://dev.w3.org/html5/webvtt/#vttcue-interface\n     */\n\n    var _id = '';\n    var _pauseOnExit = false;\n    var _startTime = startTime;\n    var _endTime = endTime;\n    var _text = text;\n    var _region = null;\n    var _vertical = '';\n    var _snapToLines = true;\n    var _line = 'auto';\n    var _lineAlign = 'start';\n    var _position = 50;\n    var _positionAlign = 'middle';\n    var _size = 50;\n    var _align = 'middle';\n\n    Object.defineProperty(cue, 'id', extend({}, baseObj, {\n      get: function get() {\n        return _id;\n      },\n      set: function set(value) {\n        _id = '' + value;\n      }\n    }));\n\n    Object.defineProperty(cue, 'pauseOnExit', extend({}, baseObj, {\n      get: function get() {\n        return _pauseOnExit;\n      },\n      set: function set(value) {\n        _pauseOnExit = !!value;\n      }\n    }));\n\n    Object.defineProperty(cue, 'startTime', extend({}, baseObj, {\n      get: function get() {\n        return _startTime;\n      },\n      set: function set(value) {\n        if (typeof value !== 'number') {\n          throw new TypeError('Start time must be set to a number.');\n        }\n        _startTime = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'endTime', extend({}, baseObj, {\n      get: function get() {\n        return _endTime;\n      },\n      set: function set(value) {\n        if (typeof value !== 'number') {\n          throw new TypeError('End time must be set to a number.');\n        }\n        _endTime = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'text', extend({}, baseObj, {\n      get: function get() {\n        return _text;\n      },\n      set: function set(value) {\n        _text = '' + value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'region', extend({}, baseObj, {\n      get: function get() {\n        return _region;\n      },\n      set: function set(value) {\n        _region = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'vertical', extend({}, baseObj, {\n      get: function get() {\n        return _vertical;\n      },\n      set: function set(value) {\n        var setting = findDirectionSetting(value);\n        // Have to check for false because the setting an be an empty string.\n        if (setting === false) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _vertical = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'snapToLines', extend({}, baseObj, {\n      get: function get() {\n        return _snapToLines;\n      },\n      set: function set(value) {\n        _snapToLines = !!value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'line', extend({}, baseObj, {\n      get: function get() {\n        return _line;\n      },\n      set: function set(value) {\n        if (typeof value !== 'number' && value !== autoKeyword) {\n          throw new SyntaxError('An invalid number or illegal string was specified.');\n        }\n        _line = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'lineAlign', extend({}, baseObj, {\n      get: function get() {\n        return _lineAlign;\n      },\n      set: function set(value) {\n        var setting = findAlignSetting(value);\n        if (!setting) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _lineAlign = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'position', extend({}, baseObj, {\n      get: function get() {\n        return _position;\n      },\n      set: function set(value) {\n        if (value < 0 || value > 100) {\n          throw new Error('Position must be between 0 and 100.');\n        }\n        _position = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'positionAlign', extend({}, baseObj, {\n      get: function get() {\n        return _positionAlign;\n      },\n      set: function set(value) {\n        var setting = findAlignSetting(value);\n        if (!setting) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _positionAlign = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'size', extend({}, baseObj, {\n      get: function get() {\n        return _size;\n      },\n      set: function set(value) {\n        if (value < 0 || value > 100) {\n          throw new Error('Size must be between 0 and 100.');\n        }\n        _size = value;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    Object.defineProperty(cue, 'align', extend({}, baseObj, {\n      get: function get() {\n        return _align;\n      },\n      set: function set(value) {\n        var setting = findAlignSetting(value);\n        if (!setting) {\n          throw new SyntaxError('An invalid or illegal string was specified.');\n        }\n        _align = setting;\n        this.hasBeenReset = true;\n      }\n    }));\n\n    /**\n     * Other <track> spec defined properties\n     */\n\n    // http://www.whatwg.org/specs/web-apps/current-work/multipage/the-video-element.html#text-track-cue-display-state\n    cue.displayState = undefined;\n\n    if (isIE8) {\n      return cue;\n    }\n  }\n\n  /**\n   * VTTCue methods\n   */\n\n  VTTCue.prototype.getCueAsHTML = function () {\n    // Assume WebVTT.convertCueToDOMTree is on the global.\n    var WebVTT = window.WebVTT;\n    return WebVTT.convertCueToDOMTree(window, this.text);\n  };\n\n  return VTTCue;\n}();\n\n},{}],53:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fixLineBreaks = undefined;\n\nvar _vttcue = _dereq_(52);\n\nvar _vttcue2 = _interopRequireDefault(_vttcue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar StringDecoder = function StringDecoder() {\n  return {\n    decode: function decode(data) {\n      if (!data) {\n        return '';\n      }\n      if (typeof data !== 'string') {\n        throw new Error('Error - expected string data.');\n      }\n      return decodeURIComponent(encodeURIComponent(data));\n    }\n  };\n}; /*\n    * Source: https://github.com/mozilla/vtt.js/blob/master/dist/vtt.js#L1716\n    */\n\nfunction VTTParser() {\n  this.window = window;\n  this.state = 'INITIAL';\n  this.buffer = '';\n  this.decoder = new StringDecoder();\n  this.regionList = [];\n}\n\n// Try to parse input as a time stamp.\nfunction parseTimeStamp(input) {\n\n  function computeSeconds(h, m, s, f) {\n    return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\n  }\n\n  var m = input.match(/^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/);\n  if (!m) {\n    return null;\n  }\n\n  if (m[3]) {\n    // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\n    return computeSeconds(m[1], m[2], m[3].replace(':', ''), m[4]);\n  } else if (m[1] > 59) {\n    // Timestamp takes the form of [hours]:[minutes].[milliseconds]\n    // First position is hours as it's over 59.\n    return computeSeconds(m[1], m[2], 0, m[4]);\n  } else {\n    // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\n    return computeSeconds(0, m[1], m[2], m[4]);\n  }\n}\n\n// A settings object holds key/value pairs and will ignore anything but the first\n// assignment to a specific key.\nfunction Settings() {\n  this.values = Object.create(null);\n}\n\nSettings.prototype = {\n  // Only accept the first assignment to any key.\n  set: function set(k, v) {\n    if (!this.get(k) && v !== '') {\n      this.values[k] = v;\n    }\n  },\n  // Return the value for a key, or a default value.\n  // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\n  // a number of possible default values as properties where 'defaultKey' is\n  // the key of the property that will be chosen; otherwise it's assumed to be\n  // a single value.\n  get: function get(k, dflt, defaultKey) {\n    if (defaultKey) {\n      return this.has(k) ? this.values[k] : dflt[defaultKey];\n    }\n    return this.has(k) ? this.values[k] : dflt;\n  },\n  // Check whether we have a value for a key.\n  has: function has(k) {\n    return k in this.values;\n  },\n  // Accept a setting if its one of the given alternatives.\n  alt: function alt(k, v, a) {\n    for (var n = 0; n < a.length; ++n) {\n      if (v === a[n]) {\n        this.set(k, v);\n        break;\n      }\n    }\n  },\n  // Accept a setting if its a valid (signed) integer.\n  integer: function integer(k, v) {\n    if (/^-?\\d+$/.test(v)) {\n      // integer\n      this.set(k, parseInt(v, 10));\n    }\n  },\n  // Accept a setting if its a valid percentage.\n  percent: function percent(k, v) {\n    var m;\n    if (m = v.match(/^([\\d]{1,3})(\\.[\\d]*)?%$/)) {\n      v = parseFloat(v);\n      if (v >= 0 && v <= 100) {\n        this.set(k, v);\n        return true;\n      }\n    }\n    return false;\n  }\n};\n\n// Helper function to parse input into groups separated by 'groupDelim', and\n// interprete each group as a key/value pair separated by 'keyValueDelim'.\nfunction parseOptions(input, callback, keyValueDelim, groupDelim) {\n  var groups = groupDelim ? input.split(groupDelim) : [input];\n  for (var i in groups) {\n    if (typeof groups[i] !== 'string') {\n      continue;\n    }\n    var kv = groups[i].split(keyValueDelim);\n    if (kv.length !== 2) {\n      continue;\n    }\n    var k = kv[0];\n    var v = kv[1];\n    callback(k, v);\n  }\n}\n\nvar defaults = new _vttcue2.default(0, 0, 0);\n// 'middle' was changed to 'center' in the spec: https://github.com/w3c/webvtt/pull/244\n// Chrome and Safari don't yet support this change, but FF does\nvar center = defaults.align === 'middle' ? 'middle' : 'center';\n\nfunction parseCue(input, cue, regionList) {\n  // Remember the original input if we need to throw an error.\n  var oInput = input;\n  // 4.1 WebVTT timestamp\n  function consumeTimeStamp() {\n    var ts = parseTimeStamp(input);\n    if (ts === null) {\n      throw new Error('Malformed timestamp: ' + oInput);\n    }\n    // Remove time stamp from input.\n    input = input.replace(/^[^\\sa-zA-Z-]+/, '');\n    return ts;\n  }\n\n  // 4.4.2 WebVTT cue settings\n  function consumeCueSettings(input, cue) {\n    var settings = new Settings();\n\n    parseOptions(input, function (k, v) {\n      switch (k) {\n        case 'region':\n          // Find the last region we parsed with the same region id.\n          for (var i = regionList.length - 1; i >= 0; i--) {\n            if (regionList[i].id === v) {\n              settings.set(k, regionList[i].region);\n              break;\n            }\n          }\n          break;\n        case 'vertical':\n          settings.alt(k, v, ['rl', 'lr']);\n          break;\n        case 'line':\n          var vals = v.split(','),\n              vals0 = vals[0];\n          settings.integer(k, vals0);\n          if (settings.percent(k, vals0)) {\n            settings.set('snapToLines', false);\n          }\n          settings.alt(k, vals0, ['auto']);\n          if (vals.length === 2) {\n            settings.alt('lineAlign', vals[1], ['start', center, 'end']);\n          }\n          break;\n        case 'position':\n          vals = v.split(',');\n          settings.percent(k, vals[0]);\n          if (vals.length === 2) {\n            settings.alt('positionAlign', vals[1], ['start', center, 'end', 'line-left', 'line-right', 'auto']);\n          }\n          break;\n        case 'size':\n          settings.percent(k, v);\n          break;\n        case 'align':\n          settings.alt(k, v, ['start', center, 'end', 'left', 'right']);\n          break;\n      }\n    }, /:/, /\\s/);\n\n    // Apply default values for any missing fields.\n    cue.region = settings.get('region', null);\n    cue.vertical = settings.get('vertical', '');\n    var line = settings.get('line', 'auto');\n    if (line === 'auto' && defaults.line === -1) {\n      // set numeric line number for Safari\n      line = -1;\n    }\n    cue.line = line;\n    cue.lineAlign = settings.get('lineAlign', 'start');\n    cue.snapToLines = settings.get('snapToLines', true);\n    cue.size = settings.get('size', 100);\n    cue.align = settings.get('align', center);\n    var position = settings.get('position', 'auto');\n    if (position === 'auto' && defaults.position === 50) {\n      // set numeric position for Safari\n      position = cue.align === 'start' || cue.align === 'left' ? 0 : cue.align === 'end' || cue.align === 'right' ? 100 : 50;\n    }\n    cue.position = position;\n  }\n\n  function skipWhitespace() {\n    input = input.replace(/^\\s+/, '');\n  }\n\n  // 4.1 WebVTT cue timings.\n  skipWhitespace();\n  cue.startTime = consumeTimeStamp(); // (1) collect cue start time\n  skipWhitespace();\n  if (input.substr(0, 3) !== '-->') {\n    // (3) next characters must match '-->'\n    throw new Error('Malformed time stamp (time stamps must be separated by \\'-->\\'): ' + oInput);\n  }\n  input = input.substr(3);\n  skipWhitespace();\n  cue.endTime = consumeTimeStamp(); // (5) collect cue end time\n\n  // 4.1 WebVTT cue settings list.\n  skipWhitespace();\n  consumeCueSettings(input, cue);\n}\n\nfunction fixLineBreaks(input) {\n  return input.replace(/<br(?: \\/)?>/gi, '\\n');\n}\n\nVTTParser.prototype = {\n  parse: function parse(data) {\n    var self = this;\n\n    // If there is no data then we won't decode it, but will just try to parse\n    // whatever is in buffer already. This may occur in circumstances, for\n    // example when flush() is called.\n    if (data) {\n      // Try to decode the data that we received.\n      self.buffer += self.decoder.decode(data, { stream: true });\n    }\n\n    function collectNextLine() {\n      var buffer = self.buffer;\n      var pos = 0;\n\n      buffer = fixLineBreaks(buffer);\n\n      while (pos < buffer.length && buffer[pos] !== '\\r' && buffer[pos] !== '\\n') {\n        ++pos;\n      }\n      var line = buffer.substr(0, pos);\n      // Advance the buffer early in case we fail below.\n      if (buffer[pos] === '\\r') {\n        ++pos;\n      }\n      if (buffer[pos] === '\\n') {\n        ++pos;\n      }\n      self.buffer = buffer.substr(pos);\n      return line;\n    }\n\n    // 3.2 WebVTT metadata header syntax\n    function parseHeader(input) {\n      parseOptions(input, function (k, v) {\n        switch (k) {\n          case 'Region':\n            // 3.3 WebVTT region metadata header syntax\n            console.log('parse region', v);\n            //parseRegion(v);\n            break;\n        }\n      }, /:/);\n    }\n\n    // 5.1 WebVTT file parsing.\n    try {\n      var line;\n      if (self.state === 'INITIAL') {\n        // We can't start parsing until we have the first line.\n        if (!/\\r\\n|\\n/.test(self.buffer)) {\n          return this;\n        }\n\n        line = collectNextLine();\n\n        var m = line.match(/^WEBVTT([ \\t].*)?$/);\n        if (!m || !m[0]) {\n          throw new Error('Malformed WebVTT signature.');\n        }\n\n        self.state = 'HEADER';\n      }\n\n      var alreadyCollectedLine = false;\n      while (self.buffer) {\n        // We can't parse a line until we have the full line.\n        if (!/\\r\\n|\\n/.test(self.buffer)) {\n          return this;\n        }\n\n        if (!alreadyCollectedLine) {\n          line = collectNextLine();\n        } else {\n          alreadyCollectedLine = false;\n        }\n\n        switch (self.state) {\n          case 'HEADER':\n            // 13-18 - Allow a header (metadata) under the WEBVTT line.\n            if (/:/.test(line)) {\n              parseHeader(line);\n            } else if (!line) {\n              // An empty line terminates the header and starts the body (cues).\n              self.state = 'ID';\n            }\n            continue;\n          case 'NOTE':\n            // Ignore NOTE blocks.\n            if (!line) {\n              self.state = 'ID';\n            }\n            continue;\n          case 'ID':\n            // Check for the start of NOTE blocks.\n            if (/^NOTE($|[ \\t])/.test(line)) {\n              self.state = 'NOTE';\n              break;\n            }\n            // 19-29 - Allow any number of line terminators, then initialize new cue values.\n            if (!line) {\n              continue;\n            }\n            self.cue = new _vttcue2.default(0, 0, '');\n            self.state = 'CUE';\n            // 30-39 - Check if self line contains an optional identifier or timing data.\n            if (line.indexOf('-->') === -1) {\n              self.cue.id = line;\n              continue;\n            }\n          // Process line as start of a cue.\n          /*falls through*/\n          case 'CUE':\n            // 40 - Collect cue timings and settings.\n            try {\n              parseCue(line, self.cue, self.regionList);\n            } catch (e) {\n              // In case of an error ignore rest of the cue.\n              self.cue = null;\n              self.state = 'BADCUE';\n              continue;\n            }\n            self.state = 'CUETEXT';\n            continue;\n          case 'CUETEXT':\n            var hasSubstring = line.indexOf('-->') !== -1;\n            // 34 - If we have an empty line then report the cue.\n            // 35 - If we have the special substring '-->' then report the cue,\n            // but do not collect the line as we need to process the current\n            // one as a new cue.\n            if (!line || hasSubstring && (alreadyCollectedLine = true)) {\n              // We are done parsing self cue.\n              if (self.oncue) {\n                self.oncue(self.cue);\n              }\n              self.cue = null;\n              self.state = 'ID';\n              continue;\n            }\n            if (self.cue.text) {\n              self.cue.text += '\\n';\n            }\n            self.cue.text += line;\n            continue;\n          case 'BADCUE':\n            // BADCUE\n            // 54-62 - Collect and discard the remaining cue.\n            if (!line) {\n              self.state = 'ID';\n            }\n            continue;\n        }\n      }\n    } catch (e) {\n\n      // If we are currently parsing a cue, report what we have.\n      if (self.state === 'CUETEXT' && self.cue && self.oncue) {\n        self.oncue(self.cue);\n      }\n      self.cue = null;\n      // Enter BADWEBVTT state if header was not parsed correctly otherwise\n      // another exception occurred so enter BADCUE state.\n      self.state = self.state === 'INITIAL' ? 'BADWEBVTT' : 'BADCUE';\n    }\n    return this;\n  },\n  flush: function flush() {\n    var self = this;\n    try {\n      // Finish decoding the stream.\n      self.buffer += self.decoder.decode();\n      // Synthesize the end of the current cue or region.\n      if (self.cue || self.state === 'HEADER') {\n        self.buffer += '\\n\\n';\n        self.parse();\n      }\n      // If we've flushed, parsed, and we're still on the INITIAL state then\n      // that means we don't have enough of the stream to parse the first\n      // line.\n      if (self.state === 'INITIAL') {\n        throw new Error('Malformed WebVTT signature.');\n      }\n    } catch (e) {\n      throw e;\n    }\n    if (self.onflush) {\n      self.onflush();\n    }\n    return this;\n  }\n};\n\nexports.fixLineBreaks = fixLineBreaks;\nexports.default = VTTParser;\n\n},{\"52\":52}],54:[function(_dereq_,module,exports){\n'use strict';\n\nvar _vttparser = _dereq_(53);\n\nvar _vttparser2 = _interopRequireDefault(_vttparser);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar cueString2millis = function cueString2millis(timeString) {\n    var ts = parseInt(timeString.substr(-3));\n    var secs = parseInt(timeString.substr(-6, 2));\n    var mins = parseInt(timeString.substr(-9, 2));\n    var hours = timeString.length > 9 ? parseInt(timeString.substr(0, timeString.indexOf(':'))) : 0;\n\n    if (isNaN(ts) || isNaN(secs) || isNaN(mins) || isNaN(hours)) {\n        return -1;\n    }\n\n    ts += 1000 * secs;\n    ts += 60 * 1000 * mins;\n    ts += 60 * 60 * 1000 * hours;\n\n    return ts;\n};\n\nvar calculateOffset = function calculateOffset(vttCCs, cc, presentationTime) {\n    var currCC = vttCCs[cc];\n    var prevCC = vttCCs[currCC.prevCC];\n\n    // This is the first discontinuity or cues have been processed since the last discontinuity\n    // Offset = current discontinuity time\n    if (!prevCC || !prevCC.new && currCC.new) {\n        vttCCs.ccOffset = vttCCs.presentationOffset = currCC.start;\n        currCC.new = false;\n        return;\n    }\n\n    // There have been discontinuities since cues were last parsed.\n    // Offset = time elapsed\n    while (prevCC && prevCC.new) {\n        vttCCs.ccOffset += currCC.start - prevCC.start;\n        currCC.new = false;\n        currCC = prevCC;\n        prevCC = vttCCs[currCC.prevCC];\n    }\n\n    vttCCs.presentationOffset = presentationTime;\n};\n\nvar WebVTTParser = {\n    parse: function parse(vttByteArray, syncPTS, vttCCs, cc, callBack, errorCallBack) {\n        // Convert byteArray into string, replacing any somewhat exotic linefeeds with \"\\n\", then split on that character.\n        var re = /\\r\\n|\\n\\r|\\n|\\r/g;\n        var vttLines = String.fromCharCode.apply(null, new Uint8Array(vttByteArray)).trim().replace(re, '\\n').split('\\n');\n        var cueTime = '00:00.000';\n        var mpegTs = 0;\n        var localTime = 0;\n        var presentationTime = 0;\n        var cues = [];\n        var parsingError = void 0;\n        var inHeader = true;\n        // let VTTCue = VTTCue || window.TextTrackCue;\n\n        // Create parser object using VTTCue with TextTrackCue fallback on certain browsers.\n        var parser = new _vttparser2.default();\n\n        parser.oncue = function (cue) {\n            // Adjust cue timing; clamp cues to start no earlier than - and drop cues that don't end after - 0 on timeline.\n            var currCC = vttCCs[cc];\n            var cueOffset = vttCCs.ccOffset;\n\n            // Update offsets for new discontinuities\n            if (currCC && currCC.new) {\n                if (localTime) {\n                    // When local time is provided, offset = discontinuity start time - local time\n                    cueOffset = vttCCs.ccOffset = currCC.start;\n                } else {\n                    calculateOffset(vttCCs, cc, presentationTime);\n                }\n            }\n\n            if (presentationTime && !localTime) {\n                // If we have MPEGTS but no LOCAL time, offset = presentation time + discontinuity offset\n                cueOffset = presentationTime + vttCCs.ccOffset - vttCCs.presentationOffset;\n            }\n\n            cue.startTime += cueOffset - localTime;\n            cue.endTime += cueOffset - localTime;\n\n            // Fix encoding of special characters. TODO: Test with all sorts of weird characters.\n            cue.text = decodeURIComponent(escape(cue.text));\n            if (cue.endTime > 0) {\n                cues.push(cue);\n            }\n        };\n\n        parser.onparsingerror = function (e) {\n            parsingError = e;\n        };\n\n        parser.onflush = function () {\n            if (parsingError && errorCallBack) {\n                errorCallBack(parsingError);\n                return;\n            }\n            callBack(cues);\n        };\n\n        // Go through contents line by line.\n        vttLines.forEach(function (line) {\n            if (inHeader) {\n                // Look for X-TIMESTAMP-MAP in header.\n                if (line.startsWith('X-TIMESTAMP-MAP=')) {\n                    // Once found, no more are allowed anyway, so stop searching.\n                    inHeader = false;\n                    // Extract LOCAL and MPEGTS.\n                    line.substr(16).split(',').forEach(function (timestamp) {\n                        if (timestamp.startsWith('LOCAL:')) {\n                            cueTime = timestamp.substr(6);\n                        } else if (timestamp.startsWith('MPEGTS:')) {\n                            mpegTs = parseInt(timestamp.substr(7));\n                        }\n                    });\n                    try {\n                        // Calculate subtitle offset in milliseconds.\n                        // If sync PTS is less than zero, we have a 33-bit wraparound, which is fixed by adding 2^33 = 8589934592.\n                        syncPTS = syncPTS < 0 ? syncPTS + 8589934592 : syncPTS;\n                        // Adjust MPEGTS by sync PTS.\n                        mpegTs -= syncPTS;\n                        // Convert cue time to seconds\n                        localTime = cueString2millis(cueTime) / 1000;\n                        // Convert MPEGTS to seconds from 90kHz.\n                        presentationTime = mpegTs / 90000;\n\n                        if (localTime === -1) {\n                            parsingError = new Error('Malformed X-TIMESTAMP-MAP: ' + line);\n                        }\n                    } catch (e) {\n                        parsingError = new Error('Malformed X-TIMESTAMP-MAP: ' + line);\n                    }\n                    // Return without parsing X-TIMESTAMP-MAP line.\n                    return;\n                } else if (line === '') {\n                    inHeader = false;\n                }\n            }\n            // Parse line by default.\n            parser.parse(line + '\\n');\n        });\n\n        parser.flush();\n    }\n};\n\nmodule.exports = WebVTTParser;\n\n},{\"53\":53}],55:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * XHR based logger\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\nvar _logger = _dereq_(50);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar XhrLoader = function () {\n  function XhrLoader(config) {\n    _classCallCheck(this, XhrLoader);\n\n    if (config && config.xhrSetup) {\n      this.xhrSetup = config.xhrSetup;\n    }\n  }\n\n  _createClass(XhrLoader, [{\n    key: 'destroy',\n    value: function destroy() {\n      this.abort();\n      this.loader = null;\n    }\n  }, {\n    key: 'abort',\n    value: function abort() {\n      var loader = this.loader;\n      if (loader && loader.readyState !== 4) {\n        this.stats.aborted = true;\n        loader.abort();\n      }\n\n      window.clearTimeout(this.requestTimeout);\n      this.requestTimeout = null;\n      window.clearTimeout(this.retryTimeout);\n      this.retryTimeout = null;\n    }\n  }, {\n    key: 'load',\n    value: function load(context, config, callbacks) {\n      this.context = context;\n      this.config = config;\n      this.callbacks = callbacks;\n      this.stats = { trequest: performance.now(), retry: 0 };\n      this.retryDelay = config.retryDelay;\n      this.loadInternal();\n    }\n  }, {\n    key: 'loadInternal',\n    value: function loadInternal() {\n      var xhr,\n          context = this.context;\n\n      if (typeof XDomainRequest !== 'undefined') {\n        xhr = this.loader = new XDomainRequest();\n      } else {\n        xhr = this.loader = new XMLHttpRequest();\n      }\n\n      xhr.onreadystatechange = this.readystatechange.bind(this);\n      xhr.onprogress = this.loadprogress.bind(this);\n\n      xhr.open('GET', context.url, true);\n\n      if (context.rangeEnd) {\n        xhr.setRequestHeader('Range', 'bytes=' + context.rangeStart + '-' + (context.rangeEnd - 1));\n      }\n      xhr.responseType = context.responseType;\n      var stats = this.stats;\n      stats.tfirst = 0;\n      stats.loaded = 0;\n      if (this.xhrSetup) {\n        this.xhrSetup(xhr, context.url);\n      }\n      // setup timeout before we perform request\n      this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), this.config.timeout);\n      xhr.send();\n    }\n  }, {\n    key: 'readystatechange',\n    value: function readystatechange(event) {\n      var xhr = event.currentTarget,\n          readyState = xhr.readyState,\n          stats = this.stats,\n          context = this.context,\n          config = this.config;\n\n      // don't proceed if xhr has been aborted\n      if (stats.aborted) {\n        return;\n      }\n\n      // >= HEADERS_RECEIVED\n      if (readyState >= 2) {\n        // clear xhr timeout and rearm it if readyState less than 4\n        window.clearTimeout(this.requestTimeout);\n        if (stats.tfirst === 0) {\n          stats.tfirst = Math.max(performance.now(), stats.trequest);\n        }\n        if (readyState === 4) {\n          var status = xhr.status;\n          // http status between 200 to 299 are all successful\n          if (status >= 200 && status < 300) {\n            stats.tload = Math.max(stats.tfirst, performance.now());\n            var data = void 0,\n                len = void 0;\n            if (context.responseType === 'arraybuffer') {\n              data = xhr.response;\n              len = data.byteLength;\n            } else {\n              data = xhr.responseText;\n              len = data.length;\n            }\n            stats.loaded = stats.total = len;\n            var response = { url: xhr.responseURL, data: data };\n            this.callbacks.onSuccess(response, stats, context);\n          } else {\n            // if max nb of retries reached or if http status between 400 and 499 (such error cannot be recovered, retrying is useless), return error\n            if (stats.retry >= config.maxRetry || status >= 400 && status < 499) {\n              _logger.logger.error(status + ' while loading ' + context.url);\n              this.callbacks.onError({ code: status, text: xhr.statusText }, context);\n            } else {\n              // retry\n              _logger.logger.warn(status + ' while loading ' + context.url + ', retrying in ' + this.retryDelay + '...');\n              // aborts and resets internal state\n              this.destroy();\n              // schedule retry\n              this.retryTimeout = window.setTimeout(this.loadInternal.bind(this), this.retryDelay);\n              // set exponential backoff\n              this.retryDelay = Math.min(2 * this.retryDelay, config.maxRetryDelay);\n              stats.retry++;\n            }\n          }\n        } else {\n          // readyState >= 2 AND readyState !==4 (readyState = HEADERS_RECEIVED || LOADING) rearm timeout as xhr not finished yet\n          this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), config.timeout);\n        }\n      }\n    }\n  }, {\n    key: 'loadtimeout',\n    value: function loadtimeout() {\n      _logger.logger.warn('timeout while loading ' + this.context.url);\n      this.callbacks.onTimeout(this.stats, this.context);\n    }\n  }, {\n    key: 'loadprogress',\n    value: function loadprogress(event) {\n      var stats = this.stats;\n      stats.loaded = event.loaded;\n      if (event.lengthComputable) {\n        stats.total = event.total;\n      }\n      var onProgress = this.callbacks.onProgress;\n      if (onProgress) {\n        // last args is to provide on progress data\n        onProgress(stats, this.context, null);\n      }\n    }\n  }]);\n\n  return XhrLoader;\n}();\n\nexports.default = XhrLoader;\n\n},{\"50\":50}]},{},[38])(38)\n});\n//# sourceMappingURL=hls.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/hls.js/dist/hls.js\n// module id = ./node_modules/hls.js/dist/hls.js\n// module chunks = 2","(function() { module.exports = window[\"jQuery\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 0\n// module chunks = 1 2 3 4 7 8 9 11 12 13 14 15 16 17 18 19 22 23 24 25 26 27 28 29 30 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 83","(function() { module.exports = window[\"_\"]; }());\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 1\n// module chunks = 1 2 3 4 7 8 9 12 13 14 16 17 18 19 22 23 24 25 26 27 28 29 30 33 34 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74"],"sourceRoot":""}